/*! For license information please see product-push.c94c249089d257498de1.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{"+I3z":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.ImageLayer=Class({fileItem:null,temporaryFileItem:null,shouldUseTempFile:!1,overrideColors:null,isCustomizable:!1,embroideryType:"",isEmbroideryAfterMigration:null,migratedToNewPicker:null,getType:function(){return PF.Components.GeneratorMockup.ImageLayer.TYPE},_getNewLayer:function(){return new PF.Components.GeneratorMockup.ImageLayer},isImageLayer:function(){return!0},getOriginalClone:function(e){var t=this._getNewLayer();return e||(t.uniqueId=this.uniqueId),t.fileItem=this.fileItem,t.temporaryFileItem=this.temporaryFileItem,t.overrideImage=this.overrideImage,t.overrideImagePulse=this.overrideImagePulse,t.position=this.position.getFromOriginalRatio(),t.originalPosition=this.originalPosition.getClone(),t.parentLayerUniqueId=this.parentLayerUniqueId,t.shouldUseTempFile=this.shouldUseTempFile,t.customizeKey=this.customizeKey,t.generatorOptions=this.generatorOptions,t.isCustomizable=this.isCustomizable,t.embroideryType=this.embroideryType,t.isEmbroideryAfterMigration=this.isEmbroideryAfterMigration,t.migratedToNewPicker=this.migratedToNewPicker,t.patternType=this.patternType,t.patternSpacing=this.patternSpacing,t.flipX=this.flipX,t.flipY=this.flipY,this.overrideColors&&(t.overrideColors={},mkE.O2O(t.overrideColors,this.overrideColors)),t},getDPI:function(){if(this.isVector())return 600;var e=this.shouldUseTempFile&&this.temporaryFileItem?this.temporaryFileItem.width:this.fileItem.width;return Math.round(e/this.position.getFromOriginalRatio().width)},getSourceWidth:function(){return this.fileItem.width},getSourceHeight:function(){return this.fileItem.height},getSourceDpi:function(){return this.fileItem.dpi},matchesAdvancedTemplate:function(e){var t=e.width/e.height,i=this.getSourceWidth()/this.getSourceHeight();return Math.abs(t-i)<=.01},isVector:function(){return this.fileItem?this.fileItem.isVector:this.temporaryFileItem.isVector},hasNaturalSize:function(){return!!this.fileItem.dpi},hasTransparencyIssues:function(){var e=this.fileItem&&this.fileItem.extra?this.fileItem.extra.transparency:this.temporaryFileItem&&this.temporaryFileItem.extra&&this.temporaryFileItem.extra.transparency;return!!e&&e.prediction>0},toArray:function(e){return{type:PF.Components.GeneratorMockup.ImageLayer.TYPE,fileId:this.fileItem?this.fileItem.fileId:null,url:this._getUrl(e),position:this.position?this.position.toArray():{},overrideColors:this.overrideColors,isCustomizable:this.isCustomizable?1:0,customizeKey:this.customizeKey,uniqueId:this.uniqueId,parentLayerUniqueId:this.parentLayerUniqueId,overrideImage:this.overrideImage,overrideImagePulse:this.overrideImagePulse,embroideryType:this.embroideryType,isEmbroideryAfterMigration:this.isEmbroideryAfterMigration,migratedToNewPicker:this.migratedToNewPicker,patternType:this.patternType,patternSpacing:this.patternSpacing,flipX:this.flipX,flipY:this.flipY}},_getUrl:function(e){var t=null;return t=this.temporaryFileItem&&this.shouldUseTempFile?this.temporaryFileItem.urlLarge:this.fileItem.urlPreview,e&&this.fileItem&&(t=this.fileItem.urlThumb),e&&this.temporaryFileItem&&this.shouldUseTempFile&&(t=this.temporaryFileItem.urlThumb),t},isConfigurationSame:function(e){var t=e.migratedToNewPicker!==this.migratedToNewPicker,i=this.fileItem&&e.fileItem&&this.fileItem.fileId===e.fileItem.fileId,r=JSON.stringify(e.overrideColors)===JSON.stringify(this.overrideColors);return i&&r&&!t}},PF.Components.GeneratorMockup.Layer),PF.Components.GeneratorMockup.ImageLayer.TYPE="file",PF.Components.GeneratorMockup.ImageLayer.fromFileItem=function(e){var t=new PF.Components.GeneratorMockup.ImageLayer;return t.fileItem=e,t.originalPosition=new PF.Items.GeneratorPositionItem,t.position=t.originalPosition.getClone(),t}}()},"0dT7":function(e,t){!function(){"use strict";PF.ProductPush.ProductMockup.Par=Class({mockupMaxWidth:400,mockupMaxHeight:400,generatorVariant:null,templateKey:"",templates:null,activeLayer:null,onReady:null,allowSpecificProductMirroring:!0,product:null,isOrderFlow:!1,disableLayerManipulations:!1,hideZoomButton:!1,disableOutOfBoundsErrorMessages:!1,isCustomizingMode:!1,designFillColor:""})}()},19:function(e,t,i){i("iv3r"),i("9w4f"),i("uGFp"),i("81X1"),i("DyGm"),i("8F1a"),i("KOkY"),i("2dYE"),i("XfzR"),i("c20R"),i("vfGd"),i("1Rbq"),i("2hoX"),i("oE+F"),i("e2M2"),i("APlb"),i("aqvs"),i("osBa"),i("tx4t"),i("XJBm"),i("XPj6"),i("j/Tf"),i("0dT7"),i("Z7Gj"),i("NuwY"),i("kPvU"),i("zfrb"),i("tFrD"),i("aH++"),i("IZFg"),i("zVjX"),i("md6N"),i("42oZ"),i("mN+k"),i("YAAi"),i("HxbZ"),i("zsu5"),i("ke60"),i("MMbA"),i("JQxb"),i("H8cr"),i("RH5U"),i("F8X5"),i("jorx"),i("C2ea"),i("589/"),i("jY/V"),i("jstg"),i("3svu"),i("KVJj"),i("ggRW"),i("ZbaC"),i("MW8O"),i("7gtE"),i("AKhu"),i("2XqL"),i("PSt6"),i("2IQc"),i("dTyb"),i("94Bt"),i("IbzY"),i("nvph"),i("2+PC"),i("oaIx"),i("VyA4"),i("pkOh"),i("v88+"),i("wllI"),i("muKr"),i("axjw"),i("gY30"),i("Z6GA"),i("ka4h"),i("7XA3"),i("cVO5"),i("53sR"),i("WJaN"),i("yGJc"),i("ULKP"),i("tWQt"),i("79oW"),i("ukqv"),i("7Pmj"),i("eQsQ"),i("n6mh"),i("+I3z"),i("pWIn"),i("gqyd"),i("N47+"),i("7h5t"),i("qud1"),i("GVd7"),i("b/Os"),i("U4D8"),i("mrzt"),i("mizT"),i("86cz"),i("yQrk"),i("wQfs"),i("hdKH"),i("dxbw"),i("VINB"),i("Vfa7"),i("FU2h"),i("sXCq"),i("4fkK"),e.exports=i("c50J")},"1Rbq":function(e,t){!function(){"use strict";PF.ProductPush.SyncedProductPicker.Item=Class({_syncProduct:null,__construct:function(e,t,i,r){this._syncProduct=e,this._shouldItemBeSelected=t,this._onItemSelectedCallback=i,this._status=r,this._nodeStatusBadge=this._getStatusBadge(),this.node=tag("div",{onclick:this._onProductSelected,className:"col-6 col-sm-3 synced-product-add-picker__item"});var n=new PF.Forms.CheckboxPar;n.checked=this._shouldItemBeSelected(this),this.productItem=tag("div","product-item pf-mb-16 pf-mb-md-24 pf-mb-lg-32",[new PF.Components.SquareBox({urlImage:e.urlImage}),tag("div","product-item__detail pf-p-16",[this._nodeStatusBadge,tag("h5","pf-h5 pf-m-0",[e.name]),tag("div","pf-ui-caption","#"+e.externalId),tag("div","text-muted pf-ui-caption",[nlang("%d variation","%d variations",e.counts.synced)])]),this._nodeCheckboxInput=new PF.Forms.Checkbox(n)]).append(this.node)},_onCheckboxChange:function(e){e&&e.stopImmediatePropagation(),this._showCheckedState(),this._onItemSelectedCallback&&this._onItemSelectedCallback(this)},_showCheckedState:function(){this._nodeCheckboxInput.checked?mkE.addClassName(this.productItem,"checked"):mkE.removeClassName(this.productItem,"checked")},isChecked:function(){return this._nodeCheckboxInput.checked},setChecked:function(e){this._nodeCheckboxInput.checked=e,this._showCheckedState()},_onProductSelected:function(){this._nodeCheckboxInput.setChecked(!this._nodeCheckboxInput.checked),this.setChecked(!this._nodeCheckboxInput.checked),this._showCheckedState(),this._onItemSelectedCallback(this)},getSyncProduct:function(){return this._syncProduct},_getStatusBadge:function(){if(!this._status)return!1;var e="success",t=PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_ADDED];return this._status===PF.ProductPush.SyncedProductCounts.TYPE_FAILED&&(e="danger",t=PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_FAILED]),tag("span",{className:"margin-right-5 label label-"+e,text:t})}},mkE.Base)}()},"2+PC":function(e,t){!function(){"use strict";PF.ProductPush.Pickers={},PF.ProductPush.Pickers.Params=Class({POPOVER:{DISCONTINUED:{TITLE:lang("Discontinued"),DESC:dlang("generator","Sorry, this color and size combination is discontinued. Please choose another color or size.")},REGION:{TITLE:dlang("site","Fulfilled in {region}"),DESC:dlang("generator","Ships to locations worldwide")},UNAVAILABLE:{TITLE:lang("Out of stock").toUpperCase(),DESC:dlang("generator","Sorry, this color and size combination is out of stock. Fulfillment may take longer while we re-stock.")},SAMPLE:{TITLE:dlang("generator","Not available as sample"),DESC:dlang("generator","You can place it as a basic order")}},values:[],allValues:[],selectedValues:[],selectedLimit:0,canDeselectLast:!0,pickerTitle:"",onChangedCallback:null,isPopoverEnabled:!1,getSelectedSizes:null,productId:null,isSizeGuideVisible:!1,designData:null,isSizeNodeTitleVisible:!0})}()},"2IQc":function(e,t){!function(){"use strict";PF.Components.GeneratorMockupControls=Class({_currentReversedDPI:0,_sizeSlider:null,__construct:function(e){if(this.par=e,this.par.withSlider){var t=new PF.Components.Slider.Par;t.min=20,t.max=100,t.onSlide=this.par.onScale,t.onSlideEnded=this.par.onScale,this._sizeSlider=new PF.Components.Slider(t)}var i=tag("a",{className:"btn btn-default pf-mr-4",onclick:e.onCenterVertical,attr:{title:clang("action (to center something)","Vertically center"),"data-toggle":"tooltip"}},[tag("i","pf-i pf-i-format-vertical-align-center pf-i-18")]),r=tag("a",{className:"btn btn-default pf-mr-4",onclick:e.onCenterHorizontal,attr:{title:clang("action (to center something)","Horizontally center"),"data-toggle":"tooltip"}},[tag("i","pf-i pf-i-format-horizontal-align-center pf-i-18")]),n=!1;this.par.onReset&&(n=mkE({tag:"a",className:"btn btn-default",onclick:e.onReset,text:clang("action (to reset something)","Reset"),attr:{title:lang("Undo all changes"),"data-toggle":"tooltip"}})),this.node=mkE({tag:"div",className:"position-controls"+(this.par.showButtons?"":" mockup-generator__controls"),els:[!!this._sizeSlider&&{tag:"div",className:"margin-right-10 slider-container",els:[this._sizeSlider]},{tag:"div",className:"hidden-lg hidden-md margin-bottom-5",els:[{tag:"span",className:"button-wrap",style:{display:"none"},els:[{tag:"a",className:"glyphicon glyphicon-minus btn btn-default margin-right-5 padding-horizontal-15",onclick:this._addDPI.bind(this,-1)},{tag:"a",className:"glyphicon glyphicon-plus btn btn-default margin-right-5 padding-horizontal-15",onclick:this._addDPI.bind(this,1)}]},{tag:"a",className:"glyphicon glyphicon-menu-left btn btn-default margin-right-5 padding-horizontal-15",onclick:this._move.bind(this,-1,0)},{tag:"a",className:"glyphicon glyphicon-menu-right btn btn-default margin-right-5 padding-horizontal-15",onclick:this._move.bind(this,1,0)},{tag:"a",className:"glyphicon glyphicon-menu-up btn btn-default margin-right-5 padding-horizontal-15",onclick:this._move.bind(this,0,-1)},{tag:"a",className:"glyphicon glyphicon-menu-down btn btn-default padding-horizontal-15",onclick:this._move.bind(this,0,1)}]},i,r,n]}),$([n,i,r].filter((function(e){return e}))).tooltip({trigger:"hover"})},show:function(){mkE.removeClassName(this.node,"mockup-generator__controls")},hide:function(){mkE.addClassName(this.node,"mockup-generator__controls")},_addDPI:function(e,t){this._setCurrentReversedDPI(this._currentReversedDPI+5*e),t.preventDefault()},_move:function(e,t,i){i.preventDefault(),this.par.onMove(e,t)},_setCurrentReversedDPI:function(e){e<=this.par.requiredDPI&&(e=this.par.requiredDPI),e>=this.par.maxDPI&&(e=this.par.maxDPI),this._currentReversedDPI=e},setSliderValue:function(e){this._sizeSlider&&this._sizeSlider.setValue(e)}},mkE.Base)}()},"2XqL":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Canvas.Par=Class({__NAME:"PF.Components.GeneratorMockup.Canvas.Par",mockupPosition:null,templates:null,onPositionChanged:null,onTextChanged:null,onLayerSelected:null,onLayerRemoved:null,onPreview:null,isCustomizingMode:!1,opts:null})}()},"2dYE":function(e,t){!function(){"use strict";PF.ProductPush.SyncedProductCounts=Class({all:0,notAdded:0,added:0,failed:0}),PF.ProductPush.SyncedProductCounts.fromArray=function(e){var t=PF.ProductPush.SyncedProductCounts;return mkE.O2O(t,e),t},PF.ProductPush.SyncedProductCounts.TYPE_ALL="all",PF.ProductPush.SyncedProductCounts.TYPE_NOT_ADDED="notAdded",PF.ProductPush.SyncedProductCounts.TYPE_ADDED="added",PF.ProductPush.SyncedProductCounts.TYPE_FAILED="failed",PF.ProductPush.SyncedProductCounts.types={},PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_ALL]=lang("All"),PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_NOT_ADDED]=lang("Not added"),PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_ADDED]=lang("Added"),PF.ProductPush.SyncedProductCounts.types[PF.ProductPush.SyncedProductCounts.TYPE_FAILED]=lang("Failed"),PF.ProductPush.SyncedProductCounts.COUNT_PUSHABLE=100,PF.ProductPush.SyncedProductCounts.AMOUNT_UNKNOWN=-1}()},"2hoX":function(e,t,i){"use strict";i.r(t);var r=i("herG"),n=i("j3JC");PF.ProductPush.AddCustomProduct=Class({_par:null,_product:null,_store:null,_designData:null,_onPushCallback:null,_breadcrumbs:null,inputMarketplaceCategory:null,breadcrumbItems:[],vuexStore:void 0,__construct:function(e){this._par=e||new PF.ProductPush.AddCustomProduct.Par,this._product=this._par.customProduct,this._store=this._par.store,this._onPushCallback=this._par.onPushCallback,this._breadcrumbs=this._par.breadcrumbs,this.breadcrumbItems=[{title:lang("Add description"),onclick:this._renderDescription},{title:lang("Pricing"),onclick:this._renderPricing}];var t=new PF.ProductPush.DesignData;t.store=this._store,t.storeId=this._store.storeId,t.templates=[],t.filesIdsByPlacement=[],t.productId=245,t.customProductId=this._product.id,this._designData=t,this._render()},_render:function(){this.node=tag("div","",[this._breadcrumbsNode=tag("div"),this._mainNode=tag("div")]),this._renderDescription()},_renderDescription:function(){mkE.clearNode(this._mainNode),this._renderBreadcrumbs(1);var e=new PF.Forms.InputPar;e.label=dlang("dashboard","Product title"),e.value=this._designData.title?this._designData.title:this._product.name,e.validators=[new PF.Forms.Validator(new PF.Forms.Validator.RequiredPar)];var t=new PF.Forms.Input(e),i=new PF.Forms.TextareaPar;i.label=dlang("dashboard","Description"),i.className="push-description",i.value=this._designData.description,i.validators=[new PF.Forms.Validator(new PF.Forms.Validator.RequiredPar)];var r=new PF.Forms.Textarea(i);tag("div","container-fluid product-push-pricing",[tag("div","row",[tag("div","col-md-4",[this._mockupNode=tag("div","text-center")]),tag("div","col-md-8",[tag("div","margin-bottom-20",[this.inputTitle=t]),tag("div","margin-bottom-20",[this.inputDescription=r]),this._store.hasFlag(PF.Items.StoreItem.Flags.HAS_MARKETPLACE_CATEGORY_PICKER)&&this._getNodeWithCategoryPicker(),PF.ProductPush.MockupPicker.Tags.allowTagPush(this._store.type)&&this._getNodeWithTagSelector()])]),tag("div","row",[tag("div","col-md-12")])]).append(this._mainNode),this._nodeFooter=tag("div","footer-block navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[tag("a",{className:"btn btn-danger",onclick:this._continueToPricing},dlang("dashboard","Proceed to pricing"))])]),tag("div","margin-bottom-25 product-push__main-mockup-image-text",[tag("img",{src:this._product.urlImage})]).append(this._mockupNode),this._par.stickyButtonNodeUpdate&&this._par.stickyButtonNodeUpdate(this._nodeFooter)},_renderBreadcrumbs:function(e){mkE.clearNode(this._breadcrumbsNode),this._breadcrumbs=new PF.Components.BreadCrumbs;var t=this._par.breadcrumbs.items.slice(),i=this.breadcrumbItems.slice(0,e).map((function(e){return new PF.Components.BreadCrumbs.Item(e)}));this._breadcrumbs.items=t.concat(i),this._breadcrumbs.render(),this._breadcrumbs.node.append(this._breadcrumbsNode)},_validateForm:function(){var e=!0;return this.inputTitle.validate()||(e=!1),this.inputDescription.validate()||(e=!1),this._store.hasFlag(PF.Items.StoreItem.Flags.HAS_MARKETPLACE_CATEGORY_PICKER)&&!this.inputMarketplaceCategory.validate()&&(e=!1),e},_continueToPricing:function(){this._validateForm()&&(this._designData.title=this.inputTitle.getValue(),this._designData.description=this.inputDescription.getValue(),PF.ProductPush.MockupPicker.Tags.allowTagPush(this._designData.store.type)&&(this._designData.tags=this._tagSelector.getTagValue()),this._store.hasFlag(PF.Items.StoreItem.Flags.HAS_MARKETPLACE_CATEGORY_PICKER)&&(this._designData.integrationMarketplaceCategoryIds=this.inputMarketplaceCategory.getValue()),RPC("product-generator/calculate-custom-product-prices",{customProductId:this._product.id,storeId:this._store.storeId},this._onPricesLoaded))},_onPricesLoaded:function(e){var t=[];for(var i in e.prices){var r=PF.Items.GeneratorPriceItem.fromArray(e.prices[i]);t.push(r)}this._designData.setPrices(t),this._initPushState(),this._renderPricing()},_initPushState:function(){this.vuexStore||(this.vuexStore=Object(r.a)(),Object(r.c)(this.vuexStore,this._designData))},_renderPricing:function(){mkE.clearNode(this._mainNode),this._renderBreadcrumbs(2);var e=new PF.ProductPush.Pricing(this._designData,this._onProductPush.bind(this),!1,{onBack:this._renderDescription.bind(this)}),t=new n.b;t.vuexStore=this.vuexStore,t.onUpdate=function(t){var i=t.isValid;e.toggleContinueState(i)};var i=new n.a(t);tag("div",null,[i,e]).append(this._mainNode),this._par.stickyButtonNodeUpdate&&this._par.stickyButtonNodeUpdate(e._nodeFooter)},_onProductPush:function(){Object(r.b)(this.vuexStore,this._designData),this._onPushCallback(this._designData)},_getNodeWithCategoryPicker:function(){var e=new PF.Repositories.IntegrationMarketplaceCategories(this._store.integrationName),t=new PF.TreeItemPicker.Par;return t.repository=e,t.selectedIds=this._designData.integrationMarketplaceCategoryIds||[],t.label=dlang("dashboard","Category"),t.placeholder=dlang("dashboard","Search category..."),t.noItemText=dlang("dashboard","Sorry, there are no categories to show"),t.inputName="category",this.inputMarketplaceCategory=new PF.TreeItemPicker(t),tag("div","margin-bottom-20",[this.inputMarketplaceCategory])},_getNodeWithTagSelector:function(){return this._tagSelector=new PF.ProductPush.MockupPicker.Tags(this._designData),this._tagSelector}},mkE.Base),PF.ProductPush.AddCustomProduct.Par=Class({customProduct:null,store:null,onPushCallback:null,breadcrumbs:null})},"3svu":function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.Tags=Class({_recentTagsItems:null,_designData:null,inputTags:null,maxTags:13,maxChars:255,inputValidation:null,__construct:function(e){this._designData=e,this._render()},_render:function(){var e=this._designData.store.type==PF.Items.StoreItem.TYPE_ETSY?lang("Tags (max 13)"):lang("Tags");this.node=mkE({tag:"div",className:"margin-bottom-20 no-icon-tags",id:"product_push_tag_block",els:[{tag:"label",text:e},this.inputTags=mkE({tag:"input",type:"text",className:"tagInput"})]}),this._getRecentTags()&&(this.recentTagList=this._getNodeWithRecentTags(),this.recentTagList.append(this.node)),this._initTagInput()},_getNodeWithRecentTags:function(){var e=this._recentTagsItems;if(0!==e.length){var t=mkE({tag:"div",className:"product-push__recent-tags--inner"});for(var i in e){var r=e[i];mkE({tag:"a",href:"#",className:"pf-link margin-right-5",text:r,onclick:this._addTagToField.bind(this,r)}).append(t)}return mkE({tag:"div",className:"product-push__recent-tags margin-top-5",els:[{tag:"span",className:"margin-right-5",text:lang("Recent:")},t]})}},_addTagToField:function(e,t){if(t.preventDefault(),!(this.getTagValue().split(",").length>=this.maxTags||e.match(this.inputValidation))){mkE.clearNode(this.recentTagList);var i=this._recentTagsItems.indexOf(e);this._recentTagsItems.splice(i,1),this.recentTagList=this._getNodeWithRecentTags(),this.recentTagList&&this.recentTagList.append(this.node);var r=$(this.node).find("input");r.tagExist(e)||(r.addTag(e),r.parent().find(".tagsinput input").val(""))}},_initTagInput:function(){var e=$("#"+this.node.id+" input");0!=e.length?(this._designData.store.type===PF.Items.StoreItem.TYPE_ETSY&&(this.maxChars=20),this._designData.store.type===PF.Items.StoreItem.TYPE_SHOPIFY&&(this.inputValidation=/^[\W]+$/),e.tagsInput({width:"100%",height:"39px",defaultText:"",placeholderColor:"#a7a7a7",placeholderFont:"ProximaNova-Regular, sans-serif",maxChars:this.maxChars,onAddTag:this._limitCount,onRemoveTag:this._limitCount,inputValidation:this.inputValidation}),$(this.node).find("input").on("paste",this._processPastedTags.bind(this)),e.parent().find(".tagsinput input").attr("placeholder",lang("Separate with comma")),this._designData.tags&&e.importTags(this._designData.tags)):setTimeout($.proxy(this._initTagInput,this),200)},_processPastedTags:function(e){e.preventDefault();var t=$(this.node).find("input"),i=null;window.clipboardData&&window.clipboardData.getData?i=window.clipboardData.getData("Text"):e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(i=e.originalEvent.clipboardData.getData("text"));var r=i.split(",");for(var n in r)if(r.hasOwnProperty(n)){var a=r[n];!(a.length<=this.maxChars)||t.tagExist(a)||a.match(this.inputValidation)||(t.addTag(a),t.parent().find(".tagsinput input").val(""))}},_getRecentTags:function(){if(this._recentTagsItems)return this._recentTagsItems;if(!localStorage)return null;var e=localStorage.getItem("pushGeneratorTags");if(!e)return null;var t=e.split(",");return t?(this._recentTagsItems=t,t):null},getTagValue:function(){return this.inputTags.value},_limitCount:function(e){var t=this.getTagValue().split(","),i=$("#"+this.node.id+" input");t.length>this.maxTags?(i.removeTag(e),i.parent().find(".tagsinput input").val(""),i.parent().find(".tagsinput input").attr("placeholder",lang("Tag limit reached"))):i.parent().find(".tagsinput input").attr("placeholder",lang("Separate with comma"))}},mkE.Base),PF.ProductPush.MockupPicker.Tags.setRecentTags=function(e){if(localStorage&&e)try{localStorage.setItem("pushGeneratorTags",e)}catch(e){console.log("Local storage not supported")}},PF.ProductPush.MockupPicker.Tags.allowTagPush=function(e){return-1!==[PF.Items.StoreItem.TYPE_ETSY,PF.Items.StoreItem.TYPE_SHOPIFY].indexOf(e)}}()},"42oZ":function(e,t){!function(){"use strict";PF.ProductPush.VariantArea.Item=Class({_par:null,__construct:function(e){this._par=e;var t=new PF.Components.GeneratorMockup.Preview.Par;t.maxHeight=85,t.maxWidth=78,t.generatorVariant=this._par.generatorVariant,this._mockupPreview=new PF.Components.GeneratorMockup.Preview(t),this._overlayNode=tag("div"),this.node=tag("div",{className:"variant-item",onclick:function(e){e.stopImmediatePropagation(),this._par.onSelect&&this._par.onSelect()}.bind(this)},[this._nodeQuality=tag("div","quality-icon"),this._par.onRemove?tag("a",{className:"variant-item__remove",onclick:function(e){e.stopImmediatePropagation(),this._par.onRemove()}.bind(this)}):"",this._mockupPreview,tag("span","",this._par.generatorVariant.title),this._overlayNode]),this._updateDPIWarnings()},setActive:function(e){e?mkE.addClassName(this.node,"active"):mkE.removeClassName(this.node,"active")},_updateDPIWarnings:function(){var e=this._par.templates.getQuality(),t=!!this._par.product&&this._par.product.isEmbroidery(),i=e.getTemplateQualityPercent(this._par.template.placementId,this._par.template.templateId);e.isQualityBad(i)&&!t?this._showDpiLabel("quality-bad",dlang("generator","Your file is not large enough to<br>meet the minimum requirements!")):e.isQualityMedium(i)&&!t?this._showDpiLabel("quality-medium",dlang("generator","We strongly suggest a larger file<br>for better results")):this._hideDpiLabel()},_hideDpiLabel:function(){this._nodeQuality.className="quality-icon",mkE.removeClassName(this.node,"quality-bad"),mkE.removeClassName(this.node,"quality-medium"),$(this.node).tooltip("destroy"),this.node.title=""},_showDpiLabel:function(e,t){this._hideDpiLabel(),this._nodeQuality.className="quality-icon icon-exclamation",mkE.addClassName(this.node,e),this.node.title=t,this.node.title&&$(this.node).tooltip({container:this.node,html:"true"})},getTemplateKey:function(){return this._par.template.getKey()},getTemplate:function(){return this._par.template},updateDpiWarning:function(e,t,i){this._mockupPreview&&"delay"!==i&&"mirror"!==i&&PF.Utils.Delayer.delay("PF.ProductPush.VariantArea.Item._updateDPIWarnings-"+this.getGeneratorVariantId(),this._updateDPIWarnings,100)},renderMockupPreviewString:function(){this._mockupPreview.renderPreviewString(!0)},getGeneratorVariantId:function(){return this._par.generatorVariant.generatorVariantId},hideOverlay:function(){mkE.removeClassName(this._overlayNode,"variant-item__overlay")},showOverlay:function(){mkE.addClassName(this._overlayNode,"variant-item__overlay")}},mkE.Base)}()},"4Vs6":function(e,t,i){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.r(t),i.d(t,"TechniquePickerPar",(function(){return n}));var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"techniques",[]),r(this,"activeValue",""),r(this,"callback",null),r(this,"isGenerator",!1),r(this,"productId",0)}},"4fkK":function(e,t){!function(){"use strict";PF.ProductPush.TextboxPicker=Class({_par:null,_state:{defaultFont:function(){return PF.Lang.isJp()?PF.TEXT2SVG.FONTS["noto-sans-jp"]:PF.TEXT2SVG.FONTS["open-sans-b"]},isExistingLayer:!1,textboxLayer:null,isFocused:!1,nodeTextStyle:null,changeTimeout:null,_forceDisableCustomizer:!1,canAddNewLayers:!0,isCharLimitEnabled:!1,position:null},_canCustomizeCheckbox:null,_validator:null,_techniqueMemory:null,_inactiveBtnClass:"pf-text-light",nodeError:null,__construct:function(e){this._par=e,this._subscribeToTemplateEvents(),this._state.textboxLayer=this._getNewLayer(),this._validator=new PF.Components.GeneratorMockup.Validator(e.product),this._validator.isCharLimitEnabled=this._state.isCharLimitEnabled,this._validator.setActiveLayer(this._state.textboxLayer),this._techniqueMemory=new PF.Utils.TechniqueMemory(this._par.product.productId),this.node=tag("div","textbox-picker pf-mb-md-160 pf-mb-lg-128"),this._fontDropdownPar=new PF.Components.FontDropdown.Par,this._fontDropdownPar.font=this._state.textboxLayer?this._state.textboxLayer.font:this._state.defaultFont(),this._fontDropdownPar.fonts=PF.Components.FontDropdown.defaultFonts(this._par.technique),this._fontDropdownPar.onChange=this._onFontChanged,this._loadRequiredFont(this._state.textboxLayer.font,this._state.textboxLayer.fontPath,this.render)},_render:function(){this._renderTextboxPicker(),this._state.textboxLayer.isCustomizable&&this._setCustomizableSliderValue(this._state.textboxLayer,!1),this.nodeError=tag("div","alert alert-danger text-center pf-d-none pf-p-12 pf-mt-16",lang("Please add text!")).append(this.node)},_renderTextboxPicker:function(){this._state._forceDisableCustomizer=this._getSelectedPlacementId()===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE;var e=this._state.textboxLayer;if(this._fontDropdownPar.font=e.font,this._fontDropdown=new PF.Components.FontDropdown(this._fontDropdownPar),this._engravingStylePicker=new PF.Components.EngravingStylePicker(e.engravingStyle,this._onEngravingStyleChanged),PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()&&this._isTechniqueEmbroidery()){var t=PF.ProductPush.EmbroideryTypePicker.Par;t.embroideryTypesAvailable=[PF.Items.OrderLineItemFile.DIGITIZATION_FLAT,PF.Items.OrderLineItemFile.DIGITIZATION_3D],t.embroideryType=e.embroideryType,t.labelTooltipText=lang("We digitize each file to a format that supports embroidery and charge a one-time fee of $6.50 for each embroidery type. You can reuse a digitized file for the same embroidery type with other orders at no additional cost."),t.embroideryTypePrices=this._par.embroideryTypePrices,this._embroideryTypePicker=new PF.ProductPush.EmbroideryTypePicker(t)}else this._embroideryTypePicker=null;var i=!this._state.canAddNewLayers&&!this._state.isExistingLayer;this._textarea=tag("textarea",{attr:{placeholder:dlang("dashboard","Start typing here")},value:e.text,prop:{oninput:this._onTextChanged,onkeydown:this._onTextKeyDown,disabled:i},className:i?"disabled":"",style:{width:"100%",height:"90px",maxWidth:"100%",minWidth:"100%",minHeight:"90px"}}),this._nodeTemplateInfo=new PF.ProductPush.GuidelineInfo(this._par.product),e.text.length&&!this._par.isAdvancedTemplate()&&this._nodeTemplateInfo.renderGuidelineInfo(),tag("div","",[this._par.onBackCallback?tag("a",{className:"pf-link-block pf-mb-8",onclick:this._par.onBackCallback},[tag("i","pf-i pf-i-chevron-left pf-i-24 pf-text-muted"),tag("span","pf-pl-4",lang("See all design layers"))]):"",this._nodeTemplateInfo.node,this._embroideryTypePicker?tag("hr"):"",this._embroideryTypePicker?this._embroideryTypePicker:"",this._embroideryTypePicker?tag("hr"):"",tag("div","pf-my-8",[tag("div","pf-d-inline",[this._nodeCustomizableLabel=new PF.ProductPush.CustomizableLabel]),this._nodeTextareaTitle=tag("h6","pf-d-inline")]),this._textarea]).append(this.node),this._state.textboxLayer.isCustomizable&&this._allowCustomizableLayers()?this._nodeCustomizableLabel.show():this._nodeCustomizableLabel.hide(),this._updateTextareaTitle(),PF.Utils.textareaAutoHeight(this._textarea),this._state.isFocused&&(this._textarea.focus(),this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)),this._state.nodeTextStyle=tag("div",this._state.isExistingLayer?"":"pf-d-none").append(this.node),this._nodeTextAlign=tag("div","pf-mb-24 "+(this._canDisplayTextAlignInput(this._state.textboxLayer.text)?"":"pf-d-none"),[tag("h6",null,[dlang("generator","Align text")]),this._nodeTextAlignButtons=tag("div",null,[tag("button",{className:"text-picker__align-btn btn btn-empty pf-mr-16 pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT}},[tag("i","pf-i pf-i-format-align-left pf-i-24")]),tag("button",{className:"text-picker__align-btn btn btn-empty pf-mr-16 pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER}},[tag("i","pf-i pf-i-format-align-center pf-i-24")]),tag("button",{className:"text-picker__align-btn btn btn-empty pf-mr-16 pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT}},[tag("i","pf-i pf-i-format-align-right pf-i-24")])])]).append(this._state.nodeTextStyle),this._updateTextAlignButtonStates(),tag("div","pf-mb-24",[tag("h6","",dlang("generator","Choose typeface")),this._fontDropdown]).append(this._state.nodeTextStyle),this._par.product.isJewelry()?tag("div","pf-mb-16",[tag("h6","",dlang("generator","Choose engraving style")),this._engravingStylePicker]).append(this._state.nodeTextStyle):tag("div","pf-mb-16",[this._colorDropdownNode=this._getColorDropdownHtml()]).append(this._state.nodeTextStyle),tag("div","row pf-mb-8",[this._nodeTextSize=this._getTextSizeInput(),this._nodeLetterSpacing=this._getLetterSpacingInput()]).append(this._state.nodeTextStyle),tag("div","row pf-mb-16",[this._nodeLineHeight=this._getLineHeightInput(),this._rotationInput=this._getRotationInput(),this._arcAngleInput=this._isTechniqueEmbroidery()?"":this._getArcAngleInput()]).append(this._state.nodeTextStyle),this.renderCustomizableCheckbox()},_setColorDropdownPars:function(){if(this._colorDropdownPar=new PF.Components.ColorDropdown.Par,this._colorDropdownPar.color=this._state.textboxLayer.getDefaultColor(this._par.product),this._colorDropdownPar.colors=this._getColors(),this._colorDropdownPar.hideRGB=this._isTechniqueEmbroidery(),this._colorDropdownPar.onChange=this._onColorChanged.bind(this),this._colorDropdownPar.colors=this._getColors(),this._colorDropdownPar.showColorInHeader=!this._isTechniqueEmbroidery(),this._colorDropdownPar.boundsCheckQuery=".modal-content",this._colorDropdownPar.nodeDropdownFooter&&mkE.clearNode(this._colorDropdownPar.nodeDropdownFooter),this._par.getSelectedEmbroideryColors&&(this._par.getSelectedEmbroideryColors().length>PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS?(this._colorDropdownPar.nodeDropdownFooter=tag("div","color-mapper__footer--warning",[dlang("generator","You can choose up to {number} colors").replace("{number}",this._par.threadColorSelectionLimit)]),this._colorDropdownPar.highlightColorsAsError=!0):this._colorDropdownPar.highlightColorsAsError=!1,this._colorDropdownPar.highlightedColors=this._par.getSelectedEmbroideryColors()),!this._isTechniqueEmbroidery()){var e=PF.Components.ColorDropdown.getNoneColor();Object.assign(e,this._getColors()),this._strokeWeightInput=this._getStrokeWeightInput(),this._strokeOffsetInput=this._getStrokeOffsetInput(),this._strokeDropdownPar=new PF.Components.ColorDropdown.Par,this._strokeDropdownPar.showColorInHeader=!0,this._strokeDropdownPar.colors=e,this._strokeDropdownPar.onChange=this._onStrokeColorChanged.bind(this),this._strokeDropdownPar.boundsCheckQuery=".modal-content",this._strokeDropdownPar.nodeDropdownFooter=tag("div","",[this._strokeWeightInput,this._strokeOffsetInput]),this._shadowDistanceInput=this._getShadowDistanceInput(),this._shadowAngleInput=this._getShadowAngleInput(),this._shadowDropdownPar=new PF.Components.ColorDropdown.Par,this._shadowDropdownPar.showColorInHeader=!0,this._shadowDropdownPar.colors=e,this._shadowDropdownPar.onChange=this._onShadowColorChanged.bind(this),this._shadowDropdownPar.boundsCheckQuery=".modal-content",this._shadowDropdownPar.nodeDropdownFooter=tag("div","",[this._shadowDistanceInput,this._shadowAngleInput])}},_getColorDropdownHtml:function(){if(this._setColorDropdownPars(),this._colorDropdown=new PF.Components.ColorDropdown(this._colorDropdownPar),this._isTechniqueEmbroidery())return tag("div","",[tag("h6","",dlang("generator","Text color")),this._colorDropdown]);var e=this._state.textboxLayer;return this._strokeDropdownPar.color=e.strokeColor,this._strokeDropdownPar.color?(this._strokeWeightInput.setValue(e.strokeWeight),this._strokeWeightInput.show(),this._strokeOffsetInput.setValue(e.strokeOffset),this._strokeOffsetInput.show()):(this._strokeWeightInput.hide(),this._strokeOffsetInput.hide()),this._strokeDropdown=new PF.Components.ColorDropdown(this._strokeDropdownPar),this._shadowDropdownPar.color=e.shadowColor,this._shadowDropdownPar.color?(this._shadowDistanceInput.setValue(e.shadowDistance),this._shadowDistanceInput.show(),this._shadowAngleInput.setValue(e.shadowAngle),this._shadowAngleInput.show()):(this._shadowDistanceInput.hide(),this._shadowAngleInput.hide()),this._shadowDropdown=new PF.Components.ColorDropdown(this._shadowDropdownPar),tag("div","textbox-colors row",[tag("div","col-4 textbox-colors__text",[tag("h6","",dlang("generator","Text color")),this._colorDropdown]),tag("div","col-4 textbox-colors__stroke",[tag("h6","",dlang("generator","Outline")),this._strokeDropdown]),tag("div","col-4 textbox-colors__shadow",[tag("h6","",dlang("generator","Shadow")),this._shadowDropdown])])},_updateTextStylingOptions:function(){var e;this._state.isExistingLayer?mkE.removeClassName(this._state.nodeTextStyle,"pf-d-none"):mkE.addClassName(this._state.nodeTextStyle,"pf-d-none"),this._state._forceDisableCustomizer=this._getSelectedPlacementId()===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Utils.textareaAutoHeight(this._textarea),this._state.isFocused&&(this._textarea.focus(),this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length));var t=this._state.textboxLayer;if(t){this._par.product.isJewelry()||(this._isTechniqueEmbroidery()&&(mkE.clearNode(this._colorDropdownNode),this._getColorDropdownHtml().append(this._colorDropdownNode)),this._colorDropdown.setColor(t.color,!0),this._isTechniqueEmbroidery()||(this._strokeDropdown.setColor(t.strokeColor,!0),t.strokeColor?(this._strokeWeightInput.setValue(t.strokeWeight),this._strokeWeightInput.show(),this._strokeOffsetInput.setValue(t.strokeOffset),this._strokeOffsetInput.show()):(this._strokeWeightInput.hide(),this._strokeOffsetInput.hide()),this._shadowDropdown.setColor(t.shadowColor,!0),t.shadowColor?(this._shadowDistanceInput.setValue(t.shadowDistance),this._shadowDistanceInput.show(),this._shadowAngleInput.setValue(t.shadowAngle),this._shadowAngleInput.show()):(this._shadowDistanceInput.hide(),this._shadowAngleInput.hide()))),this._fontDropdown.setFont(t.font,!0),this._engravingStylePicker.setStyle(t.engravingStyle,!0),this._state.textboxLayer.isCustomizable&&this._allowCustomizableLayers()?this._nodeCustomizableLabel.show():this._nodeCustomizableLabel.hide();var i=!this._state.canAddNewLayers&&!this._state.isExistingLayer;this._textarea.value=t.text,i?(mkE.addClassName(this._textarea,"disabled"),this._textarea.disabled=!0):(mkE.removeClassName(this._textarea,"disabled"),this._textarea.disabled=!1),this._showHideTextAlignInput(),this._includesNewLines(t.text)?this._nodeLineHeight.show():this._nodeLineHeight.hide(),this._nodeTextSize.setValue(t.size),this._nodeLetterSpacing.setValue(t.letterSpacing),this._nodeLineHeight.setValue(t.lineHeight),(null===(e=this._arcAngleInput)||void 0===e?void 0:e.setValue)&&this._arcAngleInput.setValue(t.arcAngle),this._setRotationValue(t.position.rotation),this._nodeTemplateInfo=new PF.ProductPush.GuidelineInfo(this._par.product),t.text.length&&!this._par.isAdvancedTemplate()&&this._nodeTemplateInfo.renderGuidelineInfo(),this._updateTextareaTitle(),this._updateTextAlignButtonStates(),this.renderCustomizableCheckbox()}},_setRotationValue:function(e){e=e>180?e-360:e,this._rotationInput.setValue(e)},_onValueChanged:function(e,t){if(this._state&&this._state.textboxLayer){var i=(e===PF.ProductPush.TextboxPicker.STROKE_OFFSET||e===PF.ProductPush.TextboxPicker.STROKE_WEIGHT)&&!this._state.textboxLayer.strokeColor,r=(e===PF.ProductPush.TextboxPicker.SHADOW_DISTANCE||e===PF.ProductPush.TextboxPicker.SHADOW_ANGLE)&&!this._state.textboxLayer.shadowColor;i||r||(e===PF.ProductPush.TextboxPicker.STROKE_WEIGHT&&(0==t?this._hideStrokeOffset():0==this._state.textboxLayer.strokeWeight&&t>0&&this._showStrokeOffset()),this._state.textboxLayer[e]=t,this._onConfigurationChanged(!0))}},_hideStrokeOffset:function(){this._state.textboxLayer.strokeOffset=0,this._strokeOffsetInput.setValue(this._state.textboxLayer.strokeOffset),this._strokeOffsetInput.hide()},_showStrokeOffset:function(){this._state.textboxLayer.strokeOffset=PF.ProductPush.TextboxPicker.STROKE_OFFSET_DEFAULT,this._strokeOffsetInput.setValue(this._state.textboxLayer.strokeOffset),this._strokeOffsetInput.show()},_getTextSizeInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Text size"),e.value=this._state.textboxLayer.size,e.defaultValue=.2,e.minValue=.2,e.maxValue=100,e.incrementStep=.1,this._par.product.isJewelry()&&(e.defaultValue=.12,e.minValue=.12,e.incrementStep=.01),e.onValueChanged=this._onFontSizeChanged,new PF.Forms.Number(e)},_getLetterSpacingInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Letter spacing"),e.value=this._state.textboxLayer.letterSpacing,e.defaultValue=-.5,e.minValue=-.5,e.maxValue=10,(this._techniqueMemory.isEmbroidery(this._par.product.type)||this._par.product.isJewelry())&&(e.defaultValue=0,e.minValue=0,e.maxValue=1),e.incrementStep=.1,e.onValueChanged=this._onLetterSpacingChanged,new PF.Forms.Number(e)},_getLineHeightInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Line height"),e.value=this._state.textboxLayer.lineHeight,e.isVisible=this._includesNewLines(this._state.textboxLayer.text),e.defaultValue=.2,e.minValue=.2,e.maxValue=100,(this._techniqueMemory.isEmbroidery(this._par.product.type)||this._par.product.isJewelry())&&(e.defaultValue=1,e.minValue=1),e.incrementStep=.1,e.onValueChanged=this._onLineHeightChanged,new PF.Forms.Number(e)},_getRotationInput:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("dashboard","Rotate"),e.className="col-sm-12",e.value=this._state.textboxLayer.position.rotation,e.minValue=-180,e.maxValue=180,e.incrementStep=1,e.fractionDigits=0,e.hasNumberInput=!0,this._par.product.isJewelry()&&(e.isVisible=!1),e.onValueChanged=this._onRotationChanged,e.onSlide=this._onRotationChanged,new PF.Forms.Range(e)},_getArcAngleInput:function(){if(!!window.navigator&&/MSIE|Trident|Edge/.test(window.navigator.userAgent)){var e=dlang("generator","Text Arc isn't supported by Internet Explorer and Microsoft Edge. Please use a different browser."),t=new PF.Components.Alert(e,"warning");return tag("div","col-sm-12",[tag("div","pf-bold pf-mb-8",dlang("generator","Arc")),t])}var i=new PF.Forms.Range.Par;return i.title=dlang("generator","Arc"),i.className="col-sm-12",i.value=this._state.textboxLayer.arcAngle,i.minValue=-360,i.maxValue=360,i.incrementStep=1,i.fractionDigits=0,i.hasNumberInput=!0,i.onValueChanged=this._onArcAngleChanged,i.onSlide=this._onArcAngleChanged,i.showNewBadge=!0,new PF.Forms.Range(i)},_getStrokeWeightInput:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("generator","Weight"),e.className="pf-mb-8",e.value=this._state.textboxLayer.strokeWeight,e.minValue=0,e.maxValue=.6,e.hasNumberInput=!0,e.onValueChanged=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.STROKE_WEIGHT),e.onSlide=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.STROKE_WEIGHT),new PF.Forms.Range(e)},_getStrokeOffsetInput:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("generator","Offset"),e.className="pf-mb-8",e.value=this._state.textboxLayer.strokeOffset,e.minValue=0,e.maxValue=.2,e.hasNumberInput=!0,e.onValueChanged=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.STROKE_OFFSET),e.onSlide=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.STROKE_OFFSET),new PF.Forms.Range(e)},_getShadowDistanceInput:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("generator","Distance"),e.className="pf-mb-8",e.value=this._state.textboxLayer.shadowDistance,e.minValue=0,e.maxValue=1,e.hasNumberInput=!0,e.onValueChanged=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.SHADOW_DISTANCE),e.onSlide=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.SHADOW_DISTANCE),new PF.Forms.Range(e)},_getShadowAngleInput:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("generator","Angle"),e.className="pf-mb-8",e.value=this._state.textboxLayer.shadowAngle,e.minValue=0,e.maxValue=359.9,e.incrementStep=.1,e.fractionDigits=1,e.hasNumberInput=!0,e.onValueChanged=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.SHADOW_ANGLE),e.onSlide=this._onValueChanged.bind(this,PF.ProductPush.TextboxPicker.SHADOW_ANGLE),new PF.Forms.Range(e)},_updateTextareaTitle:function(){this._state.textboxLayer!==this._validator._activeLayer&&this._validator.setActiveLayer(this._state.textboxLayer);var e=this._validator.getCharLimit()-this._textarea.value.length,t="text-picker__title-limit";e||(t+=" "+t+"--reached"),mkE.clearNode(this._nodeTextareaTitle);var i="";this._isTechniqueEmbroidery()&&(i=tag("span",{className:"glyphicon glyphicon-info-sign",style:{verticalAlign:0,marginLeft:"4px"},attr:{title:dlang("dashboard",dlang("generator","Only for flat embroidery"))}})),tag("span",null,[dlang("generator","Write your text"),i,this._state.isCharLimitEnabled?tag("span",t,nlang("(%d character left)","(%d characters left)",e)):""]).append(this._nodeTextareaTitle),i&&$(i).tooltip({container:"body"})},_updateRotationInput:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t instanceof PF.Forms.Range||this._setRotationValue(e.position.rotation)},_onLayerRemovedExternally:function(e,t){!this._unsubscribeTemplateEventsIfNeeded()&&this._state.textboxLayer&&t.uniqueId===this._state.textboxLayer.uniqueId&&this.resetText()},resetText:function(e){this._state.textboxLayer=null,this._state.isExistingLayer=!1,this._state.isFocused=!0,this._textarea.value="",e&&(this._rememberLayerState=!1),this._updateTextStylingOptions()},editTextboxLayer:function(e){if(!this._unsubscribeTemplateEventsIfNeeded()){var t=e instanceof PF.Components.GeneratorMockup.TextboxLayer;e&&t&&(this._state.textboxLayer=e.getOriginalClone(),this._state.isExistingLayer=!0,this._state.isFocused=!0,this._updateTextStylingOptions(),this._setCustomizableSliderValue(e,!1))}},_onLayerPositionsChangedExternally:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()&&(this._setCustomizableSliderValue(t,!0),!i instanceof PF.Forms.Range&&this._setRotationValue(t.position.rotation),i!==this&&this._state.textboxLayer))for(var r in e){var n=e[r],a=n.getLayerIndex(this._state.textboxLayer);if(a>-1){var o=n.layers[a].getOriginalClone(),s=!o.isConfigurationSame(this._state.textboxLayer);return this._state.textboxLayer=o,i instanceof PF.Components.Slider&&(this._state.isFocused=!1),void(s&&this._updateTextStylingOptions())}}},_onLayerTextChangedExternally:function(e,t){!this._unsubscribeTemplateEventsIfNeeded()&&t!==this&&e instanceof PF.Components.GeneratorMockup.TextboxLayer&&(e.parentLayerUniqueId||(this._state.textboxLayer=e),this._state.isFocused=!1,this._updateTextStylingOptions())},_getNewLayer:function(){var e=new PF.Components.GeneratorMockup.TextboxLayer;e.font=this._state.defaultFont();var t=this._getSelectedPlacementId();return e.size=PF.ProductPush.TextboxPicker.getDefaultFontSize(this._par.product,t),e.color=e.getDefaultColor(this._par.product),e.alignment=PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER,e.originalPosition=new PF.Items.GeneratorPositionItem,e.position=e.originalPosition.getClone(),PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()&&this._isTechniqueEmbroidery()&&(e.embroideryType=PF.ProductPush.EmbroideryTypePicker.getDefaultEmbroideryType()),this._rememberLayerState&&(this._isTechniqueEmbroidery()||this._par.product.isJewelry()||(e.strokeColor=this._strokeDropdown.getColor(),e.strokeWeight=this._strokeWeightInput.value,e.strokeOffset=this._strokeOffsetInput.value,e.shadowColor=this._shadowDropdown.getColor(),e.shadowDistance=this._shadowDistanceInput.value,e.shadowAngle=this._shadowAngleInput.value),this._par.product.isJewelry()?e.engravingStyle=this._engravingStylePicker.getStyle():e.color=this._colorDropdown.getColor(),!this._isTechniqueEmbroidery()&&this._arcAngleInput&&(e.arcAngle=this._arcAngleInput.value),e.font=this._fontDropdown.getFont(),e.alignment=this._getTextAlignButtonState(),e.size=this._nodeTextSize.value,e.letterSpacing=this._nodeLetterSpacing.value,e.lineHeight=this._nodeLineHeight.value,e.position=this._state.position.getClone()),e},_onColorChanged:function(e){this._state.textboxLayer.color=e,this._onConfigurationChanged(!0),this._par.templates.getChangeListener().notifyLayerColorsChanged(this._getSelectedPlacementId(),this._state.textboxLayer,!1)},_onStrokeColorChanged:function(e){!this._state.textboxLayer.strokeColor&&e&&(this._state.textboxLayer.strokeWeight=PF.ProductPush.TextboxPicker.STROKE_WEIGHT_DEFAULT,this._strokeWeightInput.setValue(this._state.textboxLayer.strokeWeight),this._strokeWeightInput.show(),this._showStrokeOffset()),this._state.textboxLayer.strokeColor=e,e||(this._state.textboxLayer.strokeWeight=0,this._strokeWeightInput.setValue(this._state.textboxLayer.strokeWeight),this._strokeWeightInput.hide(),this._hideStrokeOffset()),this._onConfigurationChanged(!0),this._par.templates.getChangeListener().notifyLayerColorsChanged(this._getSelectedPlacementId(),this._state.textboxLayer,!1)},_onShadowColorChanged:function(e){!this._state.textboxLayer.shadowColor&&e&&(this._state.textboxLayer.shadowDistance=PF.ProductPush.TextboxPicker.SHADOW_DISTANCE_DEFAULT,this._shadowDistanceInput.setValue(this._state.textboxLayer.shadowDistance),this._shadowDistanceInput.show(),this._state.textboxLayer.shadowAngle=PF.ProductPush.TextboxPicker.SHADOW_ANGLE_DEFAULT,this._shadowAngleInput.setValue(this._state.textboxLayer.shadowAngle),this._shadowAngleInput.show()),this._state.textboxLayer.shadowColor=e,e||(this._state.textboxLayer.shadowDistance=0,this._shadowDistanceInput.setValue(this._state.textboxLayer.shadowDistance),this._shadowDistanceInput.hide(),this._state.textboxLayer.shadowAngle=0,this._shadowAngleInput.setValue(this._state.textboxLayer.shadowAngle),this._shadowAngleInput.hide()),this._onConfigurationChanged(!0),this._par.templates.getChangeListener().notifyLayerColorsChanged(this._getSelectedPlacementId(),this._state.textboxLayer,!1)},_onEngravingStyleChanged:function(e){this._state.textboxLayer.engravingStyle=e,this._onConfigurationChanged(!0)},_deleteLayer:function(){this._rememberLayerState=!0,this._state.position=this._state.textboxLayer.position.getClone(),this._par.onLayerRemoved&&this._par.onLayerRemoved(this._state.textboxLayer),this.resetText()},_onTextAligned:function(e){this._state.textboxLayer.alignment=e,this._onConfigurationChanged(!0),this._updateTextAlignButtonStates()},_onTextKeyDown:function(e){e.stopPropagation()},_onTextChanged:function(e){e.stopPropagation();var t=e.target.value.trim();if(this._state.isFocused=!0,this._state.textboxLayer||(this._state.textboxLayer=this._getNewLayer()),t!==this._state.textboxLayer.text){if(""===t)return this._nodeTemplateInfo.clearGuidelineInfo(),this._deleteLayer(),void(PF.Utils.isTouch()&&clearTimeout(this._state.changeTimeout));if(this._validator.setText(t),!this._validator.isTextValid())return this._onTextChangedAfter(this._validator.getValidText()),void this._updateTextStylingOptions();this._updateTextareaTitle(),this._par.isAdvancedTemplate()||this._nodeTemplateInfo.renderGuidelineInfo(),PF.Utils.isTouch()?(clearTimeout(this._state.changeTimeout),this._state.changeTimeout=setTimeout(function(){this._loadRequiredFont(this._state.textboxLayer.font,this._state.textboxLayer.fontPath,this._onTextChangedAfter.bind(this,t))}.bind(this),200)):this._loadRequiredFont(this._state.textboxLayer.font,this._state.textboxLayer.fontPath,this._onTextChangedAfter.bind(this,t)),this.hideError()}},_onTextChangedAfter:function(e){this._canDisplayTextAlignInput(e)?mkE.removeClassName(this._nodeTextAlign,"pf-d-none"):mkE.addClassName(this._nodeTextAlign,"pf-d-none"),this._includesNewLines(e)?this._nodeLineHeight.show():this._nodeLineHeight.hide(),this._state.textboxLayer.text=e,this._state.textboxLayer.hasMultipleLines=this._includesNewLines(e),this._state.textboxLayer.resizeToPercent=null,this._onConfigurationChanged(!0)},_onConfigurationChanged:function(e){if(e||this._updateTextStylingOptions(),mkE.removeClassName(this._state.nodeTextStyle,"hidden"),this._validator.setActiveLayer(this._state.textboxLayer),this._state.isExistingLayer)this._par.onLayerConfigurationChanged(this._state.textboxLayer);else if(this._state.textboxLayer&&(this._state.isExistingLayer=!0,this._par.onLayerCreated)){var t=this._rememberLayerState&&this._state.textboxLayer.position.width;this._par.onLayerCreated(this._state.textboxLayer,this._rememberLayerState,t),this._rememberLayerState=!1}},_onFontSizeChanged:function(e){this._state.textboxLayer.size=e,this._onConfigurationChanged(!0)},_onFontChanged:function(e){this._loadRequiredFont(e,null,function(){this._state.textboxLayer.font=e,this._updateTextareaTitle(),this._onConfigurationChanged(!0)}.bind(this,e))},setEnabled:function(e){return this._state.canAddNewLayers=e,this},render:function(){return this._textarea?this._updateTextStylingOptions():this._render(),this},renderCustomizableCheckbox:function(){if(!this._allowCustomizableLayers())return!1;this._canCustomizeCheckbox&&mkE.removeNode(this._canCustomizeCheckbox.node);var e=new PF.ProductPush.CanCustomizeCheckbox.Par;e.isChecked=this._state.textboxLayer.isCustomizable,e.onChange=this._changeIsCustomizable,e.showSlider=!0,e.onSliderChange=this._onTextLayerWidthChange,e.layerType=PF.Components.GeneratorMockup.TextboxLayer.TYPE,this._canCustomizeCheckbox=new PF.ProductPush.CanCustomizeCheckbox(e),this._state.nodeTextStyle&&this._canCustomizeCheckbox.append(this._state.nodeTextStyle),this._canCustomizeCheckbox.setSliderValue(this._state.textboxLayer.resizeToPercent)},_includesNewLines:function(e){return e.trim().split("\n").length>1},_hasArcAngleSet:function(){return!!this._state.textboxLayer.arcAngle},_canDisplayTextAlignInput:function(e){return!this._hasArcAngleSet()&&this._includesNewLines(e)},_loadRequiredFont:function(e,t,i){return t||(t=PF.CANVAS.FONTS_TTF_URLS[e.fontKey]),PF.CANVAS.loadRequiredFont(e.fontKey,t,i)},_onLineHeightChanged:function(e){this._state.textboxLayer.lineHeight=e,this._onConfigurationChanged(!0)},_onRotationChanged:function(e){this._state.textboxLayer.position.rotation=parseFloat(e),this._onConfigurationChanged(!0)},_onArcAngleChanged:function(e){this._state.textboxLayer.arcAngle=parseFloat(e),this._state.textboxLayer.alignment!==PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER&&this._onTextAligned(PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER),this._onConfigurationChanged(!0),this._showHideTextAlignInput()},_showHideTextAlignInput:function(){this._canDisplayTextAlignInput(this._state.textboxLayer.text)?mkE.removeClassName(this._nodeTextAlign,"pf-d-none"):mkE.addClassName(this._nodeTextAlign,"pf-d-none")},_onLetterSpacingChanged:function(e){this._state.textboxLayer.letterSpacing=e,this._onConfigurationChanged(!0)},_changeIsCustomizable:function(){this._state.textboxLayer.isCustomizable=!this._state.textboxLayer.isCustomizable,this._onConfigurationChanged()},_onTextLayerWidthChange:function(e){this._state.textboxLayer.setWidthInPercent(e),this._onConfigurationChanged(!0)},_setCustomizableSliderValue:function(e,t){if(this._allowCustomizableLayers()&&this._canCustomizeCheckbox){var i=e.position.width;if(e.resizeToPercent){var r=e.position.areaWidth*e.resizeToPercent/100;(i=e.position.width>r?e.position.width:r)>e.originalPosition.areaWidth&&(i=e.originalPosition.areaWidth)}var n=100*i/e.originalPosition.areaWidth,a=Math.round(n);this._canCustomizeCheckbox.setSliderValue(a),t&&this._state.textboxLayer&&(this._state.textboxLayer.resizeToPercent=a)}},_allowCustomizableLayers:function(){return!this._state._forceDisableCustomizer&&this._par.allowCustomizableLayers()},_getColors:function(){var e=!!this._par.isAllOver&&this._par.isAllOver(),t=PF.ProductPush.TextPicker.getAllAvailableColors(this._isTechniqueEmbroidery(),this._getSelectedPlacementId(),this._par.product,e,!0);return this._isTechniqueEmbroidery()||(this._par.product.isWhiteDtgTote()&&delete t.White,this._par.product.isBlackMug()&&delete t.Black),t},_subscribeToTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnTemplatePositionsChangedListener(this._onLayerPositionsChangedExternally).addOnLayerRotatedListener(this._updateRotationInput).addOnLayerRemovedListener(this._onLayerRemovedExternally).addOnLayerConfigurationChanged(this._onLayerTextChangedExternally)},unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onLayerPositionsChangedExternally).unsubscribe(this._updateRotationInput).unsubscribe(this._onLayerRemovedExternally).unsubscribe(this._onLayerTextChangedExternally)},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this.unsubscribeTemplateEvents(),!0)},_updateTextAlignButtonStates:function(){for(var e=this._nodeTextAlignButtons.children,t=0;t<e.length;t++)mkE.addClassName(e[t],this._inactiveBtnClass),e[t].dataset.alignment===this._state.textboxLayer.alignment&&mkE.removeClassName(e[t],this._inactiveBtnClass)},_getTextAlignButtonState:function(){for(var e=this._nodeTextAlignButtons.children,t=0;t<e.length;t++)if(e[t].className.indexOf(this._inactiveBtnClass)<0)return e[t].dataset.alignment;return PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER},hideError:function(){mkE.addClassName(this.nodeError,"pf-d-none")},showError:function(){mkE.removeClassName(this.nodeError,"pf-d-none")},_isTechniqueEmbroidery:function(){return this._par.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY},_getSelectedPlacementId:function(){return this._par.placementSelector?this._par.placementSelector.getSelectedPlacementId():null}},mkE.Base),PF.ProductPush.TextboxPicker.getDefaultFontSize=function(e,t){return e?e.isPhoneCase()||e.isSocks()||e.isEmbroidery()?.5:e.isMug()?1:e.isSticker()?.5:t&&-1!==[PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_SLEEVE_LEFT,PF.Items.OrderLineItemFile.TYPE_SLEEVE_RIGHT,PF.Items.OrderLineItemFile.TYPE_HANG_TAG,PF.Items.OrderLineItemFile.TYPE_POCKET].indexOf(t)?.5:e.isJewelry()?.2:2:2},PF.ProductPush.TextboxPicker.STROKE_OFFSET="strokeOffset",PF.ProductPush.TextboxPicker.STROKE_WEIGHT="strokeWeight",PF.ProductPush.TextboxPicker.SHADOW_ANGLE="shadowAngle",PF.ProductPush.TextboxPicker.SHADOW_DISTANCE="shadowDistance",PF.ProductPush.TextboxPicker.STROKE_OFFSET_DEFAULT=0,PF.ProductPush.TextboxPicker.STROKE_WEIGHT_DEFAULT=.2,PF.ProductPush.TextboxPicker.SHADOW_ANGLE_DEFAULT=45,PF.ProductPush.TextboxPicker.SHADOW_DISTANCE_DEFAULT=.25}()},"53sR":function(e,t){!function(){"use strict";PF.ProductPush.ColorMapper=Class({_NAME:"PF.ProductPush.ColorMapper",colors:{},palette:null,onColorsChanged:null,__construct:function(e){this._par=e,this.onColorsChanged=e.onColorsChanged,this.colors=e.colors,this.palette=PF.Components.ColorDropdown.getNoneColor(),mkE.O2O(this.palette,e.palette);var t=[];for(var i in this.colors)t.push(this._createColorDropdown(i,this.colors[i]));this.node=tag("div","color-mapper",t)},_createColorDropdown:function(e,t){var i=new PF.Components.ColorDropdown.Par;i.colors=this.palette,i.color=t,i.disableDropdown=this._par.disableDropdown,i.onChange=function(t){this.colors[e]=t,this.onColorsChanged&&this.onColorsChanged(this.colors)}.bind(this),this._par.getSelectedEmbroideryColors&&(this._par.getSelectedEmbroideryColors().length>PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS&&(i.nodeDropdownFooter=tag("div","color-mapper__footer--warning",[dlang("generator","You can choose up to {number} colors").replace("{number}",this._par.threadColorSelectionLimit)]),i.highlightColorsAsError=!0),i.highlightedColors=this._par.getSelectedEmbroideryColors()),!this._hasAtLeastTwoThreadsSelected()&&t&&(i.disableNoneValue=!0);var r=new PF.Components.ColorDropdown(i),n=tag("div","swatches swatches--huge",[tag("span",{className:"swatches__item",style:{backgroundColor:e}})]);return tag("div","row pf-mt-8",[tag("div","col-1 col-md-2 col-xl-1 pf-pt-4",[n]),tag("div","col-1 col-md-2 col-xl-1 pf-m-auto",[tag("i","color-mapper__map-icon pf-i pf-i-arrow-right pf-i-18 pf-text-gray")]),tag("div","col-10 col-md-8 col-xl-10 pf-pl-0",[r])])},_hasAtLeastTwoThreadsSelected:function(){var e=0,t=Object.values(this.colors);for(var i in t)if(t[i]&&e++,e>1)return!0;return!1}},mkE.Base)}()},"589/":function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.Par=Class({designData:null,generatorParams:null,callback:null,stickyButtonNodeUpdate:null,ctaText:null,isMockupUpdate:!1,canShowAdditionalMockups:!0,onMockupBack:null,onMockupNext:null,onDescriptionBack:null,onDescriptionNext:null,progressSteps:null})}()},"79oW":function(e,t){!function(){"use strict";PF.ProductPush.StockManagement=Class({_table:null,__construct:function(e){if(this._par=e,this._store=e.store,this._prices=e.prices,this._isUpdateFlow=e.isUpdateFlow||!1,!this._store.canManageStock())throw new Error(dlang("dashboard","Store doesn't support stock management."));this.node=tag("div","product-push-stock-management",[]),this._render()},_render:function(){mkE.clearNode(this.node),this._table=new PF.ProductPush.StockManagement.Table({prices:this._prices,store:this._store,quantities:this._par.quantities,oldQuantities:this._par.oldQuantities,isCustomProduct:this._par.isCustomProduct,onUpdate:this._onTableUpdate.bind(this),isUpdateFlow:this._isUpdateFlow}),this.container=tag("div",null,[this._headerNode=tag("div",null,null),this._table,this._errorNode=tag("div",null,null)]),this._onTableUpdate(!1),this.container.append(this.node)},_createHeader:function(){var e=this._getStoreLimits(),t=this._getCurrentAvailability(),i=null;if(e){var r=function(e,t,i){i&&(e=prettyMoney(e,i),t=prettyMoney(t,i));var r=tag("span",{style:{fontWeight:"bold"}},e),n=tag("span",{style:{fontWeight:"bold"}},t);return tag("span",null,[r," "+dclang("dashboard","X out of Y (items/monetary value)","out of")+" ",n])};i=tag("div","limits-info margin-vertical-15",[tag("div",{style:{"line-height":"2em"}},[tag("span",null,dlang("stores","Available store's variant quantity:")+" "),r(t.quantity,e.quantity),tag("br",null,null),tag("span",null,dlang("stores","Available store's retail value:")+" "),r(t.moneyAmount,e.moneyAmount,this._getCurrency())])])}return tag("div","stock-management-header pf-ui-body",[tag("div",null,[tag("h6",null,dlang("dashboard","Variant stock quantities"))]),tag("div","text-muted",dlang("dashboard","Choose the amount of each variant that you want to push.")+(e?" "+dlang("dashboard","Make sure to fit within the allowance of your store."):"")),i||""])},_getStoreLimits:function(){var e={quantity:0,moneyAmount:0};return this._store instanceof PF.Items.StoreItems.EbayStoreItem&&this._store.hasEnabledLimits()?(e.quantity=parseInt(this._store.newProductLimits.quantity),e.moneyAmount=parseFloat(this._store.newProductLimits.amount)):e=null,e},_getPriceByKey:function(e){return this._prices.find((function(t){return t.priceKey===e}))},_getCurrentUsedAvailability:function(){if(!this._table)return null;var e={quantity:0,moneyAmount:0};return this.getCurrentQuantities().forEach(function(t){var i=t.quantity;e.quantity+=i,e.moneyAmount+=parseFloat(this._getPriceByKey(t.variantIdentifier).retailPrice*i)}.bind(this)),e},_getCurrentAvailability:function(){var e=this._getCurrentUsedAvailability(),t=this._getStoreLimits(),i={quantity:0,moneyAmount:0};return t?e?(i.quantity=t.quantity-e.quantity,i.moneyAmount=t.moneyAmount-e.moneyAmount,i):i:null},_getCurrency:function(){return this._store.currency},_onTableUpdate:function(e){e=void 0===e||!!e,mkE.clearNode(this._headerNode),this._createHeader().append(this._headerNode),mkE.clearNode(this._errorNode);var t=this._getErrorsNode();t&&t.append(this._errorNode),e&&this._par.onUpdate()},_getErrorsNode:function(){if(!this._table)return null;var e=this.getErrors();if(!e||!e.length)return null;var t,i=e.map((function(t){return tag(e.length>1?"li":"div",null,t)})),r=tag("div","alert alert-danger");return i.length>1?(t=tag("ul")).append(r):t=r,i.forEach((function(e){e.append(t)})),r},_isOnlySelfValid:function(){var e=this._getCurrentAvailability();return!e||e.quantity>=0&&e.moneyAmount>=0},isValid:function(){return!!this._table&&(!!this._table.isValid()&&this._isOnlySelfValid())},getErrors:function(){if(!this._table)return[];var e=[],t=this._table.getError();t&&e.push(t);var i=this._isOnlySelfValid()?null:dlang("dashboard","You've exceeded your store's variant and/or retail value allowance. Try adjusting the quantities.");return i&&e.push(i),e},getCurrentQuantities:function(){return this._table?this._table.getQuantities():null}},mkE.Base)}()},"7Pmj":function(e,t){!function(){"use strict";PF.ProductPush.StockManagement.Row=Class({__construct:function(e){this._price=e.price,this._currency=e.currency,this._onchange=e.onchange,this._isUpdateFlow=e.isUpdateFlow||!1,this._preloadedQuantity=(e.quantity||{quantity:this._isUpdateFlow?0:1}).quantity,this._oldQuantity=e.oldQuantity,this.node=tag("tr","stock-management-table-row",null),this._render()},_render:function(){mkE.clearNode(this.node);var e=new PF.Forms.InputPar;e.value=this._preloadedQuantity,e.onchange=this._onChange.bind(this),e.onkeyup=this._onKeyUp.bind(this),e.validators=[new PF.Forms.Validator(new PF.Forms.Validator.RequiredPar),new PF.Forms.Validator(new PF.Forms.Validator.IntegerPar(this._isUpdateFlow?{min:0}:{positiveOnly:!0}))];var t=new PF.Forms.Input(e);if(tag("td",null,this._price.title).append(this.node),tag("td","text-center",prettyMoney(this._price.retailPrice,this._currency)).append(this.node),this._isUpdateFlow){var i=this._oldQuantity?this._oldQuantity.quantity:0;tag("td","text-center",i).append(this.node)}tag("td","text-center",[this._quantityInput=t]).append(this.node)},_onChange:function(){clearTimeout(this._keyupTimeoutId),clearTimeout(this._onChangeEventTimeoutId),this._onChangeEventTimeoutId=setTimeout(function(){var e=this.getValue(),t=this.getError();this._onchange(this.getKey(),e,t)}.bind(this),50)},_onKeyUp:function(){clearTimeout(this._keyupTimeoutId),this._keyupTimeoutId=setTimeout(this._onChange,500)},getError:function(){var e=this._quantityInput.getErrors();return e&&e.length?e[0]:""},isValid:function(){return this._quantityInput.validate()},getValue:function(){return this.isValid()?parseInt(this._quantityInput.getValue()):null},getKey:function(){return this._price.priceKey}},mkE.Base)}()},"7XA3":function(e,t){!function(){"use strict";PF.ProductPush.CustomizableLabel=Class({__NAME:"PF.ProductPush.CustomizableLabel",__construct:function(){this.node=tag("span",{className:"pf-d-inline-block pf-text-white pf-bg-cyan pf-ui-legal pf-bold pf-px-4 pf-mb-4",title:lang("Let your customers create personalized versions of your design in real-time on your store")},[lang("For personalization")])},show:function(){mkE.removeClassName(this.node,"pf-d-none"),mkE.addClassName(this.node,"pf-d-inline-block")},hide:function(){mkE.removeClassName(this.node,"pf-d-inline-block"),mkE.addClassName(this.node,"pf-d-none")}},mkE.Base)}()},"7gtE":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Par=Class({maxWidth:null,maxHeight:null,designFillColor:null,isResizable:!1,templates:null,onReady:null,showImageQualityWarning:!1,template:null,onLayerOrderChanged:null,onLayerRemoved:null,product:null,onZoomIn:null,onZoomOut:null,isOrderFlow:!1,disableLayerManipulations:!1,disablePulseImageOverride:!1,hideZoomButton:!1,disableOutOfBoundsErrorMessages:!1,isCustomizingMode:!1,generatorVariant:null})}()},"7h5t":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.TextboxLayer=Class({text:"",size:0,font:null,color:"",strokeColor:null,strokeWeight:0,strokeOffset:0,shadowColor:null,shadowDistance:0,shadowAngle:0,arcAngle:0,alignment:"",lineHeight:1,letterSpacing:0,engravingStyle:null,isCustomizable:!1,resizeToPercent:null,hasMultipleLines:!1,embroideryType:"",migratedToNewPicker:null,customizerHeightScaleRatio:null,_getNewLayer:function(){return new PF.Components.GeneratorMockup.TextboxLayer},getOriginalClone:function(e){var t=this._getNewLayer();return e||(t.uniqueId=this.uniqueId),t.text=this.text,t.size=this.size,t.font=this.font,t.color=this.color,t.strokeColor=this.strokeColor,t.strokeWeight=this.strokeWeight,t.strokeOffset=this.strokeOffset,t.shadowColor=this.shadowColor,t.shadowDistance=this.shadowDistance,t.shadowAngle=this.shadowAngle,t.alignment=this.alignment,t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.engravingStyle=this.engravingStyle,t.customizeKey=this.customizeKey,t.generatorOptions=this.generatorOptions,t.isCustomizable=this.isCustomizable,t.resizeToPercent=this.resizeToPercent,t.hasMultipleLines=this.hasMultipleLines,t.overrideImage=this.overrideImage,t.overrideImagePulse=this.overrideImagePulse,t.position=this.position.getFromOriginalRatio(),t.originalPosition=this.originalPosition,t.parentLayerUniqueId=this.parentLayerUniqueId,t.embroideryType=this.embroideryType,t.migratedToNewPicker=this.migratedToNewPicker,t.customizerHeightScaleRatio=this.customizerHeightScaleRatio,t.arcAngle=this.arcAngle,t},getType:function(){return PF.Components.GeneratorMockup.TextboxLayer.TYPE},getDPI:function(){return 600},isVector:function(){return!0},toArray:function(){return{type:PF.Components.GeneratorMockup.TextboxLayer.TYPE,text:this.text,size:this.size,font:this.font.fontKey,fontName:this.font.name,fontPath:this.font["path-ttf"],color:this.color,strokeColor:this.strokeColor,strokeWeight:this.strokeWeight,strokeOffset:this.strokeOffset,shadowColor:this.shadowColor,shadowDistance:this.shadowDistance,shadowAngle:this.shadowAngle,alignment:this.alignment,lineHeight:this.lineHeight,letterSpacing:this.letterSpacing,engravingStyle:this.engravingStyle,resizeToPercent:this.resizeToPercent,hasMultipleLines:this.hasMultipleLines?1:0,position:this.position?this.position.toArray():{},embroideryType:this.embroideryType,migratedToNewPicker:this.migratedToNewPicker,isCustomizable:this.isCustomizable?1:0,customizeKey:this.customizeKey,uniqueId:this.uniqueId,parentLayerUniqueId:this.parentLayerUniqueId,overrideImage:this.overrideImage,overrideImagePulse:this.overrideImagePulse,originalWidth:this.originalPosition.width,customizerHeightScaleRatio:this.customizerHeightScaleRatio,arcAngle:this.arcAngle}},isTextLayer:function(){return!0},isAlignedLeft:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT},isAlignedRight:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT},isAlignedCenter:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER},getFontName:function(){return this.font?this.font.name:""},isSimple:function(){return!1},copyValues:function(e){this.text=e.text,this.size=e.size,this.font=e.font,this.color=e.color,this.strokeColor=e.strokeColor,this.strokeWeight=e.strokeWeight,this.strokeOffset=e.strokeOffset,this.shadowColor=e.shadowColor,this.shadowDistance=e.shadowDistance,this.shadowAngle=e.shadowAngle,this.alignment=e.alignment,this.lineHeight=e.lineHeight,this.letterSpacing=e.letterSpacing,this.engravingStyle=e.engravingStyle,this.customizeKey=e.customizeKey,this.resizeToPercent=e.resizeToPercent,this.isCustomizable=e.isCustomizable,this.generatorOptions=e.generatorOptions,this.hasMultipleLines=e.hasMultipleLines,this.overrideImage=e.overrideImage,this.overrideImagePulse=e.overrideImagePulse,this.customizerHeightScaleRatio=e.customizerHeightScaleRatio,this.arcAngle=e.arcAngle},isConfigurationSame:function(e){return this.text===e.text&&Math.abs(this.size-e.size)<.001&&this.font.fontKey===e.font.fontKey&&Math.abs(this.lineHeight-e.lineHeight)<.001&&Math.abs(this.letterSpacing-e.letterSpacing)<.001&&this.color===e.color&&this.strokeColor===e.strokeColor&&this.strokeWeight===e.strokeWeight&&this.strokeOffset===e.strokeOffset&&this.shadowColor===e.shadowColor&&this.shadowDistance===e.shadowDistance&&this.shadowAngle===e.shadowAngle&&this.alignment===e.alignment&&this.arcAngle===e.arcAngle&&this.migratedToNewPicker===e.migratedToNewPicker},isWidthHeightRatioSame:function(e){return this.text===e.text&&this.getFontName()===e.getFontName()&&this.alignment===e.alignment&&Math.abs(this.lineHeight-e.lineHeight)<.001&&Math.abs(this.letterSpacing-e.letterSpacing)<.001},isValid:function(){return(new PF.Components.GeneratorMockup.Validator).setActiveLayer(this).setText(this.text).isTextValid()},getUpdateDelay:function(){return 10},setWidthInPercent:function(e){this.resizeToPercent=e},isPartiallyOutOfBounds:function(){var e=parseFloat(this.position.rotation-parseFloat(this.shadowAngle)).toFixed(2),t=Math.cos(-e*Math.PI/180)*this.shadowDistance*this.size/2,i=Math.sin(-e*Math.PI/180)*this.shadowDistance*this.size/2,r=this.position.getClone();return r.top-=i,r.left+=t,this.position.isPartiallyOutOfBounds()||r.isPartiallyOutOfBounds()}},PF.Components.GeneratorMockup.Layer),PF.Components.GeneratorMockup.TextboxLayer.fromArray=function(e){var t=new PF.Components.GeneratorMockup.TextboxLayer;return t.text=e.text,t.font=PF.TEXT2SVG.FONTS[e.font],t.color=e.color,t.strokeColor=e.strokeColor,t.strokeWeight=parseFloat(e.strokeWeight),t.strokeOffset=parseFloat(e.strokeOffset),t.shadowColor=e.shadowColor,t.shadowDistance=parseFloat(e.shadowDistance),t.shadowAngle=parseFloat(e.shadowAngle),t.alignment=e.alignment,t.letterSpacing=parseFloat(e.letterSpacing),t.lineHeight=parseFloat(e.lineHeight),t.size=parseFloat(e.size),t.engravingStyle=e.engravingStyle,t.arcAngle=parseFloat(e.arcAngle),t},PF.Components.GeneratorMockup.TextboxLayer.fromTextLayer=function(e){var t=new PF.Components.GeneratorMockup.TextboxLayer;return t.text=e.text,t.font=e.font,t.color=e.color,t.alignment=e.alignment,t.letterSpacing=parseFloat(e.letterSpacing),t.lineHeight=parseFloat(e.lineHeight),t.size=e.size,t.engravingStyle=e.engravingStyle,t.position=e.position.getFromOriginalRatio(),t.originalPosition=e.originalPosition,t.isCustomizable=e.isCustomizable,t.resizeToPercent=e.resizeToPercent,PF.CANVAS.calculateTextboxPositions(t,!0),t},PF.Components.GeneratorMockup.TextboxLayer.TYPE="textbox"}()},"81X1":function(e,t){!function(){"use strict";PF.ProductPush.AddBlock=function(e,t,i,r,n){if(this.store=e,this._hideSyncedItemsTab=!!n,this._onCompleteCallback=r,this._simpleNode=tag("a",{className:"btn btn-danger btn-lg",onclick:this.onAddClick.bind(this)},[dlang("dashboard","Add product")]),this._complexNode=tag("div","add-block",[this._complexNodeButton=tag("a",{className:"btn btn-danger",onclick:this.onAddClick.bind(this)},[dlang("dashboard","Add product"),tag("span",{className:"info-arrow hidden-xs"})])]),this.node=tag("div","product-push-add",[t?this._simpleNode:this._complexNode,this.nodeStatuses=i||tag("div",{className:"product-push-statuses"})]),this.store.isIntegrationUnavailable()||this.store.isPushDisabled){var a=this.store.isPushDisabled?this.store.getPushDisabledText():PF.Components.ButtonDisableWrapper.INTEGRATION_MAINTENANCE;t?new PF.Components.ButtonDisableWrapper(this._simpleNode,a):new PF.Components.ButtonDisableWrapper(this._complexNodeButton,a)}if(1==(new Url).query.push){var o=parseInt((new Url).query.pushProductId);if(o){var s=(new PF.Repositories.Products).getCachedProductById(o);s&&new PF.ProductPush(this.store,s,this.onProductPushedCallback.bind(this),this._hideSyncedItemsTab)}else this.onAddClick()}this.initDebugging(),this.reloadStatuses()},PF.ProductPush.AddBlock.prototype=new mkE.Base,PF.ProductPush.AddBlock.prototype.onAddClick=function(){-1===PF.MAINTENANCE_INTEGRATIONS.indexOf(this.storeType)&&(1!=(new Url).query.push&&ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:'Click "Add" from sync page',eventLabel:this.store.type}),new PF.ProductPush(this.store,null,this.onProductPushedCallback.bind(this),this._hideSyncedItemsTab))},PF.ProductPush.AddBlock.prototype.onProductPushedCallback=function(e){PF.ProductPush.onProductPushedEvent(this.store.storeId,e),this.reloadStatuses()},PF.ProductPush.AddBlock.prototype.reloadStatuses=function(){this._onCompleteCallback&&(new PF.Repositories.GeneratorRepository).getPushStatuses(this.store.storeId,this.renderStatuses.bind(this))},PF.ProductPush.AddBlock.prototype.renderStatuses=function(e){if(this._onCompleteCallback){mkE.clearNode(this.nodeStatuses);var t=e.statuses,i=!1,r=!1;for(var n in t){var a=PF.Items.GeneratorTaskStatusItem.fromArray(t[n]);a.isFinal||(i=!0),a.hasErrors||(r=!0),new PF.ProductPush.AddBlock.StatusRow(this.store,a,this.retryTask.bind(this)).append(this.nodeStatuses)}i?this.delayedReload():r&&this._onCompleteCallback&&this._onCompleteCallback()}},PF.ProductPush.AddBlock.prototype.retryTask=function(e){(new PF.Repositories.GeneratorRepository).retryTask(this.store.storeId,e,this.reloadStatuses.bind(this))},PF.ProductPush.AddBlock.prototype.delayedReload=function(){clearTimeout(this.refreshTimeoutId),this.refreshTimeoutId=setTimeout($.proxy(this.reloadStatuses,this),5e3)},PF.ProductPush.AddBlock.prototype.initDebugging=function(){PF.DEV&&PF.Events.on(PF.Events.PRODUCT_PUSH_STARTED,(function(e){var t="["+(new Date).toISOString()+"] newProductPushedEvent: \n";console.log(t),console.log(e)}))},PF.ProductPush.AddBlock.DispatchPushStartedEvent=function(e){PF.Events.emit(PF.Events.PRODUCT_PUSH_STARTED,{taskId:parseInt(e)})}}()},"86cz":function(e,t){!function(){"use strict";PF.ProductPush.LayerPicker=Class({__NAME:"PF.ProductPush.LayerPicker",fileCountLimit:5,_pickerItems:{},nodeError:null,_par:null,_productOptionsPicker:null,_productOptions:null,_productOptionsValues:null,_forceDisableCustomizer:!1,_templatesAvailableForLayerCopy:[],_unsubscribedFromEvents:!1,_isPopupBusy:!1,__construct:function(e){this._par=e,this._par.fileCountLimit&&(this.fileCountLimit=this._par.fileCountLimit),this._productOptions={},this._productOptionsValues={},mkE.O2O(this._productOptions,this._par.productOptions),this.setProductOptionsValues(this._par.productOptionsValues),this._setTemplatesAvailableForLayerCopy(),this._nodeTemplateInfo=new PF.ProductPush.GuidelineInfo(this._par.product),this.node=tag("div","",[this._nodeTemplateInfo.node,this._nodePicker=tag("div"),this._nodeLayersTitle=tag("h6","pf-border-top pf-h6 pf-mt-24 pf-mb-12 pf-pt-12 pf-d-none",dlang("generator","Layers")),this._nodeLayersCopy=tag("div"),this._nodeLayers=tag("div"),this.nodeError=tag("div","alert alert-danger text-center hidden pf-p-12 pf-mt-16",lang("Please add a design!")),this._nodePlacementOptions=tag("div","layer-picker__item__options-picker pf-mt-16")]),this._subscribeTemplateEvents(),this.render()},_unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onLayerRemoved).unsubscribe(this._updateLayers).unsubscribe(this._renderCurrentPlacement).unsubscribe(this._updateRotationInput)},_subscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnLayerRemovedListener(this._onLayerRemoved).addOnTemplateResizedListener(this._updateLayers).addOnActiveLayerChanged(this._renderCurrentPlacement).addOnLayerConfigurationChanged(this._renderCurrentPlacement).addOnLayerRotatedListener(this._updateRotationInput).addOnLayerOrderChangedListener(this._renderCurrentPlacement)},_unsubscribeTemplateEventsIfNeeded:function(){return!(PF.Utils.isInDocument(this.node)&&!this._unsubscribedFromEvents)&&(this._unsubscribeTemplateEvents(),this._unsubscribedFromEvents=!0,!0)},resubscribeToEvents:function(){this._unsubscribedFromEvents&&PF.Utils.isInDocument(this.node)&&this._par.templates&&(this._unsubscribeTemplateEvents(),this._subscribeTemplateEvents(),this.render())},_setTemplatesAvailableForLayerCopy:function(){if(this._canCopyLayers(this._par.activePlacementId)){var e=this._par.templates.getActiveTemplate(this._par.activePlacementId),t=this._par.templates.getTemplates(),i=[];for(var r in t)for(var n in t[r])i.push(t[r][n]);this._templatesAvailableForLayerCopy=i.filter(function(t){if(e&&this._templatesMatchForCopy(e,t)&&this._canCopyLayers(t.placementId))return t.placement_title=this._par.placements.filter((function(e){if(e.id===t.placementId)return e.title})).shift().title,t}.bind(this))}},_templatesMatchForCopy:function(e,t){return e.placementId!==t.placementId&&e.width===t.width&&e.height===t.height},_canCopyLayers:function(e){var t=[PF.Items.OrderLineItemFile.TYPE_SLEEVE_LEFT,PF.Items.OrderLineItemFile.TYPE_SLEEVE_RIGHT,PF.Items.OrderLineItemFile.TYPE_LEG_LEFT,PF.Items.OrderLineItemFile.TYPE_LEG_RIGHT];return!this._par.templates.isCoverMode()&&t.indexOf(e)>-1},_onLayerRemoved:function(e,t){if(!this._unsubscribeTemplateEventsIfNeeded()){var i=this._par.getSelectedMockupVariant(),r=i?i.templateId:null,n=this._par.templates.getActiveLayer()||this._par.templates.getFirstLayer(this._par.activePlacementId,r);if(n){var a=this._par.templates.getTemplateByLayer(n);a&&a.layers.length?this._par.templates.silentlySetActiveLayer(n):mkE.clearNode(this._nodePlacementOptions)}this._renderFiles()}},_renderCurrentPlacement:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||this===t||t instanceof PF.Forms.Range||this._renderFiles()},_updateRotationInput:function(e,t){if(!(this._unsubscribeTemplateEventsIfNeeded()||t instanceof PF.Forms.Range)){var i=this._pickerItems[this._par.activePlacementId];if(i&&i.length){var r=e.position.rotation>180?e.position.rotation-360:e.position.rotation;i.filter((function(t){return t.hasLayer(e)})).forEach((function(e){e.updateRotationInput(r)}))}}},render:function(){this._renderFiles(),this._renderCopyLayersTool()},_renderFiles:function(){this._forceDisableCustomizer=this._par.activePlacementId===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE;var e=this._par.templates.getActiveTemplate(this._par.activePlacementId);mkE.clearNode(this._nodeLayers);for(var t=[],i=e?e.layers:[],r=this._par.templates.getActiveLayer(),n=i.length;n--;){var a=i[n],o=new PF.ProductPush.LayerPicker.Item.Par;o.templates=this._par.templates,o.placements=this._par.placements,o.activePlacementId=this._par.activePlacementId,o.layer=a,o.onRequestRemoval=this._removeFile.bind(this,e,a),o.onRequestCenterHorizontally=this._centerHorizontally.bind(this,a),o.onRequestCenterVertically=this._centerVertically.bind(this,a),o.onRequestFlipHorizontally=this._flipHorizontally.bind(this,a),o.onRequestFlipVertically=this._flipVertically.bind(this,a),o.onRequestRotate=this._onRotate.bind(this,a),o.onRequestPositionReset=this._resetPositions.bind(this,a),o.onDuplicate=this._par.onDuplicate.bind(this,a),o.onColorChanged=this._colorChanged.bind(this,a),o.onClicked=this._onItemClicked.bind(this,a),o.onEdit=this._par.onItemEdit?this._par.onItemEdit.bind(this,a):null,o.product=this._par.product,o.onChangeIsCustomizable=this._onChangeIsCustomizable.bind(this,a),o.allowCustomizableLayers=!this._forceDisableCustomizer&&this._par.allowCustomizableLayers,o.isAllOver=this._par.isAllOver,o.validateAddingLayer=this._par.validateAddingLayer,o.showPatternPicker=this._par.showPatternPicker,o.fileCountLimit=this._par.fileCountLimit;var s=new PF.ProductPush.LayerPicker.Item(o);r&&r.uniqueId===a.uniqueId&&s.setActive(!0),s.append(this._nodeLayers),t.push(s)}$(this._nodeLayers).sortable({handle:".layer-picker__item__handle, .layer-picker__item__handle-wrap",placeholder:"layer-picker__placeholder",items:".layer-picker__item",cancel:".pf-d-none",update:function(e,i){var r=i.item.attr("data-layer-id"),n=i.item.index();n=t.length-n-1;for(var a=0,o=t.length;a<o;a++){var s=t[a].getLayer();if(String(s.uniqueId)===String(r)){this._par.templates.reorderLayer(s,n);break}}}.bind(this),tolerance:"pointer",start:function(e,t){t.item.show().addClass("layer-picker__item--ghost")},stop:function(e,t){t.item.removeClass("layer-picker__item--ghost")},helper:"clone"}),t.length>0?mkE.removeClassName(this._nodeLayersTitle,"pf-d-none"):mkE.addClassName(this._nodeLayersTitle,"pf-d-none"),this._pickerItems[this._par.activePlacementId]=t;var l=this._par.conflictCalculator.getConflictingPlacementTitles(this._par.activePlacementId),d=t.filter((function(e){return e.isImageLayer()}));if(mkE.clearNode(this._nodePicker),l.length)tag("div",{className:"alert alert-warning",innerHTML:lang("Can't be combined with {tiles}").replace("{tiles}",l.join(", "))}).append(this._nodePicker);else{this._par.layerPickerChooser.append(this._nodePicker),this._par.layerPickerChooser.setTitleHidden(!0),this._par.nodeTemplateTypePicker&&(this._par.nodeTemplateTypePicker.append(this._nodePicker),0===i.length&&tag("hr").append(this._nodePicker));var c=d.length<this.fileCountLimit,u=dlang("dashboard","Max limit is {number} image layers. Please delete a layer if you want to add another one.").replace("{number}",this.fileCountLimit);this._par.layerPickerChooser.setTypeEnabled(PF.ProductPush.LayerPicker.TYPE_FILE,c,u)}this._par.layerPickerChooser.setMinified(t.length>0),t.length?this._par.isAdvancedTemplate()||this._nodeTemplateInfo.renderGuidelineInfo():this.clearGuidelineIfo(),t.length&&this.renderOptions()},clearGuidelineIfo:function(){this._nodeTemplateInfo.clearGuidelineInfo()},setProductOptionsValues:function(e){return this._productOptionsValues||(this._productOptionsValues={}),mkE.O2O(this._productOptionsValues,e),this},renderOptions:function(){if(mkE.clearNode(this._nodePlacementOptions),this._par.onProductOptionsChanged){var e=new PF.Components.ProductOptions.Par;e.inputNamePrefix="gp-",e.optionItems=this._productOptions,e.values=this._productOptionsValues,e.onChange=this._onProductOptionsChanged,this._productOptionsPicker=new PF.VariantPicker.OptionPicker(e),this._productOptionsPicker.setFileTypesWithFiles(this._par.templates.getPlacementIdsHavingFiles()).setPlacementIdsWithFiles(this._par.templates.getPlacementIdsHavingFiles(PF.Components.GeneratorMockup.ImageLayer)),this._productOptionsPicker.setPickerGeneratorPlacements(this._par.productOptionsPlacements),this._productOptionsPicker.setSelectedPlacementId(this._par.activePlacementId),this._productOptionsPicker.append(this._nodePlacementOptions)}},_onProductOptionsChanged:function(e){var t=this._productOptionsPicker.getValues();return t.hasOwnProperty(e.getName())||(t[e.getName()]=e.getValue()),this.setProductOptionsValues(t),this._par.onProductOptionsChanged(t)},_renderCopyLayersTool:function(){if(!(this._pickerItems[this._par.activePlacementId].length<=0||this._templatesAvailableForLayerCopy.length<=0)){for(var e in mkE.addClassName(this._nodeLayersCopy,"pf-my-24"),this._templatesAvailableForLayerCopy)tag("a",{className:"pf-link-block col-12 pf-mb-8",onclick:this._onClickCopyLayers.bind(this,e)},[tag("i","pf-i pf-i-content-duplicate pf-i-18 pf-text-gray pf-mb-2"),tag("span","pf-pl-4",dlang("generator","Copy this design on the {placement_title}").replace("{placement_title}",this._templatesAvailableForLayerCopy[e].placement_title)),tag("span","pf-badge pf-badge-small pf-badge--primary pf-ml-8",[dlang("global","new")])]).append(this._nodeLayersCopy);tag("div","pf-my-24 pf-border-bottom").append(this._nodeLayersCopy)}},_onClickCopyLayers:function(e){this._templatesAvailableForLayerCopy[e].hasLayers()?this._isPopupBusy||(this._isPopupBusy=!0,setTimeout(function(){this._isPopupBusy=!1}.bind(this),1e3),new PF.ProductPush.CopyWarningPopup(this._copyLayersAndShowMessage.bind(this,e),this._templatesAvailableForLayerCopy[e].placement_title)):this._copyLayersAndShowMessage(e)},_copyLayersAndShowMessage:function(e){var t=this._templatesAvailableForLayerCopy[e];this._par.templates.copyLayersBetweenTemplates(this._par.activePlacementId,t.placementId,t.templateId),this._showSuccsessMessage(dlang("generator","Layers are duplicated on the {placement_title}").replace("{placement_title}",t.placement_title))},_showSuccsessMessage:function(e){var t=$(".modal-content");t.length<=0&&(t=$("body")),new PF.Components.StatusMessage(e,PF.Components.StatusMessage.TYPE_SUCCESS,3e3).append(t[0])},_onItemClicked:function(e,t,i){for(var r in i&&i.stopPropagation(),this._pickerItems[this._par.activePlacementId]){var n=this._pickerItems[this._par.activePlacementId][r];n.setActive(t===n)}this._par.templates.setActiveLayer(e,this,!1)},_removeFile:function(e,t){var i=new PF.Items.GeneratorPlacement;i.id=e.placementId,i.title="",this._par.templates.removeLayer(e,t)},requestFilePicking:function(e){var t=new PF.FileLibrary.Par;t.onPickCallback=this._onFilePicked.bind(this,e),this._par.product&&(t.productId=this._par.product.productId,t.technique=PF.Utils.TechniqueMemory(this._par.product.productId).getTechniqueFromMemory()),PF.Customer.customerId?(t.storeId=this._par.storeId,t.includeSwatches=this._par.includeSamples,t.search=this._par.searchTag):(t.showSearch=!1,t.allowStoreChange=!1,t.storeId=PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID),PF.FileLibrary.popup(t)},_centerVertically:function(e,t){t&&t.stopPropagation();var i=this._par.templates.getFreshLayer(e).position.getClone().centerVertically();this._par.templates.updateLayerPosition(e,i)},_centerHorizontally:function(e,t){t&&t.stopPropagation();var i=this._par.templates.getFreshLayer(e).position.getClone().centerHorizontally();this._par.templates.updateLayerPosition(e,i)},_flipHorizontally:function(e,t){t&&t.stopPropagation(),e.flipX=!e.flipX,this._notifyLayerFlipChanged(e)},_flipVertically:function(e,t){t&&t.stopPropagation(),e.flipY=!e.flipY,this._notifyLayerFlipChanged(e)},_notifyLayerFlipChanged:function(e){e instanceof PF.Components.GeneratorMockup.ImageLayer?this._par.templates.updateImageLayer(e,this):e instanceof PF.Components.GeneratorMockup.ClipartLayer?this._par.templates.updateClipartLayer(e,this):console.log("Cannot update layer flip settings!",e),this._par.templates.updateLayerPosition(e,e.position,this,!0)},_resetPositions:function(e,t){t&&t.stopPropagation(),this._par.templates.resetLayer(e)},_onRotate:function(e,t,i){var r=this._par.templates.getFreshLayer(e).position.getClone();r.rotation=parseFloat(t),this._par.templates.updateLayerPosition(e,r,i)},updateLayer:function(e){var t=this._par.activePlacementId;for(var i in this._pickerItems[t]){var r=this._pickerItems[t][i];if(r.getLayer().uniqueId===e.uniqueId){r.updateLayer(e);break}}},_updateLayers:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()){if(!PF.Utils.isInDocument(this.node))return!1;var r=this._par.activePlacementId;for(var n in this._pickerItems[r]){var a=this._pickerItems[r][n];if(a.updateLayer(this._par.templates.getFreshLayer(a.getLayer())),t&&a.getLayer().uniqueId===t.uniqueId)break}}},getLayerIndexInPicker:function(e,t,i){for(var r in this._pickerItems[e]){if(this._pickerItems[e][r].getLayer().uniqueId===t)return i?this._pickerItems[e].length-r-1:r}return-1},_colorChanged:function(e){this._par.onColorChanged&&this._par.onColorChanged(e)},_onFilePicked:function(e,t){if(!t.width||!t.height)return console.error(lang("Cannot use this file, because width or height is not known")),void this.requestFilePicking(e);this._par.onPicked&&this._par.onPicked(e,t)},getValueCount:function(){return 1},isValuePicked:function(){return this._par.templates.getPlacementIdsHavingFiles().length>0||this._par.hasAtLeastOneDesignFillColor()},hasSameProductOptionValues:function(e,t){return!this._productOptionsPicker||this._productOptionsPicker.hasSameValues(e,t)},checkProductOptionsStatus:function(){return!this._productOptionsPicker||(this._productOptionsPicker.hasValidOptions(),this._productOptionsPicker.updateErrorStatus())},getProductOptionsPicker:function(){return this._productOptionsPicker},_onChangeIsCustomizable:function(e){if(e.isCustomizable=!e.isCustomizable,this._par.templates){var t=this._par.templates.getTemplateByLayer(e);this._par.templates.changeCustomizableState(t,e,e.isCustomizable),this._par.templates.getChangeListener().notifyLayerCustomizableStateChanged([t])}this._par.onCustomizableChanged&&this._par.onCustomizableChanged(e)}},PF.VariantPicker.BasePicker),PF.ProductPush.LayerPicker.checkForWarnings=function(e,t,i){e&&!t&&e.isEmbroidery()?PF.FileLibrary.EmbroideryWarning.showPopup(PF.ProductPush.LayerPicker.checkForWarnings.bind(this,e,!0,i)):i()},PF.ProductPush.LayerPicker.TYPE_FILE="file",PF.ProductPush.LayerPicker.TYPE_TEXT="text",PF.ProductPush.LayerPicker.TYPE_TEXTBOX="textbox",PF.ProductPush.LayerPicker.TYPE_CLIPART="clipart"}()},"8F1a":function(e,t){!function(){"use strict";PF.ProductPush.ConflictCalculator=Class({_conflictingTypes:{},_templates:null,_placementSelector:null,__construct:function(e,t){this._placementSelector=e,this._templates=t},setConflictingTypes:function(e){this._conflictingTypes=e},getConflictingPlacementTitles:function(e){var t=this._conflictingTypes[e];if(!t||!t.conflictsWith.length)return[];var i=[],r=this._templates.getPlacementIdsHavingFiles();for(var n in t.conflictsWith){var a=t.conflictsWith[n];r.indexOf(a.id)>-1&&i.push(a.title)}return i},getCurrentPlacementConflicts:function(){return this.getConflictingPlacementTitles(this._placementSelector.getSelectedPlacementId())}})}()},"8oxB":function(e,t){var i,r,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l,d=[],c=!1,u=-1;function h(){c&&l&&(c=!1,l.length?d=l.concat(d):u=-1,d.length&&p())}function p(){if(!c){var e=s(h);c=!0;for(var t=d.length;t;){for(l=d,d=[];++u<t;)l&&l[u].run();u=-1,t=d.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new g(e,t)),1!==d.length||c||s(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},"94Bt":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Actions.Button=Class({_nameToggledOn:"",_nameToggledOff:"",_iconClassName:{on:"",off:""},_imgSrc:null,_onClickCallback:null,_isToggledOn:!1,_nodeBadge:null,__construct:function(){this.node=tag("div","pf-mb-8 generator-mockup__actions__container generator-mockup__actions__container--off")},setName:function(e,t){return this._nameToggledOn=e,this._nameToggledOff=t,this},setIconClass:function(e,t){return this._iconClassName.on=e,this._iconClassName.off=t||e,this},setImgSrc:function(e,t){return this._imgSrc||(this._imgSrc={on:"",off:""}),this._imgSrc.on=e,this._imgSrc.off=t,this},setCallback:function(e){return this._onClickCallback=e,this},setIsToggledOn:function(e){return this._isToggledOn=e,mkE.addClassName(this.node,"generator-mockup__actions__container--"+(this._isToggledOn?"on":"off")),mkE.removeClassName(this.node,"generator-mockup__actions__container--"+(this._isToggledOn?"off":"on")),this},setBadge:function(e,t){return this._nodeBadge=tag("span","badge "+t,e),this},render:function(){mkE.clearNode(this.node);var e=this._isToggledOn?"on":"off",t=this._imgSrc&&this._imgSrc[e]?tag("img",{className:this._isToggledOn?this._iconClassName.off:this._iconClassName.on,src:this._imgSrc[e]}):tag("i","pf-i  pf-i-24 "+(this._isToggledOn?this._iconClassName.off:this._iconClassName.on));return tag("a",{className:"generator-mockup__actions__button",onclick:this._onClick.bind(this,!this._isToggledOn),href:"#"},[t,this._isToggledOn?this._nameToggledOff:this._nameToggledOn,this._nodeBadge?this._nodeBadge:""]).append(this.node),this},_onClick:function(e,t){t.preventDefault(),this._isToggledOn=e,this._onClickCallback&&this._onClickCallback(e)}},mkE.Base)}()},"9Nv7":function(e,t,i){"use strict";var r=i("LvDl"),n=i.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function d(e,t,i){return(d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&c(n,i.prototype),n}).apply(null,arguments)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g=function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=s(this,u(t).call(this,e.statusText))).xhr=e,i}var i,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),i=t,(r=[{key:"getXhr",value:function(){return this.xhr}}])&&o(i.prototype,r),n&&o(i,n),t}(l(Error));t.a=function(e,t,i){i=i||{},t=t||{};var r=e.split("/"),a=null,o=null,s=null;3===r.length?(a=r[0],o=r[1],s=r[2]):2===r.length?(o=r[0],s=r[1]):console.error("RPC call got strange URL: "+e);var l=(a?"/"+a:"")+"/rpc/"+o+"-rpc/"+s;return new Promise((function(r,a){var o=i.simpleRejection||!1,s=i.beforeSend||null,d={url:l,method:"POST",dataType:"json",data:t,success:function(t){t.output&&console&&console.info&&console.info(e+" output:\n"+t.output),r(t.result)},error:function(i){if(o)a(new g(i));else{var r=parseInt(i.status+"");404===r?(PF.ErrorLogger.log("RPC 404 for `"+l+"`"),alert("Whoa, we encountered an unexpected problem.\nPlease, refresh the page and try again!\nIf this persists, please contact us!")):504===r?alert("Whoa, it seems that the communication to server timed-out.\nPlease, refresh the page and try again!\nIf this persists, please contact us!"):429===r?alert(i.responseJSON.message):403===r?location.reload():0!==r?alert("["+r+"]\nSorry, an error occurred.\nReload the page and try again.\nIf this persists, please contact at devsupport@printful.com"):console.error("Unknown error",e,t),a(new g(i))}}};n.a.assign(d,i),$.ajax(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(i,!0).forEach((function(t){p(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},d,{},i,{beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",window.yii.getCsrfToken()),s&&s(e)}}))}))}},"9w4f":function(e,t){!function(){"use strict";PF.ProductPush.SizeGuide=Class({_product:null,_isVisible:!1,__construct:function(e,t){this._product=(new PF.Repositories.Products).getCachedProductById(e),this._isVisible=t},getButton:function(){return this.canHaveSizeGuide()?mkE({tag:"a",className:"pull-right margin-right-5 margin-left-30 pf-link",text:dlang("products","See size guide"),onclick:this.show}):""},canHaveSizeGuide:function(){return this._isVisible&&this._product.canHaveSizeGuide},show:function(e){var t=new PF.Modal.Par;t.title=lang("Size guide"),t.modalDialogClass="modal-lg",t.onClose=this.hide.bind(this),t.url=PF.Items.ProductItem.getSizeChartUrl(this._product.productId),t.useScrollableModal=!0,this.sizeGuideModal=new PF.Modal(t),$(e.target).css("pointer-events","none"),this.sizeGuideModal.show(),$(this.sizeGuideModal._node).on("hidden.bs.modal",(function(){$(e.target).css("pointer-events","all")}))},hide:function(){this.sizeGuideModal&&(this.sizeGuideModal.remove(),this.sizeGuideModal=null)}},mkE.Base)}()},AKhu:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Canvas=Class({__NAME:"PF.Components.GeneratorMockup.Canvas",_par:null,_canvasNode:null,_canvas:null,__construct:function(e){this._par=e,this.node=tag("div",{className:"canvas-wrapper",style:{width:this._par.mockupPosition.areaWidth+"px",height:this._par.mockupPosition.areaHeight+"px",top:0,marginLeft:-this._par.mockupPosition.areaWidth/2+"px",left:"50%",pointerEvents:this._par.isReadOnly?"none":""}},[this._canvasNode=tag("canvas")]),$(".modal-dialog").length>0&&$(document).off("focusin.modal"),this._canvas=new PF.CANVAS(this._par.mockupPosition,this._canvasNode,this._par.isReadOnly?null:{onLayerSelected:this._onCanvasLayerSelected.bind(this),onLayerChanged:this._onCanvasLayerChanged.bind(this),onLayerRemoved:this._onCanvasLayerRemoved.bind(this),onLayerScaled:this._onLayerScaled.bind(this),onRotationShadowChanged:this._onRotationShadowChanged.bind(this)},this._par.opts),this._subscribeTemplateEvents()},isEventOrigin:function(e){return e&&(e===this||e===this._getUid())},_getUid:function(){return"canvas-"+this._canvas.uid},_subscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnLayerAddedListener(this._onLayerAddedFromCanvas).addOnLayerRemovedListener(this._onLayerRemovedFromCanvas).addOnLayerOrderChangedListener(this._onLayerOrderChangedFromCanvas).addOnTemplatePositionsChangedListener(this._onTemplatePositionsChangedFromCanvas).addOnLayerConfigurationChanged(this._onLayerConfigurationChangedFromCanvas).addOnActiveLayerChanged(this._onActiveLayerChangedFromCanvas).addOnTemplateResizedListener(this._onTemplateResizedFromCanvas)},_unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onLayerAddedFromCanvas).unsubscribe(this._onLayerRemovedFromCanvas).unsubscribe(this._onLayerOrderChangedFromCanvas).unsubscribe(this._onLayerConfigurationChangedFromCanvas).unsubscribe(this._onTemplatePositionsChangedFromCanvas).unsubscribe(this._onActiveLayerChangedFromCanvas).unsubscribe(this._onTemplateResizedFromCanvas)},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this._unsubscribeTemplateEvents(),!0)},setLayers:function(e){this._canvas.setLayers(e),this.notifyPreview()},setLayer:function(e){this._canvas.setPosition(e.uniqueId,e.toArray(!0,!0)),this.notifyPreview()},showActiveLayer:function(e){this._canvas.showActiveLayer(e)},getActiveLayer:function(){var e=this._canvas.getActiveLayerId();return this._par.templates.getLayerById(e)},notifyPreview:function(){PF.Utils.Delayer.delay("PF.Components.GeneratorMockup.Canvas._onCanvasLayerChanged-preview-"+this._getUid(),this._par.onPreview.bind(null,this._canvas.convertToPreview.bind(this._canvas),this._getUid()),100)},toggleGuidelines:function(e,t){this._canvas.toggleGuidelines(e,t)},toggleZoom:function(e){this._canvas.toggleZoom(e)},_onCanvasLayerSelected:function(e){if(this._par.templates&&e){var t=this._par.templates.getLayerById(e.id),i=this._par.templates.getActiveLayer();if(!i||t){e&&t&&t.patternType&&this._onCanvasLayerChanged(!1,{target:e,transform:{}});var r=i&&t&&i.uniqueId===t.uniqueId;this._par.onLayerSelected(t,r,this)}}},_onCanvasLayerChanged:function(e,t){if(this._par.templates){var i=t.target||t.transform.target;if(i){var r=this._par.templates.getLayerById(i.id);if(r){var n=r.position.getFromOriginalRatio().getScaledPosition(this._par.mockupPosition.width,this._par.mockupPosition.height),a=i.getPointByOrigin("center","center"),o=a.x-i.getScaledWidth()/2,s=a.y-i.getScaledHeight()/2,l={width:i.getScaledWidth(),height:i.getScaledHeight(),top:s-this._par.mockupPosition.top,left:o-this._par.mockupPosition.left,rotation:i.getAngle()};n.left=this._normalizePosition(l.left,n.left),n.top=this._normalizePosition(l.top,n.top),n.width=this._normalizePosition(l.width,n.width),n.height=this._normalizePosition(l.height,n.height),n.rotation=this._normalizePosition(l.rotation,n.rotation,!0),r.flipX=i.flipX,r.flipY=i.flipY,e?PF.Utils.Delayer.delay("PF.Components.GeneratorMockup.Canvas._onCanvasLayerChanged-position-"+this._getUid(),this._par.onPositionChanged.bind(null,r,n,this._getUid()),100):this._par.onPositionChanged(r,n,this),this.notifyPreview()}}}},_onLayerScaled:function(e,t,i){if(this._par.templates){var r=i.target||i.transform.target;if(r){var n=this._par.templates.getLayerById(r.id);n&&n instanceof PF.Components.GeneratorMockup.TextboxLayer&&!n.overrideImagePulse&&(e?PF.Utils.Delayer.delay("PF.Components.GeneratorMockup.Canvas._onLayerScaled-"+this._getUid(),function(){PF.CANVAS.calculateTextboxPositions(n),this._canvas.setPosition(n.uniqueId,n.toArray(!0,!0))}.bind(this),100):(PF.CANVAS.calculateTextboxPositions(n),this._canvas.setPosition(n.uniqueId,n.toArray(!0,!0))))}}},_onRotationShadowChanged:function(e){if(this._par.templates){var t=e.target||e.transform.target;if(t){var i=this._par.templates.getLayerById(t.id);if(i&&t.shadow&&t.shadow.color){var r=parseFloat(i.shadowAngle-t.angle).toFixed(1),n=Math.cos(-r*Math.PI/180)*i.shadowDistance*PF.CANVAS.FONT_SIZE_MULTIPLIER,a=Math.sin(-r*Math.PI/180)*i.shadowDistance*PF.CANVAS.FONT_SIZE_MULTIPLIER;t.subType&&t.subType===PF.CANVAS.Layer.TYPES.textbox_png&&(n*=PF.CANVAS.PNG_TEXT_MULTIPLIER,a*=PF.CANVAS.PNG_TEXT_MULTIPLIER),t.shadow=new fabric.Shadow({color:i.shadowColor,blur:0,offsetX:n,offsetY:a})}}}},_normalizePosition:function(e,t,i){e=parseFloat(Number(e).toFixed(4));var r=i?0:.9;return PF.CANVAS.NUMDIFF(e,t)>r?e:t},_onCanvasLayerRemoved:function(e){if(this._par.templates&&e){this._canvas.removeLayer(e);var t=this._par.templates.getLayerById(e.id);this._par.onLayerRemoved(t)}},_onLayerAddedFromCanvas:function(e,t){if(!this._unsubscribeTemplateEventsIfNeeded()){var i=e.length?e[0]:null;if(i)if(t)t instanceof PF.Components.GeneratorMockup.TextboxLayer?this._canvas.drawTextbox(t.toArray()):this._canvas.drawLayer(new PF.CANVAS.Layer(t.toArray()));else{var r=i.layersToArray();this.setLayers(r)}}},_onLayerRemovedFromCanvas:function(e,t){if(!this._unsubscribeTemplateEventsIfNeeded()){var i=e.length?e[0]:null;if(i)if(t)this._canvas.removeLayerById(t.uniqueId);else{var r=i.layersToArray();this.setLayers(r)}}},_onLayerOrderChangedFromCanvas:function(){this._unsubscribeTemplateEventsIfNeeded()||this._canvas.sortLayers(!0)},_onTemplatePositionsChangedFromCanvas:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()&&!(this.isEventOrigin(i)||(this._canvas.setPosition(t.uniqueId,t.toArray(!0,!0)),e.length<=1))){var r=this._par.templates.getTemplateByLayer(t);if(r)if(!(r.getLayerIndex(t)<0)){for(var n in e){var a=e[n],o=a.getLayerIndex(t);if(a.layers[o]){var s=a.layers[o].getOriginalClone();s.isConfigurationSame(t);this._canvas.setPosition(s.uniqueId,s.toArray(!0,!0))}}this.notifyPreview()}}},_onActiveLayerChangedFromCanvas:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||this.isEventOrigin(t)||this.showActiveLayer(e?e.uniqueId:null)},_onTemplateResizedFromCanvas:function(e,t,i){this._unsubscribeTemplateEventsIfNeeded()||this.isEventOrigin(i)||this._canvas.setPosition(t.uniqueId,t.toArray(!0,!0))},_onLayerConfigurationChangedFromCanvas:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||this.isEventOrigin(t)||this._canvas.updateLayer(e.toArray(!0,!0))}},mkE.Base)}()},APlb:function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryHelper.Par=Class({shouldAllowFileColorChanger:null,templates:null,designerNode:null,getNodeMainMockupArea:null,pickerConfig:null,product:null,getSelectedPlacementId:null,getSelectedPlacementTechnique:null,onAllImagesProcessed:null,scheduleEmbroideryPreviewUpdate:null,editImageLayer:null,onLayerColorsChanged:null,getAvailablePlacements:null,isAllOverProduct:null,getProductOptionsPicker:null,isCustomizingMode:null})}()},C2ea:function(e,t,i){"use strict";i.r(t);var r=i("LvDl"),n=i.n(r);PF.ProductPush.MockupPicker=Class({_par:null,_generatorPicker:null,_rows:[],_designData:null,breadcrumbItems:[],_preselectedGeneratorVariantId:null,_tagSelector:null,_sizeGuide:null,_activeItem:null,_activeMainGroup:null,_mainGroupItems:[],_genderCategorySelector:null,_loadedFlags:{GenderCategory:!1},_isAdditionalMockupsActive:!1,_additionalGroupItems:[],_productDetailInputs:null,_productPricingWithoutPricing:null,shouldPushMockups:!0,__construct:function(e){this._par=e,this._designData=this._par.designData,this._setPreselectedData(),this._designData.store.type!==PF.Items.StoreItem.TYPE_AMAZON&&this._designData.store.type!==PF.Items.StoreItem.TYPE_WEEBLY||(this._designData.isTransparent=!1),this.node=tag("div","",[this._mainNode=tag("div")]),this._renderMockupPicker()},_setPreselectedData:function(){if(this._preselectedGeneratorVariantId=this._designData.defaultGeneratorVariantId,this._designData.defaultGeneratorVariantId&&null==this._activeMainGroup)for(var e in this._par.generatorParams.generatorVariants){var t=this._par.generatorParams.generatorVariants[e];t.generatorVariantId==this._preselectedGeneratorVariantId&&t.optionGroup&&(this._activeMainGroup=t.optionGroup)}},_renderMockupPicker:function(){mkE.clearNode(this._mainNode),tag("div","pf-py-24 pf-px-sm-4",[this._mockupNode=tag("div"),tag("div","main-image-block pf-pt-32 pf-mt-32 pf-mb-24",[tag("span","pf-h3",dlang("generator","Mockups that will be pushed to your store"))]),this._groupsOuterNode=tag("div","main-group-mockup-picker pf-mt-12"),this._additionalMockupBlock=tag("div"),null!==this._designData.isTransparent?this._getTransparencySelector():"",this._par.isMockupUpdate?this._getUpdateMockupsNode():"",this._getUpdateInIntegrationNode()]).append(this._mainNode);var e=this._hasProductDescription()?lang("Proceed to description"):lang("Proceed to title");this._nodeFooter=tag("div","navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[this._mockupsBackBtn=tag("a",{id:"js--back",className:"pf-btn pf-btn-secondary pf-mr-12",onclick:this._par.onMockupBack?this._par.onMockupBack:""},dlang("products","Back")),this._mockupsContinueBtn=tag("a",{className:"pf-btn pf-btn-primary",onclick:this._par.onMockupNext?this._par.onMockupNext:this.renderDescription},this._par.ctaText?this._par.ctaText:e)])]),this._par.modalTitleNodeUpdate&&this._par.modalTitleNodeUpdate(lang("Choose mockup images")),this._par.stickyButtonNodeUpdate(this._nodeFooter),setTimeout(function(){this._renderMainMockupGroups(),this._renderAdditionalMockupGroups()}.bind(this),1)},_getUpdateMockupsNode:function(){return-1===[PF.Items.StoreItem.TYPE_SHOPIFY,PF.Items.StoreItem.TYPE_ETSY,PF.Items.StoreItem.TYPE_WOOCOMMERCE,PF.Items.StoreItem.TYPE_WIX].indexOf(this._designData.store.type)?"":tag("div","update-mockup-block pf-pt-32 pf-mt-32 pf-mb-24",[tag("div","",[tag("span","pf-d-inline-block pf-h3 pf-mb-12",dlang("generator","Publish updated mockups"))]),tag("span","text-muted",dlang("generator","The updated mockups will be pushed to your storefront.")),tag("div","",[tag("div","checkbox pf-mt-24 pf-mb-12 pf-d-inline-block",[tag("label",{attr:{for:"publishUpdatedMockups"}},[tag("input",{type:"checkbox",id:"publishUpdatedMockups",prop:{checked:!!this.shouldPushMockups},onclick:function(){this.shouldPushMockups=!this.shouldPushMockups}.bind(this)}),tag("b",null,dlang("generator","Publish mockups"))])])]),this._designData.store.type===PF.Items.StoreItem.TYPE_ETSY?tag("div","integration-disclaimer",[tag("div","",dlang("generator","The updated mockups will be published on Etsy as new, so please delete the old mockups on Etsy manually.")),tag("div","",dlang("generator","Note that Etsy allows up to 10 images per product."))]):""])},_renderAdditionalMockupNodeButton:function(){this._isAdditionalMockupsActive=!this._isAdditionalMockupsActive,this._isAdditionalMockupsActive?$(this._additionalMockupNode).slideDown("slow"):$(this._additionalMockupNode).slideUp("slow"),this._isAdditionalMockupsActive&&mkE.hasClassName(this._nodeAdditionalMockupPicker,"slick-initialized")&&$(this._nodeAdditionalMockupPicker).slick("refresh")},_renderAdditionalMockupGroups:function(){if(this._canShowAdditionalMockups()&&!(this._mainGroupItems.length<=1)){if(tag("div","additional-mockups-block pf-pt-32",[tag("div",null,[tag("span","pf-d-inline-block pf-h3",dlang("generator","Additional mockups")),tag("span",{className:"pf-badge pf-badge-small pf-badge--primary pf-ml-8",style:{position:"relative",top:"-3px"}},dlang("global","New"))]),tag("span","text-muted pf-pt-8",dlang("generator","Choose a product color you want featured in several mockup styles")),tag("div",null,[tag("div","checkbox pf-my-24 pf-d-inline-block",[tag("label",{attr:{for:"additionalMockupStylesCheckbox"}},[tag("input",{type:"checkbox",id:"additionalMockupStylesCheckbox",onclick:this._renderAdditionalMockupNodeButton.bind(this),prop:{checked:!!this._isAdditionalMockupsActive}}),tag("b",null,dlang("generator","Add additional mockup styles"))])])]),this._additionalMockupNode=tag("div")]).append(this._additionalMockupBlock),this._additionalSizePicker=tag("div"),0===this._par.generatorParams.colors.length){var e=new PF.ProductPush.Pickers.Params;e.values=this._par.generatorParams.sizes,e.selectedValues=[this._par.generatorParams.sizes[0]],e.selectedLimit=1,e.onChangedCallback=this._renderAdditionalMockupNode,e.designData=this._par.designData,this._additionalSizePicker=new PF.ProductPush.SizePicker(e)}var t="";this._par.generatorParams.colors.length>0&&(t=tag("div","pf-pb-8",[tag("b",null,lang("Choose 1 color:"))]));var i=new PF.Components.ColorPicker.Par;i.colors=this._formatColors(this._par.generatorParams.colors),i.onChange=this._renderAdditionalMockupNode,i.showHuge=!0,i.selectedColors=[this._par.designData.colors[0]],i.canDeselectLast=!1,i.maxCount=1,tag("div","additional-mockups",[t,this._additionalColorPicker=new PF.Components.ColorPicker(i),this._additionalSizePicker,this._additionalMockupContentNode=tag("div")]).append(this._additionalMockupNode),this._renderAdditionalMockupNode()}},_renderAdditionalMockupNode:function(){if(!this._canShowAdditionalMockups())return!1;mkE.clearNode(this._additionalMockupContentNode),this._additionalGroupItems=Object.keys(this._mainGroups).filter(this._filterMainGroup.bind(this)).filter(this._excludeMainMockup.bind(this)).map(this._mapAdditionGroupItems.bind(this)),tag("div","container-fluid slick-slider-container pf-mt-24",[this._nodeAdditionalMockupPicker=tag("div","bubble-slider slick-dotted additional-mockup-picker slick-slider--loading row",this._additionalGroupItems)]).append(this._additionalMockupContentNode),setTimeout(function(){this._initSlickr(this._nodeAdditionalMockupPicker),this._isAdditionalMockupsActive||$(this._additionalMockupNode).hide(),mkE.removeClassName(this._nodeAdditionalMockupPicker,"slick-slider--loading")}.bind(this),50),$(window).on("resize",this._onResizeAdditionalItems),this._designData.additionalGeneratorVariantIds=[]},_excludeMainMockup:function(e){return e!==this._activeMainGroup.getGroupName()},_formatColors:function(e){var t=this._par.designData.colors,i={};for(var r in e){var n=e[r];if(n.colorCode){var a=!1;for(var o in t)if(t[o]===e[r].color){a=!0;break}if(a){var s=[n.colorCode.toUpperCase()];n.colorCode2&&s.push(n.colorCode2.toUpperCase()),i[n.color]=s}}}return i},_mapGroupItems:function(e){var t=new PF.ProductPush.MockupPicker.Row.Par;return t.items=this._mainGroups[this._activeMainGroup.getGroupName()][e],t.groupName=e,t.onRowChanged=this._onRowChanged,t.onItemClick=this._onItemClick,t.designData=this._designData,t.activeItemCallback=this._setActiveItemForRow,t.activeItem=this._activeItem,t.isMockupUpdate=this._par.isMockupUpdate,new PF.ProductPush.MockupPicker.Row(t)},_renderMockupGroups:function(){if(mkE.clearNode(this._groupsOuterNode),Object.keys(this._mainGroups).length<1||!this._activeMainGroup)return mkE.addClassName(this._mockupsContinueBtn,"disabled"),new PF.Components.Alert(lang("Something went wrong!"),"danger",2e3).append(this._mockupNode);this._activeItem=null;var e=Object.keys(this._mainGroups[this._activeMainGroup.getGroupName()]).shift(),t=this._mainGroups[this._activeMainGroup.getGroupName()][e];t&&t.length>0&&(this._designData.defaultGeneratorVariantId=t[0].generatorVariantId),this._rows=Object.keys(this._mainGroups[this._activeMainGroup.getGroupName()]).map(this._mapGroupItems.bind(this)),this._designData.optionGroup=this._activeMainGroup.getGroupName(),tag("div","",this._rows).append(this._groupsOuterNode)},_filterMainGroup:function(e){return!!this._par.generatorParams.getGeneratorVariant(this._variantFilter.getDefaultGroupVariantId(e))},_mapCheckedMainGroupItem:function(e){return e.isChecked()&&(this._activeMainGroup=e,this._designData.generatorVariantsIdsToSave=new PF.ProductPush.VariantFilter(this._designData,this._par.generatorParams).getGroupMockupVariantIds(e.getGroupName())),e},_setDefaultTemplateId:function(){this._designData.generatorVariantsIdsToSave.some(function(e){return e===this._designData.defaultGeneratorVariantId}.bind(this))||(this._designData.defaultGeneratorVariantId=this._designData.generatorVariantsIdsToSave[0])},_isDefaultMockup:function(e){var t=Object.keys(this._mainGroups);return(1===t.length||this._variantFilter.getGroupMockupVariantIds(e).some(function(e){return e===this._designData.defaultGeneratorVariantId}.bind(this))||t.length-1===t.indexOf(e,1))&&!this.mainGroupItemChecked},_mapMainGroupItems:function(e){var t=this._isDefaultMockup(e);this.mainGroupItemChecked=!!this.mainGroupItemChecked||t;var i=new PF.MockupGenerator.GeneratorPicker.Par;return i.itemTitle.text=e,i.itemTitle.isVisible=!0,i.isRadio=!0,i.isChecked=t,i.onNodeClickCallback=this._onMockupClick,i.mockupPreview=this._getGeneratorMockupPreview,i.generatorVariant=this._par.generatorParams.getGeneratorVariant(this._variantFilter.getDefaultGroupVariantId(e)),i.productId=this._designData.productId,new PF.MockupGenerator.GeneratorPicker.MainGroupItem(i)},_mapAdditionGroupItems:function(e){var t=this._additionalColorPicker.getSelectedColors()[0],i=null;this._additionalSizePicker.selectedSizes&&(i=this._additionalSizePicker.selectedSizes[0]);var r=new PF.MockupGenerator.GeneratorPicker.Par;return r.itemTitle.text=e,r.itemTitle.isVisible=!0,r.onNodeClickCallback=this._onAdditionalMockupClick,r.mockupPreview=this._getGeneratorMockupPreview,r.generatorVariant=this._par.generatorParams.getGeneratorVariant(this._variantFilter.getAdditionalGroupVariantId(e,t,i)),r.productId=this._designData.productId,new PF.MockupGenerator.GeneratorPicker.MainGroupItem(r)},_onAdditionalMockupClick:function(e){if(!$(this._nodeAdditionalMockupPicker).hasClass("isSliding")){e.setCheckedState(!e.isChecked());var t=e._par.generatorVariant.generatorVariantId;if(this._designData.additionalGeneratorVariantIds||(this._designData.additionalGeneratorVariantIds=[]),e.isChecked()){if(-1!==this._designData.additionalGeneratorVariantIds.indexOf(t))return;this._designData.additionalGeneratorVariantIds.push(t)}else{var i=this._designData.additionalGeneratorVariantIds.indexOf(t);if(-1===i)return;this._designData.additionalGeneratorVariantIds.splice(i,1)}}},_renderMainMockupGroups:function(){return mkE.clearNode(this._mockupNode),this._setDefaultTemplateId(),this._variantFilter=new PF.ProductPush.VariantFilter(this._designData,this._par.generatorParams),this._mainGroups=this._variantFilter.getGroupedMockupVariants(),this.mainGroupItemChecked=!1,this._mainGroupItems=Object.keys(this._mainGroups).filter(this._filterMainGroup.bind(this)).map(this._mapMainGroupItems.bind(this)).map(this._mapCheckedMainGroupItem.bind(this)),tag("div","pf-mb-8",[tag("span",{className:"pf-h3",text:dlang("generator","Mockup style")}),tag("h4",{className:"pf-ui-body pf-text-muted pf-pt-8 pf-my-0 hide-empty",innerHTML:this._par.generatorParams.getPhotificInfoText(this._designData.productId)})]).append(this._mockupNode),tag("div","container-fluid slick-slider-container",[this._nodeMockupPicker=tag("div","bubble-slider slick-dotted main-mockup-picker row pf-pt-16 slick-slider--loading",this._mainGroupItems)]).append(this._mockupNode),setTimeout(function(){this._initSlickr(this._nodeMockupPicker),$(this._nodeMockupPicker).hide(),mkE.removeClassName(this._nodeMockupPicker,"slick-slider--loading"),$(this._nodeMockupPicker).slideDown("slow")}.bind(this),50),$(window).on("resize",this._onResizeMainItems),this._renderMockupGroups(),this._mockupNode},_initSlickr:function(e){var t=$(e);t.hasClass(".slick-initialized")&&t.unslick(),t.not(".slick-initialized").on("init reInit breakpoint",(function(e,t){t.slideCount<=t.getOption("slidesToShow")&&t.unslick(),window.innerWidth<768&&PF.SlickHelper.limitSliderDots(this,0,1,6)})).on("beforeChange",(function(e,t,i,r){window.innerWidth<768&&PF.SlickHelper.limitSliderDots(this,i,r,6)})).slick({slidesToShow:5.3,slidesToScroll:5,lazyLoad:"ondemand",infinite:!0,arrows:!0,dots:!0,swipe:!0,responsive:[{breakpoint:335,settings:{slidesToShow:1.3,slidesToScroll:1}},{breakpoint:400,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:2.3,slidesToScroll:2}},{breakpoint:560,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:700,settings:{slidesToShow:3.3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:4.3,slidesToScroll:4}},{breakpoint:1200,settings:{slidesToShow:3.3,slidesToScroll:3}},{breakpoint:1600,settings:{slidesToShow:4.3,slidesToScroll:4}}]}),t.on("beforeChange",(function(){t.addClass("isSliding")})),t.on("afterChange",(function(){t.removeClass("isSliding")}))},_onResizeMainItems:function(){this._mainGroupItems.map((function(e){e._onResize()}))},_onResizeAdditionalItems:function(){this._additionalGroupItems.map((function(e){e._onResize()}))},_renderPrimaryMockup:function(){var e=this._par.generatorParams.getGeneratorVariant(this._designData.defaultGeneratorVariantId);return e&&(mkE.clearNode(this._mockupNode),this._getGeneratorMockupPreview(e,{maxWidth:195,maxHeight:195}).append(this._mockupNode),tag("div","margin-bottom-25 product-push__main-mockup-image-text",lang("Main mockup image")).append(this._mockupNode)),this._mockupNode},_getGeneratorMockupPreview:function(e,t){return this._designData.getMockupPreview(e,t.maxWidth,t.maxHeight)},_onRowChanged:function(){var e=[],t=!1;for(var i in this._rows){var r=this._rows[i].getVariantIds();e=e.concat(r),!r.length&&this._rows[i].containsDefaultVariant()&&(t=!0)}this._designData.generatorVariantsIdsToSave=e,e.length?(t&&(this._designData.defaultGeneratorVariantId=e[0],this._renderMockupGroups()),mkE.removeClassName(this._mockupsContinueBtn,"disabled")):mkE.addClassName(this._mockupsContinueBtn,"disabled")},_onMockupClick:function(e){$(this._nodeMockupPicker).hasClass("isSliding")||(this._activeMainGroup.setCheckedState(!1),e.setCheckedState(!0),this._activeMainGroup=e,this._designData.optionGroup=this._activeMainGroup.getGroupName(),this._designData.generatorVariantsIdsToSave=new PF.ProductPush.VariantFilter(this._designData,this._par.generatorParams).getGroupMockupVariantIds(e.getGroupName()),this._renderMockupGroups(),this._onRowChanged(),this._renderAdditionalMockupNode())},_onItemClick:function(e){this._activeItem&&this._activeItem.getGeneratorVariantId()!==e.getGeneratorVariantId()&&(this._activeItem.removeActive(),this._activeItem.groupItem!==e&&this._activeItem.groupItem&&this._activeItem.groupItem.setAsGroupActive(!1)),this._setActiveItemForRow(e),this._onRowChanged()},_setActiveItemForRow:function(e){this._activeItem=e,this._designData.defaultGeneratorVariantId=e.getGeneratorVariantId()},_getTransparencySelector:function(){return this._designData.store.type==PF.Items.StoreItem.TYPE_AMAZON||this._designData.store.type==PF.Items.StoreItem.TYPE_ETSY?mkE({tag:"div",els:[mkE({tag:"input",type:"hidden",name:"is-png",value:0})]}):tag("div","product-push__transperancy mockup-format-block pf-mt-32 pf-pt-32",[tag("label",null,[tag("span","pf-h3 pf-mt-32",lang("Mockup format")),tag("div","pf-pt-24",[tag("label","inline-radio",[tag("input",{type:"radio",name:"is-png",value:0,prop:{checked:!this._designData.isTransparent,onchange:function(){this._designData.isTransparent=!1}.bind(this)}}),tag("span",{innerHTML:dlang("generator","<b>JPG</b> (smaller, your store will load faster)")})]),tag("label","inline-radio",[tag("input",{type:"radio",name:"is-png",value:1,prop:{checked:this._designData.isTransparent,onchange:function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Click PNG mockup"}),this._designData.isTransparent=!0}.bind(this)}}),tag("span",{innerHTML:dlang("generator","<b>PNG</b> (bulkier, but with a transparent background)")})])])])])},_onDescriptionFormUpdate:function(){this._renderErrorMessages()},_renderErrorMessages:function(){if(this._continueBtn){mkE.clearNode(this.descriptionErrorNode);var e={},t=(this._productPricingWithoutPricing.validate(e),e.errors&&e.errors.length>0?e.errors:[]);(t=n.a.concat(t,this._productDetailInputs.validate())).length?(tag("div","pf-text-red pf-bold",[t.slice().pop()]).append(this.descriptionErrorNode),mkE.addClassName(this._continueBtn,"disabled")):mkE.removeClassName(this._continueBtn,"disabled")}},_onMockupPickerFormUpdate:function(){this._par.modalContentNodeUpdate&&this._par.modalContentNodeUpdate(this._mainNode),this._par.stickyButtonNodeUpdate(this._nodeFooter)},renderDescription:function(){mkE.clearNode(this._mainNode),this._productPricingWithoutPricing=new PF.ProductPush.Pricing(this._designData,(function(){return console.warn('Unexpected action "onPricesSet" triggered!')}),!1,{onBack:function(){return console.warn('Unexpected action "onBack" triggered!')},onValidate:this._renderErrorMessages,isPush:!0}),tag("div","row",[tag("div","col-md-3",[this._mockupNode=tag("div","text-center")]),tag("div","col-md-9",[this._getProductDetailInputs(),this._designData.store.type===PF.Items.StoreItem.TYPE_AMAZON&&new PF.ProductPush.MockupPicker.AmazonCategoryInfo(this._designData.productId),this._sizeGuideAvailable()&&this._getNodeWithSizeGuideSelector(),PF.ProductPush.MockupPicker.Tags.allowTagPush(this._designData.store.type)&&this._getNodeWithTagSelector(),this.genderCategories=tag("div"),this._productPricingWithoutPricing])]).append(this._mainNode),this._renderGenderCategories(),this._nodeFooter=tag("div","navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[this._backBtn=tag("a",{className:"pf-btn pf-btn-secondary pf-mr-12",onclick:this._par.onDescriptionBack},[dlang("products","Back")]),this._continueBtn=tag("a",{className:"pf-btn pf-btn-primary disabled",onclick:this._onContinue.bind(this)},lang("Proceed to pricing")),this.descriptionErrorNode=tag("span")])]),this._par.modalTitleNodeUpdate&&this._par.modalTitleNodeUpdate(this._hasProductDescription()?lang("Add description"):lang("Add title")),this._par.modalContentNodeUpdate&&this._par.modalContentNodeUpdate(this._mainNode),this._par.stickyButtonNodeUpdate(this._nodeFooter),this._designData.defaultGeneratorVariantId&&this._renderPrimaryMockup(this._designData.defaultGeneratorVariantId),this._onDescriptionFormUpdate()},_getProductDetailInputs:function(){var e=new PF.Components.ProductDetailInputs.Par;return e.title=this._designData.title,e.description=this._designData.description,e.onUpdate=this._onDescriptionFormUpdate.bind(this),e.store=this._designData.store,e.languages=this._designData.store.getStorefrontLanguages(),e.primaryLanguage=this._designData.store.getStorefrontPrimaryLanguage(),e.translations=PF.Utils.ProductDetailBuilder.build(this._designData.multiLanguageDetails,e.languages),e.productTranslations=this._designData.productTranslations,e.translationLanguage=this._designData.translationLanguage,this._productDetailInputs=new PF.Components.ProductDetailInputs(e),this._productDetailInputs.node},_onContinue:function(){if(!(this._productDetailInputs.validate().length>0)){if(!this._productPricingWithoutPricing.validate())return this._renderErrorMessages(),!1;if(!this._loadedFlags.GenderCategory)return!1;var e=this._productDetailInputs.getValues();if(this._designData.title=e.title,this._designData.description=e.description,this._designData.multiLanguageDetails=e.translations,e.translationLanguage&&(this._designData.translationLanguage=e.translationLanguage),PF.ProductPush.MockupPicker.Tags.allowTagPush(this._designData.store.type)&&(this._designData.tags=this._tagSelector.getTagValue()),this._genderCategorySelector&&(this._designData.genderCategory=this._genderCategorySelector.getSelectedValue()),this._sizeGuideAvailable&&this._sizeGuide&&this._sizeGuide.getSizeGuideEnabled()?(this._designData.withSizeGuide=this._sizeGuide.getSizeGuideEnabled(),this._designData.sizeGuideUnits=this._sizeGuide.getSizeGuideUnits()):(this._designData.withSizeGuide=!1,this._designData.sizeGuideUnits=[]),e.translationLanguage){var t=this._designData.productTranslations.getProductTranslationOptionNameByValue(e.translationLanguage);t&&ga("send","event","ProductPush","Product description language preference",t.name)}this._par.onDescriptionNext(this._designData)}},_getNodeWithSizeGuideSelector:function(){return this._sizeGuide=new PF.ProductPush.MockupPicker.SizeGuide(this._designData),this._sizeGuide},_getNodeWithTagSelector:function(){return this._tagSelector=new PF.ProductPush.MockupPicker.Tags(this._designData),this._tagSelector},_setGenderCategoriesNode:function(e){this._genderCategorySelector=new PF.ProductPush.MockupPicker.GenderCategory(e),this._genderCategorySelector.append(this.genderCategories)},_renderGenderCategories:function(){PF.ProductPush.MockupPicker.GenderCategory.allowGenderCategory(this._designData.store.type,this._designData.productId,function(e){e&&this._setGenderCategoriesNode(e),this._loadedFlags.GenderCategory=!0,this._onDescriptionFormUpdate()}.bind(this))},_sizeGuideAvailable:function(){return!!this._designData.product.sizeGuide&&this._designData.product.hasSizeGuide&&PF.ProductPush.MockupPicker.SizeGuide.allowSizeGuidePush(this._designData.store.type)},_getUpdateInIntegrationNode:function(){return[PF.Items.StoreItem.TYPE_SHOPIFY,PF.Items.StoreItem.TYPE_ETSY,PF.Items.StoreItem.TYPE_WOOCOMMERCE,PF.Items.StoreItem.TYPE_NATIVE,PF.Items.StoreItem.TYPE_API_LAUNCHCART,PF.Items.StoreItem.TYPE_API_3DCART,PF.Items.StoreItem.TYPE_WIX].indexOf(this._designData.store.type)>-1||!this._par.isMockupUpdate?"":mkE({tag:"div",className:"pf-mt-24 alert alert-warning",innerHTML:dlang("dashboard","For this ecommerce platform, the updated mockups <strong> have to be added on the storefront manually.</strong>")})},_canShowAdditionalMockups:function(){if(!this._par.generatorParams.isAdditionalMockupPushEnabled||!this._par.canShowAdditionalMockups)return!1;var e=this._par.designData.product;return e.isDtgShirt()||e.isLeggings()||e.isEmbroidery()||e.isSublimation()},_hasProductDescription:function(){return!(this._designData.store.isNative()||this._designData.store.isThirdPartyApiIntegration())}},mkE.Base)},CXOy:function(e,t,i){"use strict";i.d(t,"f",(function(){return h})),i.d(t,"e",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"a",(function(){return m})),i.d(t,"i",(function(){return P})),i.d(t,"h",(function(){return f})),i.d(t,"g",(function(){return y})),i.d(t,"c",(function(){return v})),i.d(t,"b",(function(){return b}));var r,n=i("MSZa"),a=i("mTkf"),o=i("wy2R"),s=i.n(o);function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,i){return t&&d(e.prototype,t),i&&d(e,i),e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.itemRepository=t.itemRepository||{},this.viewType=t.viewType||P.LIST,this.filter=t.filter?new g(t.filter):null,this.currentItemsResponseMetadata=t.currentItemsResponseMetadata?new p(t.currentItemsResponseMetadata):null,this.selectedItemIds=t.selectedItemIds||[],this.flags=t.flags||{}};h.FLAG_KEYS=Object.freeze({IS_LOADING:"IS_LOADING",SHOW_DELETE_MODAL:"SHOW_DELETE_MODAL",JUST_CREATED_FIRST_TEMPLATE:"JUST_CREATED_FIRST_TEMPLATE",HAS_NOT_CREATED_ANY_TEMPLATES:"HAS_NOT_CREATED_ANY_TEMPLATES",HAS_NO_PUSH_STORES:"HAS_NO_PUSH_STORES",HAS_NOT_CLOSED_INTRO:"HAS_NOT_CLOSED_INTRO"});var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.itemIds=t.itemIds||[],this.page=parseInt(t.page||0),this.itemsPerPage=parseInt(t.itemsPerPage||0),this.totalPages=parseInt(t.totalPages||0),this.totalItems=parseInt(t.totalItems||0),this.filter=t.filter?new g(t.filter):null}return c(e,[{key:"isLastPage",get:function(){return this.page===this.totalPages}}]),e}(),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.search=t.search||null,this.sortBy=t.sortBy||v.CREATED_DATE,this.sortDir=t.sortDir||b.DESC,this.page=parseInt(t.page||1)}return c(e,[{key:"isDifferentThan",value:function(t){return!(t&&t instanceof e)||Object.keys(this).some(function(e){return this[e]!=t[e]}.bind(this))}},{key:"toQueryParams",value:function(){var e={};return this.search&&this.search.length&&(e.search=this.search),this.sortBy&&this.sortBy.length&&(e.sortBy=this.sortBy),this.sortDir&&this.sortDir.length&&(e.sortDir=this.sortDir),this.page&&(e.page=this.page),e}}]),e}(),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.id=t.id||null,this.title=t.title||null,this.templateStatus=t.templateStatus||null,this.productStatus=t.productStatus||null,this.productData=t.productData?t.productData instanceof PF.Items.ProductItem?PF.Items.ProductItem.duplicateFrom(t.productData):PF.Items.ProductItem.fromArray(t.productData):null,this.mainImage=t.mainImage?new n.a(t.mainImage):null,this.design=t.design?t.design instanceof PF.Items.GeneratorDesign?PF.Items.GeneratorDesign.duplicateFrom(t.design):PF.Items.GeneratorDesign.fromArray(t.design):null,this.colors=t.colors||{},this.sizes=t.sizes||null,this.technique=t.technique||null,this.placementNames=t.placementNames||{},this.placementSVGs=t.placementSVGs||{},this.createdAt=t.createdAt?t.createdAt instanceof s.a?s.a.utc(t.createdAt.toISOString()):s.a.utc(t.createdAt):null,this.updatedAt=t.updatedAt?t.updatedAt instanceof s.a?s.a.utc(t.updatedAt.toISOString()):s.a.utc(t.updatedAt):null,this.storeData=t.storeData?_.cloneDeep(t.storeData):null}return c(e,[{key:"getPlacementSVG",value:function(e){var t=this;return new Promise((function(i,r){t.design&&e?t.placementSVGs&&t.placementSVGs[e]?i(t.placementSVGs[e]):Object(a.e)(t.design,e).then((function(r){t.placementSVGs||(t.placementSVGs={}),t.placementSVGs[e]=r,i(r)})).catch((function(e){return r(e)})):r(new Error("Design or placement type missing!"))}))}},{key:"shouldShowTechnique",get:function(){var e;return!!(null===(e=this.productData)||void 0===e?void 0:e.hasMultipleTechniques())&&this.technique}},{key:"isDraft",get:function(){return this.templateStatus===e.TEMPLATE_STATUSES.DRAFT}},{key:"isActive",get:function(){return this.templateStatus===e.TEMPLATE_STATUSES.ACTIVE}},{key:"displaySizes",get:function(){return(this.sizes||[]).filter((function(e){return!!e}))}},{key:"displayColors",get:function(){return _.pickBy(this.colors||{},(function(e){return!!e}))}},{key:"techniqueDisplayName",get:function(){return this.technique?PF.Items.ProductItem.LABELS[this.technique]||this.technique:""}}]),e}();m.TEMPLATE_STATUSES=Object.freeze({DRAFT:"draft",ACTIVE:"active",REMOVED:"removed"}),m.PRODUCT_STATUSES=Object.freeze({ACTIVE:"active",INACTIVE:"inactive",DISABLED_IN_PUSH:"disabled_in_push",BROKEN:"broken"});var P=Object.freeze({GRID:"GRID",LIST:"LIST"}),f=Object.freeze({CREATED_DATE_DESC:"CREATED_DATE_DESC",CREATED_DATE_ASC:"CREATED_DATE_ASC",UPDATED_DATE_DESC:"UPDATED_DATE_DESC",UPDATED_DATE_ASC:"UPDATED_DATE_ASC",TITLE_ASC:"TITLE_ASC",TITLE_DESC:"TITLE_DESC"}),y=Object.freeze((l(r={},f.CREATED_DATE_DESC,dclang("dashboard","sort type","Created: newest first")),l(r,f.CREATED_DATE_ASC,dclang("dashboard","sort type","Created: oldest first")),l(r,f.UPDATED_DATE_DESC,dclang("dashboard","sort type","Updated: newest first")),l(r,f.UPDATED_DATE_ASC,dclang("dashboard","sort type","Updated: oldest first")),l(r,f.TITLE_ASC,dclang("dashboard","sort type","Title: A to Z")),l(r,f.TITLE_DESC,dclang("dashboard","sort type","Title: Z to A")),r)),v=Object.freeze({CREATED_DATE:"created",UPDATED_DATE:"updated",TITLE:"title"}),b=Object.freeze({ASC:"asc",DESC:"desc"})},Cc5H:function(e,t,i){"use strict";i.d(t,"s",(function(){return n})),i.d(t,"n",(function(){return a})),i.d(t,"r",(function(){return o})),i.d(t,"t",(function(){return s})),i.d(t,"c",(function(){return l})),i.d(t,"o",(function(){return d})),i.d(t,"w",(function(){return c})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return h})),i.d(t,"u",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"h",(function(){return m})),i.d(t,"m",(function(){return _})),i.d(t,"i",(function(){return P})),i.d(t,"j",(function(){return f})),i.d(t,"v",(function(){return y})),i.d(t,"q",(function(){return v})),i.d(t,"p",(function(){return b})),i.d(t,"g",(function(){return C})),i.d(t,"f",(function(){return T})),i.d(t,"e",(function(){return I})),i.d(t,"l",(function(){return k})),i.d(t,"k",(function(){return E}));var r="productTemplates/index/",n="m_setFlag",a="m_loadItemsIntoRepo",o="m_removeItemsFromRepo",s="m_setItemsResponseMetadata",l="m_changeViewType",d="m_loadSavedItem",c="m_updateItemFiles",u="m_changeItemCheckedState",h="m_changePageCheckedState",p="m_toggleDeleteModal",g="m_cleanupDeletedItemData",m="g_getFlag",_="g_getPageItems",P="g_getItem",f="g_getItemCheckedState",y="a_updateFilterAndLoad",v="a_loadUsingFilter",b="a_loadSingleItem",C="a_duplicateItem",T="a_deleteItems",I="a_closeIntro";function k(e){return e.productTemplates.index}function E(e){return r+e}},Do4x:function(e,t,i){"use strict";i.d(t,"f",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"g",(function(){return u})),i.d(t,"c",(function(){return h})),i.d(t,"e",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"b",(function(){return m}));var r=i("LvDl"),n=i.n(r);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}var l=Object.freeze({EDIT_PRICES:"EDIT_PRICES",IGNORE_PRODUCTS:"IGNORE_PRODUCTS",UNIGNORE_PRODUCTS:"UNIGNORE_PRODUCTS",DELETE_PRODUCTS:"DELETE_PRODUCTS"}),d=Object.freeze({SOME_OUT_OF_STOCK:"SOME_OUT_OF_STOCK"}),c=Object.freeze({EDIT_PRODUCT:"edit_product_popover"}),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.currentDataResponse=t.currentDataResponse?new m(t.currentDataResponse):null,this.productGroups=t.productGroups&&t.productGroups.length?t.productGroups.map((function(e){return new g(e)})):[],this.allowedHeaderActions=t.allowedHeaderActions?t.allowedHeaderActions.filter((function(e){return l.hasOwnProperty(e)})):[],this.selectedItemModels=t.selectedItemModels?n.a.mapValues(t.selectedItemModels,(function(e){return new p(e)})):{},this.currentMessageTypes=t.currentMessageTypes||[],this.filter=t.filter?new h(t.filter):null,this.store=t.store||null,this.requiredPopoverIDs=t.requiredPopoverIDs||[],this.isLoadingResults=t.isLoadingResults||!1,this.isPollingUnfinishedUpdates=t.isPollingUnfinishedUpdates||!1,this.regularlyPollUnfinisheds=t.regularlyPollUnfinisheds||!1,this.latestNewlyPushedSyncProductID=t.latestNewlyPushedSyncProductID||null,this.flags=t.flags||{}}return s(e,[{key:"hasFilterRealChanges",value:function(e){if(!this.filter)return!0;var t=new h(n.a.merge({},this.filter,e));return this.filter.isDifferentThan(t)}}]),e}();u.SELECTED_FLAG_KEYS=Object.freeze({SOME_IGNORED_SELECTED:"SOME_IGNORED_SELECTED",SOME_UNIGNORED_SELECTED:"SOME_UNIGNORED_SELECTED",SOME_SYNCED_SELECTED:"SOME_SYNCED_SELECTED",SOME_CAN_BE_USED_TO_CREATE_PRODUCT_TEMPLATES:"SOME_CAN_BE_USED_TO_CREATE_PRODUCT_TEMPLATES"}),u.FLAG_KEYS=Object.freeze({CAN_IGNORE_ALL:"CAN_IGNORE_ALL",POLL_LIMIT_TIMESTAMP:"POLL_LIMIT_TIMESTAMP",QUEUED_ITEM_KEYS_FOR_PRODUCT_TEMPLATE_CREATE:"QUEUED_ITEM_KEYS_FOR_PRODUCT_TEMPLATE_CREATE",SKIP_PRODUCT_TEMPLATES_DISCLAIMER:"SKIP_PRODUCT_TEMPLATES_DISCLAIMER"});var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.productTitle=t.productTitle||null,this.currentGroupType=t.currentGroupType||PF.Items.SyncCountsItem.TYPE_ALL,this.currentPage=t.currentPage?parseInt(t.currentPage):1}return s(e,[{key:"isDifferentThan",value:function(t){return!(t&&t instanceof e)||Object.keys(this).some(function(e){return this[e]!=t[e]}.bind(this))}}]),e}(),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.id=t.id||null,this.key=t.key||null,this.itemType=t.itemType||null,this.status=t.status||null,this.statusCode=t.statusCode||null,this.title=t.title||null,this.subtitle=t.subtitle||null,this.thumbnailURL=t.thumbnailURL||null,this.productModel=t.productModel?PF.Items.SyncProductItem.fromArray(t.productModel):null,this.externalViewURL=t.externalViewURL||null,this.externalEditURL=t.externalEditURL||null,this.newlyPushedProductTaskID=t.newlyPushedProductTaskID?parseInt(t.newlyPushedProductTaskID):null,this.flags=t.flags||{},this.pusherKey=t.pusherKey||null}return s(e,[{key:"getFlagData",value:function(e){return this.flags&&this.flags.hasOwnProperty(e)&&this.flags[e]||null}},{key:"hasFlag",value:function(e){return!!this.getFlagData(e)}},{key:"isNewlyPushedProduct",get:function(){return!!this.newlyPushedProductTaskID}},{key:"isRealProduct",get:function(){return this.itemType===e.AVAILABLE_TYPES.PRODUCT}},{key:"isPushTask",get:function(){return this.itemType===e.AVAILABLE_TYPES.GENERATOR_TASK}},{key:"isIgnored",get:function(){return!(!this.isRealProduct||!this.productModel)&&this.productModel.isIgnored}}]),e}();p.AVAILABLE_STATUSES=Object.freeze({VALID:"VALID",INVALID:"INVALID"}),p.AVAILABLE_TYPES=Object.freeze({PRODUCT:"PRODUCT",GENERATOR_TASK:"GENERATOR_TASK"}),p.AVAILABLE_FLAGS=Object.freeze({DUPLICABLE_PRODUCT:"DUPLICABLE_PRODUCT",CAN_CREATE_PRODUCT_TEMPLATE_FROM_ITEM:"CAN_CREATE_PRODUCT_TEMPLATE_FROM_ITEM"}),p.AVAILABLE_STATUS_CODES=Object.freeze({GENERATING_PRINT_FILES:"GENERATING_PRINT_FILES",WAITING_TO_BE_PUSHED:"WAITING_TO_BE_PUSHED",WAITING_TO_BE_PROCESSED:"WAITING_TO_BE_PROCESSED",PUSHING_PRODUCT:"PUSHING_PRODUCT",GENERATING_MOCKUPS:"GENERATING_MOCKUPS"});var g=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.type=t.type||null,this.displayName=t.displayName||null,this.count=t.count||null},m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.page=t.page?parseInt(t.page):0,this.pages=t.pages?parseInt(t.pages):0,this.total=t.total?parseInt(t.total):0,this.maxPageSize=t.maxPageSize?parseInt(t.maxPageSize):0,this.items=t.items?n.a.mapValues(t.items,(function(e){return new p(e)})):{},this.filter=t.filter?new h(t.filter):null,this.isSetAutoStoreReturns=t.isSetAutoStoreReturns||!1,this.flags=t.flags||{}}return s(e,[{key:"hasFlag",value:function(e){return this.flags&&this.flags.hasOwnProperty(e)&&this.flags[e]}}]),e}();m.FLAG_KEYS=Object.freeze({CAN_IGNORE_ALL:"CAN_IGNORE_ALL"})},DyGm:function(e,t){!function(){"use strict";PF.ProductPush.AddBlock.StatusRow=function(e,t,i){this.store=e,this.status=t,this.retryCallback=i;var r=this.status;this.node=mkE({tag:"div",className:"row "+(r.isFinal&&r.hasErrors?"error":r.isFinal&&!r.hasErrors?"success":""),els:[{tag:"div",className:"col "+(this.status.isFinal?"col-xs-11":"col-xs-12"),els:[{tag:"table",className:"table",els:[{tag:"tr",els:[this.getProductImageCell(),{tag:"td",className:"title",els:[this.getStatusText(),this.getRetryButton(),this.getViewButton(),this.getEditButton()]}]},this.getExtraText()]}]},this.getRemoveButton()]})},PF.ProductPush.AddBlock.StatusRow.prototype=new mkE.Base,PF.ProductPush.AddBlock.StatusRow.prototype.getRemoveButton=function(){return this.status.isFinal?{tag:"div",className:"col-bt col-xs-1 text-right",els:[{tag:"a",className:"close-bt",els:[{tag:"span",className:"icon-close"}],onclick:$.proxy((function(e){this.remove(),(new PF.Repositories.GeneratorRepository).hidePushTask(e),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Hide task status item"})}),this,this.status.taskId)}]}:""},PF.ProductPush.AddBlock.StatusRow.prototype.getEditButton=function(){return this.status.isFinal&&!this.status.hasErrors&&this.status.externalEditUrl?{tag:"a",className:"extra-links",attr:{target:"_blank"},els:[{tag:"span",className:"icon-edit"},dclang("dashboard","Edit in integration storefront","Edit in {0}").replace("{0}",this.store.integrationName)],href:this.status.externalEditUrl,onclick:$.proxy((function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Edit externally",eventLabel:this.store.integrationName})}),this)}:""},PF.ProductPush.AddBlock.StatusRow.prototype.getRetryButton=function(){return this.status.isFinal&&this.status.hasErrors&&this.store?-1===[PF.Items.StoreItem.TYPE_EBAY,PF.Items.StoreItem.TYPE_WOOCOMMERCE].indexOf(this.store.type)?"":{tag:"a",className:"extra-links",els:[{tag:"span",className:"icon-refresh"}," "+dclang("dashboard","Retry product push","Retry")],href:this.status.externalViewUrl,onclick:function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Retry",eventLabel:this.store.integrationName}),this.retryCallback(this.status.taskId)}.bind(this)}:""},PF.ProductPush.AddBlock.StatusRow.prototype.getViewButton=function(){if(!this.status.isFinal||this.status.hasErrors||!this.status.externalViewUrl)return"";var e=" View in "+this.store.integrationName;return this.store.type==PF.Items.StoreItem.TYPE_ECWID&&(e=" View in storefront"),{tag:"a",className:"extra-links",attr:{target:"_blank"},els:[{tag:"span",className:"icon-cart"},e],href:this.status.externalViewUrl,onclick:$.proxy((function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"View in storefront",eventLabel:this.store.integrationName})}),this)}},PF.ProductPush.AddBlock.StatusRow.prototype.getExtraText=function(){var e=[];return this.status.isFinal?(this.status.hasErrors||this.status.showText)&&this.status.text&&""!=this.status.text&&e.push({tag:"span",innerHTML:this.status.text}):e.push(this.getProgress()),e.length?{tag:"tr",els:[{tag:"td",className:"extra",els:e}]}:[]},PF.ProductPush.AddBlock.StatusRow.prototype.getProgress=function(){return{tag:"div",className:"progress progress-success progress-striped active",els:[{tag:"div",className:"progress-bar"}]}},PF.ProductPush.AddBlock.StatusRow.prototype.getStatusText=function(){var e=this.status.productTitle;return this.status.isFinal&&(this.status.hasErrors?e+=" adding failed":e+=" added"),{tag:"span",text:e}},PF.ProductPush.AddBlock.StatusRow.prototype.getProductImageCell=function(){var e=mkE({tag:"td",className:"image text-center",attr:{rowspan:2},els:[{tag:"img",src:this.status.productImageUrl}]});if(this.status.mockupImageUrl){var t=new Image;t.onload=$.proxy((function(){mkE.clearNode(e),mkE({tag:"a",href:this.status.mockupImageUrl,attr:{target:"_blank"},els:[{tag:"img",src:this.status.mockupImageUrl}]}).append(e)}),this),t.src=this.status.mockupImageUrl}return e},PF.Items.GeneratorTaskStatusItem=function(){},PF.Items.GeneratorTaskStatusItem.prototype=new PF.Items.Item,PF.Items.GeneratorTaskStatusItem.prototype.taskId=null,PF.Items.GeneratorTaskStatusItem.prototype.text=null,PF.Items.GeneratorTaskStatusItem.prototype.hasErrors=null,PF.Items.GeneratorTaskStatusItem.prototype.isFinal=null,PF.Items.GeneratorTaskStatusItem.prototype.showText=null,PF.Items.GeneratorTaskStatusItem.prototype.productImageUrl=null,PF.Items.GeneratorTaskStatusItem.prototype.mockupImageUrl=null,PF.Items.GeneratorTaskStatusItem.prototype.externalEditUrl=null,PF.Items.GeneratorTaskStatusItem.prototype.externalViewUrl=null,PF.Items.GeneratorTaskStatusItem.prototype.productTitle=null,PF.Items.GeneratorTaskStatusItem.prototype.subtitle=null,PF.Items.GeneratorTaskStatusItem.prototype.syncProductId=null,PF.Items.GeneratorTaskStatusItem.prototype.updated=null,PF.Items.GeneratorTaskStatusItem.fromArray=function(e){var t=new PF.Items.GeneratorTaskStatusItem;return mkE.O2O(t,e),t}}()},F8X5:function(e,t){!function(){"use strict";PF.ProductPush.Live3dView.Par=Class({mockup:null,loadingNode:null,productId:null,getSelectedVariant:null,width:null,height:null,getLoaded3dObj:null,on3dObjectLoaded:null,showWarningAlert:null,onWarningAlertClose:null})}()},FU2h:function(e,t){!function(){"use strict";PF.ProductPush.TextPicker=Class({_par:null,_state:{defaultFont:function(){return PF.Lang.isJp()?PF.TEXT2SVG.FONTS["noto-sans-jp"]:PF.TEXT2SVG.FONTS["open-sans-b"]},isExistingLayer:!1,textLayer:null,isFocused:!1,nodeTextStyle:null,changeTimeout:null,_forceDisableCustomizer:!1,canAddNewLayers:!0,isCharLimitEnabled:!1},_canCustomizeCheckbox:null,_validator:null,_techniqueMemory:null,nodeError:null,__construct:function(e){this._par=e,this._subscribeToTemplateEvents(),this._state.textLayer=this._getNewLayer(),this._validator=new PF.Components.GeneratorMockup.Validator(e.product),this._validator.isCharLimitEnabled=this._state.isCharLimitEnabled,this._validator.setActiveLayer(this._state.textLayer),this._techniqueMemory=new PF.Utils.TechniqueMemory(this._par.product.productId),this.node=tag("div","text-picker"),this._colorDropdownPar=new PF.Components.ColorDropdown.Par,this._colorDropdownPar.color=this._state.textLayer.getDefaultColor(this._par.product),this._colorDropdownPar.colors=this._getColors(),this._colorDropdownPar.hideRGB=this._isPlacementEmbroidery(),this._colorDropdownPar.onChange=this._onColorChanged,this._fontDropdownPar=new PF.Components.FontDropdown.Par,this._fontDropdownPar.font=this._state.textLayer?this._state.textLayer.font:this._state.defaultFont(),this._fontDropdownPar.fonts=PF.Components.FontDropdown.defaultFonts(this._par.technique),this._fontDropdownPar.onChange=this._onFontChanged,this._loadRequiredFont(this._state.textLayer.font,this._render)},_render:function(){mkE.clearNode(this.node),this._renderTextPicker(),this._state.textLayer.isCustomizable&&this._setCustomizableSliderValue(this._state.textLayer,!1),this.nodeError=tag("div","alert alert-danger text-center hidden pf-p-12 pf-mt-16",lang("Please add text!")).append(this.node)},_renderTextPicker:function(){this._state._forceDisableCustomizer=this._getSelectedPlacementId()===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE;var e=this._state.textLayer;if(this._colorDropdownPar.color=e.color,this._colorDropdownPar.colors=this._getColors(),this._colorDropdownPar.nodeDropdownFooter&&mkE.clearNode(this._colorDropdownPar.nodeDropdownFooter),this._par.getSelectedEmbroideryColors&&(this._par.getSelectedEmbroideryColors().length>PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS?(this._colorDropdownPar.nodeDropdownFooter=tag("div","color-mapper__footer--warning",[dlang("generator","You can choose up to {number} colors").replace("{number}",this._par.threadColorSelectionLimit)]),this._colorDropdownPar.highlightColorsAsError=!0):this._colorDropdownPar.highlightColorsAsError=!1,this._colorDropdownPar.highlightedColors=this._par.getSelectedEmbroideryColors()),this._colorDropdown=new PF.Components.ColorDropdown(this._colorDropdownPar),this._fontDropdownPar.font=e.font,this._fontDropdown=new PF.Components.FontDropdown(this._fontDropdownPar),this._engravingStylePicker=new PF.Components.EngravingStylePicker(e.engravingStyle,this._onEngravingStyleChanged),PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()&&this._isPlacementEmbroidery()){var t=PF.ProductPush.EmbroideryTypePicker.Par;t.embroideryTypesAvailable=[PF.Items.OrderLineItemFile.DIGITIZATION_FLAT,PF.Items.OrderLineItemFile.DIGITIZATION_3D],t.embroideryType=e.embroideryType,t.labelTooltipText=lang("We digitize each file to a format that supports embroidery and charge a one-time fee of $6.50 for each embroidery type. You can reuse a digitized file for the same embroidery type with other orders at no additional cost."),t.embroideryTypePrices=this._par.embroideryTypePrices,this._embroideryTypePicker=new PF.ProductPush.EmbroideryTypePicker(t)}else this._embroideryTypePicker=null;var i=!this._state.canAddNewLayers&&!this._state.isExistingLayer,r=this._state.textLayer.isCustomizable&&this._allowCustomizableLayers();this._textarea=tag("textarea",{attr:{placeholder:dlang("dashboard","Start typing here")},value:e.text,prop:{onkeyup:this._onTextChanged,onkeydown:this._onTextKeyDown,disabled:i},className:i?"disabled":"",style:{width:"100%",height:"90px",maxWidth:"100%",minWidth:"100%",minHeight:"90px"}}),this._nodeTemplateInfo=new PF.ProductPush.GuidelineInfo(this._par.product),e.text.length&&!this._par.isAdvancedTemplate()&&this._nodeTemplateInfo.renderGuidelineInfo(),tag("div","",[this._par.onBackCallback?tag("a",{className:"pf-link-block pf-mb-8",onclick:this._par.onBackCallback},[tag("i","pf-i pf-i-chevron-left pf-i-24 pf-text-muted"),tag("span","pf-pl-4",lang("Back to design tools"))]):"",this._nodeTemplateInfo.node,this._embroideryTypePicker?tag("hr"):"",this._embroideryTypePicker?this._embroideryTypePicker:"",this._embroideryTypePicker?tag("hr"):"",tag("div","pf-my-8",[tag("div","pf-d-inline",[r?new PF.ProductPush.CustomizableLabel:""]),this._nodeTextareaTitle=tag("h6","pf-d-inline")]),this._textarea]).append(this.node),this._updateTextareaTitle(),PF.Utils.textareaAutoHeight(this._textarea),this._state.isFocused&&(this._textarea.focus(),this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)),this._state.nodeTextStyle=tag("div",this._state.isExistingLayer?"":"pf-d-none").append(this.node),this._nodeTextAlign=tag("div","pf-mb-24 "+(this._includesNewLines(this._state.textLayer.text)?"":"hidden"),[tag("h6",null,[dlang("generator","Align text")]),this._nodeTextAlignButtons=tag("div",null,[tag("button",{className:"text-picker__align-btn text-picker__glyphicon text-picker__glyphicon--squared glyphicon glyphicon-align-left btn btn-empty pf-mr-16 pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT}}),tag("button",{className:"text-picker__align-btn text-picker__glyphicon text-picker__glyphicon--squared glyphicon glyphicon-align-center btn btn-empty pf-mr-16 pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER}}),tag("button",{className:"text-picker__align-btn text-picker__glyphicon text-picker__glyphicon--squared glyphicon glyphicon-align-right btn btn-empty pf-px-8",onclick:this._onTextAligned.bind(this,PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT),data:{alignment:PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT}})])]).append(this._state.nodeTextStyle),this._updateTextAlignButtonStates(),tag("div","pf-mb-24",[tag("h6","",dlang("generator","Choose typeface")),this._fontDropdown]).append(this._state.nodeTextStyle),this._par.product.isJewelry()?tag("div","pf-mb-16",[tag("h6","",dlang("generator","Choose engraving style")),this._engravingStylePicker]).append(this._state.nodeTextStyle):tag("div","pf-mb-16",[tag("h6","",this._isPlacementEmbroidery()?dlang("generator","Choose thread color"):dlang("generator","Choose text color")),this._colorDropdown]).append(this._state.nodeTextStyle),tag("div","row",[this._getTextSizeInput(),this._getLetterSpacingInput()]).append(this._state.nodeTextStyle),tag("div","row pf-mb-16",[this._nodeLineHeight=this._getLineHeightInput(),this._rotationInput=this._getRotationInput()]).append(this._state.nodeTextStyle),this.renderCustomizableCheckbox()},_getTextSizeInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Text size"),e.value=this._state.textLayer.size,e.defaultValue=.2,e.minValue=.2,e.incrementStep=.1,this._par.product.isJewelry()&&(e.defaultValue=.12,e.minValue=.12,e.incrementStep=.01),e.onValueChanged=this._onFontSizeChanged,new PF.Forms.Number(e)},_getLetterSpacingInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Letter spacing"),e.value=this._state.textLayer.letterSpacing,e.defaultValue=-1,e.minValue=-1,(this._techniqueMemory.isEmbroidery(this._par.product.type)||this._par.product.isJewelry())&&(e.defaultValue=0,e.minValue=0,e.maxValue=1),e.incrementStep=.1,e.onValueChanged=this._onLetterSpacingChanged,new PF.Forms.Number(e)},_getLineHeightInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Line height"),e.value=this._state.textLayer.lineHeight,e.isVisible=this._includesNewLines(this._state.textLayer.text),e.defaultValue=.2,e.minValue=.2,(this._techniqueMemory.isEmbroidery(this._par.product.type)||this._par.product.isJewelry())&&(e.defaultValue=1,e.minValue=1),e.incrementStep=.1,e.onValueChanged=this._onLineHeightChanged,new PF.Forms.Number(e)},_getRotationInput:function(){var e=new PF.Forms.Number.Par;return e.title=dlang("dashboard","Rotate"),e.value=this._state.textLayer.position.rotation,e.minValue=-359,e.maxValue=359,this._par.product.isJewelry()&&(e.isVisible=!1),e.onValueChanged=this._onRotationChanged,new PF.Forms.Number(e)},_updateTextareaTitle:function(){this._state.textLayer!==this._validator._activeLayer&&this._validator.setActiveLayer(this._state.textLayer);var e=this._validator.getCharLimit()-this._textarea.value.length,t="text-picker__title-limit";e||(t+=" "+t+"--reached"),mkE.clearNode(this._nodeTextareaTitle);var i="";this._isPlacementEmbroidery()&&(i=tag("span",{className:"glyphicon glyphicon-info-sign",style:{verticalAlign:0,marginLeft:"4px"},attr:{title:dlang("dashboard",dlang("generator","Only for flat embroidery"))}})),tag("span",null,[dlang("generator","Write your text"),i,this._state.isCharLimitEnabled?tag("span",t,nlang("(%d character left)","(%d characters left)",e)):""]).append(this._nodeTextareaTitle),i&&$(i).tooltip({container:"body"})},_updateRotationInput:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t instanceof PF.Forms.Number||this._rotationInput.setValue(e.position.rotation)},_onLayerRemovedExternally:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t.uniqueId===this._state.textLayer.uniqueId&&this.resetText()},resetText:function(){this._state.textLayer=this._getNewLayer(),this._state.isExistingLayer=!1,this._state.isFocused=!0,this._render()},editTextLayer:function(e){this._unsubscribeTemplateEventsIfNeeded()||e&&e.isTextLayer()&&(this._state.textLayer=e.getOriginalClone(),this._state.isExistingLayer=!0,this._state.isFocused=!0,this._render(),this._setCustomizableSliderValue(e,!1))},_onLayerPositionsChangedExternally:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()&&(this._setCustomizableSliderValue(t,!0),!i instanceof PF.Forms.Number&&this._rotationInput.setValue(t.position.rotation),i!==this))for(var r in e){var n=e[r],a=n.getLayerIndex(this._state.textLayer);if(a>-1){var o=n.layers[a].getOriginalClone(),s=!o.isConfigurationSame(this._state.textLayer);return this._state.textLayer=o,i instanceof PF.Components.Slider&&(this._state.isFocused=!1),void(s&&this._render())}}},_getNewLayer:function(e){var t=new PF.Components.GeneratorMockup.TextLayer;t.font=this._state.defaultFont();var i=this._getSelectedPlacementId();return t.size=PF.ProductPush.TextboxPicker.getDefaultFontSize(this._par.product,i),t.color=t.getDefaultColor(this._par.product),t.alignment=PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER,t.originalPosition=new PF.Items.GeneratorPositionItem,t.position=t.originalPosition.getClone(),PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()&&this._isPlacementEmbroidery()&&(t.embroideryType=PF.ProductPush.EmbroideryTypePicker.getDefaultEmbroideryType()),e&&this._state.textLayer&&(t.font=this._state.textLayer.font,t.color=this._state.textLayer.color,t.alignment=this._state.textLayer.alignment,t.size=this._state.textLayer.size),t},_onColorChanged:function(e){this._state.textLayer.color=e,this._onConfigurationChanged(!0),this._par.templates.getChangeListener().notifyLayerColorsChanged(this._getSelectedPlacementId(),this._state.textLayer,!1)},_onEngravingStyleChanged:function(e){this._state.textLayer.engravingStyle=e,this._onConfigurationChanged(!0)},_createNewTextInput:function(){this._state.textLayer=this._getNewLayer(!0),this._state.isExistingLayer=!1,this._render()},_deleteLayer:function(){this._par.onLayerRemoved&&this._par.onLayerRemoved(this._state.textLayer),this._createNewTextInput()},_onTextAligned:function(e){this._state.textLayer.alignment=e,this._onConfigurationChanged(!0),this._updateTextAlignButtonStates()},_onTextKeyDown:function(e){e.stopPropagation()},_onTextChanged:function(e){e.stopPropagation();var t=e.target.value.trim();if(this._state.isFocused=!0,t!==this._state.textLayer.text){if(""===t)return this._nodeTemplateInfo.clearGuidelineInfo(),this._deleteLayer(),void(PF.Utils.isTouch()&&clearTimeout(this._state.changeTimeout));if(this._validator.setText(t),!this._validator.isTextValid())return this._onTextChangedAfter(this._validator.getValidText()),void this._render();this._updateTextareaTitle(),this._par.isAdvancedTemplate()||this._nodeTemplateInfo.renderGuidelineInfo(),PF.Utils.isTouch()?(clearTimeout(this._state.changeTimeout),this._state.changeTimeout=setTimeout(function(){this._loadRequiredFont(this._state.textLayer.font,this._onTextChangedAfter.bind(this,t))}.bind(this),200)):this._loadRequiredFont(this._state.textLayer.font,this._onTextChangedAfter.bind(this,t)),this.hideError()}},_onTextChangedAfter:function(e){this._includesNewLines(e)?(mkE.removeClassName(this._nodeTextAlign,"hidden"),this._nodeLineHeight.show()):(mkE.addClassName(this._nodeTextAlign,"hidden"),this._nodeLineHeight.hide()),this._state.textLayer.text=e,this._state.textLayer.hasMultipleLines=this._includesNewLines(e),this._state.textLayer.resizeToPercent=null,this._onConfigurationChanged(!0)},_onConfigurationChanged:function(e){e||this._render(),mkE.removeClassName(this._state.nodeTextStyle,"hidden"),this._validator.setActiveLayer(this._state.textLayer),this._state.isExistingLayer?this._par.onLayerConfigurationChanged(this._state.textLayer):(this._state.isExistingLayer=!0,this._par.onLayerCreated&&this._par.onLayerCreated(this._state.textLayer))},_onFontSizeChanged:function(e){this._state.textLayer.size=e,this._onConfigurationChanged(!0)},_onFontChanged:function(e){this._loadRequiredFont(e,function(){this._state.textLayer.font=e,this._updateTextareaTitle(),this._onConfigurationChanged(!0)}.bind(this,e))},enabled:function(e){return this._state.canAddNewLayers=e,this},render:function(){return this._render(),this},renderCustomizableCheckbox:function(){if(!this._allowCustomizableLayers())return!1;this._canCustomizeCheckbox&&mkE.removeNode(this._canCustomizeCheckbox.node);var e=new PF.ProductPush.CanCustomizeCheckbox.Par;e.isChecked=this._state.textLayer.isCustomizable,e.onChange=this._changeIsCustomizable,e.showSlider=!0,e.onSliderChange=this._onTextLayerWidthChange,e.layerType=PF.Components.GeneratorMockup.TextLayer.TYPE,this._canCustomizeCheckbox=new PF.ProductPush.CanCustomizeCheckbox(e),this._state.nodeTextStyle&&this._canCustomizeCheckbox.append(this._state.nodeTextStyle),this._canCustomizeCheckbox.setSliderValue(this._state.textLayer.resizeToPercent)},_includesNewLines:function(e){return e.trim().split("\n").length>1},_loadRequiredFont:function(e,t){return PF.TEXT2SVG.loadRequiredFont(e,t)},_onLineHeightChanged:function(e){this._state.textLayer.lineHeight=e,this._onConfigurationChanged(!0)},_onRotationChanged:function(e){this._state.textLayer.position.rotation=e,this._onConfigurationChanged(!0)},_onLetterSpacingChanged:function(e){this._state.textLayer.letterSpacing=e,this._onConfigurationChanged(!0)},_changeIsCustomizable:function(){this._state.textLayer.isCustomizable=!this._state.textLayer.isCustomizable,this._onConfigurationChanged()},_onTextLayerWidthChange:function(e){this._state.textLayer.setWidthInPercent(e),this._onConfigurationChanged(!0)},_setCustomizableSliderValue:function(e,t){if(this._allowCustomizableLayers()&&this._canCustomizeCheckbox){var i=100*e.position.width/e.originalPosition.areaWidth,r=Math.round(i);this._canCustomizeCheckbox.setSliderValue(r),t&&(this._state.textLayer.resizeToPercent=r)}},_allowCustomizableLayers:function(){return!this._state._forceDisableCustomizer&&this._par.allowCustomizableLayers()},_getColors:function(){var e=!!this._par.isAllOver&&this._par.isAllOver(),t=PF.ProductPush.TextPicker.getAllAvailableColors(this._isPlacementEmbroidery(),this._getSelectedPlacementId(),this._par.product,e,!0);return this._isPlacementEmbroidery()||(this._par.product.isWhiteDtgTote()&&delete t.White,this._par.product.isBlackMug()&&delete t.Black),t},_subscribeToTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnTemplatePositionsChangedListener(this._onLayerPositionsChangedExternally).addOnLayerRotatedListener(this._updateRotationInput).addOnLayerRemovedListener(this._onLayerRemovedExternally)},unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onLayerPositionsChangedExternally).unsubscribe(this._updateRotationInput).unsubscribe(this._onLayerRemovedExternally)},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this.unsubscribeTemplateEvents(),!0)},_updateTextAlignButtonStates:function(){for(var e=this._nodeTextAlignButtons.getElementsByClassName("text-picker__align-btn"),t=0;t<e.length;t++)mkE.addClassName(e[t],"text-picker__glyphicon--muted"),e[t].dataset.alignment===this._state.textLayer.alignment&&mkE.removeClassName(e[t],"text-picker__glyphicon--muted")},hideError:function(){mkE.addClassName(this.nodeError,"pf-d-none")},showError:function(){mkE.removeClassName(this.nodeError,"pf-d-none")},_isPlacementEmbroidery:function(){var e=this._par.placementSelector&&this._par.placementSelector.getSelectedPlacement();return e&&e.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY},_getSelectedPlacementId:function(){return this._par.placementSelector?this._par.placementSelector.getSelectedPlacementId():null}},mkE.Base),PF.ProductPush.TextPicker.hasFontLoaded=function(e){return PF.TEXT2SVG.LOADED_JS_FONTS.hasOwnProperty(e)},PF.ProductPush.TextPicker.getAllAvailableColors=function(e,t,i,r,n){if(!e){var a=r?PF.Components.ColorDropdown.allOverColors():PF.Components.ColorDropdown.defaultColors();if(n)return a;var o={};for(var s in a)o[s]=a[s].value;return o}if(!t)return{};var l={},d=null;if(PF.Items.OrderLineItemFile.PLACEMENT_COLOR_MAP[t]===PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE){var c=i.options[PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS]||{values:{}},u=i.options[PF.Items.ProductOptionItem.NAME_THREAD_COLORS]||{values:{}},h=i.options[PF.Items.ProductOptionItem.NAME_THREAD_COLORS_3D]||{values:{}};d={values:Object.assign({},c.values,u.values,h.values)}}else d=i.options[PF.Items.OrderLineItemFile.PLACEMENT_COLOR_MAP[t]];if(d&&d.values&&(l=PF.Utils.Colors.swap(d.values)),n){var p={};for(var g in l)p[g]={name:g,value:l[g]};return p}return l}}()},GVd7:function(e,t){!function(){"use strict";PF.ProductPush.ClipartPicker.Par=Class({__NAME:"PF.ProductPush.ClipartPicker.Par",onAddFileCallback:null,onBackCallback:null,selectedPlacementTechnique:null,fileDropZone:null})}()},Gfrr:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"h",(function(){return n})),i.d(t,"f",(function(){return a})),i.d(t,"g",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return c}));var r="push/pricing",n="m_updateState",a="m_updatePrice",o="m_updatePrices",s="m_updateErrors",l="m_updateInitializer",d="g_getPrices";function c(e){return r+"/"+e}},H8cr:function(e,t){!function(){"use strict";PF.ProductPush.ProductTranslations=Class({translations:[],_defaultLanguageName:"English (EN)",_defaultLanguageLocale:"en",selectedLanguage:"en",lastSelectedLanguage:null,_laguageValues:[{name:"English (EN)",value:"en"},{name:"Spanish (ES)",value:"es"},{name:"German (DE)",value:"de"},{name:"Japanese (JP)",value:"ja"},{name:"French (FR)",value:"fr"},{name:"Italian (IT)",value:"it"},{name:"Latvian (LV)",value:"lv"}],getDefaultLanguage:function(){return this._defaultLanguageName},getDefaultLanguageLocale:function(){return this._defaultLanguageLocale},getProductTranslationOptions:function(){return this._laguageValues},getProductTranslationOptionNameByValue:function(e){var t=this._laguageValues.filter((function(t){return t.value===e}));return t.length?t[0]:null},getLastSelectedLanguage:function(){return this.lastSelectedLanguage},setLastSelectedLanguage:function(e){this.lastSelectedLanguage=e},setLanguage:function(e){this.selectedLanguage=e},getLanguageData:function(){return this.translations?this.translations[this.selectedLanguage]:void 0},getLanguageDataByLocale:function(e){return this.translations?this.translations[e]:void 0},getLanguage:function(){return this.selectedLanguage}}),PF.ProductPush.ProductTranslations.fromArray=function(e){var t=new PF.ProductPush.ProductTranslations,i=e.translations;return delete e.translations,t.translations=i,mkE(t,e),t}}()},HSPo:function(e,t,i){"use strict";i.d(t,"f",(function(){return o})),i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return h}));var r=i("9Nv7"),n=i("CXOy"),a=i("PwNb");function o(e){var t=e.filter,i=e.storeId,n=void 0===i?null:i,a=e.forPushFlow,o=void 0!==a&&a,s=e.forOrderFlow,l=void 0!==s&&s;return new Promise((function(e,i){t?Object(r.a)("product-templates/get-templates",{filter:Object.assign({},t),storeId:n||null,forPushFlow:!!o,forOrderFlow:!!l}).then((function(t){t?(p(t),e(t)):i(new Error("Malformed getTemplatesResponse data!"))})).catch((function(e){return i(e)})):i(new Error("Missing filter parameters!"))}))}function s(e){var t=e.id,i=e.storeId,o=void 0===i?null:i;return new Promise((function(e,i){t?Object(r.a)("product-templates/get-template",{id:t,storeId:o}).then((function(t){t.item?(t.item=new n.a(t.item),e(t)):i(new a.a("Item wasn't found!"))})).catch((function(e){return i(e)})):i(new Error("Missing template id!"))}))}function l(e){return new Promise((function(t,i){e?Object(r.a)("product-templates/duplicate-template",{id:e}).then((function(e){g(e),e.item?t(e.item):i(new Error("Template duplication failed!"))})).catch((function(e){return i(e)})):i(new Error("Missing template id!"))}))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(i,n){e&&Array.isArray(e)&&e.length?Object(r.a)("product-templates/delete-templates",{ids:e,filter:t}).then((function(e){e&&e.hasOwnProperty("deletedRows")?(p(e.newResponse),i(e)):n(new Error("Malformed deleteTemplatesResponse data!"))})):n(new Error("Missing deletable template ID array!"))}))}function c(e){return new Promise((function(t,i){if(!e.designData||!e.designData instanceof PF.ProductPush.DesignData)i(new Error("Missing design data for template save!"));else{var n=e.designData.toArray();Object(r.a)("product-templates/save",{designData:n,existingTemplateId:e.existingTemplateId||null,isDraftSave:!!e.forceDraft,isFinalSubmit:!!e.forceActive,saveFlowType:e.saveFlowType||u.DEFAULT}).then((function(e){g(e),e.item?t(e.item):i(new Error("Template save failed!"))})).catch((function(e){return i(e)}))}}))}var u={DEFAULT:"DEFAULT",SYNC_PRODUCT_DRAFT:"SYNC_PRODUCT_DRAFT"};function h(){return Object(r.a)("product-templates/close-intro")}function p(e){e&&(e.items&&(e.items=e.items.map((function(e){return new n.a(e)}))),e.usedFilter&&(e.usedFilter=new n.d(e.usedFilter)))}function g(e){e&&e.item&&(e.item=new n.a(e.item))}},HxbZ:function(e,t){!function(){"use strict";PF.ProductPush.LabelSwitcher=Class({_templateType:"",_availablePopover:"label_info_popover",_popoverAttributes:{label_info_popover:{description:lang("Each product variant's specific country of origin, size, fabric info, and care instructions will be printed automatically.")}},__construct:function(){this.node=tag("div","label-switcher-node")},_render:function(){var e=this._templateType;mkE.clearNode(this.node);var t=tag("div",null,[tag("div",{style:{position:"relative",overflow:"hidden",top:"0",textAlign:"center",margin:"0 50px 0 50px"}},[this._switchNative=tag("a",{className:"type-native blue-link",style:{padding:"0 10px"},text:lang("Inside label template"),onclick:this._onSelectInsideLabelCallback.bind(this,PF.Components.InsideLabelTemplate.LABEL_NATIVE)}),this._switchCustom=tag("a",{className:"type-custom blue-link",style:{padding:"0 10px"},text:lang("Change to Blank"),onclick:this._onSelectInsideLabelCallback.bind(this,PF.Components.InsideLabelTemplate.LABEL_CUSTOM)})])]);this.setActiveSwitch(e),t.append(this.node)},show:function(e,t){this._onSelectInsideLabelCallback=t,this._templateType=e,this._render()},hide:function(){mkE.clearNode(this.node)},setActiveSwitch:function(e){e===PF.Components.InsideLabelTemplate.LABEL_NATIVE?(mkE.removeClassName(this._switchCustom,"active"),mkE.addClassName(this._switchNative,"active")):(mkE.removeClassName(this._switchNative,"active"),mkE.addClassName(this._switchCustom,"active"))},getLabelMockupInfoNode:function(e){var t=this._popoverAttributes[e],i=tag("div",{className:"hidden-xs",id:e});return tag("a",{className:"pulsating-dot",style:{opacity:"0.8"},onclick:function(r){new PF.Components.PopoverExtended(i,"",t.description,{placement:"top"},this.dismissPopover.bind(null,r.target,e)).show()}.bind(this)}).append(i),i},dismissPopover:function(e,t){try{localStorage.setItem(t,"1")}catch(e){console.warn("Could not save popover info in local storage")}e&&mkE.removeNode(e)},getLabelPopover:function(e){var t=null;(localStorage.getItem(this._availablePopover)||(t=this._availablePopover),t)?e(this.getLabelMockupInfoNode(t)):e(!1)}},mkE.Base)}()},IZFg:function(e,t){!function(){"use strict";PF.ProductPush.Templates.Par=Class({validateAddingLayer:null,getProduct:null,getSelectedMockupVariant:null,getOrientation:null,getDesignMeta:null})}()},IbzY:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Preview=Class({__NAME:"PF.Components.GeneratorMockup.Preview",_par:null,_mockupPosition:null,_previewString:null,__construct:function(e){this._par=e,this._mockupPosition=this._par.generatorVariant.mockupPosition.getScaledPosition(this._par.maxWidth,this._par.maxHeight),this.node=tag("div","generator-mockup-preview pf-mx-auto",[this._nodeBackground=tag("div"),this._nodeBase=tag("div"),this._nodeDesign=tag("div")]),this._par.maxHeight&&(this.node.style.minHeight=this._par.maxHeight+"px"),this._par.maxWidth&&(this.node.style.width=this._par.maxWidth+"px"),this.render()},render:function(){if(this.node.style.width=this._mockupPosition.areaWidth+"px",this.node.style.minHeight=this._mockupPosition.areaHeight+"px",this._par.isPrintfile)mkE.addClassName(this._nodeBackground,"generator-mockup-preview__printfile");else{mkE.removeClassName(this._nodeBackground,"generator-mockup-preview__printfile");var e=Math.min(this._par.maxWidth,this._par.maxHeight)>300,t={image:e?this._par.generatorVariant.backgroundImageUrl:this._par.generatorVariant.backgroundThumbnailUrl,shadow:e?this._par.generatorVariant.backgroundShadowUrl:this._par.generatorVariant.backgroundShadowThumbnailUrl,base:e?this._par.generatorVariant.generatorImageUrl:this._par.generatorVariant.generatorThumbnailUrl};this._nodeBackground.style.backgroundColor=this._par.generatorVariant.backgroundColor;var i=[];t.shadow&&i.push("url("+t.shadow+")"),t.image&&i.push("url("+t.image+")"),this._nodeBackground.style.backgroundImage=i.length?i.join(", "):null,this._nodeBase.style.backgroundImage=t.base?"url("+t.base+")":null,this._nodeBase.style.zIndex=0===this._par.generatorVariant.mockupPrintZIndex?2:null}this.renderPreviewString()},renderPreviewString:function(e){var t=this._par.template?this._par.template.getKey():this._par.generatorVariant.getKey(),i=PF.Components.GeneratorMockup.Preview.getPreviewString(t);if(!this._previewString||String(this._previewString)!==String(i)){var r=!e&&!this._par.isPrintfile&&this._par.generatorVariant.hideDesignPreview;if(r?(i="",mkE.addClassName(this._nodeDesign,"pf-d-none")):mkE.removeClassName(this._nodeDesign,"pf-d-none"),r||i||this._previewString||!this._par.template)this._previewString=String(i),"<svg"===this._previewString.substring(0,4)?(this._nodeDesign.style.background=null,this._nodeDesign.innerHTML=this._previewString):"data:"===this._previewString.substring(0,5)?(this._nodeDesign.style.background='transparent url("'+this._previewString+'") '+this._mockupPosition.left+"px "+this._mockupPosition.top+"px / "+this._mockupPosition.width+"px "+this._mockupPosition.height+"px no-repeat",this._nodeDesign.innerHTML=""):(this._nodeDesign.style.background=null,this._nodeDesign.innerHTML="");else{var n={fillColor:this._par.designFillColor};PF.Components.GeneratorMockup.Preview.setPreviewStringFromTemplate(this._par.template,this._mockupPosition,n,this.renderPreviewString.bind(this,e))}}}},mkE.Base),PF.Components.GeneratorMockup.Preview._previewStringCache={},PF.Components.GeneratorMockup.Preview.getPreviewString=function(e){return this._previewStringCache.hasOwnProperty(e)?this._previewStringCache[e]:""},PF.Components.GeneratorMockup.Preview.setPreviewString=function(e,t){return this._previewStringCache[e]=t},PF.Components.GeneratorMockup.Preview.clearPreviewStrings=function(){this._previewStringCache={}},PF.Components.GeneratorMockup.Preview.setPreviewStringFromTemplate=function(e,t,i,r){i=Object.assign({},{fillColor:null,isReadOnly:!0,textToPng:!0,readyCallback:function(t){var i=t.convertToPreview({multiplier:2});null!==i&&PF.Components.GeneratorMockup.Preview.setPreviewString(e.getKey(),i),"function"==typeof r&&r()}.bind(this)},i||{}),new PF.CANVAS(t,null,{},i).setLayers(e.layersToArray(!0,!1))}}()},JQxb:function(e,t){!function(){"use strict";PF.ProductPush.GuidelineInfo=Class({_product:null,__construct:function(e){this._product=e,this.node=mkE({tag:"div",className:"layer-picker__item__guideline-info"})},renderGuidelineInfo:function(){this.clearGuidelineInfo(this.node);var e=this._product.productId;this._showGuidelineInfo()&&(localStorage.getItem("mockup-generator-guideline-info-"+e)||mkE({tag:"div",className:"alert alert-warning",els:[{tag:"button",text:"",className:"close",attr:{"aria-label":lang("Close")},data:{dismiss:"alert"},onclick:this._setStorageItem.bind(this,"mockup-generator-guideline-info-"+e)},{tag:"span",innerHTML:dlang("generator","Looks great! Your design will be printed on both sides of the bag. If you want to customize each side separately, select Advanced print file template in Design tab.")}]}).append(this.node))},clearGuidelineInfo:function(){mkE.clearNode(this.node)},_showGuidelineInfo:function(){return[PF.Items.ProductItem.ID_ALL_OVER_TOTE,PF.Items.ProductItem.ID_SOCKS,PF.Items.ProductItem.ID_ALL_OVER_DRAWSTRING_BAG].indexOf(this._product.productId)>-1},_setStorageItem:function(e){try{localStorage.setItem(e,1)}catch(e){console.log("Local storage not supported")}}})}()},KOkY:function(e,t){!function(){"use strict";PF.ProductPush.AddSyncedProducts=Class({_store:null,_selectedStoreId:null,_productPicker:null,_productIds:null,_selectedCategoryIds:[],__construct:function(e,t){this._store=(new PF.Repositories.StoreRepository).getCachedStore(e),this._repository=new PF.Repositories.SyncRepository,this._onSyncedProductsPushedCallback=t,this.tabs=new PF.Components.Tabs("secondary"),this.node=tag("div","product-push-sync-products sync-row-selector"),this._render(),(new PF.Repositories.StoreRepository).get(this._storesRe.bind(this))},_render:function(){mkE.clearNode(this.node),tag("tag","row pf-pb-24",[tag("div","col-12",[tag("h5","pf-h5 pf-m-0 pf-mb-8",lang("Choose store"))]),tag("div","col-12 col-xl-3 col-lg-4 col-md-4",[this._nodeStoreSelect=mkE({tag:"select",className:"styled-select",prop:{onchange:this._onStoreSelectChange.bind(this)}}),this._store.type===PF.Items.StoreItem.TYPE_BIGCOMMERCE&&mkE({tag:"div",className:"pf-mt-16",els:[{tag:"label",text:lang("Select BigCommerce store collections for your products")},this._nodeCategoryPicker=mkE({tag:"div"})]})])]).append(this.node),this._store.type===PF.Items.StoreItem.TYPE_BIGCOMMERCE&&this._loadCategoryList(),this.tabs.append(this.node),this._nodeSyncProducts=mkE({tag:"div"}).append(this.node)},_storesRe:function(e){if(0!=e.length){var t,i,r,n=[],a=[];for(t in e){var o=e[t];this._shouldSkipStore(o)||(o.isRemoved()?(r||(r=o),a.push(o)):(i||(i=o),n.push(o)))}i=i||r,mkE.clearNode(this._nodeStoreSelect);var s=function(e){return{tag:"option",value:e.storeId,text:e.name}};if(n.length){var l=mkE({tag:"optgroup",attr:{label:lang("Active stores")}});for(t in n)mkE(s(n[t])).append(a.length?l:this._nodeStoreSelect);a.length&&l.append(this._nodeStoreSelect)}if(a.length){var d=mkE({tag:"optgroup",attr:{label:lang("Removed stores")}}).append(this._nodeStoreSelect);for(t in a)mkE(s(a[t])).append(d)}i&&(this._nodeStoreSelect.value=i.storeId,this._selectedStoreId=i.storeId,this._loadCounts())}else console.error("Could not load stores")},_onStoreSelectChange:function(){this._selectedStoreId=this._nodeStoreSelect.value,this._loadCounts()},_shouldSkipStore:function(e){return e.storeId===this._store.storeId||e.isUnsupportedPushSource()},_loadSyncedProducts:function(e){mkE.clearNode(this._nodeSyncProducts),mkE({tag:"table",className:"table margin-top-20",els:[{tag:"thead",els:[{tag:"tr",els:[{tag:"td",className:"checkbox-wrapper text-center pf-p-0",style:{verticalAlign:"middle"},onclick:function(){this._nodeToggleAllCheckbox.checked=!this._nodeToggleAllCheckbox.checked,this._toggleAllProducts()}.bind(this),els:[this._nodeToggleAllCheckbox=mkE({tag:"input",type:"checkbox",onclick:this._toggleAllProducts.bind(this)})]},{tag:"td",className:"text-nowrap",els:[this._nodeCountSelected=mkE({tag:"span",className:"hidden-deselected-inline pf-ui-body",text:"0",onclick:this._triggerCheckbox.bind(this)}),{tag:"span",className:"hidden-deselected-inline pf-ui-body",text:" "+lang("products selected"),onclick:this._triggerCheckbox.bind(this)},{tag:"span",className:"hidden-selected pf-ui-body",text:lang("Select all"),onclick:this._triggerCheckbox.bind(this)}]},{tag:"td",className:"pf-p-0 col-xs-12",els:[this._isAllowedToSubmitAll(this._counts[e])&&(this._nodeSubmitAllToStore=mkE({tag:"a",className:"btn btn-default pull-right pf-ml-8 pf-mb-8",onclick:this._onClickSubmitAllToStore.bind(this,e),innerHTML:lang("Submit all (<span>{count}</span>)").replace("{count}",this._counts[e])})),this._nodeSubmitToStore=mkE({tag:"a",className:"btn btn-danger pull-right",text:this._store.isNative()?lang("Save product"):lang("Submit to store"),onclick:this._onClickSubmitToStore,style:{pointerEvents:"auto"}})]}]}]}]}).append(this._nodeSyncProducts);var t=new PF.ProductPush.SyncedProductPicker.Par;t.sourceStoreId=this._selectedStoreId,t.targetStoreId=this._store.storeId,t.type=e,t.onProductCountUpdatedCallback=this._updateCountSelectedNode.bind(this),t.addedFailedProductIds=this._productIds,this._productPicker=new PF.ProductPush.SyncedProductPicker(t).append(this._nodeSyncProducts),this._productPicker.load(),this._updateCountSelectedNode()},_triggerCheckbox:function(e){this._nodeToggleAllCheckbox.checked=!this._nodeToggleAllCheckbox.checked,this._toggleAllProducts()},_toggleAllProducts:function(e){e&&e.stopImmediatePropagation(),this._nodeToggleAllCheckbox.indeterminate||this._nodeToggleAllCheckbox.checked?this._productPicker.selectAllRows():this._productPicker.deselectAllRows(),this._calculateCheckboxState()},_isAllowedToSubmitAll:function(e){return e>0&&e<PF.ProductPush.SyncedProductCounts.COUNT_PUSHABLE},_onClickSubmitToStore:function(){if(!mkE.hasClassName(this._nodeSubmitToStore,"disabled")){mkE.addClassName(this._nodeSubmitToStore,"disabled");var e=this._productPicker.getSelectedProducts().map((function(e){return e.getSyncProduct().syncProductId}));this._onSubmitToStoreProceed(e)}},_onSubmitToStoreProceed:function(e){this._productPicker.hideError(),RPC("product-generator/push-synced-products",{sourceStoreId:this._selectedStoreId,targetStoreId:this._store.storeId,categoryIds:this._selectedCategoryIds,syncProductIds:e},this._onSyncedProductsPushed.bind(this)),ga("send","event","ProductPush","Synced product pushed",(new PF.Repositories.StoreRepository).getCachedStore(this._selectedStoreId).integrationName+" to "+this._store.integrationName)},_onClickSubmitAllToStore:function(e){RPC("product-generator/push-all-synced-products",{sourceStoreId:this._selectedStoreId,targetStoreId:this._store.storeId,categoryIds:this._selectedCategoryIds,type:e},this._onSyncedProductsPushed.bind(this)),ga("send","event","ProductPush","Synced product pushed",(new PF.Repositories.StoreRepository).getCachedStore(this._selectedStoreId).integrationName+" to "+this._store.integrationName)},_onSyncedProductsPushed:function(e){e&&e.error?this._productPicker.showError(e.message):this._onSyncedProductsPushedCallback&&this._onSyncedProductsPushedCallback()},_updateCountSelectedNode:function(e){this._nodeCountSelected.textContent=e||0,e&&e<=PF.ProductPush.SyncedProductCounts.COUNT_PUSHABLE?(mkE.removeClassName(this._nodeSubmitToStore,"disabled"),$(this._nodeSubmitToStore).tooltip("destroy")):mkE.addClassName(this._nodeSubmitToStore,"disabled"),this._nodeSubmitAllToStore&&(e?mkE.addClassName(this._nodeSubmitAllToStore,"hidden"):mkE.removeClassName(this._nodeSubmitAllToStore,"hidden")),e>PF.ProductPush.SyncedProductCounts.COUNT_PUSHABLE&&$(this._nodeSubmitToStore).tooltip({title:lang("You can only push up to 100 existing products at once.")}),e?mkE.addClassName(this.node,"sync-row-selector--selected"):mkE.removeClassName(this.node,"sync-row-selector--selected"),this._bigCommerceCategoryCheck(),this._calculateCheckboxState()},_calculateCheckboxState:function(){var e=this._productPicker.getSelectedProducts().length,t=this._productPicker.getItems(),i=!!t.length;for(var r in t)if(i&&!t[r].isChecked()){i=!1;break}!i&&e>0?(this._nodeToggleAllCheckbox.checked=!1,this._nodeToggleAllCheckbox.indeterminate=!0):i?(this._nodeToggleAllCheckbox.checked=!0,this._nodeToggleAllCheckbox.indeterminate=!1):0==e&&(this._nodeToggleAllCheckbox.checked=!1,this._nodeToggleAllCheckbox.indeterminate=!1)},_loadCounts:function(){this._selectedStoreId&&(this._store.type===PF.Items.StoreItem.TYPE_BIGCOMMERCE&&0==this._selectedCategoryIds.length||this._repository.getSyncedCounts(this._selectedStoreId,this._store.storeId,this._loadCountsRe.bind(this)))},_loadCountsRe:function(e,t){this._counts=e,this._productIds=t,this.tabs.clear();var i=PF.ProductPush.SyncedProductCounts.types,r=!1;for(var n in i){var a=new PF.Components.Tabs.Item,o=this._counts[n];0!==o&&(a.caption=tag("span","",[i[n]+" ",tag("span",{style:{color:n===PF.ProductPush.SyncedProductCounts.TYPE_FAILED?"red":"inherit"}},o===PF.ProductPush.SyncedProductCounts.AMOUNT_UNKNOWN?"":"("+o+")")]),r||(a.isActive=!0,r=!0),a.onclick=this._loadSyncedProducts.bind(this,n),this.tabs.add(a))}this._loadSyncedProducts(PF.ProductPush.SyncedProductCounts.TYPE_ALL)},_loadCategoryList:function(){mkE.clearNode(this._nodeCategoryPicker),mkE({tag:"div",text:lang("Fetching collection list")}).append(this._nodeCategoryPicker),this._nodeInputCategories=mkE({tag:"select",className:"product-push-pricing__collection-select",attr:{multiple:"multiple","data-placeholder":lang("Choose collection(s)")},prop:{onchange:function(){var e=!1;0===this._selectedCategoryIds.length&&1===$(this._nodeInputCategories).val().length&&(e=!0),this._selectedCategoryIds=$(this._nodeInputCategories).val()||[],console.log(this._selectedCategoryIds),e&&this._loadCounts(),0===this._selectedCategoryIds.length&&(this.tabs.clear(),mkE.clearNode(this._nodeSyncProducts)),this._bigCommerceCategoryCheck()}.bind(this)}}),(new PF.Repositories.StoreRepository).getProductPushCategories(this._store.storeId,this._categoriesLoaded.bind(this),this._categoriesFailedToLoad.bind(this))},_categoriesLoaded:function(e){if(mkE.clearNode(this._nodeCategoryPicker),mkE.clearNode(this._nodeInputCategories),0!==e.length){for(var t in mkE({tag:"option",text:""}).append(this._nodeInputCategories),e){var i=e[t];mkE({tag:"option",text:i.title,value:i.categoryId,prop:{}}).append(this._nodeInputCategories)}mkE({tag:"div",className:"margin-bottom-20 row",els:[{tag:"div",className:"col-xs-12",els:[this._nodeInputCategories]}]}).append(this._nodeCategoryPicker),$(this._nodeInputCategories).chosen({width:"100%"})}else this._nodeCategoryPicker.textContent=lang("We failed to load your collections. Please check your store to make sure theyre added correctly")},_categoriesFailedToLoad:function(){mkE.clearNode(this._nodeCategoryPicker),mkE({tag:"p",els:[{tag:"b",text:lang("We could not retrieve the collection list from your store."),style:{color:"#f0473d"}},{tag:"br"},tag("span",null,lang("You can add these products to collections manually in your store later or {@@}try again{@@}.").split("{@@}").map(function(e,t){return 1!==t?e:tag("a",{onclick:this.loadCategoryList.bind(this)},e)}.bind(this)))]}).append(this._nodeCategoryPicker)},_bigCommerceCategoryCheck:function(){this._store.type===PF.Items.StoreItem.TYPE_BIGCOMMERCE&&0===this._selectedCategoryIds.length&&(mkE.addClassName(this._nodeSubmitToStore,"disabled"),this._nodeSubmitAllToStore&&mkE.addClassName(this._nodeSubmitAllToStore,"hidden"))}},mkE.Base)}()},KVJj:function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.GenderCategory=Class({__construct:function(e){var t=tag("div");this.node=mkE({tag:"div",className:"margin-bottom-20 no-icon-tags",els:[this.genderSelectorLabel=mkE({tag:"label",text:dclang("dashboard","Product push","Style")}),t]}),this.genderSelectorTooltip=mkE({tag:"span",className:"glyphicon glyphicon-info-sign",attr:{title:dlang("dashboard","The product will be added to a category according to this choice")},style:{marginLeft:"5px",top:"3px"}}),this.genderSelectorTooltip.append(this.genderSelectorLabel),$(this.genderSelectorTooltip).tooltip();var i=e||[PF.ProductPush.MockupPicker.GenderCategory.UNISEX],r=PF.ProductPush.MockupPicker.GenderCategory.UNISEX;for(var n in-1===i.indexOf(PF.ProductPush.MockupPicker.GenderCategory.UNISEX)&&(r=e[0]),i)mkE({tag:"label",className:"inline-radio",els:[{tag:"input",type:"radio",name:"categoryGender",value:i[n].key,checked:i[n]===r,onclick:this.setValue.bind(this,i[n].key)}," "+i[n].title]}).append(t);this.setValue(r.key)},getSelectedValue:function(){return this.activeValue?this.activeValue:PF.ProductPush.MockupPicker.GenderCategory.UNISEX.key},setValue:function(e){this.activeValue=e}},mkE.Base),PF.ProductPush.MockupPicker.GenderCategory.allowGenderCategory=function(e,t,i){RPC("product-catalog/product-integration-category-options",{productId:t,integrationType:e,optionType:"option_gender"},this.allowGenderCategoryRe.bind(this,e,t,i))},PF.ProductPush.MockupPicker.GenderCategory.allowGenderCategoryRe=function(e,t,i,r){if(r.length){var n=[];e!==PF.Items.StoreItem.TYPE_EBAY&&n.push(PF.ProductPush.MockupPicker.GenderCategory.UNISEX),r.forEach((function(e){var t=null;e===PF.ProductPush.MockupPicker.GenderCategory.MEN.key?t=PF.ProductPush.MockupPicker.GenderCategory.MEN:e===PF.ProductPush.MockupPicker.GenderCategory.WOMEN.key&&(t=PF.ProductPush.MockupPicker.GenderCategory.WOMEN),t&&-1===n.indexOf(t)&&n.push(t)})),i(n)}else i(null)},PF.ProductPush.MockupPicker.GenderCategory.UNISEX={key:"option_gender_unisex",title:clang("Gender picker","Unisex")},PF.ProductPush.MockupPicker.GenderCategory.MEN={key:"option_gender_male",title:clang("Gender picker","Men")},PF.ProductPush.MockupPicker.GenderCategory.WOMEN={key:"option_gender_female",title:clang("Gender picker","Women")}}()},L2JU:function(e,t,i){"use strict";i.d(t,"f",(function(){return y})),i.d(t,"e",(function(){return v})),i.d(t,"d",(function(){return b})),i.d(t,"c",(function(){return C})),i.d(t,"a",(function(){return T}));var r=function(e){if(Number(e.version.split(".")[0])>=2)e.mixin({beforeCreate:i});else{var t=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[i].concat(e.init):i,t.call(this,e)}}function i(){var e=this.$options;e.store?this.$store="function"==typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}},n="undefined"!=typeof window&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function a(e,t){Object.keys(e).forEach((function(i){return t(e[i],i)}))}var o=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var i=e.state;this.state=("function"==typeof i?i():i)||{}},s={namespaced:{configurable:!0}};s.namespaced.get=function(){return!!this._rawModule.namespaced},o.prototype.addChild=function(e,t){this._children[e]=t},o.prototype.removeChild=function(e){delete this._children[e]},o.prototype.getChild=function(e){return this._children[e]},o.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},o.prototype.forEachChild=function(e){a(this._children,e)},o.prototype.forEachGetter=function(e){this._rawModule.getters&&a(this._rawModule.getters,e)},o.prototype.forEachAction=function(e){this._rawModule.actions&&a(this._rawModule.actions,e)},o.prototype.forEachMutation=function(e){this._rawModule.mutations&&a(this._rawModule.mutations,e)},Object.defineProperties(o.prototype,s);var l=function(e){this.register([],e,!1)};l.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},l.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,i){return e+((t=t.getChild(i)).namespaced?i+"/":"")}),"")},l.prototype.update=function(e){!function e(t,i,r){0;i.update(r);if(r.modules)for(var n in r.modules){if(!i.getChild(n))return void 0;e(t.concat(n),i.getChild(n),r.modules[n])}}([],this.root,e)},l.prototype.register=function(e,t,i){var r=this;void 0===i&&(i=!0);var n=new o(t,i);0===e.length?this.root=n:this.get(e.slice(0,-1)).addChild(e[e.length-1],n);t.modules&&a(t.modules,(function(t,n){r.register(e.concat(n),t,i)}))},l.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),i=e[e.length-1];t.getChild(i).runtime&&t.removeChild(i)};var d;var c=function(e){var t=this;void 0===e&&(e={}),!d&&"undefined"!=typeof window&&window.Vue&&f(window.Vue);var i=e.plugins;void 0===i&&(i=[]);var r=e.strict;void 0===r&&(r=!1);var a=e.state;void 0===a&&(a={}),"function"==typeof a&&(a=a()||{}),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new l(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new d;var o=this,s=this.dispatch,c=this.commit;this.dispatch=function(e,t){return s.call(o,e,t)},this.commit=function(e,t,i){return c.call(o,e,t,i)},this.strict=r,m(this,a,[],this._modules.root),g(this,a),i.forEach((function(e){return e(t)})),d.config.devtools&&function(e){n&&(e._devtoolHook=n,n.emit("vuex:init",e),n.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){n.emit("vuex:mutation",e,t)})))}(this)},u={state:{configurable:!0}};function h(e,t){return t.indexOf(e)<0&&t.push(e),function(){var i=t.indexOf(e);i>-1&&t.splice(i,1)}}function p(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var i=e.state;m(e,i,[],e._modules.root,!0),g(e,i,t)}function g(e,t,i){var r=e._vm;e.getters={};var n=e._wrappedGetters,o={};a(n,(function(t,i){o[i]=function(){return t(e)},Object.defineProperty(e.getters,i,{get:function(){return e._vm[i]},enumerable:!0})}));var s=d.config.silent;d.config.silent=!0,e._vm=new d({data:{$$state:t},computed:o}),d.config.silent=s,e.strict&&function(e){e._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}(e),r&&(i&&e._withCommit((function(){r._data.$$state=null})),d.nextTick((function(){return r.$destroy()})))}function m(e,t,i,r,n){var a=!i.length,o=e._modules.getNamespace(i);if(r.namespaced&&(e._modulesNamespaceMap[o]=r),!a&&!n){var s=_(t,i.slice(0,-1)),l=i[i.length-1];e._withCommit((function(){d.set(s,l,r.state)}))}var c=r.context=function(e,t,i){var r=""===t,n={dispatch:r?e.dispatch:function(i,r,n){var a=P(i,r,n),o=a.payload,s=a.options,l=a.type;return s&&s.root||(l=t+l),e.dispatch(l,o)},commit:r?e.commit:function(i,r,n){var a=P(i,r,n),o=a.payload,s=a.options,l=a.type;s&&s.root||(l=t+l),e.commit(l,o,s)}};return Object.defineProperties(n,{getters:{get:r?function(){return e.getters}:function(){return function(e,t){var i={},r=t.length;return Object.keys(e.getters).forEach((function(n){if(n.slice(0,r)===t){var a=n.slice(r);Object.defineProperty(i,a,{get:function(){return e.getters[n]},enumerable:!0})}})),i}(e,t)}},state:{get:function(){return _(e.state,i)}}}),n}(e,o,i);r.forEachMutation((function(t,i){!function(e,t,i,r){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){i.call(e,r.state,t)}))}(e,o+i,t,c)})),r.forEachAction((function(t,i){var r=t.root?i:o+i,n=t.handler||t;!function(e,t,i,r){(e._actions[t]||(e._actions[t]=[])).push((function(t,n){var a,o=i.call(e,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:e.getters,rootState:e.state},t,n);return(a=o)&&"function"==typeof a.then||(o=Promise.resolve(o)),e._devtoolHook?o.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):o}))}(e,r,n,c)})),r.forEachGetter((function(t,i){!function(e,t,i,r){if(e._wrappedGetters[t])return void 0;e._wrappedGetters[t]=function(e){return i(r.state,r.getters,e.state,e.getters)}}(e,o+i,t,c)})),r.forEachChild((function(r,a){m(e,t,i.concat(a),r,n)}))}function _(e,t){return t.length?t.reduce((function(e,t){return e[t]}),e):e}function P(e,t,i){var r;return null!==(r=e)&&"object"==typeof r&&e.type&&(i=t,t=e,e=e.type),{type:e,payload:t,options:i}}function f(e){d&&e===d||r(d=e)}u.state.get=function(){return this._vm._data.$$state},u.state.set=function(e){0},c.prototype.commit=function(e,t,i){var r=this,n=P(e,t,i),a=n.type,o=n.payload,s=(n.options,{type:a,payload:o}),l=this._mutations[a];l&&(this._withCommit((function(){l.forEach((function(e){e(o)}))})),this._subscribers.forEach((function(e){return e(s,r.state)})))},c.prototype.dispatch=function(e,t){var i=this,r=P(e,t),n=r.type,a=r.payload,o={type:n,payload:a},s=this._actions[n];if(s)return this._actionSubscribers.forEach((function(e){return e(o,i.state)})),s.length>1?Promise.all(s.map((function(e){return e(a)}))):s[0](a)},c.prototype.subscribe=function(e){return h(e,this._subscribers)},c.prototype.subscribeAction=function(e){return h(e,this._actionSubscribers)},c.prototype.watch=function(e,t,i){var r=this;return this._watcherVM.$watch((function(){return e(r.state,r.getters)}),t,i)},c.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},c.prototype.registerModule=function(e,t,i){void 0===i&&(i={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),m(this,this.state,e,this._modules.get(e),i.preserveState),g(this,this.state)},c.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var i=_(t.state,e.slice(0,-1));d.delete(i,e[e.length-1])})),p(this)},c.prototype.hotUpdate=function(e){this._modules.update(e),p(this,!0)},c.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(c.prototype,u);var y=k((function(e,t){var i={};return I(t).forEach((function(t){var r=t.key,n=t.val;i[r]=function(){var t=this.$store.state,i=this.$store.getters;if(e){var r=E(this.$store,"mapState",e);if(!r)return;t=r.context.state,i=r.context.getters}return"function"==typeof n?n.call(this,t,i):t[n]},i[r].vuex=!0})),i})),v=k((function(e,t){var i={};return I(t).forEach((function(t){var r=t.key,n=t.val;i[r]=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];var r=this.$store.commit;if(e){var a=E(this.$store,"mapMutations",e);if(!a)return;r=a.context.commit}return"function"==typeof n?n.apply(this,[r].concat(t)):r.apply(this.$store,[n].concat(t))}})),i})),b=k((function(e,t){var i={};return I(t).forEach((function(t){var r=t.key,n=t.val;n=e+n,i[r]=function(){if(!e||E(this.$store,"mapGetters",e))return this.$store.getters[n]},i[r].vuex=!0})),i})),C=k((function(e,t){var i={};return I(t).forEach((function(t){var r=t.key,n=t.val;i[r]=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];var r=this.$store.dispatch;if(e){var a=E(this.$store,"mapActions",e);if(!a)return;r=a.context.dispatch}return"function"==typeof n?n.apply(this,[r].concat(t)):r.apply(this.$store,[n].concat(t))}})),i})),T=function(e){return{mapState:y.bind(null,e),mapGetters:b.bind(null,e),mapMutations:v.bind(null,e),mapActions:C.bind(null,e)}};function I(e){return Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}}))}function k(e){return function(t,i){return"string"!=typeof t?(i=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,i)}}function E(e,t,i){return e._modulesNamespaceMap[i]}var S={Store:c,install:f,version:"3.0.1",mapState:y,mapMutations:v,mapGetters:b,mapActions:C,createNamespacedHelpers:T};t.b=S},MMbA:function(e,t){!function(){"use strict";PF.ProductPush.DesignerState=Class({__NAME:"PF.ProductPush.DesignerState",_placementLayers:{},_templateLayers:{},generatorDesignId:null,__construct:function(){},addPlacementFileLayer:function(e,t,i){if(!t.isTempGeneratorFile()){var r=this._placementLayers[e]||[],n=new PF.Components.GeneratorMockup.ImageLayer;i&&(n.originalPosition=i.getClone(),n.position=i.getClone()),n.fileItem=t,r.push(n),this._placementLayers[e]=r}},addPlacementClipartLayer:function(e,t,i){var r=this._placementLayers[e]||[],n=new PF.Components.GeneratorMockup.ClipartLayer;i&&(n.originalPosition=i.getClone(),n.position=i.getClone()),n.clipartItem=t,r.push(n),this._placementLayers[e]=r},getLayersByPlacement:function(){return this._placementLayers},hasLayersByPlacement:function(){return Object.keys(this._placementLayers).length>0},hasTemplates:function(){return Object.keys(this._templateLayers).length>0},addFromTemplates:function(e){var t=e.getTemplates();for(var i in t)for(var r in t[i]){var n=t[i][r];this._templateLayers[n.getKey()]=n.getCloneWithLayers()}},getTemplates:function(){return this._templateLayers},getTemplateByKey:function(e){return this._templateLayers[e]||null},getTemplatesBestMatchingLayers:function(e){var t,i,r=(e.width/e.height).toFixed(2);for(var n in this._templateLayers){var a=this._templateLayers[n];if(a.placementId===e.placementId){var o=(a.height/a.width).toFixed(2),s=(a.width/a.height).toFixed(2);if(t=a.layers.slice(0),r==s||r==o){if(a.width===e.height&&a.height===e.width)return t;i=t}}}return i||t||[]}}),PF.ProductPush.DesignerState.initialize=function(e,t){var i=new PF.Repositories.LibraryRepository,r=new PF.ProductPush.DesignerState;for(var n in r.generatorDesignId=t,e){var a=e[n];a.exists()&&!a.isMockup()&&r.addPlacementFileLayer(a.type,i.getCachedFile(a.fileId),a.position)}return r}}()},MSZa:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,"a",(function(){return a}));var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.status=t.status||e.STATUSES.STATUS_BROKEN,this.imageURL=t.imageURL||null,this.thumbnailURL=t.thumbnailURL||null,this.imageSVG=t.imageSVG||null,this.pusherKey=t.pusherKey||null}var t,i,n;return t=e,(i=[{key:"loadResults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.imageURL,r=void 0===i?null:i,n=t.thumbnailURL,a=void 0===n?null:n,o=t.imageSVG,s=void 0===o?null:o;if(this.pusherKey=null,!r&&!a&&!s)return this.imageURL=this.thumbnailURL=this.imageSVG=null,void(this.status=e.STATUSES.STATUS_BROKEN);r&&(this.imageURL=r),a&&(this.thumbnailURL=a),s&&(this.imageSVG=s),this.status=e.STATUSES.STATUS_DONE}},{key:"isDone",get:function(){return this.status===e.STATUSES.STATUS_DONE}},{key:"isLoading",get:function(){return this.status===e.STATUSES.STATUS_LOADING}},{key:"isBroken",get:function(){return this.status===e.STATUSES.STATUS_BROKEN}}])&&r(t.prototype,i),n&&r(t,n),e}();n(a,"IMAGE_LOADING_URL","/static/images/layout/spinner-transparent.gif"),n(a,"IMAGE_BROKEN_URL","/static/images/retina/invalid-file.svg"),a.STATUSES=Object.freeze({STATUS_BROKEN:"broken",STATUS_LOADING:"loading",STATUS_DONE:"done"})},MW8O:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup=Class({_lastActiveLayer:null,_isGridVisible:!1,_isZoomedIn:!1,_canvas:null,_shouldHideMediumQualityMessage:null,_par:null,_mockupPosition:null,_lastPreviewString:null,__construct:function(e){this._par=e,this._mockupPosition=this._par.generatorVariant.mockupPosition.getScaledPosition(this._par.maxWidth,this._par.maxHeight),this._par.maxHeight=Math.floor(this._par.maxHeight),this._par.maxWidth=Math.floor(this._par.maxWidth),this._mockupPosition.areaWidth=Math.round(this._mockupPosition.areaWidth),this._mockupPosition.areaHeight=Math.round(this._mockupPosition.areaHeight),this._mockupPosition.height=Math.round(this._mockupPosition.height),this._mockupPosition.width=Math.round(this._mockupPosition.width),this._mockupPosition.top=Math.round(this._mockupPosition.top),this._mockupPosition.left=Math.round(this._mockupPosition.left),this.node=tag("div","generator-mockup pf-mx-auto",[this._nodeCanvasHolder=tag("div"),this._nodePrintQualityHolder=tag("div"),this._nodeControlsHolder=tag("div")]),this._par.maxHeight&&(this.node.style.minHeight=this._par.maxHeight+"px",this.node.style.paddingTop=this._par.maxHeight+"px"),this._par.maxWidth&&(this.node.style.width=this._par.maxWidth+"px");var t=new PF.Components.GeneratorMockup.Canvas.Par;if(t.mockupPosition=this._mockupPosition,t.templates=this._par.templates,t.onPositionChanged=this._onPositionChanged.bind(this),t.onLayerSelected=this.setActiveLayer.bind(this),t.onLayerRemoved=this._onLayerRemoved.bind(this),t.onTextChanged=this._onTextChanged.bind(this),t.onPreview=this._onPreview.bind(this),t.opts={backgroundColor:this._par.generatorVariant.backgroundColor,backgroundImage:this._par.generatorVariant.backgroundImageUrl,backgroundShadow:this._par.generatorVariant.backgroundShadowUrl,baseImageUrl:this._par.generatorVariant.generatorImageUrl,overlayColor:null,fillColor:this._par.designFillColor,mockupPrintZIndex:this._par.generatorVariant.mockupPrintZIndex,isReadOnly:this._par.disableLayerManipulations||!this._par.isResizable,readyCallback:this._readyCallback,disablePulseImageOverride:this._par.disablePulseImageOverride,labelText:this._labelText(),isCustomizingMode:this._par.isCustomizingMode},this._canvas=new PF.Components.GeneratorMockup.Canvas(t),this._canvas.setLayers(this._par.template?this._par.template.layersToArray():[]),this._canvas.append(this._nodeCanvasHolder),PF.DEV&&!t.opts.isReadOnly){var i='display:block;position:relative;top:0;left:0;width:200px;height:200px;background:transparent url("/static/images/layout/trasnparent-pattern.png") center center;border:solid 1px gray;text:black;font-weight:bolder;';$(tag("div",{id:"mockup-generator-layers-debug",className:"pf-d-none",style:"position:absolute;top:0;left:0;z-index:4;left:-200px;"},[tag("div","pf-bold pf-bg-white","mockupPrintZIndex: "+this._par.generatorVariant.mockupPrintZIndex),tag("div","pf-bold pf-bg-white","backgroundColor: "+this._par.generatorVariant.backgroundColor),tag("div",{style:i+"background:"+this._par.generatorVariant.backgroundColor}),tag("div","pf-bold pf-bg-white","backgroundImage:"),tag("img",{style:i,src:this._par.generatorVariant.backgroundImageUrl||""}),tag("div","pf-bold pf-bg-white","backgroundShadow:"),tag("img",{style:i,src:this._par.generatorVariant.backgroundShadowUrl||""}),tag("div","pf-bold pf-bg-white","baseImageUrl:"),tag("img",{style:i,src:this._par.generatorVariant.generatorImageUrl||""})]).append(this._nodeCanvasHolder)).draggable()}e.isResizable&&(this.nodePrintQuality=tag("div","print-quality "+(e.isOrderFlow?"":"pf-d-none"))),this._toggleGrid(!1,this._shouldGridBeVisible(),!0),this._shouldCanvasBeZoomedIn()&&this._toggleZoom(!1,this._shouldCanvasBeZoomedIn(),!0),this._par.isResizable&&!this._par.disableLayerManipulations&&this.setActiveLayer(this._par.templates.getActiveLayer()||this._lastActiveLayer,!0)},isEventOrigin:function(e){return e&&(e===this||this._canvas.isEventOrigin(e))},_labelText:function(){if(!this._par.product)return null;var e=[PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT,PF.Items.OrderLineItemFile.TYPE_FRONT,PF.Items.OrderLineItemFile.TYPE_BACK,PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_BACK,PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_LEFT,PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_RIGHT].indexOf(this._par.generatorVariant.placementId)>-1,t=this._par.product.isDtgTote()||this._par.product.isEmbroidery()||this._par.product.isDtgShirt();return e&&t?this._par.product.isEmbroidery()?lang("Embroidery area"):lang("Print area"):null},_readyCallback:function(e){var t=this;this._canvas.notifyPreview(),this._par.onReady&&setTimeout((function(){return t._par.onReady()}),100)},_shouldGridBeVisible:function(){return null!==PF.Components.GeneratorMockup.isGridVisible&&this._par.isResizable?PF.Components.GeneratorMockup.isGridVisible:this._shouldShowGridButton()},_shouldCanvasBeZoomedIn:function(){return!!(this._par.product&&this._shouldShowZoomIn()&&null!==PF.Components.GeneratorMockup.isZoomedIn&&this._par.isResizable)&&PF.Components.GeneratorMockup.isZoomedIn},_toggleGrid:function(e,t,i){this._isGridVisible=t,e&&(PF.Components.GeneratorMockup.isGridVisible=t),this._par.template&&(this._canvas.toggleGuidelines(this._isGridVisible,{center:this._shouldShowCenterLine(),sideCenter:this._shouldShowSideCenterLines(),sideCenterRatio:this._par.template.getSideCenterDistanceRatio()}),i||this._renderViewActions())},_toggleZoom:function(e,t,i){this._isZoomedIn=t,e&&(PF.Components.GeneratorMockup.isZoomedIn=t),this._canvas.toggleZoom(this._isZoomedIn),this._par.templates&&(this._par.templates.getChangeListener().notifyZoomChanged(t),this._canvas.setLayers(this._par.template?this._par.template.layersToArray():[])),i||this._renderViewActions()},render:function(){if(this.node.style.width=this._mockupPosition.areaWidth+"px",this.node.style.minHeight=this._mockupPosition.areaHeight+"px",this.node.style.paddingTop=this.node.style.minHeight,this._nodeViewActions=tag("div").append(this.node),this._par.isResizable&&!this._par.disableLayerManipulations){this._renderViewActions(),mkE.clearNode(this._nodePrintQualityHolder),this.nodePrintQuality.append(this._nodePrintQualityHolder);var e={maxDPI:600,requiredDPI:this._par.templates.getRequiredDpi(),onCenterVertical:this._centerLayerVertically,onCenterHorizontal:this._centerLayersHorizontally,onReset:this._resetLayers,onMove:this._onMove,onScale:this._onScale,withSlider:!0,showButtons:this._par.isOrderFlow};this._controls=new PF.Components.GeneratorMockupControls(e),mkE.clearNode(this._nodeControlsHolder),this._controls.append(this._nodeControlsHolder),this._updateSliderState()}this.displayOutOfBoundsIndicator(),this.displayQualityIndicators(),this.displayCustomizableTextLayerError()},_renderViewActions:function(){if(this._par.product){mkE.clearNode(this._nodeViewActions);var e=new PF.Components.GeneratorMockup.Actions;this._shouldShowGridButton()&&e.addButton().setName(dlang("dashboard","Grid off"),dlang("dashboard","Grid on")).setIconClass("pf-i-grid-large").setCallback(this._toggleGrid.bind(this,!0)).setIsToggledOn(this._isGridVisible),this._shouldShowZoomIn()&&e.addButton().setName(lang("Zoom in"),lang("Zoom out")).setImgSrc(null,PF.ASSETS_URL+"generator/zoom-in-icon.svg").setIconClass("action-zoom","pf-i pf-i-fullscreen-exit").setCallback(this._toggleZoom.bind(this,!0)).setBadge(clang("Badge","New"),"pf-badge pf-badge-small pf-badge-new pf-badge--primary").setIsToggledOn(this._isZoomedIn),e.hasButtons()&&e.render().append(this._nodeViewActions)}},setControlsVisibility:function(e){this._controls&&(e?(this._controls.show(),this.displayQualityIndicators()):(this._controls.hide(),mkE.addClassName(this.nodePrintQuality,"pf-d-none")))},_updateSliderState:function(){if(this._controls){var e=this._getSelectedLayer();if(e&&this._par&&this._par.template&&this._par.template.fillMode){var t="w"===e.position.getScaleDimensionByFillMode(this._par.template.fillMode)?e.position.width/e.position.areaWidth*100:e.position.height/e.position.areaHeight*100;this._controls.setSliderValue(t)}}},_shouldShowGridButton:function(){return this._par.isResizable&&!this._par.disableLayerManipulations&&this._par.product&&(this._par.product.isDtgShirt()||this._par.product.isDtgTote()||this._par.product.isJewelry())&&this._shouldShowZoomIn()},_shouldShowZoomIn:function(){if(this._par.hideZoomButton)return!1;var e=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_HANG_TAG],t=[PF.Items.ProductItem.TYPE_EMBROIDERY,PF.Items.ProductItem.TYPE_JEWELRY,PF.Items.ProductItem.TYPE_T_SHIRT];return!(e.indexOf(this._par.generatorVariant.placementId)>-1)&&t.indexOf(this._par.product.type)>-1},_shouldShowCenterLine:function(){return this._par.product&&(!this._par.product.isCutSew()||[PF.Items.OrderLineItemFile.TYPE_FRONT,PF.Items.OrderLineItemFile.TYPE_BACK].indexOf(this._par.template.placementId)>-1)},_shouldShowSideCenterLines:function(){return this._par.product&&this._par.product.isMug()},_onPositionChanged:function(e,t,i){i||(i=this),e=this._par.templates.getFreshLayer(e),e=this._par.templates.updateLayerPosition(e,t,i),this._lastActiveLayer=e},_onTextChanged:function(e,t){t||(t=this),e=this._par.templates.getFreshLayer(e),e=this._par.templates.updateLayerText(e,t),this._lastActiveLayer=e},_onPreview:function(e,t){var i=e();String(this._lastPreviewString)!==String(i)&&(this._lastPreviewString=i,t||(t=this),this._par.templates&&this._par.templates.getChangeListener().notifyPreviewChanged(i,this._par.template,t))},_centerLayerVertically:function(e){e&&e.stopPropagation();var t=this._getSelectedLayer();if(t){var i=t.position.getClone().centerVertically();this._par.templates.updateLayerPosition(t,i)}},_centerLayersHorizontally:function(e){e&&e.stopPropagation();var t=this._getSelectedLayer();if(t){var i=t.position.getClone().centerHorizontally();this._par.templates.updateLayerPosition(t,i)}},_onMove:function(e,t,i){var r=this._getSelectedLayer();if(r){var n=r.position.getClone();n.left+=e,n.top+=t,this._par.templates.updateLayerPosition(r,n,i)}},_onScale:function(e,t){var i=this._getSelectedLayer();if(i&&this._par&&this._par.template&&this._par.template.fillMode){var r=i.position.getClone();"w"===r.getScaleDimensionByFillMode(this._par.template.fillMode)?r.setWidthScale(e/100):r.setHeightScale(e/100),this._par.templates.updateLayerPosition(i,r,t)}},_resetLayers:function(e){e&&e.stopPropagation();var t=this._getSelectedLayer();t&&this._par.templates.resetLayer(t)},updateLayersPositions:function(e,t,i){this.isEventOrigin(i)||(t?this._canvas.setLayer(t):this._canvas.setLayers(e?e.layersToArray():[]),this._updateSliderState())},setMockupDesignFillColor:function(e){this._par.designFillColor=e},showActiveLayer:function(e){if(e){var t=this._getSelectedLayer(),i=this._canvas.getActiveLayer();(t||i)&&(t&&t.uniqueId===e.uniqueId&&i&&i.uniqueId===e.uniqueId||this._canvas.showActiveLayer(e.uniqueId))}},setActiveLayer:function(e,t,i){var r=e&&this._lastActiveLayer&&this._lastActiveLayer.uniqueId===e.uniqueId;this._lastActiveLayer=e,this._bindKeypressEvents(),this._controls&&(this.showActiveLayer(e),this._updateSliderState()),!r&&this._nodeImageQualityMessage&&this._removeQualityAlert(!1),i&&!r&&this._lastActiveLayer&&PF.MockupGenerator.Tracking.unblockEvent("transparency-warning-show"),t||this._par.templates.setActiveLayer(e,i)},_onArrowKeyPress:function(e){if(!this._par.disableLayerManipulations&&this._par.isResizable)if(PF.Utils.isInDocument(this.node)){if(e.target.getAttribute("data-prevent"))if(e.target.getAttribute("data-prevent").split(", ").indexOf(e.key)>-1)return;var t=this._getSelectedLayer();if(t){var i=t.position.getClone(),r=["TEXTAREA","INPUT"],n=document.activeElement.className.split(" "),a=["font-dropdown__font"].some((function(e){return n.indexOf(e)>-1}));switch(e.which){case $.ui.keyCode.LEFT:i.left-=.1;break;case $.ui.keyCode.UP:a||(i.top-=.1);break;case $.ui.keyCode.RIGHT:i.left+=.1;break;case $.ui.keyCode.DOWN:a||(i.top+=.1);break;case $.ui.keyCode.BACKSPACE:case $.ui.keyCode.DELETE:!this._par.isCustomizingMode&&r.indexOf(document.activeElement.tagName)<0&&this._onLayerRemoved(this._lastActiveLayer)}switch(e.which){case $.ui.keyCode.LEFT:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:e.preventDefault(),this._par.templates.updateLayerPosition(t,i,this);break;case $.ui.keyCode.BACKSPACE:case $.ui.keyCode.DELETE:r.indexOf(document.activeElement.tagName)<0&&e.preventDefault()}}}else this._unbindKeypressEvents();else this._unbindKeypressEvents()},_onLayerRemoved:function(e){if(this._par.onLayerRemoved)return this._par.onLayerRemoved(e)},displayQualityIndicators:function(){if(this._par.templates){var e=this._getSelectedLayer();if(e){var t=this._par.templates.getTemplateByLayer(e),i=this._par.templates.getQuality(),r=i.getQualityPercent(e,this._par.product),n=t&&t.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY,a=i.getQualityKey(r,e,n,this._par.isCustomizingMode,this._par.product);this._showQualityAlert(a),this._updateQualityText(a,e)}}},displayOutOfBoundsIndicator:function(){if(this._par.templates&&!this._par.disableOutOfBoundsErrorMessages){var e=this._getSelectedLayer();if(e){var t=this._par.templates.getTemplateByLayer(e),i=PF.ProductPush.TemplateQuality.QUALITY_GOOD,r=this._par.templates.getQuality(),n=r.getQualityPercent(e,this._par.product),a=!1;!(this._par.templates.isCoverMode()&&this._par.product&&!(this._par.product.isPhoneCase()||this._par.product.isPoster()||this._par.product.isCanvas()||this._par.product.isFramedPoster()))&&e.isPartiallyOutOfBounds()&&(i=PF.ProductPush.TemplateQuality.QUALITY_MEDIUM),this._par.product&&this._par.product.isEmbroidery()&&t&&t.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY&&e.isTextLayerPartiallyOutOfBounds()&&(i=PF.ProductPush.TemplateQuality.QUALITY_EMBROIDERY,a=!0),!this._par.showImageQualityWarning||a||e.patternType||this._showOutOfBoundsAlert(i,e.isCustomizable);var o=t&&t.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY;(i=r.getQualityKey(n,e,o,this._par.isCustomizingMode,this._par.product))!==PF.ProductPush.TemplateQuality.QUALITY_GOOD?this.displayQualityIndicators():this._removeQualityAlert(!1)}}},displayCustomizableTextLayerError:function(){if(this._par.templates&&this._par.showImageQualityWarning){var e=this._getSelectedLayer();e&&(this._nodeCustomizableTextLayerError&&(this._nodeCustomizableTextLayerError.remove(),this._nodeCustomizableTextLayerError=null),e.isCustomizable&&((e.hasMultipleLines||e.arcAngle)&&(this._nodeCustomizableTextLayerError=this._getCustomizableTextLayerAlertNode(dlang("generator","Personalization tool doesn't support text arcs or multiple lines"))),this._nodeCustomizableTextLayerError&&this._nodeCustomizableTextLayerError.append(this.node)))}},_getSelectedLayer:function(){var e=this._par.templates.getActiveLayer()||this._lastActiveLayer;return e?this._par.templates.getFreshLayer(e):e},_removeOutOfBoundsAlert:function(){this._nodeLayerOutOfBounds.remove(),this._nodeLayerOutOfBounds=null},_removeQualityAlert:function(e,t){this._nodeImageQualityMessage&&(this._shouldHideMediumQualityMessage=e,this._nodeImageQualityMessage.remove(),this._nodeImageQualityMessage=null,this._qualityKey===PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY&&t&&(PF.MockupGenerator.Tracking.trackEvent("transparency-warning-hide",{event:"transparency-warning",eventCategory:"Generator transparency warning message",eventAction:"Message pop-up closed",eventLabel:this._getActiveLayerFileId()}),this._par.templates.closedTransparencyWarnigns[this._lastActiveLayer.uniqueId]=!0,PF.MockupGenerator.Tracking.unblockEvent("transparency-warning-show"),this._onMouseOutQualityAlert()),this._qualityKey=null)},_onMouseOverQualityAlert:function(){var e=this;this._qualityKey===PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY&&(this._transparencyWarningHoverTimeout||(this._transparencyWarningHoverTimeout=[]),this._transparencyWarningHoverTimeout.push(setTimeout((function(){PF.MockupGenerator.Tracking.trackEvent("transparency-warning-hover",{event:"transparency-warning",eventCategory:"Generator transparency warning message",eventAction:"Customer hovered over the message",eventLabel:e._getActiveLayerFileId()},!0)}),4e3)))},_onMouseOutQualityAlert:function(){this._qualityKey===PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY&&(this._transparencyWarningHoverTimeout&&(this._transparencyWarningHoverTimeout.forEach((function(e){return clearTimeout(e)})),this._transparencyWarningHoverTimeout=[]),PF.MockupGenerator.Tracking.unblockEvent("transparency-warning-hover"))},_getActiveLayerFileId:function(){var e=this._par.templates?this._par.templates.getActiveLayer():null;return e.fileItem?e.fileItem.fileId:null},_showQualityAlert:function(e){if(this._par.showImageQualityWarning){var t=e===PF.ProductPush.TemplateQuality.QUALITY_GOOD,i=e===PF.ProductPush.TemplateQuality.QUALITY_MEDIUM,r=this._shouldHideMediumQualityMessage;t||i&&r?this._nodeImageQualityMessage&&this._removeQualityAlert(!1):(this._nodeImageQualityMessage||(this._nodeImageQualityMessage=this._getQualityAlertNode()),this._nodeImageQualityMessage.append(this.node),this._updateQualityAlertText(e),e===PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY&&this._nodeImageQualityMessage.className&&this._lastActiveLayer&&!this._par.templates.closedTransparencyWarnigns[this._lastActiveLayer.uniqueId]&&PF.MockupGenerator.Tracking.trackEvent("transparency-warning-show",{event:"transparency-warning",eventCategory:"Generator transparency warning message",eventAction:"Message appeared",eventLabel:this._getActiveLayerFileId()},!0),this._qualityKey=e)}},_showOutOfBoundsAlert:function(e,t){e===PF.ProductPush.TemplateQuality.QUALITY_GOOD?this._nodeLayerOutOfBounds&&this._removeOutOfBoundsAlert():(this._nodeLayerOutOfBounds||(this._nodeLayerOutOfBounds=this._getOutOfBoundsAlertNode(t)),this._nodeLayerOutOfBounds.append(this.node))},_getQualityAlertNode:function(){return tag("div",{prop:{onmouseover:this._onMouseOverQualityAlert.bind(this),onmouseleave:this._onMouseOutQualityAlert.bind(this)}},[this._nodeImageQualityMessageText=tag("span"),this._nodeImageQualityMessageClose=tag("a",{className:"generator-mockup__warning-close",innerHTML:"&times;",onclick:this._removeQualityAlert.bind(this,!0,!0)})])},_getOutOfBoundsAlertNode:function(e){return tag("div","alert alert-warning generator-mockup__error-message",[tag("span","",e?lang("Make sure all design elements fit inside the print area"):lang("Part of your design layer is outside the print area.")),tag("a",{className:"generator-mockup__warning-close",innerHTML:"&times;",onclick:this._removeOutOfBoundsAlert.bind(this)})])},_getCustomizableTextLayerAlertNode:function(e){return tag("div","alert alert-danger generator-mockup__error-message",[tag("span","",e)])},_updateQualityAlertText:function(e){var t=e===PF.ProductPush.TemplateQuality.QUALITY_MEDIUM,i=e===PF.ProductPush.TemplateQuality.TEXT_TOO_SMALL,r=e===PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY,n=this._shouldHideMediumQualityMessage,a=this._par.product.isEmbroidery();if(!(n&&t||r&&this._lastActiveLayer&&this._par.templates.closedTransparencyWarnigns[this._lastActiveLayer.uniqueId]||a)){var o={};o[PF.ProductPush.TemplateQuality.QUALITY_GOOD]="",o[PF.ProductPush.TemplateQuality.QUALITY_MEDIUM]=dlang("generator","We strongly suggest a larger file<br />for better results"),o[PF.ProductPush.TemplateQuality.QUALITY_EMBROIDERY]=PF.VariantPicker.Footer.EMBROIDERY_OUT_OF_BOUNDS,o[PF.ProductPush.TemplateQuality.QUALITY_BAD]=this._par.isCustomizingMode?dlang("generator","This file is too small to generate print files. <br />Please upload a new file."):dlang("generator","The DPI is too small to generate print files. <br />Please either increase the DPI (by scaling down the image) or upload a new file."),o[PF.ProductPush.TemplateQuality.TEXT_TOO_SMALL]=dlang("dashboard","Minimum recommended font size is 0.275  smaller text may not be easily readable."),o[PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_TOO_SMALL]=PF.VariantPicker.Footer.EMBROIDERY_TEXT_TOO_SMALL,o[PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_OVERLAPPING]=PF.VariantPicker.Footer.EMBROIDERY_LAYERS_OVERLAPPING,o[PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY]=dlang("generator",'Your design contains <a href="{url}" target="_blank">semi-transparent elements</a> that may result in a discolored and grainy print. We suggest creating a graphic with solid colors only.').replace("{url}",langUrl("/transparency-in-dtg-files")),this._nodeImageQualityMessage.className="generator-mockup__error-message alert alert-"+{good:"",medium:"warning",bad:"danger",embroidery:"danger",textSmall:"warning",embroideryTextOverlapping:"danger",embroideryTextSmall:"danger",transparencyWarning:"warning"}[e],this._nodeImageQualityMessageText.innerHTML=o[e],t||i||r?mkE.removeClassName(this._nodeImageQualityMessageClose,"hidden"):mkE.addClassName(this._nodeImageQualityMessageClose,"hidden")}},_updateQualityText:function(e,t){if(this._par.isResizable&&!this._par.disableLayerManipulations){mkE.clearNode(this.nodePrintQuality);var i=PF.Components.GeneratorMockup.getQualityMap();tag("span","pf-pr-12",[t instanceof PF.Components.GeneratorMockup.ClipartLayer?dlang("generator","Clipart width"):dlang("generator","File width"),": ",tag("span","pf-bold",t.position.width.toFixed(2))," ",dlang("generator","Height"),": ",tag("span","pf-bold",t.position.height.toFixed(2))]).append(this.nodePrintQuality),tag("span",{innerHTML:t.isVector()?dlang("generator",'Print quality: <span class="pf-bold {0}">{1} / vector graphics</span>').format(i[e][0],i[e][1]):dlang("generator",'Print quality: <span class="pf-bold {0}">{1} / {2} DPI</span>').format(i[e][0],i[e][1],t.getDPI())}).append(this.nodePrintQuality)}},_bindKeypressEvents:function(){this._unbindKeypressEvents(),document.body.addEventListener("keydown",this._onArrowKeyPress)},_unbindKeypressEvents:function(){document.body.removeEventListener("keydown",this._onArrowKeyPress)}},mkE.Base),PF.Components.GeneratorMockup.getQualityMap=function(){var e={};return e[PF.ProductPush.TemplateQuality.QUALITY_GOOD]=["pf-text-green",clang("quality rating","Good")],e[PF.ProductPush.TemplateQuality.QUALITY_MEDIUM]=["pf-text-yellow-dark",clang("quality rating","Average")],e[PF.ProductPush.TemplateQuality.QUALITY_BAD]=["pf-text-red",clang("quality rating","Poor")],e[PF.ProductPush.TemplateQuality.QUALITY_EMBROIDERY]=["pf-text-red",clang("quality rating","Poor")],e[PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY]=["pf-text-yellow-dark",clang("quality rating","Average")],e[PF.ProductPush.TemplateQuality.TEXT_TOO_SMALL]=["pf-text-yellow-dark",clang("quality rating","Average")],e[PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_TOO_SMALL]=["pf-text-red",clang("quality rating","Poor")],e[PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_OVERLAPPING]=["pf-text-red",clang("quality rating","Poor")],e},PF.Components.GeneratorMockup.isGridVisible=null,PF.Components.GeneratorMockup.isZoomedIn=null,PF.Components.GeneratorMockup.resetGrid=function(){PF.Components.GeneratorMockup.isGridVisible=null},PF.Components.GeneratorMockup.resetZoom=function(){PF.Components.GeneratorMockup.isZoomedIn=null}}()},"N47+":function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.GeneratorOptions=Class({originalPosition:null,shouldUseOriginalAreaSize:!1}),PF.Components.GeneratorMockup.GeneratorOptions.fromArray=function(e){var t=new PF.Components.GeneratorMockup.GeneratorOptions;return t.originalPosition=PF.Items.GeneratorPositionItem.fromArray(e.originalPosition),t.shouldUseOriginalAreaSize=e.shouldUseOriginalAreaSize,t}}()},NuwY:function(e,t){!function(){"use strict";PF.ProductPush.DropZoneArea.Par=Class({storeId:0,callback:null,targetNode:null,product:null,activePlacement:null,generatorVariant:null,isModalDesigner:!1,onClick:null,validateAddingLayer:null,getMaxFileLayerCount:null,nodeDomElementDropArea:null,onDropDomElement:null})}()},PSt6:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Validator=Class({DEFAULT_LIMIT_KEY:"DEFAULT",DEFAULT_CHAR_LIMITS:{},_productItem:null,_activeLayer:null,_text:null,_techniqueMemory:null,isCharLimitEnabled:!0,__construct:function(e){this._initCharLimits(),e&&this.setProduct(e)},_initCharLimits:function(){this.DEFAULT_CHAR_LIMITS[this.DEFAULT_LIMIT_KEY]=50,this.DEFAULT_CHAR_LIMITS[PF.Items.ProductItem.TYPE_EMBROIDERY]=25},reset:function(){return this._activeLayer=null,this._productItem=null,this._techniqueMemory=null,this._text=null,this},setProduct:function(e){return e&&(this._productItem=e,this._techniqueMemory=new PF.Utils.TechniqueMemory(this._productItem.productId)),this},setActiveLayer:function(e){return this._activeLayer=e,this},setText:function(e){return this._text=e,this},isValid:function(){return this._activeLayer&&this.isTextValid()},isClipartSizeValid:function(){var e=this._getTechnique();if(!e||[PF.Items.ProductItem.TECHNIQUE_ENGRAVING].indexOf(e)<0||!this._activeLayer.clipartItem)return!0;var t=.12;return[PF.Items.GeneratorClipartGroup.GROUP_LINE_DRAWINGS,PF.Items.GeneratorClipartGroup.GROUP_VALENTINE_DRAWINGS,PF.Items.GeneratorClipartGroup.GROUP_CATS_DOGS,PF.Items.GeneratorClipartGroup.GROUP_LEAVES,PF.Items.GeneratorClipartGroup.GROUP_ONE_LINE_ART].indexOf(this._activeLayer.clipartItem.groupId)>-1&&(t=.2),this._activeLayer.position.height>t},isTextSizeValid:function(){var e=this._getTechnique();if(!e||[PF.Items.ProductItem.TYPE_EMBROIDERY,PF.Items.ProductItem.TECHNIQUE_ENGRAVING,PF.Items.ProductItem.TYPE_JEWELRY].indexOf(e)<0)return!0;if(!this._activeLayer.font||this._activeLayer instanceof PF.Components.GeneratorMockup.TextLayer&&!PF.ProductPush.TextPicker.hasFontLoaded(this._activeLayer.font.fontKey))return!0;var t=this._activeLayer.getOriginalClone();t instanceof PF.Components.GeneratorMockup.TextLayer?PF.TEXT2SVG.TextCalculator(t):t instanceof PF.Components.GeneratorMockup.TextboxLayer&&PF.CANVAS.calculateTextboxPositions(t);var i=t.text.trim().split("\n").length,r=this._getFontOptions();return PF.Items.ProductItem.TECHNIQUE_ENGRAVING===e?t.size>r.minSize:t.position.height/i*t.lineHeight>r.minSize},isTextValid:function(){var e=this._getFontOptions();return!(this.isCharLimitEnabled&&e&&this._text)||e.maxCharacters>=this._text.length},getValidText:function(){var e=this._getFontOptions();return e&&this._text?this._text.substr(0,e.maxCharacters):""},getCharLimit:function(){var e=this._getTechnique()||"DEFAULT",t=this.DEFAULT_CHAR_LIMITS.hasOwnProperty(e)?this.DEFAULT_CHAR_LIMITS[e]:this.DEFAULT_CHAR_LIMITS.DEFAULT,i=this._getFontOptions();return i&&i.maxCharacters?i.maxCharacters:t},_getFontOptions:function(){var e=this._getTechnique();return this._activeLayer.font?(this._activeLayer.font.options.hasOwnProperty(e)?this._activeLayer.font.options[e]:null)||new PF.Items.GeneratorFontItem.Options:null},_getTechnique:function(){var e=this._techniqueMemory?this._techniqueMemory.getTechniqueFromMemory():null;return!e&&this._productItem&&(e=this._productItem.availableTechniques?this._productItem.availableTechniques.slice().shift():this._productItem.type),e}}),PF.Components.GeneratorMockup.Validator.LAYER_LIMITS={},PF.Components.GeneratorMockup.Validator.LAYER_LIMITS[PF.Items.ProductItem.TYPE_EMBROIDERY]=2,PF.Components.GeneratorMockup.Validator.getLayerLimit=function(e){return PF.Components.GeneratorMockup.Validator.LAYER_LIMITS.hasOwnProperty(e)?PF.Components.GeneratorMockup.Validator.LAYER_LIMITS[e]:null}}()},PwNb:function(e,t,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){var t="function"==typeof Map?new Map:void 0;return(a=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return o(e,arguments,l(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)})(e)}function o(e,t,i){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&s(n,i.prototype),n}).apply(null,arguments)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i.d(t,"a",(function(){return d}));var d=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,l(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,e),t}(a(Error))},QxQC:function(e,t,i){"use strict";function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return i}i.d(t,"a",(function(){return a}));var a=function e(t,i,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s.add(this),o.add(this),this.node=mkE({tag:"div",className:"alternative__status-message alternative__status-message--"+i,els:[t]}),a?this.node.append(document.getElementById(a)):this.node.append(document.body),setTimeout(n(this,o,l).bind(this),500),setTimeout(n(this,s,d).bind(this),r+500)},o=new WeakSet,s=new WeakSet;r(a,"TYPE_SUCCESS","success"),r(a,"TYPE_WARNING","warning"),r(a,"TYPE_ERROR","error");var l=function(){mkE.addClassName(this.node,"alternative__status-message--visible")},d=function(){mkE.removeClassName(this.node,"alternative__status-message--visible"),setTimeout(mkE.removeNode.bind(this,this.node),500)}},RH5U:function(e,t){function i(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}!function(){"use strict";var e,t;PF.ProductPush.Live3dView=Class({_par:null,_camera:null,_scene:null,_renderer:null,_model:null,_material:null,_loadedJsFilesCount:null,_loadedJFilesNeeded:null,_mapObj:null,__construct:function(e){this._par=e,this.node=tag("div","live-3d-view",[this._nodeStatus=tag("div","pf-d-none"),this._nodeMain=tag("div","live-3d-view__main")]),this._validate3dViewCreation()&&PF.Utils.AsyncJsLoader.loadResourcesAsync(PF.ASSETS_URL+PF.ProductPush.Live3dView.PATH_THREE_JS,[PF.ASSETS_URL+PF.ProductPush.Live3dView.PATH_OBJ_LOADER_JS,PF.ASSETS_URL+PF.ProductPush.Live3dView.PATH_ORBIT_CONTROLS_JS],this._generate3d.bind(this))},_validate3dViewCreation:function(){var e,t=null===(e=this._par.getSelectedVariant())||void 0===e?void 0:e.templateId;return PF.ProductPush.Live3dView.getMapObject(this._par.productId,t)?this._par.mockup&&this._par.mockup._mockup&&this._par.mockup._mockup._canvas&&this._par.mockup._mockup._canvas._canvas&&this._par.mockup._mockup._canvas._canvas.convertToImagePreview&&this._par.mockup._mockup._canvas._par&&this._par.mockup._mockup._canvas._par.opts?!!this._isWebGlAvailable()||(console.error("WebGl is not available for your browser"),this._setAndShowError(dlang("generator","Failed to load 3D model")),!1):(console.error('Canvas method "convertToImagePreview" is not reachable!'),this._setAndShowError(dlang("generator","Failed to load 3D model")),!1):(console.error("Obj file could not be found for fileMapKey:",fileMapKey),this._setAndShowError(dlang("generator","Failed to load 3D model")),!1)},_generate3d:(e=regeneratorRuntime.mark((function e(t){var i,r,n,a,o,s,l,d,c,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this._setAndShowError(this,dlang("generator","Failed to load 3D model")),e.abrupt("return");case 3:if(e.prev=3,r=null===(i=this._par.getSelectedVariant())||void 0===i?void 0:i.templateId,this._mapObj=PF.ProductPush.Live3dView.getMapObject(this._par.productId,r),this._mapObj){e.next=10;break}return console.error("map config object not defined",this._par.productId,r),this._setAndShowError(this,dlang("generator","Failed to load 3D model")),e.abrupt("return");case 10:if(n=this._mapObj.fillColor||PF.ProductPush.Live3dView.DEFAULT_FILL_COLOR,a=this._par.mockup._mockup._canvas._canvas.convertToImagePreview({multiplier:2,fillColor:n}),!this._mapObj.rowColCount){e.next=16;break}return e.next=15,this._resamplePngFile(this._mapObj.rowColCount,a,n);case 15:a=e.sent;case 16:if((o=PF.ASSETS_URL+this._mapObj.objFile)&&a){e.next=21;break}return console.error("pngImg or objFilePath is not defined"),this._setAndShowError(this,dlang("generator","Failed to load 3D model")),e.abrupt("return");case 21:s=this._par.width,l=this._par.height,this._camera=new THREE.PerspectiveCamera(75,s/l,.1,1e3),this._camera.position.x=this._mapObj.positionX||PF.ProductPush.Live3dView.POSITION_X,this._camera.position.y=this._mapObj.positionY||PF.ProductPush.Live3dView.POSITION_Y,this._camera.position.z=this._mapObj.positionZ||PF.ProductPush.Live3dView.POSITION_Z,(d=new THREE.OrbitControls(this._camera,this._nodeMain)).minDistance=this._mapObj.minDistance||PF.ProductPush.Live3dView.MIN_DISTANCE,d.maxDistance=this._mapObj.maxDistance||PF.ProductPush.Live3dView.MAX_DISTANCE,d.noPan=!0,this._scene=new THREE.Scene,c=new THREE.AmbientLight(PF.ProductPush.Live3dView.AMBIENT_LIGHT_COLOR,PF.ProductPush.Live3dView.AMBIENT_LIGHT_INTENSITY),this._scene.add(c),(u=new THREE.DirectionalLight(PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_COLOR,PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_INTENSITY)).position.set(1,1,1).normalize(),this._scene.add(u),(h=new THREE.DirectionalLight(PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_COLOR,PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_INTENSITY)).position.set(-1,-1,-1).normalize(),this._scene.add(h),this._model=new THREE.Object3D,this._scene.add(this._model),THREE.ImageUtils.crossOrigin="",(new THREE.TextureLoader).load(a,function(e){e.wrapS=THREE.RepeatWrapping,e.generateMipmaps=!1,e.wrapS=e.wrapT=THREE.ClampToEdgeWrapping,e.minFilter=THREE.LinearFilter,this._material=new THREE.MeshPhongMaterial({map:e,needsUpdate:!0,side:THREE.DoubleSide});var t=this._par.getLoaded3dObj();t?this._onObjLoaded(t):new THREE.OBJLoader(new THREE.LoadingManager).load(o,this._onObjLoaded.bind(this),this._onObjLoadProgress,this._onDataLoadError)}.bind(this),null,this._onDataLoadError),this._renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(s,l),this._renderer.setClearColor(16777215,0),this._nodeMain.appendChild(this._renderer.domElement),this._animate(),e.next=57;break;case 53:e.prev=53,e.t0=e.catch(3),this._setAndShowError(dlang("generator","Failed to load 3D model")),console.error(e.t0);case 57:case"end":return e.stop()}}),e,this,[[3,53]])})),t=function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,l,"next",e)}function l(e){i(o,n,a,s,l,"throw",e)}s(void 0)}))},function(e){return t.apply(this,arguments)}),_getPngDimensions:function(e){e=e.split(",")[1];var t=atob(e.slice(0,50)).slice(16,24),i=Uint8Array.from(t,(function(e){return e.charCodeAt(0)})),r=new DataView(i.buffer);return{width:r.getInt32(0),height:r.getInt32(4)}},_resamplePngFile:function(e,t,i){if(!t)return new Promise((function(e){return e("")}));var r=this._getPngDimensions(t),n=document.createElement("canvas"),a=n.getContext("2d");return n.width=r.width*e,n.height=r.height*e,a.fillStyle=i,a.fillRect(0,0,n.width,n.height),new Promise((function(e,i){var o=new Image;o.onload=function(){a.drawImage(o,0,0,r.width,r.height),e(n.toDataURL())},o.onerror=i,o.src=t}))},_animate:function(){this._animationKey=requestAnimationFrame(this._animate.bind(this)),this._renderer.render(this._scene,this._camera)},stopAnimate:function(){this._animationKey&&cancelAnimationFrame(this._animationKey)},startAnimate:function(){this._animate(),PF.LoadingOverlay.hide(this._par.loadingNode)},_onObjLoaded:function(e){var t,i,r,n,a;e.position.x=(null===(t=this._mapObj)||void 0===t?void 0:t.objPosAdjustX)||0,e.position.y=(null===(i=this._mapObj)||void 0===i?void 0:i.objPosAdjustY)||0,e.position.z=(null===(r=this._mapObj)||void 0===r?void 0:r.objPosAdjustZ)||0,e.traverse(function(e){e instanceof THREE.Mesh&&(e.material=this._material)}.bind(this)),this._model.add(e),this._par.on3dObjectLoaded&&this._par.on3dObjectLoaded(e),this._par.showWarningAlert&&(null===(n=this._mapObj)||void 0===n?void 0:n.showWarning)&&(null===(a=this._mapObj)||void 0===a?void 0:a.warningNode)&&new PF.Components.Alert(this._mapObj.warningNode,"warning",!1,!0,!0,this._par.onWarningAlertClose).prepend(this._nodeMain),PF.LoadingOverlay.hide(this._par.loadingNode)},_onObjLoadProgress:function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(Math.round(t,2)+"% downloaded")}},_onDataLoadError:function(e){this._setAndShowError(dlang("generator","Failed to load 3D model")),console.error(e)},_setAndShowError:function(e){this._nodeStatus.textContent=e,mkE.removeClassName(this._nodeStatus,"pf-d-none"),PF.LoadingOverlay.hide(this._par.loadingNode)},_isWebGlAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}},mkE.Base),PF.ProductPush.Live3dView.DEFAULT_FILL_COLOR="#ffffff",PF.ProductPush.Live3dView.MIN_DISTANCE=1.5,PF.ProductPush.Live3dView.MAX_DISTANCE=5,PF.ProductPush.Live3dView.POSITION_X=0,PF.ProductPush.Live3dView.POSITION_Y=0,PF.ProductPush.Live3dView.POSITION_Z=PF.ProductPush.Live3dView.MIN_DISTANCE,PF.ProductPush.Live3dView.AMBIENT_LIGHT_COLOR=13421772,PF.ProductPush.Live3dView.AMBIENT_LIGHT_INTENSITY=1,PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_COLOR=15658734,PF.ProductPush.Live3dView.DIRECTIONAL_LIGHT_INTENSITY=.2,PF.ProductPush.Live3dView.PATH_THREE_JS="js/three.min.js",PF.ProductPush.Live3dView.PATH_OBJ_LOADER_JS="js/OBJLoader.min.js",PF.ProductPush.Live3dView.PATH_ORBIT_CONTROLS_JS="js/OrbitControls.min.js",PF.ProductPush.Live3dView.PRODUCT_OBJ_FILE_MAP=[{productId:PF.Items.ProductItem.ID_LEGGINGS_ALL_OVER,templateId:58,objFile:"generator/3d-objects/189-all-over-print-leggings-3d.obj",showWarning:!0,warningNode:[tag("div","pf-h4",dlang("generator","3D view represents size M")),tag("div","",dlang("generator","The design's position and scale may look a little different for other sizes"))]},{productId:PF.Items.ProductItem.ID_GLOSSY_MUG,templateId:43,objFile:"generator/3d-objects/19-11oz-mug.obj",rowColCount:2,minDistance:3,maxDistance:10,positionX:-4,positionZ:.5},{productId:PF.Items.ProductItem.ID_GLOSSY_MUG,templateId:44,objFile:"generator/3d-objects/19-15oz-mug.obj",rowColCount:2,minDistance:3,maxDistance:10,positionX:-.45,positionZ:4,objPosAdjustY:-1.5}],PF.ProductPush.Live3dView.getMapObject=function(e,t){return PF.ProductPush.Live3dView.PRODUCT_OBJ_FILE_MAP.find((function(i){return i.productId===e&&i.templateId===t}))}}()},SBaP:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i.d(t,"a",(function(){return n}));var n=function(){function e(){var t,i,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(i="node")in(t=this)?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r}var t,i,n;return t=e,(i=[{key:"append",value:function(e){return this.node.component=this,this.node.append(e),this}},{key:"prepend",value:function(e){return this.node.component=this,this.node.prepend(e),this}},{key:"remove",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.node.component=this,e&&mkE.destroyNodeComponents(this.node),this.node.remove(),this}},{key:"replace",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return mkE.insertBefore(this.node,e),mkE.removeNode(e,t),this}},{key:"destroy",value:function(){}}])&&r(t.prototype,i),n&&r(t,n),e}()},U4D8:function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryImagePicker.Par=Class({templateChangeListener:null,fileColorMapperPalette:null,currentPlacementId:null,threadColorSelectionLimit:6,embroideryTypePrices:null,onEmbroideryTypeChangedCallback:null,shouldShowExtraPriceForEmbroideryType:null,getSelectedEmbroideryColors:null,onLayerRemoved:function(e){console.error("No callback present for - onLayerRemoved",e)}})}()},ULKP:function(e,t){!function(){"use strict";PF.ProductPush.Pricing.VariantPricesEdit=Class({_component:null,__construct:function(e){this._par=e,this._designData=e.designData,this._shouldShowDigitizationNote=this._isDigitizationNeeded(),this.node=tag("div","product-push-variant-prices-edit-wrapper"),this._render()},_render:function(){mkE.clearNode(this.node),this._createHeaderNode().append(this.node);var e=this._designData.product?this._designData.product.mainCatalogCategoryId:null;this._component=new PF.Sync.VariantPricesEdit({store:this._designData.store,prices:this._getPrices(),initPrices:this._getPrices(!0),isCustomProduct:this._designData.isCustomProduct(),onUpdate:this._onUpdate.bind(this),showDigitizationNote:this._shouldShowDigitizationNote,nonCustomizablePlacementsCount:this._designData.getNonCustomizablePlacementsCount(),customizablePlacementsCount:this._designData.getCustomizablePlacementsCount(),mainCatalogCategoryId:e}),this._component.append(this.node)},_createHeaderNode:function(){var e=tag("div","",null),t=this._designData.store.currency,i=this._designData.store.retailCurrency,r=this._designData.store.retailCurrencyRate,n="";return this._designData.store.hasDifferentRetailCurrency()&&(n=(n=dlang("dashboard","We noticed that your store is in <b>{currentCurrency}</b> and converted pricing to your currency. Feel free to adjust for a more rounded sum (1 {defaultCurrency} is {currencyRate} {currentCurrency}).")).replace("{defaultCurrency}",t).replace("{currencyRate}",r.toPrecision(6)).replace(/{currentCurrency}/g,i),n=tag("p",{innerHTML:n})),tag("div","row",[tag("div","col-xs-10",[n,tag("p","",dlang("dashboard","Choose the mark up price and we'll auto configure your product prices."))])]).append(e),this._designData.store.type===PF.Items.StoreItem.TYPE_AMAZON&&tag("div","row",[tag("div","col-xs-12",[tag("p",{className:"alert alert-warning",innerHTML:dlang("dashboard",'<strong>Important:</strong> Amazon charges you a referral fee for each product sold, up to 15% of your listing price. Read more <a href="{url}" target="_blank" class="pf-link">here</a>.').replace("{url}","https://sellercentral.amazon.com/gp/help/external/200336920?language=en-US&ref=efph_200336920_cont_19211")})])]).append(e),e},_getPrices:function(e){var t=e?this._designData.initPrices:this._designData.prices,i=[];return(t||[]).forEach(function(e){var t=new PF.Items.GeneratorPriceItem.fromArray(e);this._unconvertPrintfulPrice(t),i.push(t)}.bind(this)),i},_unconvertPrintfulPrice:function(e){if(this._designData.store.hasDifferentRetailCurrency()&&!this._designData.isCustomProduct()){var t=this._designData.store.retailCurrencyRate;["originalPrice","originalPriceVD","minOriginalPrice","minOriginalPriceVD"].forEach((function(i){e[i]&&(e[i]=e[i]/t)}))}},_getDesignDataPrice:function(e){return this._designData.prices.find((function(t){return t.priceKey+""==e+""}))},_onUpdate:function(){if(this._component){if(this._component.isValid())(this._component.getValues(!1)||[]).forEach(function(e){var t=this._getDesignDataPrice(e.priceKey);e.retailPrice&&t&&(t.retailPrice=parseFloat(e.retailPrice))}.bind(this));this._par.onUpdate&&this._par.onUpdate()}},_isDigitizationNeeded:function(){if(!this._designData.isEmbroidery())return!1;if(this._designData.hasTextLayers())return!0;for(var e,t,i,r=new PF.Repositories.LibraryRepository,n=this._designData.filesIdsByPlacement,a=Object.keys(n),o=0;o<a.length;o++){t=a[o];for(var s=0;s<n[t].length;s++){if(e=n[t][s],i=r.getCachedFile(e),t===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT){if(this._designData.is3DEmbroidery()&&!i.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_3D))return!0;if(this._designData.isPartial3DEmbroidery()&&!i.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_BOTH))return!0;if(!i.isSample&&this._designData.isFlatEmbroidery()&&!i.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_FLAT))return!0}else if(!i.isSample&&!i.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_FLAT))return!0;if(!i.isDigitized)return!0}}return!1},isValid:function(){return this._component&&this._component.isValid()}},mkE.Base)}()},URgk:function(e,t,i){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(n.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(n.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i("YBdB"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i("yLpj"))},VINB:function(e,t){!function(){"use strict";PF.ProductPush.PatternPicker=Class({__NAME:"PF.ProductPush.PatternPicker",_par:null,_nodeSpacing:null,_nodeTypeButtons:null,__construct:function(e){this._par=e,this._nodeTypeButtons={},this.node=tag("div","",[tag("div","pf-ui-body pf-bold pf-text-dark pf-my-12",dlang("generator","Pattern type")),this._getTypeButton(null,"generator/pattern-none.svg",""),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.BLOCK,"generator/pattern-block.svg",dclang("generator","pattern type","Block")),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.HALFDROP,"generator/pattern-halfdrop.svg",dclang("generator","pattern type","Half drop")),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.BRICK,"generator/pattern-brick.svg",dclang("generator","pattern type","Brick")),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.REFLECT,"generator/pattern-reflect.svg",dclang("generator","pattern type","Reflect")),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.HORIZONTAL,"generator/pattern-horizontal.svg",dclang("generator","pattern type","Horizontal line")),this._getTypeButton(PF.CANVAS.PATTERN_TYPE.VERTICAL,"generator/pattern-vertical.svg",dclang("generator","pattern type","Vertical line")),this._nodeSpacing=this._getSpacingNode()]),this._subscribeTemplateEvents()},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this._unsubscribeTemplateEvents(),!0)},_unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onActiveLayerChangedPattern).unsubscribe(this._onLayerConfigurationChangedPattern).unsubscribe(this._onLayerRemovedPattern)},_subscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnActiveLayerChanged(this._onActiveLayerChangedPattern).addOnLayerConfigurationChanged(this._onLayerConfigurationChangedPattern).addOnLayerRemovedListener(this._onLayerRemovedPattern)},resubscribeToEvents:function(){PF.Utils.isInDocument(this.node)&&this._par.templates&&(this._unsubscribeTemplateEvents(),this._subscribeTemplateEvents(),this._render())},_getTypeButton:function(e,t,i){return this._nodeTypeButtons[e]=tag("button",{className:"pf-bg-white pf-border pf-border-dark pf-p-8 pf-mr-8 pf-mb-8",onclick:this._onTypeClick.bind(this,e),attr:{"data-toggle":"tooltip","data-placement":"top",title:i},style:{opacity:.4}},[tag("img",{className:"pf-d-inline-block",src:PF.ASSETS_URL+t,style:{width:"24px",height:"24px"}})])},_getSpacingNode:function(){var e=new PF.Forms.Range.Par;return e.title=dlang("generator","Spacing"),e.className="pf-my-12",e.value=PF.CANVAS.PATTERN_SPACING.DEFAULT,e.minValue=PF.CANVAS.PATTERN_SPACING.MIN,e.maxValue=PF.CANVAS.PATTERN_SPACING.MAX,e.fractionDigits=2,e.incrementStep=PF.CANVAS.PATTERN_SPACING.STEP,e.hasNumberInput=!0,e.onValueChanged=this._onSpacingChange,e.onSlide=this._onSpacingChange,new PF.Forms.Range(e)},_render:function(){var e=this._par.templates.getActiveLayer();if(e){var t=e&&e.patternType||null,i=e&&e.patternSpacing||PF.CANVAS.PATTERN_SPACING.DEFAULT;this._setType(t),this._nodeSpacing.setValue(i),t?this._nodeSpacing.show():this._nodeSpacing.hide()}},_onTypeClick:function(e,t){t.preventDefault(),this._setType(e);var i=this._par.templates.getActiveLayer();i&&i.patternType!==e&&(i.patternType=e,e?this._nodeSpacing.show():(this._nodeSpacing.setValue(0),i.patternSpacing=0,this._nodeSpacing.hide()),this._notifyLayerPatternChanged(i))},_setType:function(e){for(var t in this._nodeTypeButtons)this._nodeTypeButtons.hasOwnProperty(t)&&(this._nodeTypeButtons[t].style.opacity=.4);this._nodeTypeButtons[e]&&(this._nodeTypeButtons[e].style.opacity=1)},_onSpacingChange:function(e){this._nodeSpacing.value!==String(e)&&this._nodeSpacing.swetValue(e);var t=this._par.templates.getActiveLayer();t&&t.patternSpacing!==e&&(t.patternSpacing=e,this._notifyLayerPatternChanged(t))},_onActiveLayerChangedPattern:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t===this||this._render()},_onLayerConfigurationChangedPattern:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t===this||this._render()},_notifyLayerPatternChanged:function(e){e instanceof PF.Components.GeneratorMockup.ImageLayer?this._par.templates.updateImageLayer(e,this):e instanceof PF.Components.GeneratorMockup.ClipartLayer?this._par.templates.updateClipartLayer(e,this):console.log("Cannot update layer pattern settings!",e)},_onLayerRemovedPattern:function(e,t){if(!this._unsubscribeTemplateEventsIfNeeded()){var i=this._par.templates.getActiveLayer();(!i||t&&t.uniqueId===i.uniqueId)&&this._par.onLayerRemoved&&this._par.onLayerRemoved(t)}},append:function(e){return this.node.append(e),$(this.node).find('[data-toggle="tooltip"]').tooltip({container:document.body}),this}},mkE.Base)}()},VbEi:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"g",(function(){return o})),i.d(t,"k",(function(){return s})),i.d(t,"h",(function(){return l})),i.d(t,"n",(function(){return d})),i.d(t,"j",(function(){return c})),i.d(t,"i",(function(){return u})),i.d(t,"f",(function(){return h})),i.d(t,"e",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"m",(function(){return m})),i.d(t,"l",(function(){return P}));var r=Object.freeze({PERCENTAGE:"%",FIXED:"$"}),n=Object.freeze({CHANGE:"PROFIT_CHANGE_TYPE_CHANGE",INCREASE:"PROFIT_CHANGE_TYPE_INCREASE",DECREASE:"PROFIT_CHANGE_TYPE_DECREASE"}),a=Object.freeze({PROFIT_CHANGE_TYPE_CHANGE:dlang("stores","Change to"),PROFIT_CHANGE_TYPE_INCREASE:dlang("stores","Increase by"),PROFIT_CHANGE_TYPE_DECREASE:dlang("stores","Decrease by")});function o(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?prettyMoney(t,e.retailCurrency):prettyMoney(t,e.currency)}function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.hasDifferentRetailCurrency()?t*e.retailCurrencyRate:i?t:null}function l(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t==PF.Items.PriceItem.DISCOUNT_TYPE_LAUNCH_PRICE?i?e.originalLaunchPrice:e.minOriginalLaunchPrice:t==PF.Items.PriceItem.DISCOUNT_TYPE_VOLUME?i?e.originalPriceVD:e.minOriginalPriceVD:i?e.originalPrice:e.minOriginalPrice}function d(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&l(e,t,!0)!==l(e,t,!1)}function c(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=l(e,t,arguments.length>4&&void 0!==arguments[4]&&arguments[4]),a=r?s(i,n):n;return a?o(i,a,r):null}function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.initPrices:e.prices,i=e.store.hasDifferentRetailCurrency(),r=e.isCustomProduct(),n=e.store.retailCurrencyRate,a=[];return _.forEach(t,(function(e){var t=new PF.Items.GeneratorPriceItem.fromArray(_.clone(e));i&&!r&&function(e,t){["originalPrice","originalPriceVD","minOriginalPrice","minOriginalPriceVD"].forEach((function(i){e[i]&&(e[i]=e[i]/t)}))}(t,n),a.push(t)})),g(a)}function h(e){return _.mapValues(e,(function(e){return p(e)}))}function p(e){return e?PF.Items.GeneratorPriceItem.fromArray(_.clone(e)):null}function g(e){return _.keyBy(e,"priceKey")}function m(e){var t=function(e){var t=(e+"").replace(/,/,".");if(!t||!t.length)return null;var i=_.toNumber(t);return!_.isNaN(i)&&_.isNumber(i)?i:null}(e);return null===t||t<.99}function P(e,t){return!(e||!t)||(!(!e||t)||_.toNumber(e.retailPrice)!==_.toNumber(t.retailPrice))}},Vfa7:function(e,t){!function(){"use strict";PF.ProductPush.PatternPicker.Par=Class({__NAME:"PF.ProductPush.PatternPicker.Par",templates:null,onLayerRemoved:null})}()},VyA4:function(e,t){!function(){"use strict";PF.ProductPush.AdvancedTemplatePicker.Popup=Class({_okCallback:null,_cancelCallback:null,__construct:function(e,t){this._okCallback=e,this._cancelCallback=t,this._render()},_render:function(){var e=new PF.Modal.Par;e.modalDialogClass="modal-md",e.useScrollableModal=!0,this._modal=new PF.Modal(e),this._modal.setHeaderContent("");var t=tag("div","",[tag("div","warning-text",[tag("h4","",lang("Are you sure?")),tag("p","",lang("None of your layer changes will be saved. Are you sure you want to continue switching template type?"))])]);this._modal.setContent(t);var i=tag("div","text-left",[tag("a",{className:"pf-btn pf-btn-primary pf-mr-16",onclick:this._onOkClicked.bind(this)},lang("Yes, continue")),tag("a",{className:"pf-btn pf-btn-secondary",onclick:this._onCancelClicked.bind(this)},lang("No, go back"))]);this._modal.setFooterContent(i),this._modal.show()},_onOkClicked:function(){this._modal.remove(),this._okCallback&&this._okCallback()},_onCancelClicked:function(){this._modal.remove(),this._cancelCallback&&this._cancelCallback()}})}()},WJaN:function(e,t){!function(){"use strict";PF.ProductPush.ColorMapper.Par=Class({colors:null,palette:null,onColorsChanged:null,threadColorSelectionLimit:null,disableDropdown:null,getSelectedEmbroideryColors:null})}()},XJBm:function(e,t){!function(){"use strict";PF.ProductPush.Designer.Observer=Class({_subscribers:{},onSizesChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_SIZES,e)},onAfterSizesChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_AFTER_SIZES,e)},onBeforeColorsChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_BEFORE_COLORS,e)},onAfterColorsChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_AFTER_COLORS,e)},onRegionChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_REGION,e)},onProductOptionsChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_OPTIONS,e)},onPlacementLayersChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_LAYERS,e)},onPlacementPositionsChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_POSITIONS,e)},onDesignerReady:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_READY,e)},onDesignerDisabled:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_DISABLED,e)},onTechniqueChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_TECHNIQUE_CHANGED,e)},onMockupReady:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_MOCKUP_READY,e)},onEmbroideryNotesChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_EMBROIDERY_NOTES_CHANGED,e)},onDesignFillColorChanged:function(e){return this._subscribe(PF.ProductPush.Designer.Observer.CHANNEL_DESIGN_FILL_COLOR_CHANGED,e)},emitBeforeColorsChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_BEFORE_COLORS,e)},emitAfterColorsChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_AFTER_COLORS,e)},emitSizesChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_SIZES,e)},emitAfterSizesChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_AFTER_SIZES,e)},emitRegionChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_REGION,e)},emitProductOptionsChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_OPTIONS,e)},emitPlacementLayersChanged:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_LAYERS,null)},emitPlacementPositionsChanged:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_POSITIONS)},emitDesignerReady:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_READY)},emitDesignerDisabled:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_DISABLED)},emitMainMockupReady:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_MOCKUP_READY)},emitDesignFillColorChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_DESIGN_FILL_COLOR_CHANGED,e)},emitMainTechniqueChanged:function(e){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_TECHNIQUE_CHANGED,e)},emitEmbroideryNotesValueChanged:function(){return this._emit(PF.ProductPush.Designer.Observer.CHANNEL_EMBROIDERY_NOTES_CHANGED)},_subscribe:function(e,t){return this._hasChannelSubscribers(e)||(this._subscribers[e]=[]),this._subscribers[e].push(t),this},_emit:function(e,t){return 0===this._getSubscribersByChannel(e).map((function(e){return!e||e(t)})).filter((function(e){return!1===e})).length},_hasChannelSubscribers:function(e){return this._getSubscribersByChannel(e).length>0},_getSubscribersByChannel:function(e){return this._subscribers[e]||[]}}),PF.ProductPush.Designer.Observer.CHANNEL_BEFORE_COLORS="beforeColors",PF.ProductPush.Designer.Observer.CHANNEL_AFTER_COLORS="afterColors",PF.ProductPush.Designer.Observer.CHANNEL_SIZES="sizes",PF.ProductPush.Designer.Observer.CHANNEL_AFTER_SIZES="afterSizes",PF.ProductPush.Designer.Observer.CHANNEL_REGION="region",PF.ProductPush.Designer.Observer.CHANNEL_OPTIONS="options",PF.ProductPush.Designer.Observer.CHANNEL_LAYERS="layers",PF.ProductPush.Designer.Observer.CHANNEL_POSITIONS="layerPositions",PF.ProductPush.Designer.Observer.CHANNEL_READY="designerReady",PF.ProductPush.Designer.Observer.CHANNEL_DISABLED="designerDisabled",PF.ProductPush.Designer.Observer.CHANNEL_MOCKUP_READY="mockupReady",PF.ProductPush.Designer.Observer.CHANNEL_TECHNIQUE_CHANGED="techniqueChanged",PF.ProductPush.Designer.Observer.CHANNEL_DESIGN_FILL_COLOR_CHANGED="designFillColorChanged",PF.ProductPush.Designer.Observer.CHANNEL_EMBROIDERY_NOTES_CHANGED="embroideryNotesChanged"}()},XPj6:function(e,t){!function(){"use strict";PF.ProductPush.Designer.Par=Class({store:null,product:null,ctaText:lang("Proceed"),onProductDesigned:null,onBack:null,onFooterRender:null,isOrderFlowMode:!1,isFooterVisible:!0,isMockupGeneratorMode:!1,arePickersVisible:!0,updateStickyButtonHeight:null,isProductPushMode:!1,isChangePrintfileMode:!1,onReady:null,designerState:null,orderLineItem:null,onFileRemoved:null,onPositionsChanged:null,onPickerChanged:null,placementDependentOptions:!1,withGlobalDropZone:!0,mockupMainMaxWidth:800,mockupMainMaxHeight:800,pushMockupMainMaxWidth:561,pushMockupMainMaxHeight:561,mockupZoomMaxWidth:1e3,observer:null,generatorParameters:null,generatorDesignKey:"",useGeneratedDesignRpcUrl:!1,disableLayerManipulations:!1,hideZoomButton:!1,hideEmptyPlacements:!1,onActiveLayerChanged:null,disableOutOfBoundsErrorMessages:!1,existingVariants:null,autoLoad:!0,pickerConfig:new PF.VariantPicker.PickersConfig,isCustomizerEnabled:!1,forceOrientation:"",previewMockupVariant:null,isCustomizingMode:!1,isModalDesigner:!1,isCustomizerEnabledJS:!1,defaultPlacementId:null,productTemplateEditorState:null,onLoaderToggle:null,onProductLoaded:null,onCanContinueChange:null,shouldShowPrice:!1,disableDesignerLeaveWarning:!1,isProductPreloaded:!1})}()},XfzR:function(e,t){!function(){"use strict";PF.ProductPush.SyncedProductIds=Class({added:[],failed:[]}),PF.ProductPush.SyncedProductIds.fromArray=function(e){var t=PF.ProductPush.SyncedProductIds;return mkE.O2O(t,e),t}}()},YAAi:function(e,t){!function(){"use strict";PF.ProductPush.PlacementSelector=Class({_placements:[],_selectedPlacement:null,_priceData:null,__construct:function(e,t){this._onSelectPlacement=e,t&&(this._priceData=t),this.node=tag("div","text-center")},setPlacements:function(e){if(this._placements=e,!this._selectedPlacement)for(var t in e){this._selectedPlacement=e[t];break}this._render()},setPriceDataAndRender:function(e){this._priceData=e,this._render()},_render:function(){if(mkE.clearNode(this.node),!(this._placements.length<2)){var e=this._shouldShowPrices(),t=new PF.Components.Tabs("secondary "+(e?"subtitle":""));for(var i in this._placements){var r=this._placements[i],n=this._selectedPlacement&&this._selectedPlacement.id==r.id;!0!==r.hide&&t.add({caption:r.title.replace(/ print$/,""),badge:r.isNew?tag("span","pf-badge pf-badge-small pf-badge--primary pf-ml-4",clang("Badge","New")):"",subtitle:e?this._getPrice(r.id):"",isActive:n,onclick:this._selectPlacement.bind(this,r),customId:r.id})}t.append(this.node)}},_shouldShowPrices:function(){return!!this._priceData&&Object.values(this._priceData).filter((function(e){return e.basePrice||e.finalPrice})).length>0},_selectPlacement:function(e,t){t=void 0===t||t,this._selectedPlacement=e,t&&this._onSelectPlacement(e),this._render()},_getPrice:function(e){if(!this._priceData)return"";if(!this._priceData.hasOwnProperty(e))return"-";var t=this._priceData[e],i="-";return t.basePrice&&t.finalPrice||t.canDisplayPrice||(i=dclang("products","price","Incl")),t.basePrice>0&&t.canDisplayPrice?i="+ "+prettyMoney(t.basePrice,t.currency):t.finalPrice&&(i="+ "+prettyMoney(t.finalPrice,t.currency)),i},getSelectedPlacement:function(){return this._selectedPlacement},getSelectedPlacementId:function(){return this._selectedPlacement?this._selectedPlacement.id:null},setSelectedPlacement:function(e,t){t=void 0!==t&&t,this._selectPlacement(e,t)},deselectPlacement:function(){this._selectedPlacement=null},setSelectedPlacementById:function(e,t){for(var i in this._placements){var r=this._placements[i];if(r.id==e)return void this.setSelectedPlacement(r,t)}}},mkE.Base)}()},YBdB:function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var r,n,a,o,s,l=1,d={},c=!1,u=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){g(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){g(e.data)},r=function(e){a.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(n=u.documentElement,r=function(e){var t=u.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(g,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&g(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(o+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var n={callback:e,args:t};return d[l]=n,r(l),l++},h.clearImmediate=p}function p(e){delete d[e]}function g(e){if(c)setTimeout(g,0,e);else{var t=d[e];if(t){c=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(i,r)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i("yLpj"),i("8oxB"))},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},Z6GA:function(e,t){!function(){"use strict";PF.ProductPush.TaxRulePicker=Class({_storeId:null,__construct:function(e){this._storeId=e,this.node=tag("div","product-push-variant-prices-edit-wrapper pf-mb-16"),this._render()},_render:function(){mkE.clearNode(this.node),mkE({tag:"div",els:[{tag:"label",text:lang("Product tax rule")},{tag:"span",className:"product-push-pricing__select-note",text:dclang("dashboard","Pick a tax rule","Pick one")},this.nodeTaxRulePicker=mkE({tag:"div"})]}).append(this.node),this.loadTaxRules()},getValue:function(){return this.inputTaxRule?this.inputTaxRule.value:null},loadTaxRules:function(){mkE.clearNode(this.nodeTaxRulePicker),mkE({tag:"div",text:lang("Fetching tax rule list")}).append(this.nodeTaxRulePicker),this.inputTaxRule=mkE({tag:"select",className:"product-push-pricing__collection-select",attr:{"data-placeholder":lang("Choose tax rule")}}),(new PF.Repositories.StoreRepository).getTaxRules(this._storeId,this.taxRulesLoaded.bind(this),this.taxRulesFailedToLoad.bind(this))},taxRulesLoaded:function(e){if(mkE.clearNode(this.nodeTaxRulePicker),mkE.clearNode(this.inputTaxRule),0!==e.length){for(var t in mkE({tag:"option",text:""}).append(this.inputTaxRule),e){var i=e[t];mkE({tag:"option",text:i.name,value:i.id}).append(this.inputTaxRule)}mkE({tag:"div",className:"margin-bottom-20 row",els:[{tag:"div",className:"col-lg-8",els:[this.inputTaxRule]}]}).append(this.nodeTaxRulePicker),$(this.inputTaxRule).chosen({width:"100%"})}else this.nodeTaxRulePicker.textContent=lang("We failed to load your tax rules. Please check your store to make sure theyre added correctly")},taxRulesFailedToLoad:function(){mkE.clearNode(this.nodeTaxRulePicker),mkE({tag:"p",els:[{tag:"b",text:lang("We could not retrieve the tax rule list from your store."),style:{color:"#f0473d"}},{tag:"br"},tag("span",null,dclang("dashboard","{@@} parts should wrap clickable text","You can add tax rules to these products manually in your store later or {@@}try again{@@}.").split("{@@}").map(function(e,t){return 1!==t?e:tag("a",{onclick:this.loadTaxRules.bind(this)},e)}.bind(this)))]}).append(this.nodeTaxRulePicker)}},mkE.Base)}()},Z7Gj:function(e,t){!function(){"use strict";PF.ProductPush.DropZoneArea=Class({filesToAdd:[],_enabled:!0,_activePlacement:null,_generatorVariant:null,_dropZone:null,_domElementDropZoneEnabled:!1,_lastInsideLabelType:null,__construct:function(e){this._par=e,this._activePlacement=e.activePlacement,this._generatorVariant=e.generatorVariant,this.node=tag("div","product-push__droparea "+this._getProductDependentClassName(),[tag("img",{className:"img-responsive product-push__droparea__image",prop:{onclick:this._par.onClick,src:langImage("/static/generator/drop-your-design-here.svg")}})]),this._initDropZone()},setActivePlacement:function(e,t){this._activePlacement=e,t&&this._render()},setGeneratorVariant:function(e,t){this._generatorVariant=e,t&&this._render()},_render:function(){this.node.className="product-push__droparea "+this._getProductDependentClassName()},_getProductDependentClassName:function(){var e=[PF.Items.ProductItem.ID_AA_2007,PF.Items.ProductItem.ID_GILDAN_18500,PF.Items.ProductItem.ID_GILDAN_18000,PF.Items.ProductItem.ID_NEX_LEVEL_9700,PF.Items.ProductItem.ID_BELLA_CANVAS_JACKET_3710,PF.Items.ProductItem.ID_BELLA_CANVAS_3501,PF.Items.ProductItem.ID_GILDAN_2400,PF.Items.ProductItem.ID_CHAMPION_CC8C,PF.Items.ProductItem.ID_COTTON_HERITAGE_M2580];switch(!0){case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_RIGHT:return"product-push__droparea--hats-right-side";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_LEFT:return"product-push__droparea--hats-left-side";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_BACK:return"product-push__droparea--hats-back-side";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE&&!(this._par.product.productId===PF.Items.ProductItem.ID_BEAN_BAG||this._par.product.productId===PF.Items.ProductItem.ID_BEAN_BAG_CASE):return"product-push__droparea--label-outside";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE&&this._lastInsideLabelType===PF.Components.InsideLabelTemplate.LABEL_NATIVE:return"product-push__droparea--label-inside-native";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE&&this._lastInsideLabelType===PF.Components.InsideLabelTemplate.LABEL_CUSTOM:return"product-push__droparea--label-inside-custom";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE&&this._par.product.productId===PF.Items.ProductItem.ID_FLIP_FLOPS:return"product-push__droparea--label-inside-flip-flops";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE:return"product-push__droparea--label-inside";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_SLEEVE_LEFT&&this._activePlacement.technique!==PF.Items.ProductItem.TECHNIQUE_CUT_SEW&&e.indexOf(this._par.product.productId)<0:return"product-push__droparea--sleeve-left";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_SLEEVE_RIGHT&&this._activePlacement.technique!==PF.Items.ProductItem.TECHNIQUE_CUT_SEW&&e.indexOf(this._par.product.productId)<0:return"product-push__droparea--sleeve-right";case!this._isPrimaryMockup()&&this._par.product.productId===PF.Items.ProductItem.ID_CUT_SEW_MEN_TANK_TOP:return"product-push__droparea--tank-template";case this._isPrimaryMockup()&&(this._par.product.productId===PF.Items.ProductItem.ID_YOGA_SHORTS||this._par.product.productId===PF.Items.ProductItem.ID_MINI_SKIRT_SUBLIMATION||this._par.product.productId===PF.Items.ProductItem.ID_304_SHORT_SHORTS):return"product-push__droparea--padding-top-3";case this._isPrimaryMockup()&&(this._par.product.productId===PF.Items.ProductItem.ID_LEGGINGS_ALL_OVER_SHORTS||this._par.product.productId===PF.Items.ProductItem.ID_305_LONG_SHORTS||this._par.product.productId===PF.Items.ProductItem.ID_SKATER_SKIRT||this._par.product.productId===PF.Items.ProductItem.ID_PENCIL_SKIRT_SUBLIMATION):return"product-push__droparea--padding-top-7";case this._par.product.productId===PF.Items.ProductItem.ID_KIDS_LEGGINGS:case this._par.product.isEmbroideryApron():case this._par.product.productId===PF.Items.ProductItem.ID_RABBIT_SKINS_1004:case this._par.product.isTote()||this._par.product.isDtgTote():case!this._isPrimaryMockup()&&this._par.product.productId===PF.Items.ProductItem.ID_ALL_OVER_SPORTS_BRA_W_PADDING:return"product-push__droparea--padding-top-45";case this._par.product.productId===PF.Items.ProductItem.ID_SP15_CAP:case this._par.product.productId===PF.Items.ProductItem.ID_82_BEANIE:case this._par.product.productId===PF.Items.ProductItem.ID_YUPOONG_1501KC:return"product-push__droparea--beanies";case this._par.product.productId===PF.Items.ProductItem.ID_BACKPACK:return"product-push__droparea--backpack";case this._par.product.productId===PF.Items.ProductItem.ID_975MPR&&this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_APPAREL_FRONT:return"product-push__droparea--975mpr";case this._par.product.productId===PF.Items.ProductItem.ID_GLOSSY_MUG:case this._par.product.productId===PF.Items.ProductItem.ID_GLOSSY_MUG_USA:return"product-push__droparea--mugs";case this._par.product.productId===PF.Items.ProductItem.ID_MUG_MAGIC_MATTE_BLACK:case this._par.product.productId===PF.Items.ProductItem.ID_MUG_MAGIC_GLOSSY_BLACK:return"product-push__droparea--mugs-black";case this._par.product.productId===PF.Items.ProductItem.ID_FANNYPACK:switch(!0){case this._isPrimaryMockup():return"product-push__droparea--fannypack";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_FRONT:return"product-push__droparea--fannypack-front";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_TOP:return"product-push__droparea--fannypack-top";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_BACK:return"product-push__droparea--fannypack-back";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE:return"product-push__droparea--fannypack-label";case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_POCKET:return"product-push__droparea--fannypack-pocket";default:return""}case this._par.product.isApparelEmbroidery():case this._activePlacement&&this._activePlacement.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_CHEST_LEFT:return"product-push__droparea--embroidery-chest-left";case this._par.product.isBlackMug():return"product-push__droparea--black-mugs";default:return""}},_isPrimaryMockup:function(){return this._generatorVariant&&"primary"===this._generatorVariant.role},setInsideLabelType:function(e){this._lastInsideLabelType=e,this._render()},_clearFiles:function(){this.filesToAdd=[]},_addFilesToPlacements:function(e){for(var t in e){var i=e[t];this._par.callback(i)}this._clearFiles()},_initDropZone:function(){var e=new PF.Components.DropZone.Par;e.targetNode=this._par.targetNode,e.onDone=this._onDone.bind(this),e.getUploadExtra=this._getUploadExtra.bind(this),e.onDragEnter=this._onDragEnter.bind(this),e.onDragLeave=this._onDragLeave.bind(this),e.isPushGenerator=!0,e.getMaxFileLayerCount=this._par.getMaxFileLayerCount,e.validateAddingLayer=this._par.validateAddingLayer,e.elementDropNode=this._par.nodeDomElementDropArea,e.onDropElement=this._onDropDomElement.bind(this),e.enableTransparencyValidation=!0,this._dropZone=new PF.Components.DropZone(e)},_addFile:function(e){this.filesToAdd.push(e)},_onDone:function(e,t){this._addFile(e),0==t&&(this._addFilesToPlacements(this.filesToAdd),this._clearFiles())},_getUploadExtra:function(){return{storeId:this._par.storeId}},_onDragEnter:function(){if(this._enabled){var e=$("body");this._par.isModalDesigner&&(e=$(".modal-content")),$(".product-push__droparea").show(),mkE.addClassName(this.node,"product-push__droparea--active"),$(".modal-backdrop.in").css({opacity:".7"}),e.prepend('<div class="mockup-generator-loading-overlay"></div>')}},_onDragLeave:function(){this._enabled&&($(".mockup-generator-loading-overlay").remove(),mkE.removeClassName(this.node,"product-push__droparea--active"),$(".modal-backdrop.in").css({opacity:".5"}))},isEnabled:function(){return this._enabled},enable:function(){this._enabled=!0,this._dropZone.enable()},disable:function(){this._enabled=!1,this._dropZone.disable()},_onDropDomElement:function(e){this._domElementDropZoneEnabled&&this._par.onDropDomElement&&this._par.onDropDomElement(e,this._activePlacement)},enableDomElementDropZone:function(){this._dropZone.disableBeforeElementDrag(),this._domElementDropZoneEnabled=!0},disableDomElementDropZone:function(){this._domElementDropZoneEnabled=!1,this._dropZone.enableAfterElementDrag()}},mkE.Base)}()},ZbaC:function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.AmazonCategoryInfo=Class({__construct:function(e){this._productId=e,this.node=this._getNode(),$(this._tooltipNode).tooltip()},_getNode:function(){return tag("div","pf-mb-16",[tag("label","pf-d-inline pf-pr-8",lang("Amazon product category:")),this._categoryNode=tag("p","text-muted pf-d-inline pf-pr-4",this._getCategoryName()),this._tooltipNode=mkE({tag:"span",className:"glyphicon glyphicon-info-sign",attr:{title:lang("A valid GTIN exemption is required")}})])},_getCategoryName:function(){return PF.ProductPush.MockupPicker.AmazonCategoryInfo.cachedCategoryNames[this._productId]?PF.ProductPush.MockupPicker.AmazonCategoryInfo.cachedCategoryNames[this._productId]:(RPC("store/get-amazon-product-category",{productId:this._productId},this._onGetCategoryNameRe.bind(this),{error:this._onGetCategoryNameRe.bind(this,null)}),lang("Fetching category"))},_onGetCategoryNameRe:function(e){mkE.clearNode(this._categoryNode),e.categoryName&&(PF.ProductPush.MockupPicker.AmazonCategoryInfo.cachedCategoryNames[this._productId]=e.categoryName,tag("span",null,e.categoryName).append(this._categoryNode))}},mkE.Base),PF.ProductPush.MockupPicker.AmazonCategoryInfo.cachedCategoryNames={}}()},"aH++":function(e,t){!function(){"use strict";PF.ProductPush.Templates=Class({_requiredDpi:null,_userTemplates:{},_changeListeners:null,_quality:null,_activeLayer:null,_par:null,closedTransparencyWarnigns:{},__construct:function(e){this._par=e,this._changeListeners=new PF.ProductPush.TemplateChangeListeners,this._quality=new PF.ProductPush.TemplateQuality(this)},clone:function(){var e={};Object.keys(this._par).forEach(function(t){e[t]=this._par[t]}.bind(this));var t=new PF.ProductPush.Templates(e);this.getRequiredDpi()&&t.setRequiredDpi(this.getRequiredDpi());var i=this.getTemplates()||{};if(i){var r={};Object.keys(i).forEach((function(e){var t=i[e]||{},n={};Object.keys(t).forEach((function(e){var i=t[e];n[e]=i.getCloneWithLayers()})),r[e]=n})),t._userTemplates=r}return this.getActiveLayer()&&t.silentlySetActiveLayer(this.getActiveLayer()),t},setRequiredDpi:function(e){this._requiredDpi=e},getRequiredDpi:function(){return this._requiredDpi},getChangeListener:function(){return this._changeListeners},getQuality:function(){return this._quality},hasTemplates:function(e){return!$.isEmptyObject(this._userTemplates[e])},isPlacementSimple:function(e){if(!this._userTemplates[e])return!0;for(var t in this._userTemplates[e]){var i=this._userTemplates[e][t].layers;if(i.length>1)return!1;for(var r in i)if(!i[r].isSimple())return!1}return!0},isCoverMode:function(){var e=!1;return this._loopTemplates((function(t){e=e||t.isCover()})),e},areTextLayersOverlapping:function(){var e=!1;return this._loopTemplates((function(t){t.areLayersOverlapping(PF.Components.GeneratorMockup.TextLayer,PF.Components.GeneratorMockup.TextboxLayer)&&(e=!0)})),e},getRelatedTemplates:function(e){var t=[];return this._loopTemplates((function(i){e.isRelated(i)&&t.push(i)})),t},setUserTemplateIfMissing:function(e){return this._userTemplates[e.placementId]||(this._userTemplates[e.placementId]={}),!this._userTemplates[e.placementId][e.templateId]&&(this._userTemplates[e.placementId][e.templateId]=e,!0)},overrideLayerImages:function(e,t,i){this._loopTemplates(function(r){if(r.placementId===e)for(var n=0,a=r.layers.length;n<a;n++){var o=r.layers[n];o instanceof PF.Components.GeneratorMockup.ImageLayer&&(o.fileItem.fileId===t&&(o.overrideImage=i,this.getChangeListener().notifyLayerConfigurationChanged(o,this)))}}.bind(this))},getUserTemplate:function(e,t){var i=this._userTemplates[e];if(i&&i[t])return i[t];console.error(dlang("generator","Template is missing."))},reorderLayer:function(e,t){var i=this.getTemplateByLayer(e);this._setLayerIndex(i,e,t);for(var r=i.getMirroredLayers(),n=0,a=r.length;n<a;n++){var o=r[n],s=i.getMirroredLayer(o),l=i.getLayerIndex(s);this._setLayerIndex(i,o,l)}},_setLayerIndex:function(e,t,i){var r=e.getLayerIndex(t);if(!(r<0||i<0||i>=e.layers.length)){var n=e.getMirroredLayer(t),a=-1;n&&(a=e.getLayerIndex(n)),this._loopTemplates((function(t){if(t.layers.length&&t.placementId===e.placementId){var n=t.layers.splice(r,1)[0];if(t.layers.splice(i,0,n),a>-1){var o=t.layers.splice(a,1)[0];t.layers.splice(i,0,o)}}})),this.getChangeListener().notifyLayerOrderChanged()}},getActiveTemplate:function(e){if(!this._activeLayer)return null;var t=this.getTemplateByLayer(this._activeLayer);return t&&t.placementId===e?t:null},getActiveLayer:function(){return this._activeLayer},removeLayer:function(e,t,i,r){if(e){var n=e.getLayerIndex(t);if(n<0)alert(dlang("generator","Layer index WAS NOT FOUND when removing it"));else{var a=e.placementId;this._loopTemplates(function(e){if(e.placementId===a&&e.layers.length){var t=e.layers.splice(n,1)[0];if(t.hasTransparencyIssues&&t.hasTransparencyIssues()&&PF.MockupGenerator.Tracking.trackEvent("transparency-warning-remove-layer",{event:"transparency-warning",eventCategory:"Generator transparency warning message",eventAction:"Graphic file removed",eventLabel:t.fileItem?t.fileItem.fileId:null},!0),t&&(this._activeLayer&&this._activeLayer.uniqueId===t.uniqueId&&(this._activeLayer=null),!i)){var r=e.getMirroredLayer(t);r&&delete r.parentLayerUniqueId}}}.bind(this)),PF.MockupGenerator.Tracking.unblockEvent("transparency-warning-remove-layer"),r||this._changeListeners.notifyLayerRemoved([e],t)}}else console.warn("Removing layer without template!")},changeCustomizableState:function(e,t,i){var r=e.getLayerIndex(t);r<0?console.error("Layer not found"):this._loopTemplates((function(t){if(e.placementId===t.placementId){var n=t.layers[r];n&&(n.isCustomizable=i)}}))},silentlyRemoveAllLayers:function(){this._activeLayer=null,this._loopTemplates(function(e){e.layers=[]}.bind(this))},getByKey:function(e){for(var t in this._userTemplates)for(var i in this._userTemplates[t]){var r=this._userTemplates[t][i];if(r.getKey()===e)return r}alert(dlang("generator","Template by key not found: {key}").replace("{key}",e))},getPlacementIdsHavingFiles:function(e){var t=[];return this._loopTemplates((function(i){i.hasLayers(e)&&-1===t.indexOf(i.placementId)&&t.push(i.placementId)})),t},hasLayersForPlacement:function(e,t){return this.getPlacementIdsHavingFiles(t).indexOf(e)>-1},copyLayersFromTemplates:function(e){var t=e.map((function(e){return e.getKey()})),i=[];if(this._loopTemplates((function(e){i.push(e.getKey())})),i.sort().join()!==t.sort().join())for(var r in this._userTemplates)Object.keys(this._userTemplates[r]).length>0&&(console.log("OVERRIDING OLD LAYERS for "+r),this._userTemplates[r]={});var n=this.silentlyCopyLayers(e);this.getChangeListener().notifyLayersAdded(n)},silentlyCopyLayers:function(e){var t=[];for(var i in e){var r=e[i].getCloneWithLayers();if(!this.setUserTemplateIfMissing(r)){var n=!1,a=this.getUserTemplate(r.placementId,r.templateId);for(var o in r.layers){var s=r.layers[o];if(s instanceof PF.Components.GeneratorMockup.TextLayer)PF.TEXT2SVG.TextCalculator(s);else if(s instanceof PF.Components.GeneratorMockup.TextboxLayer){this._par.getProduct()&&PF.CANVAS.calculateTextboxPositions(s)}s instanceof PF.Components.GeneratorMockup.ImageLayer&&s.overrideColors&&this.getChangeListener().notifyLayerColorsChanged(r.placementId,s),a.layers.push(s),n=!0}n&&t.push(a)}}return t},copyLayersBetweenTemplates:function(e,t,i){var r=this.getUserTemplate(e,i).getCloneWithLayers(),n=this.getUserTemplate(t,i);n.layers=r.layers,this.setFeatureDesignCopied(e,t,i),this.getChangeListener().notifyLayersAdded([n])},copyLayerToPlacementTemplates:function(e,t){for(var i=0,r=t.length;i<r;i++){var n=t[i];e=e.getOriginalClone(!0),this.addLayerToPlacementTemplates(n.id,e,!0)}},addMirroredLayersForTemplates:function(e){Object.keys(this._userTemplates).length||console.error(dlang("generator","Empty user templates, cannot add mirrored layer"));var t=[];this._loopTemplates(function(i){if(i.hasLayers()){for(var r=i.layers.filter((function(t){var r=!(i.getMirroredLayer(t)||t.wasMirrored()&&!e),n=t.patternType;return r&&!n})),n=[],a=0,o=r.length;a<o;a++){var s=r[a];if(this._par.validateAddingLayer(s)){if(s instanceof PF.Components.GeneratorMockup.TextLayer)PF.TEXT2SVG.TextCalculator(s);else if(s instanceof PF.Components.GeneratorMockup.TextboxLayer){this._par.getProduct()&&PF.CANVAS.calculateTextboxPositions(s)}var l=s.getOriginalClone(!0);l.parentLayerUniqueId=s.uniqueId,this._recalculateMirroredPosition(s.position,l.position);var d=i.getLayerIndex(s);i.layers.splice(d,0,l),n.push(l)}}n.length>0&&t.push(i)}}.bind(this)),t.length>0&&this.getChangeListener().notifyLayersAdded(t)},removeMirroredLayersFromTemplates:function(){Object.keys(this._userTemplates).length||alert(dlang("generator","Empty user templates, cant remove mirrored layer")),this._loopTemplates(function(e){var t=e.getMirroredLayers();for(var i in t)this.removeLayer(e,t[i],!0)}.bind(this))},getUniqueFilesForPlacement:function(e){if(!this._userTemplates[e])return[];for(var t in this._userTemplates[e]){var i=[],r=[],n=this.getUserTemplate(e,t).layers;for(var a in n){var o=n[a];o instanceof PF.Components.GeneratorMockup.ImageLayer&&(i.indexOf(o.fileItem.fileId)>-1||(r.push(o.fileItem),i.push(o.fileItem.fileId)))}return r}return[]},getUsedFonts:function(){var e=[];return this._loopTemplates((function(t){e=e.concat(t.layers.filter((function(e){return e.isTextLayer()})).map((function(e){return e.font})).filter((function(e,t,i){return i.indexOf(e)===t})))})),e},getUsedColors:function(e){var t=[];return this._loopTemplates((function(i){e===i.placementId&&(t=t.concat(i.layers.filter((function(e){return e.isTextLayer()})).map((function(e){return e.color})).filter((function(e,t,i){return i.indexOf(e)===t}))))})),t},_loopTemplates:function(e){for(var t in this._userTemplates)for(var i in this._userTemplates[t])e(this._userTemplates[t][i])},resetLayer:function(e){var t=e.position.width,i=e.position.height,r=e.position.getClone().copyPositions(e.originalPosition);e.isTextLayer()&&(r.width=t,r.height=i,r.left=e.position.areaWidth/2-t/2,r.top=e.position.areaHeight/2-i/2),this.updateLayerPosition(e,r)},updateImageLayer:function(e,t,i){if(!(e instanceof PF.Components.GeneratorMockup.ImageLayer))return console.error("Non-image layer given for updating!"),null;var r=e.getOriginalClone(),n=this.getTemplateByLayer(r),a=n.getLayerIndex(r),o=[];this._loopTemplates(function(e){if(e.placementId===n.placementId){var t=e.layers[a];if(t){t.overrideImage=r.overrideImage,t.overrideImagePulse=r.overrideImagePulse,t.patternType=r.patternType,t.patternSpacing=r.patternSpacing,t.flipX=r.flipX,t.flipY=r.flipY;var i=e.getMirroredLayer(t);i&&(i.overrideImage=t.overrideImage,i.overrideImagePulse=t.overrideImagePulse,i.patternType=t.patternType,i.patternSpacing=t.patternSpacing,i.flipX=t.flipX,i.flipY=t.flipY),o.push(e)}}}.bind(this));var s={skipMockupRegeneration:i};return this.getChangeListener().notifyLayerConfigurationChanged(r,t,s),o},updateTextLayer:function(e,t,i,r){if(!e.isTextLayer())return console.error("Non-text layer given for updating!"),null;e=e.getOriginalClone();var n=this.getFreshLayer(e);if(!n)return[];var a=e.isWidthHeightRatioSame(n),o=this.getTemplateByLayer(e),s=this._par.getProduct();(!a||t instanceof PF.ProductPush.TextPicker||t instanceof PF.ProductPush.TextboxPicker||t instanceof PF.ProductPush.Templates)&&!i&&(n.position.rotation=e.position.rotation,e.position=n.position.getFromOriginalRatio(),e instanceof PF.Components.GeneratorMockup.TextLayer?PF.TEXT2SVG.TextCalculator(e):e instanceof PF.Components.GeneratorMockup.TextboxLayer&&s&&PF.CANVAS.calculateTextboxPositions(e)),!e.overrideImage&&!e.overrideImagePulse||a&&e.color===n.color&&e.strokeColor===n.strokeColor&&e.shadowColor===n.shadowColor||(e.overrideImage=null,e.overrideImagePulse=null),"productCustomizer"===t&&(e instanceof PF.Components.GeneratorMockup.TextLayer?PF.TEXT2SVG.TextCalculator(e):e instanceof PF.Components.GeneratorMockup.TextboxLayer&&s&&PF.CANVAS.calculateTextboxPositions(e)),o.layers.splice(o.getLayerIndex(e),1,e);var l=this._updateRelatedTextLayers(o,e);l.push(o);var d=this._repositionLinkedLayers(o,e),c=this._repositionRelatedTemplates(o);l=l.concat(c,o),l=this._filterUniqueTemplates(l);var u={skipMockupRegeneration:r};return d&&(this.getChangeListener().notifyLayerConfigurationChanged(d,"mirror",u),this.getChangeListener().notifyTemplatePositionsChanged(l,d,"mirror",u)),this.getChangeListener().notifyLayerConfigurationChanged(e,t,u),this.getChangeListener().notifyTemplatePositionsChanged(l,e,t,u),l},updateClipartLayer:function(e,t){if(!(e instanceof PF.Components.GeneratorMockup.ClipartLayer))return console.error("Non-clipart layer given for updating!"),null;var i=e.getOriginalClone(),r=this.getTemplateByLayer(i),n=r.getLayerIndex(i),a=[];return this._loopTemplates(function(e){if(e.placementId===r.placementId){var t=e.layers[n];if(t){t.overrideImage=i.overrideImage,t.fillColor=i.fillColor,t.patternType=i.patternType,t.patternSpacing=i.patternSpacing,t.flipX=i.flipX,t.flipY=i.flipY;var o=e.getMirroredLayer(t);o&&(o.overrideImage=t.overrideImage,o.fillColor=t.fillColor,o.patternType=t.patternType,o.patternSpacing=t.patternSpacing,o.flipX=t.flipX,o.flipY=t.flipY),a.push(e)}}}.bind(this)),this.getChangeListener().notifyLayerConfigurationChanged(i,t),a},updateLayerText:function(e,t){this.getChangeListener().notifyLayerConfigurationChanged(e,t)},updateLayerPosition:function(e,t,i,r){var n=this.getTemplateByLayer(e),a=(e=this.getFreshLayer(e)).position.getFromOriginalRatio();e.position=t.getFromOriginalRatio(),e.position.isOutOfBounds()&&e.position.centerHorizontally().centerVertically(),n.layers.splice(n.getLayerIndex(e),1,e);var o=a.isSizeDifferent(e.position),s=a.isPositionDifferent(e.position),l=a.isRotationDifferent(e.position);if(o&&e.isTextLayer()){0!==a.height&&(e.size*=e.position.height/a.height);var d=this.updateTextLayer(e,i);this.getChangeListener().notifyTemplateResized(d,e,i),l&&this.getChangeListener().notifyLayerRotated(e,i)}else{var c=this._repositionLinkedLayers(n,e),u=this._repositionRelatedTemplates(n);u.push(n),(s||o||l||r)&&(c&&this.getChangeListener().notifyTemplatePositionsChanged(u,c,"mirror"),this.getChangeListener().notifyTemplatePositionsChanged(u,e,i)),l&&(c&&this.getChangeListener().notifyLayerRotated(c,"mirror"),this.getChangeListener().notifyLayerRotated(e,i)),o&&(c&&this.getChangeListener().notifyTemplateResized(u,c,"mirror"),this.getChangeListener().notifyTemplateResized(u,e,i))}return e},_filterUniqueTemplates:function(e){var t=[];return e.filter((function(e){return!(t.indexOf(e.getKey())>-1)&&(t.push(e.getKey()),!0)}))},_updateRelatedTextLayers:function(e,t){var i=e.getLayerIndex(t),r=[];return this._loopTemplates(function(n){if(n.placementId===e.placementId&&(r.push(n),n!==e)){var a=n.width/e.width,o=n.layers[i];if(o){o.copyValues(t),o.size=t.size*a;var s=o.position.width,l=o.position.height;o.position.width=t.position.width*a,o.position.height=t.position.height*a,o.position.left+=s/2-o.position.width/2,o.position.top+=l/2-o.position.height/2;this._repositionLinkedLayers(n,o)}}}.bind(this)),r},_repositionRelatedTemplates:function(e){var t=this.getRelatedTemplates(e);if(!t.length)return[];var i=e.layers;for(var r in t){var n=t[r];for(var a in i){var o=n.layers[a];o.position=o.position.getRelativelyPositioned(i[a].position)}}return t},_repositionLinkedLayers:function(e,t){for(var i in e.layers){var r=e.layers[i];if(r.parentLayerUniqueId===t.uniqueId||r.uniqueId===t.parentLayerUniqueId){var n=t.position.getFromOriginalRatio(),a=r.position.getFromOriginalRatio();return r.isTextLayer()&&(r.copyValues(t),a=t.position.getClone()),this._recalculateMirroredPosition(n,a),r.position=a,r}}return null},_recalculateMirroredPosition:function(e,t){var i=e.areaWidth/2,r=i-e.width-e.left;t.left=i+r,t.top=e.top,t.width=e.width,t.height=e.height,t.rotation=e.rotation},getTemplateByLayer:function(e){if(!e)return null;var t=null;return this._loopTemplates((function(i){!t&&i.hasLayer(e.uniqueId)&&(t=i)})),t},getTemplatesByPlacement:function(e){var t=[];return this._loopTemplates((function(i){i.placementId===e&&t.push(i)})),t},getFreshLayer:function(e){var t=this.getTemplateByLayer(e);return t?t.layers[t.getLayerIndex(e)]:null},setActiveLayer:function(e,t,i){var r=!e&&!this._activeLayer||e&&this._activeLayer&&this._activeLayer.uniqueId===e.uniqueId;r&&!i||(e&&(e=this.getFreshLayer(e)),this.silentlySetActiveLayer(e),r&&!i||this.getChangeListener().notifyActiveLayerChanged(e,t))},silentlySetActiveLayer:function(e){this._activeLayer=e},setActiveLayerFromTemplate:function(e,t,i){var r=this.getUserTemplate(e,t),n=r.layers.length-1;if(this._activeLayer){var a=this.getTemplateByLayer(this._activeLayer);a&&a.layers.length===r.layers.length&&(n=a.getLayerIndex(this._activeLayer))}this.setActiveLayer(r.layers[n],i)},silentlyRemoveAllTemplates:function(){this._activeLayer=null,this._userTemplates={}},hasLayers:function(e,t){for(var i in this._userTemplates)if(!t||i===t)for(var r in this._userTemplates[i]){var n=this._userTemplates[i][r];if(n.layers.length){if(!e)return!0;if(n.layers.filter((function(t){return t instanceof e})).length)return!0}}return!1},hasTextLayers:function(e){return this.hasLayers(PF.Components.GeneratorMockup.TextLayer,e)||this.hasLayers(PF.Components.GeneratorMockup.TextboxLayer,e)},getOrientation:function(){var e="";return this._loopTemplates((function(t){e=e||t.width<t.height})),e?PF.Repositories.GeneratorRepository.GeneratorParameters.ORIENTATION_VERTICAL:PF.Repositories.GeneratorRepository.GeneratorParameters.ORIENTATION_HORIZONTAL},duplicateLayer:function(e,t){var i=t.getOriginalClone(!0);return i.parentLayerUniqueId=null,i.position.areaWidth&&i.position.areaHeight||this._calculateDefaultLayerPositions(e,i),i.position.top+=i.position.height/2,i.position.left+=i.position.width/2,e.layers.push(i),i},_getRelatedLayers:function(e,t){var i=e.getLayerIndex(t),r=[];return this._loopTemplates(function(t){t.placementId===e.placementId&&t!==e&&t.layers.length&&t.layers.length>i&&r.push(t.layers[i])}.bind(this)),r},duplicateLayerToPlacementTemplates:function(e){if(this._par.validateAddingLayer(e)){var t=this.getTemplateByLayer(e),i=this.duplicateLayer(t,e),r=[];r.push(t);for(var n=this._getRelatedLayers(t,e),a=0,o=n.length;a<o;a++){var s=n[a],l=this.getTemplateByLayer(s);this.duplicateLayer(l,s),r.push(l)}this.getChangeListener().notifyLayersAdded(r,i),this.setActiveLayer(i)}},addLayerToPlacementTemplates:function(e,t,i,r,n){if(!this._par.validateAddingLayer(t))return this;var a=this._userTemplates[e],o=[],s=this._par.getSelectedMockupVariant(),l=Object.values(a).filter((function(e){return e.templateId===s.templateId}))[0]||Object.values(a)[0],d=t.getOriginalClone(!1),c=l;if(!c)return console.warn("No base/selected template to add layer!",a),this;for(var u in i?d.position.areaWidth===c.width&&d.position.areaHeight===c.height||(d.position.areaWidth=c.width,d.position.areaHeight=c.height,n||(d.position.centerHorizontally(),d.position.centerVertically())):this._calculateDefaultLayerPositions(c,d),c.layers.push(d),o.push(c),a){var h=a[u];if(h.templateId!==l.templateId){var p=t.getOriginalClone(!0);i?p.position.areaWidth===h.width&&p.position.areaHeight===h.height||(p.position.areaWidth=h.width,p.position.areaHeight=h.height,n||(p.position.centerHorizontally(),p.position.centerVertically())):(this._calculateDefaultLayerPositions(h,p),this._calculateScaledLayerPositions(h,p,d,c)),h.layers.push(p),o.push(h)}}return r||this.getChangeListener().notifyLayersAdded(o,t),this},_calculateScaledLayerPositions:function(e,t,i,r){if(t.isTextLayer()){var n=e.width/r.width;t.copyValues(i),t.size=i.size*n;var a=t.position.width,o=t.position.height;t.position.width=i.position.width*n,t.position.height=i.position.height*n,t.position.left+=a/2-t.position.width/2,t.position.top+=o/2-t.position.height/2}},_calculateDefaultLayerPositions:function(e,t){var i=t.originalPosition;if(i.originalRatio=1,i.areaWidth=e.width,i.areaHeight=e.height,i.left=0,i.top=0,i.width=0,i.height=0,t.position=i.getClone(),t instanceof PF.Components.GeneratorMockup.TextLayer)PF.TEXT2SVG.TextCalculator(t);else if(t instanceof PF.Components.GeneratorMockup.TextboxLayer){(r=this._par.getProduct())&&PF.CANVAS.calculateTextboxPositions(t)}else if(t instanceof PF.Components.GeneratorMockup.ImageLayer||t instanceof PF.Components.GeneratorMockup.ClipartLayer){var r;if((t=this._getInitialLayerSize(e,t))instanceof PF.Components.GeneratorMockup.ClipartLayer&&!t.fillColor)(r=this._par.getProduct())&&t.clipartItem&&t.clipartItem.customizable&&(t.fillColor=t.getDefaultColor(r))}else console.error(dlang("generator","Unknown layer type for default position calculation!"));i.width=t.position.width,i.height=t.position.height,i.left=i.areaWidth/2-t.position.width/2,i.top=i.areaHeight/2-t.position.height/2,t.position=i.getClone()},silentlySetDesignerState:function(e){e.hasLayersByPlacement()?this._overrideTemplatePositionsFromDesignerState(e):e.hasTemplates()&&this._setTemplatePositionsFromDesignerState(e)},_overrideTemplatePositionsFromDesignerState:function(e){var t=e.getLayersByPlacement(),i=function(e,i){var r=t[e];if(!r)return null;for(var n in r){var a=r[n];if(a.originalPosition&&a.originalPosition.isAreaSame(i.originalPosition)&&(i.fileItem&&a.fileItem.fileId==i.fileItem.fileId))return a}return null};this._loopTemplates((function(e){for(var t in e.layers){var r=e.layers[t],n=i(e.placementId,r);n&&(r.position=n.position.getClone(),r.originalPosition=n.originalPosition.getClone())}}))},_setTemplatePositionsFromDesignerState:function(e){this._loopTemplates(function(t){var i=e.getTemplateByKey(t.getKey());if(i)t.layers=i.layers.slice(0);else{var r=e.getTemplatesBestMatchingLayers(t);t.layers=r.map((function(e){return this._scaleLayerForTemplate(t,e)}),this)}}.bind(this))},_getInitialLayerSize:function(e,t){var i=t.getInitialScale(e.technique),r=t.getDefaultSize(this.getRequiredDpi()),n=this._getScale(e.width/i,e.height/i,r.width,r.height,e.fillMode);return t.position.width=r.width*n.scale,t.position.height=r.height*n.scale,t},_scaleLayerForTemplate:function(e,t){var i=(t=t.getOriginalClone(!0)).position.getFromOriginalRatio(),r=this._getScale(e.width,e.height,i.areaWidth,i.areaHeight,e.fillMode);return i.areaWidth=e.width,i.areaHeight=e.height,i.left=i.left*r.scale+r.x,i.top=i.top*r.scale+r.y,i.width=i.width*r.scale,i.height=i.height*r.scale,t instanceof PF.Components.GeneratorMockup.TextLayer&&(t.size*=r.scale),t.position=i,t.originalPosition=i.getClone(),t},_getScale:function(e,t,i,r,n){var a=e/i,o=t/r,s=this._par.getOrientation?this._par.getOrientation():null,l="cover"===n?s?o:Math.max(a,o):Math.min(1,a,o);return{scale:l,x:(e-i*l)/2,y:(t-r*l)/2}},getLayerCountByType:function(e,t,i){return this.getLayersByType(e,t,!i,i).length},getLayersByType:function(e,t,i,r){var n=this.getTemplatesByPlacement(t),a=[],o=this.getActiveTemplate(t);if(r)a=this._getLayersByTypeFromTemplate(e,r);else for(var s=0;s<n.length;s++){var l=n[s];(!i||o&&l.templateId===o.templateId)&&(a=a.concat(this._getLayersByTypeFromTemplate(e,l)))}return a},_getLayersByTypeFromTemplate:function(e,t){if(!t)return[];for(var i=[],r=0;r<t.layers.length;r++){var n=t.layers[r];n instanceof e&&i.push(n)}return i},getFirstLayer:function(e,t){var i=null,r=e&&t?this.getUserTemplate(e,t):null;return r?i=r.layers[r.layers.length-1]:this._loopTemplates((function(e){!i&&e.hasLayers()&&(i=e.layers[e.layers.length-1])})),i},getTechnique:function(){var e=null;return this._loopTemplates((function(t){t.technique&&!e&&(e=t.technique)})),e},getTemplates:function(){return this._userTemplates},getLayerByCustomizeKey:function(e){var t=!1;return this._loopTemplates((function(i){i.getLayerByCustomizeKey(e)&&(t=i.getLayerByCustomizeKey(e))})),t},getLayerById:function(e){var t=null;return this._loopTemplates((function(i){for(var r=0,n=i.layers.length;r<n;r++){var a=i.layers[r];if(a.uniqueId===e){t=a;break}}})),t},updateFileLayerByCustomizeKey:function(e,t,i,r){var n=this.getLayerByCustomizeKey(e),a=this.getTemplateByLayer(n),o=a.getLayerIndex(n);t||(t=n.fileItem||n.temporaryFileItem);var s=n.getOriginalClone();t instanceof PF.Items.TemporaryFileItem?(s.temporaryFileItem=t,s.shouldUseTempFile=!0):t instanceof PF.Items.FileItem&&(s.fileItem=t,s.temporaryFileItem=null,s.shouldUseTempFile=!1);var l=t.width/t.height;if(n.generatorOptions.originalPosition.width/n.generatorOptions.originalPosition.height<l){var d=t.height*n.generatorOptions.originalPosition.width/t.width,c=(n.generatorOptions.originalPosition.height-d)/2+n.generatorOptions.originalPosition.top;s.position.width=n.generatorOptions.originalPosition.width,s.position.height=d,s.position.left=n.generatorOptions.originalPosition.left,s.position.top=c}else{var u=t.width*n.generatorOptions.originalPosition.height/t.height,h=(n.generatorOptions.originalPosition.width-u)/2+n.generatorOptions.originalPosition.left;s.position.width=u,s.position.height=n.generatorOptions.originalPosition.height,s.position.left=h,s.position.top=n.generatorOptions.originalPosition.top}this.removeLayer(a,n),this.addLayerToPlacementTemplates(a.placementId,s,!0),this._setLayerIndex(a,s,o);var p=this.getQuality(),g=p.getQualityPercent(s,i),m=p.getQualityKey(g,s,a.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY,!1,i);r&&r(m,e,s.getDPI())},removeCustomizerDataFromAllLayers:function(){this._loopTemplates(function(e){e.layers.forEach(function(e){if(!e.isCustomizable)return!1;var t=e.position;e.isCustomizable=!1,e.isTextLayer()&&this.updateTextLayer(e,this);var i=this.getFreshLayer(e);this._resizeTextLayerFromCustomizedPosition(t,e,i)}.bind(this))}.bind(this));var e=[];this._loopTemplates(function(t){t.layers.forEach(function(t){var i=Object.assign({},t.toArray());e.push(i)}.bind(this))}.bind(this)),PF.Popup.DesignerLeaveWarning.updateInitialStateLayers=e},_resizeTextLayerFromCustomizedPosition:function(e,t,i){if(i.position.width<=e.width)return!1;var r=t.position;r.left=e.left,r.width=t.position.width,r.height=t.position.width/(i.position.width/i.position.height),r.top=e.top+(i.position.height-r.height)/2,this.updateLayerPosition(t,r)},refreshClipartColors:function(e){this._loopTemplates(function(t){t.layers.forEach(function(t){e(t)}.bind(this))}.bind(this))},getDesignMeta:function(){return this._par.getDesignMeta&&this._par.getDesignMeta()},setFeatureDesignCopied:function(e,t,i){var r=this.getDesignMeta(),n=this.getUserTemplate(e,i);if(r&&n){var a={};a[PF.Components.GeneratorMockup.ImageLayer.TYPE]=[],a[PF.Components.GeneratorMockup.ClipartLayer.TYPE]=[],a[PF.Components.GeneratorMockup.TextLayer.TYPE]=[],n.layers.forEach((function(e){e.isImageLayer()?a[PF.Components.GeneratorMockup.ImageLayer.TYPE].push(e.fileItem.fileId):e.isClipartLayer()?a[PF.Components.GeneratorMockup.ClipartLayer.TYPE].push(e.clipartItem.id):e.isTextLayer()&&a[PF.Components.GeneratorMockup.TextLayer.TYPE].push(e.text)})),r[PF.ProductPush.DesignData.META_COPY_DESIGN]={fromPlacementId:e,toPlacementId:t,templateId:i,layers:a}}},removeFeatureDesignCopied:function(e){var t=this.getDesignMeta();if(e&&t&&t[PF.ProductPush.DesignData.META_COPY_DESIGN]&&(t[PF.ProductPush.DesignData.META_COPY_DESIGN].fromPlacementId==e||t[PF.ProductPush.DesignData.META_COPY_DESIGN].toPlacementId==e)){var i=t[PF.ProductPush.DesignData.META_COPY_DESIGN].layers,r=this.getUserTemplate(e,t[PF.ProductPush.DesignData.META_COPY_DESIGN].templateId).layers,n=!!i.hasOwnProperty(PF.Components.GeneratorMockup.ImageLayer.TYPE)&&i[PF.Components.GeneratorMockup.ImageLayer.TYPE].map(Number),a=!!i.hasOwnProperty(PF.Components.GeneratorMockup.ClipartLayer.TYPE)&&i[PF.Components.GeneratorMockup.ClipartLayer.TYPE].map(Number),o=i[PF.Components.GeneratorMockup.TextLayer.TYPE];r.filter((function(e){return n&&e.isImageLayer()?n.indexOf(e.fileItem.fileId)>-1:a&&e.isClipartLayer()?a.indexOf(e.clipartItem.id)>-1:o&&e.isTextLayer()?o.indexOf(e.text)>-1:void 0})).length||(t[PF.ProductPush.DesignData.META_COPY_DESIGN]=!1)}}}),PF.ProductPush.Templates.MISSING_PRINTFILES_WARNING=["default","belt_front","belt_back","belt","back","front","sleeve_right","sleeve_left","top","bottom","pocket","top_front","top_back"]}()},alOy:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("Do4x"),n=i("tK7T"),a=i("CXOy"),o=i("jYDD");function s(e){var t=e.replaceState;e.replaceState=function(e){var i,s,l,d,c=e;(null==c?void 0:null===(i=c.sync)||void 0===i?void 0:i.syncProductsList)&&(c.sync.syncProductsList=new r.g(c.sync.syncProductsList)),(null==c?void 0:null===(s=c.sync)||void 0===s?void 0:s.addSimilarProducts)&&(c.sync.addSimilarProducts=new n.a(c.sync.addSimilarProducts)),(null==c?void 0:null===(l=c.productTemplates)||void 0===l?void 0:l.index)&&(c.productTemplates.index=new a.f(c.productTemplates.index)),(null==c?void 0:null===(d=c.push)||void 0===d?void 0:d.pricing)&&(c.push.pricing=new o.b(c.push.pricing)),t.call(this,c)}}},aqvs:function(e,t){!function(){"use strict";PF.ProductPush.CopyWarningPopup=Class({callback:null,_placementTitle:"",__construct:function(e,t){this._placementTitle=t,this.callback=e,this._render()},_render:function(){var e=new PF.Modal.Par;e.modalDialogClass="modal-md",e.useScrollableModal=!0,this._modal=new PF.Modal(e),this._modal.setHeaderContent("");var t=tag("div","",[tag("div","warning-text",[tag("h4","",dlang("generator","Are you sure?")),tag("p","",dlang("generator","The {placement_title} youre copying the design to already has a design. Do you wish to replace the existing design with the new one?").replace("{placement_title}",this._placementTitle))])]);this._modal.setContent(t);var i=tag("div",{style:{textAlign:"left"}},[tag("a",{className:"pf-btn pf-btn-primary pf-mr-16",onclick:this._callback.bind(this)},dlang("generator","Yes, replace")),tag("a",{className:"pf-btn pf-btn-secondary",onclick:this._modal.remove.bind(this._modal)},dlang("generator","Cancel"))]);this._modal.setFooterContent(i),this._modal.show()},_callback:function(){this._modal.remove(),this.callback()}})}()},axjw:function(e,t){!function(){"use strict";PF.ProductPush.RegionPicker=Class({__NAME:"PF.ProductPush.RegionPicker",activeRegion:"",url:"",DEFAULT_REGION:PF.VariantPicker.RegionPicker.REGION_USA,__construct:function(e,t,i){e=PF.VariantPicker.VariantRegions.getFilteredAvailableRegions(e),this.callback=i,this.availableRegions=e.availableRegions,this.variantsByRegion=e.variantsByRegion,this.activeRegion=t;var r=new PF.Components.RegionPicker.Par;r.regionData=e,r.onChanged=this._onRegionClick,this.regionPicker=new PF.Components.RegionPicker(r),this.node=mkE({tag:"div"}),this.regionPicker._picker.append(this.node),this.url=new Url,this.url.query.region&&this.availableRegions.indexOf(this.url.query.region)>-1&&(this.activeRegion=this.url.query.region),this.setActiveValue(this.activeRegion)},_onRegionClick:function(e){var t=this.activeRegion;this.url.query.region&&(this.url.query.region=e,history.replaceState(null,document.title,this.url)),this.activeRegion=e,this.callback(e,t)},setActiveValue:function(e){-1===this.regionPicker.getActiveItems().indexOf(e)&&(e=this.regionPicker.getFirstActiveItem()),this.regionPicker.setActiveValue(e),this.activeRegion=e,this._onRegionClick(e)},getValueCount:function(){return 1},isValuePicked:function(){return this.activeRegion.length>0},getMatchingVariants:function(){if(!this.activeRegion)return[];var e=new PF.Repositories.Products;return this.getRegionVariants(this.activeRegion).map((function(t){return e.getCachedVariantById(t,!0)}))},getRegionVariants:function(e){return this.variantsByRegion[e]?this.variantsByRegion[e]:[]}},PF.VariantPicker.BasePicker)}()},"b/Os":function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryImagePicker=Class({_par:null,_imageLayer:null,__construct:function(e){this._par=e,this.node=tag("div","image-picker"),this._imageLayer=this._getNewLayer(),this._subscribeToTemplateEvents()},_render:function(e,t){mkE.clearNode(this.node),this._par.currentPlacementId=e;var i=this._imageLayer;if(this._par.fileColorMapperPalette){var r=new PF.ProductPush.EmbroideryTypePicker.Par;r.embroideryTypesAvailable=[PF.Items.OrderLineItemFile.DIGITIZATION_FLAT,PF.Items.OrderLineItemFile.DIGITIZATION_3D],r.embroideryType=i.embroideryType,r.labelTooltipText=lang("We digitize each file to a format that supports embroidery and charge a one-time fee of $6.50 for each embroidery type. You can reuse a digitized file for the same embroidery type with other orders at no additional cost."),r.renderRadioInput=this._par.currentPlacementId===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT,r.embroideryTypePrices=this._par.embroideryTypePrices,r.onEmbroideryTypeChangedCallback=this._par.onEmbroideryTypeChangedCallback,r.showExtraPrice=this._par.shouldShowExtraPriceForEmbroideryType(i),r.nodeFooter=t?tag("div","alert alert-warning",dlang("generator","We have updated our embroidery system. To continue editing, please re-upload your design.")):null,this._embroideryTypePicker=new PF.ProductPush.EmbroideryTypePicker(r),this._embroideryTypePicker.append(this.node),tag("hr").append(this.node);var n=new PF.ProductPush.ColorMapper.Par;n.colors=Object.assign({},i.overrideColors),n.palette=this._par.fileColorMapperPalette,n.onColorsChanged=this._onColorMappingChanged.bind(this,i),n.disableDropdown=t,n.getSelectedEmbroideryColors=this._par.getSelectedEmbroideryColors,n.threadColorSelectionLimit=this._par.threadColorSelectionLimit,this._colorMapper=new PF.ProductPush.ColorMapper(n),this._renderColorMapper()}},_renderColorMapper:function(){this._nodeColorMapper&&mkE.removeNode(this._nodeColorMapper),this._nodeColorMapper=tag("div","pf-mb-24",[tag("h6","",[dlang("generator","Choose thread colors (max {maxThreadColors})").replace("{maxThreadColors}",this._par.threadColorSelectionLimit)]),this._colorMapper]).append(this.node)},_subscribeToTemplateEvents:function(){this._par.templateChangeListener&&this._par.templateChangeListener.addOnLayerRemovedListener(this._onLayerRemovedExternally)},editImageLayer:function(e,t){if(!this._unsubscribeTemplateEventsIfNeeded()){var i=e instanceof PF.Components.GeneratorMockup.ImageLayer;if(e&&i){this._imageLayer=e.getOriginalClone();var r=!(!this._imageLayer.isEmbroideryAfterMigration||this._imageLayer.embroideryType!==PF.Items.OrderLineItemFile.DIGITIZATION_BOTH);this._render(t,r)}}},_onColorMappingChanged:function(e,t){e.overrideColors=t,this._par.templateChangeListener.notifyLayerColorsChanged(this._par.currentPlacementId,e,t,!1)},_onLayerRemovedExternally:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||t.uniqueId===this._imageLayer.uniqueId&&this._par.onLayerRemoved(t)},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this.unsubscribeTemplateEvents(),!0)},unsubscribeTemplateEvents:function(){this._par.templateChangeListener&&this._par.templateChangeListener.unsubscribe(this._onLayerRemovedExternally)},_getNewLayer:function(){return new PF.Components.GeneratorMockup.ImageLayer}},mkE.Base)}()},"bA+e":function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return u}));var r=i("oCYn"),n=i("L2JU"),a=i("e7F3");function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(i,!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d=Object.freeze({PRINTFUL:"PRINTFUL",ECOM:"ECOM",MYORDERS:"MYORDERS",DYNAMIC_INSTANCE:"DYNAMIC_INSTANCE"});function c(e){var t=new e({});Object.defineProperty(e.prototype,"$bus",{get:function(){return t}}),Object.defineProperty(e.prototype,"$eventBus",{get:function(){return t}})}function u(e,t){var i=$("[data-vue-root]");i.length?h(i,e,t):g(e,t)}t.b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.PRINTFUL;e.__PF_CONFIGURED_ALREADY||(e.__PF_CONFIGURED_ALREADY=!0,e.mixin({methods:{prettyMoney:t!==d.ECOM?window.prettyMoney:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return window.prettyMoney(e,t)},xss:function(){window.xss&&window.xss(!0)}}}),e.mixin({methods:{lang:window.lang,nlang:window.nlang,clang:window.clang,nclang:window.nclang,dlang:window.dlang,dnlang:window.dnlang,dclang:window.dclang,dnclang:window.dnclang,langUrl:window.langUrl}}),t===d.DYNAMIC_INSTANCE&&(e.use(a.a),e.use(n.b)),[d.MYORDERS,d.DYNAMIC_INSTANCE].includes(t)||(t===d.PRINTFUL?e.mixin({methods:{asset:function(e){return"".concat(window.PF.ASSETS_URL).concat(e)}}}):t===d.ECOM&&e.mixin({methods:{mObjectSimpleClone:function(e){return JSON.parse(JSON.stringify(e))}}})))};var h=function(e,t,i){var r=Object.keys(t);r.push("router-view"),r.push("router-link");var n=r.filter((function(e){return $(":not([data-vue-root], [data-vue-root] *) > "+e).length}));if(n.length){var a="Initializing the old Vue flow, components outside defined roots found";return console.error(a,n),window.Raven&&window.Raven.captureException(new Error(a),n),void g(t,i)}for(var o=0;o<e.length;o++)p(e[o],t,i)},p=function(e,t,i){var n=e.dataset.vueRoot,a=[];void 0!==e.dataset.vueComponents&&(a=JSON.parse(e.dataset.vueComponents));var o={};a.forEach((function(e){o[e]=t[e]})),new r.a(s({el:e,name:n,components:o},i))},g=function(e,t){new r.a(s({el:"#content",components:e},t))}},c20R:function(e,t){!function(){"use strict";PF.ProductPush.SyncedProductPicker=Class({_loadedSyncProducts:[],_currentPage:1,_totalPages:null,_par:null,_items:[],__construct:function(e){this._par=e,this.node=tag("div","synced-product-add-picker",[this._errorMessage=tag("div"),this._nodeUpperPaging=tag("div"),this._nodeItems=tag("div"),this._nodeDownPaging=tag("div")]),this.sync=new PF.Repositories.SyncRepository,this._rowSelector=new PF.Sync.RowSelector,this._render()},_render:function(){if(this._loadedSyncProducts.length<1)this._renderEmpty();else{mkE.clearNode(this._nodeItems),tag("div",{className:"alert alert-warning",innerHTML:lang('If existing product push fails, give it another go later. E-mail <a href="mailto:support@printful.com">support@printful.com</a> if nothing changes.')}).append(this._nodeItems);var e=tag("div","row row-flex").append(this._nodeItems),t=0;for(var i in this._items.splice(0),this._loadedSyncProducts){t+=1;var r=this._loadedSyncProducts[i],n=new PF.ProductPush.SyncedProductPicker.Item(r,this._shouldNewItemBeSelected.bind(this),this._onItemSelectedCallback.bind(this),this._getStatus(r)).append(e);this._items.push(n),t%4==0&&tag("div","clearfix visible-sm visible-md visible-lg").append(e),t%2==0&&tag("div","clearfix visible-xs").append(e)}this._getPaging(this._nodeUpperPaging),this._getPaging(this._nodeDownPaging)}},_renderEmpty:function(){mkE.clearNode(this._nodeItems),mkE.clearNode(this._nodeUpperPaging),mkE.clearNode(this._nodeDownPaging);var e=this.par&&this.par.searchKeyword?this.par.searchKeyword:null;tag("div",{className:"text-center",style:{height:"180px"}},[tag("div",{className:"alert alert-warning",innerHTML:e?lang('Sorry, couldn\'t find any synced products by "{searchKeyword}"').replace("{searchKeyword}",tag("b",{text:e}).outerHTML):lang("Sorry, couldn't find any synced products")})]).append(this._nodeItems)},_getPaging:function(e){mkE.clearNode(e);var t=new PF.Components.Paging.Par;t.page=this._currentPage,t.pages=this._totalPages,t.callback=this._loadPage.bind(this),new PF.Components.Paging(t).append(e)},_loadPage:function(e){this._currentPage=e,this._load()},load:function(){this._load()},_load:function(){PF.LoadingOverlay.show(this.node,{minHeight:180});var e=new PF.Repositories.SyncRepository.GetPar;e.callback=this._loadRe.bind(this),e.page=this._currentPage,e.perPage=12,e.storeId=this._par.sourceStoreId,e.targetStoreId=this._par.targetStoreId,e.syncedProductType=this._par.type,this.sync.getSyncedProducts(e)},_loadRe:function(e){this._loadedSyncProducts=e.items,this._currentPage=e.page,this._totalPages=e.pages,PF.LoadingOverlay.hide(this.node),this._render(),this._par.onProductCountUpdatedCallback&&this._par.onProductCountUpdatedCallback(this._rowSelector.getSelectedRows().length)},_shouldNewItemBeSelected:function(e){var t=e.getSyncProduct(),i=this._rowSelector.getSelectedRows();for(var r in i){var n=i[r];if(n.getSyncProduct().syncProductId===t.syncProductId)return n!=e&&this._rowSelector.replaceRow(n,e),!0}return!1},_onItemSelectedCallback:function(e){this._rowSelector.toggleSelectedRow(e),this._par.onProductCountUpdatedCallback&&this._par.onProductCountUpdatedCallback(this._rowSelector.getSelectedRows().length)},getSelectedProducts:function(){return this._rowSelector.getSelectedRows()},getItems:function(){return this._items},_getStatus:function(e){return this._par.addedFailedProductIds?-1!==this._par.addedFailedProductIds.failed.indexOf(e.syncProductId)?PF.ProductPush.SyncedProductCounts.TYPE_FAILED:-1!==this._par.addedFailedProductIds.added.indexOf(e.syncProductId)?PF.ProductPush.SyncedProductCounts.TYPE_ADDED:void 0:null},selectAllRows:function(){for(var e in this._rowSelector.setSelectedRows(this._items),this._items)this._items[e].setChecked(!0),this._items[e]._nodeCheckboxInput.setChecked(!0);this._par.onProductCountUpdatedCallback&&this._par.onProductCountUpdatedCallback(this._rowSelector.getSelectedRows().length)},deselectAllRows:function(){for(var e in this._items)this._items[e].setChecked(!1),this._items[e]._nodeCheckboxInput.setChecked(!1);this._rowSelector.removeSelectedRows(this._items),this._par.onProductCountUpdatedCallback&&this._par.onProductCountUpdatedCallback(this._rowSelector.getSelectedRows().length)},showError:function(e){tag("div",{className:"alert alert-danger",text:e}).append(this._errorMessage)},hideError:function(){mkE.clearNode(this._errorMessage)}},mkE.Base)}()},c50J:function(e,t){!function(){"use strict";PF.ProductPush.TextboxPicker.Par=Class({templates:null,onLayerCreated:function(e,t,i){console.error("No callback present for - onLayerCreated",e,t,i)},onLayerRemoved:function(e){console.error("No callback present for - onLayerRemoved",e)},onLayerConfigurationChanged:function(e){console.error("No callback present for - onLayerConfigurationChanged",e)},product:null,placementSelector:null,allowCustomizableLayers:null,technique:null,onBackCallback:null,isAdvancedTemplate:null,isAllOver:null,threadColorSelectionLimit:null,embroideryTypePrices:null,getSelectedEmbroideryColors:null})}()},cVO5:function(e,t){!function(){"use strict";PF.ProductPush.CanCustomizeCheckbox.Par=Class({isChecked:null,onChange:null,showSlider:null,onSliderChange:null,layerType:null})}()},dTyb:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Actions=Class({_buttons:[],__construct:function(){this.node=tag("div","generator-mockup__actions")},addButton:function(){var e=new PF.Components.GeneratorMockup.Actions.Button;return this._buttons.push(e),e},hasButtons:function(){return!!this._buttons.length},render:function(){return mkE.clearNode(this.node),this._buttons.forEach((function(e){e.render().append(this.node)}),this),this}},mkE.Base)}()},dhaL:function(e,t,i){"use strict";var r,n=i("jYDD"),a=i("Gfrr"),o=i("LvDl"),s=i.n(o),l=i("oCYn"),d=i("VbEi");function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u={state:new n.b,mutations:(r={},c(r,a.h,(function(e,t){for(var i in t)e.hasOwnProperty(i)&&(e[i]=t[i])})),c(r,a.f,(function(e,t){e.prices[t.priceKey]=t})),c(r,a.g,(function(e,t){s.a.isEmpty(t)||l.a.set(e,"prices",Object(d.f)(t))})),c(r,a.d,(function(e,t){var i=t.hasErrors;l.a.set(e,"hasErrors",i)})),c(r,a.e,(function(e){l.a.set(e,"isInitialized",!0)})),r),actions:{},getters:c({},a.c,(function(e){return s.a.mapValues(e.prices,(function(e){return new PF.Items.GeneratorPriceItem.fromArray(s.a.clone(e))}))})),namespaced:!0};t.a={modules:{pricing:u},namespaced:!0}},dxbw:function(e,t){!function(){"use strict";PF.ProductPush.LayerPicker.Item.Par=Class({__NAME:"PF.ProductPush.LayerPicker.Item.Par",templates:null,placements:[],activePlacementId:"",layer:null,onRequestRemoval:null,onRequestCenterVertically:null,onRequestCenterHorizontally:null,onRequestFlipHorizontally:null,onRequestFlipVertically:null,onRequestPositionReset:null,onRequestRotate:null,onColorChanged:null,onClicked:null,onChangeIsCustomizable:null,onDuplicate:null,product:null,onActive:null,onEdit:null,allowCustomizableLayers:null,onRequestFilePicking:null,isAllOver:null,validateAddingLayer:null,showPatternPicker:null,fileCountLimit:null})}()},e2M2:function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryHelper=Class({_par:null,_embroiderySelectedPaletteColors:[],_embroiderySelectedPaletteColorsByLayer:null,_colorizeImageCallStack:[],_showImageQualityWarning:null,lastZoomedInEmbroideryTemplate:null,__construct:function(e){this._par=e},getSelectedPaletteColors:function(){return this._embroiderySelectedPaletteColors},quantizeLayer:function(e,t){var i=this.getFileColorChangerColors(e.id,e.technique),r=Object.keys(i).map((function(e){return i[e].value}));t.embroideryType&&e.id===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT||(t.embroideryType=PF.ProductPush.EmbroideryTypePicker.getDefaultEmbroideryType()),(new PF.Utils.ColorMapper).quantizeWithPaletteColors(t.fileItem.urlPreview,PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_IMAGE_COLORS,r,this._embroiderySelectedPaletteColors,this._par.designerNode,this.onImageQuantized.bind(this,t,e,!1),this._onImageQuantizeError.bind(this))},_onImageQuantizeError:function(){this._imageQualityWarningNode&&mkE.removeNode(this._imageQualityWarningNode);var e=dlang("generator","Your embroidery design can't be created because the file you added contains too many colors or is empty.");new PF.Components.Alert(e,"danger",1e4,!0).prepend(this._par.getNodeMainMockupArea())},onImageQuantized:function(e,t,i,r,n){i||this.customizingDesignWithNewEmbroideryColorPicker()||!(n>PF.ProductPush.EmbroideryHelper.EMBROIDERY_IMAGE_COLOR_COUNT_LIMIT||0===n)||(this._showImageQualityWarning=!0);var a=i;e.overrideColors=r,i||this._par.templates.addLayerToPlacementTemplates(t.id,e,!1,!0),this._par.onLayerColorsChanged&&this._par.onLayerColorsChanged(t.id,e,!1,a,i)},colorizeEmbroideryLayers:function(){if((this._isNewPickerEnabled()||this.customizingDesignWithNewEmbroideryColorPicker())&&this._par.getAvailablePlacements){var e=!1;this._colorizeImageCallStack=[],this._par.getAvailablePlacements().forEach(function(t){this._par.templates.getLayersByType(PF.Components.GeneratorMockup.ImageLayer,t.id).forEach(function(i){i.overrideColors&&(e=!0,this.recolorizeImageLayer(i,t.id,!0,!0,!1))}.bind(this)),this._par.templates.getLayersByType(PF.Components.GeneratorMockup.TextLayer,t.id).forEach(function(e){this._par.scheduleEmbroideryPreviewUpdate&&this._par.scheduleEmbroideryPreviewUpdate(t.id,e,!0)}.bind(this)),this._par.templates.getLayersByType(PF.Components.GeneratorMockup.TextboxLayer,t.id).forEach(function(e){this._par.scheduleEmbroideryPreviewUpdate&&this._par.scheduleEmbroideryPreviewUpdate(t.id,e,!0)}.bind(this))}.bind(this)),!e&&this._par.onAllImagesProcessed&&this._par.onAllImagesProcessed()}},recolorizeImageLayer:function(e,t,i,r,n){r&&this._colorizeImageCallStack.push(e.uniqueId),PF.LoadingOverlay.show(this._par.designerNode),(new PF.Utils.ColorMapper).colorizeImage(e.fileItem.urlPreview,Object.keys(e.overrideColors),Object.values(e.overrideColors),this._onImageRecolorized.bind(this,e,t,i,r,n))},_onImageRecolorized:function(e,t,i,r,n,a){var o;if(this._par.getSelectedPlacementId)if(e.overrideImage=a,e.overrideImagePulse=null,this.updateSelectedEmbroideryPaletteColors(e),r)this._colorizeImageCallStack.pop(),0===this._colorizeImageCallStack.length&&(n&&this.recalcGlobalSelectedEmbroiderySelectedColors(),this._par.onAllImagesProcessed&&(o=this._par.onAllImagesProcessed,this._par.onAllImagesProcessed()),PF.LoadingOverlay.hide(this._par.designerNode)),this._par.scheduleEmbroideryPreviewUpdate&&this._par.scheduleEmbroideryPreviewUpdate(t,e,i,o);else if(t===this._par.getSelectedPlacementId()){if(this._showImageQualityWarning){this._showImageQualityWarning=!1;var s=this._par.getNodeMainMockupArea();s&&(this._imageQualityWarningNode||(this._imageQualityWarningNode=this._getImageQualityWarningNode()),mkE.insertBefore(this._imageQualityWarningNode,s))}this._par.onAllImagesProcessed&&(o=this._par.onAllImagesProcessed,this._par.onAllImagesProcessed()),setTimeout(function(){this._par.templates.setActiveLayer(e,null,!0),this._par.editImageLayer&&this._par.editImageLayer(e),this._par.scheduleEmbroideryPreviewUpdate&&this._par.scheduleEmbroideryPreviewUpdate(t,e,i,o),PF.LoadingOverlay.hide(this._par.designerNode)}.bind(this),1e3)}},updateSelectedEmbroideryPaletteColors:function(e){this._embroiderySelectedPaletteColorsByLayer||(this._embroiderySelectedPaletteColorsByLayer={});var t=[];if(e){if(e instanceof PF.Components.GeneratorMockup.ImageLayer){var i=Object.values(e.overrideColors);t=i.filter((function(e,t){return e&&i.indexOf(e)==t})).map((function(e){if(e)return new PF.Utils.Colors.Color.fromHex(e)}))}else e.isTextLayer()&&t.push(new PF.Utils.Colors.Color.fromHex(e.color));this._embroiderySelectedPaletteColorsByLayer[e.uniqueId]=t}this.recalcGlobalSelectedEmbroiderySelectedColors()},recalcGlobalSelectedEmbroiderySelectedColors:function(){if(this._isNewPickerEnabled()&&this._par.getSelectedPlacementId){var e=[];if(this._par.templates.getTemplatesByPlacement(this._par.getSelectedPlacementId()).forEach(function(t){for(var i in t.layers){var r=t.layers[i];-1===e.indexOf(r.uniqueId)&&e.push(r.uniqueId)}}.bind(this)),this._embroiderySelectedPaletteColorsByLayer||(this._embroiderySelectedPaletteColorsByLayer={}),this._embroiderySelectedPaletteColorsByLayer)for(var t in this._embroiderySelectedPaletteColors.length=0,e){var i=this._embroiderySelectedPaletteColorsByLayer[e[t]];for(var r in i)if(i[r]){var n=i[r];n.isContainedBy(this._embroiderySelectedPaletteColors)||this._embroiderySelectedPaletteColors.push(n)}}}},hasEmbroideryThreadColorsError:function(){return!!this._isNewPickerEnabled()&&this._embroiderySelectedPaletteColors.length>PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS},getFileColorChangerColors:function(e,t){if(!this._isNewPickerEnabled()||!this._par.isAllOverProduct)return null;var i=PF.ProductPush.TextPicker.getAllAvailableColors(t===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY,e,this._par.product,this._par.isAllOverProduct(),!0);for(var r in i)i[r].value=i[r].value.toLowerCase();return i},manageEmbroiderySelectedColorsOnLayerRemove:function(e){this._embroiderySelectedPaletteColorsByLayer&&this._embroiderySelectedPaletteColorsByLayer[e.uniqueId]&&delete this._embroiderySelectedPaletteColorsByLayer[e.uniqueId],this.recalcGlobalSelectedEmbroiderySelectedColors()},switchToNewEmbrColorPicker:function(){if(this.canSwitchToNewEmbrColorPicker()&&this._par.pickerConfig&&this._par.pickerConfig.productOptionsValues&&this._par.product&&this._par.getAvailablePlacements){console.log("Switching to new embroidery color picker...");var e=this._par.product.getOptionItems(),t=[];if(this._colorizeImageCallStack=[],this._par.getAvailablePlacements().forEach(function(i){if(e.forEach((function(e){-1!==e.getConditionFilesTypes().indexOf(i.id)&&e.type===PF.Items.ProductOptionItem.TYPE_COLOR&&t.push(e.name)})),this._par.templates.hasLayersForPlacement(i.id,PF.Components.GeneratorMockup.ImageLayer)){var r,n=[],a={};e.forEach(function(e){-1!==e.getConditionFilesTypes().indexOf(i.id)&&(e.type===PF.Items.ProductOptionItem.TYPE_COLOR&&-1!==e.getConditionLayerTypes().indexOf(PF.Components.GeneratorMockup.ImageLayer.TYPE)&&n.push(e.name),e.type===PF.Items.ProductOptionItem.TYPE_RADIO&&e.name===PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE&&(r=this._par.pickerConfig.productOptionsValues[e.name]))}.bind(this));var o=Object.keys(this._par.pickerConfig.productOptionsValues).filter((function(e){return-1!==n.indexOf(e)}));for(var s in o){var l=this._par.pickerConfig.productOptionsValues[o[s]];if(l)for(var d in l){var c=l[d].toLowerCase();a[c]||(a[c]=c)}}this._par.templates.getLayersByType(PF.Components.GeneratorMockup.ImageLayer,i.id).forEach(function(e){r||(r=PF.ProductPush.EmbroideryTypePicker.getDefaultEmbroideryType()),e.embroideryType=r,e.migratedToNewPicker=!0,r===PF.Items.OrderLineItemFile.DIGITIZATION_BOTH&&(e.isEmbroideryAfterMigration=!0),this.onImageQuantized(e,i,!0,a)}.bind(this))}var u=function(e){e.embroideryType=PF.Items.OrderLineItemFile.DIGITIZATION_FLAT,e.migratedToNewPicker=!0,this.updateSelectedEmbroideryPaletteColors(e)}.bind(this);this._par.templates.hasLayersForPlacement(i.id,PF.Components.GeneratorMockup.TextLayer)&&(this._par.templates.getLayersByType(PF.Components.GeneratorMockup.TextLayer,i.id).forEach(u),this._par.templates.getLayersByType(PF.Components.GeneratorMockup.TextboxLayer,i.id).forEach(u),this._par.onAllImagesProcessed&&this._par.onAllImagesProcessed())}.bind(this)),this._par.getProductOptionsPicker&&t.length>0){var i=this._par.getProductOptionsPicker();for(var r in t)i.setValue(t[r],null)}}},canSwitchToNewEmbrColorPicker:function(){return this._isNewPickerEnabled()&&!this._par.isCustomizingMode&&this._hasLayersWithoutOverrideColorsOrEmbroideryType()},getEmbrTypeFromDigitizedItem:function(e){if(!e.digitizedItems||!e.digitizedItems.itemList)return null;var t=null;for(var i in e.digitizedItems.itemList){var r=e.digitizedItems.itemList[i];if(r.puffType){if(r.puffType!==PF.Items.OrderLineItemFile.DIGITIZATION_BOTH)return r.puffType;t=r.puffType}}return t},_hasLayersWithoutOverrideColorsOrEmbroideryType:function(){if(!this._par.getAvailablePlacements)return!1;var e=this._par.getAvailablePlacements();for(var t in e){var i=e[t],r=this._par.templates.getLayersByType(PF.Components.GeneratorMockup.ImageLayer,i.id);for(var n in r)if(!r[n].overrideColors&&!r[n].embroideryType)return!0;var a=this._par.templates.getLayersByType(PF.Components.GeneratorMockup.TextLayer,i.id);for(var o in a)if(!a[o].embroideryType)return!0}return!1},_getImageQualityWarningNode:function(){return tag("div","generator-mockup__warning-message generator-mockup__warning-message_image-quality alert alert-warning alert-dismissible text-center pf-mx-0",[tag("button",{className:"close",attr:{"aria-label":lang("Close")},data:{dismiss:"alert"}},""),tag("span","",dlang("generator","Your embroidery design may not turn out as expected  the uploaded file has too many colors or is low quality due to compression."))])},_isNewPickerEnabled:function(){return this._par.shouldAllowFileColorChanger&&this._par.shouldAllowFileColorChanger()},hasLayerWithPartial3dType:function(e){if(!e)return!1;for(var t in e){var i=Object.values(e[t]);for(var r in i){return i[r].layers.some((function(e){return e.embroideryType===PF.Items.OrderLineItemFile.DIGITIZATION_BOTH}))}}return!1},customizingDesignWithNewEmbroideryColorPicker:function(){if(!this._par.isCustomizingMode)return!1;var e=this._par.templates.getFirstLayer();return e&&e.embroideryType},reScheduleEmbroideryPreviewForTemplate:function(){this._par.scheduleEmbroideryPreviewUpdate&&this.lastZoomedInEmbroideryTemplate&&this.lastZoomedInEmbroideryTemplate.layers.forEach(function(e){this._par.scheduleEmbroideryPreviewUpdate(this._par.getSelectedPlacementId(),e,!1)}.bind(this))}}),PF.ProductPush.EmbroideryHelper.prototype.getEmbrTypeForPlacement=function(e,t){var i;if(e)for(var r in e){var n=e[r];if(n&&n.placementId===t){for(var a in n.layers){var o=n.layers[a];i=PF.ProductPush.EmbroideryHelper.prototype._getCommonEmbrType(i,o.embroideryType)}return i}}},PF.ProductPush.EmbroideryHelper.prototype._getCommonEmbrType=function(e,t){return e&&e!==t?PF.Items.OrderLineItemFile.DIGITIZATION_BOTH:t},PF.ProductPush.EmbroideryHelper.MAX_EMBROIDERY_PREVIEW_AREA=30,PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_IMAGE_COLORS=8,PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS=6,PF.ProductPush.EmbroideryHelper.EMBROIDERY_IMAGE_COLOR_COUNT_LIMIT=32,PF.ProductPush.EmbroideryHelper.EMBROIDERY_NONE_COLOR_BE_LCASE_VALUE="transparent"}()},e7F3:function(e,t,i){"use strict";var r=function(e){return L(["text","password","search","email","tel","url","textarea","number"],e.type)},n=function(e){return L(["radio","checkbox"],e.type)},a=function(e,t){return e.getAttribute("data-vv-"+t)},o=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return e.every((function(e){return null==e}))},s=function(e,t){if(e instanceof RegExp&&t instanceof RegExp)return s(e.source,t.source)&&s(e.flags,t.flags);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!s(e[i],t[i]))return!1;return!0}return m(e)&&m(t)?Object.keys(e).every((function(i){return s(e[i],t[i])}))&&Object.keys(t).every((function(i){return s(e[i],t[i])})):e===t},l=function(e){return o(e)?null:"FORM"===e.tagName?e:o(e.form)?o(e.parentNode)?null:l(e.parentNode):e.form},d=function(e,t,i){if(void 0===i&&(i=void 0),!e||!t)return i;var r=t;return e.split(".").every((function(e){return e in r?(r=r[e],!0):(r=i,!1)})),r},c=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i={cancelled:!1}),0===t?e:function(){for(var n=[],a=arguments.length;a--;)n[a]=arguments[a];var o=function(){r=null,i.cancelled||e.apply(void 0,n)};clearTimeout(r),(r=setTimeout(o,t))||e.apply(void 0,n)};var r},u=function(e,t){return t?e?("string"==typeof t&&(t=h(t)),v({},t,h(e))):h(t):h(e)},h=function(e){return e?m(e)?Object.keys(e).reduce((function(t,i){var r=[];return r=!0===e[i]?[]:Array.isArray(e[i])?e[i]:m(e[i])?e[i]:[e[i]],!1!==e[i]&&(t[i]=r),t}),{}):"string"!=typeof e?(p("rules must be either a string or an object."),{}):e.split("|").reduce((function(e,t){var i=function(e){var t=[],i=e.split(":")[0];return L(e,":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:i,params:t}}(t);return i.name?(e[i.name]=i.params,e):e}),{}):{}},p=function(e){console.warn("[vee-validate] "+e)},g=function(e){return new Error("[vee-validate] "+e)},m=function(e){return null!==e&&e&&"object"==typeof e&&!Array.isArray(e)},_=function(e){return"function"==typeof e},P=function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},f=function(e,t,i){if(e&&t){if(!Array.isArray(t))return i?function(e,t){e.classList?e.classList.add(t):P(e,t)||(e.className+=" "+t)}(e,t):void function(e,t){if(e.classList)e.classList.remove(t);else if(P(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ")}}(e,t);t.forEach((function(t){return f(e,t,i)}))}},y=function(e){if(_(Array.from))return Array.from(e);for(var t=[],i=e.length,r=0;r<i;r++)t.push(e[r]);return t},v=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];if(_(Object.assign))return Object.assign.apply(Object,[e].concat(t));if(null==e)throw new TypeError("Cannot convert undefined or null to object");var r=Object(e);return t.forEach((function(e){null!=e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))})),r},b=0,C="{id}",T=function(e,t){for(var i=Array.isArray(e)?e:y(e),r=0;r<i.length;r++)if(t(i[r]))return i[r]},I=function(e){if(!e)return!1;var t=e.componentOptions.tag;return/^(keep-alive|transition|transition-group)$/.test(t)},k=function(e){if("number"==typeof e)return e;if("string"==typeof e)return parseInt(e);var t={};for(var i in e)t[i]=parseInt(e[i]);return t},E=function(e,t){return m(e)&&m(t)?(Object.keys(t).forEach((function(i){var r,n;if(m(t[i]))return e[i]||v(e,((r={})[i]={},r)),void E(e[i],t[i]);v(e,((n={})[i]=t[i],n))})),e):e},S=function(e,t){if(e.required&&(t=u("required",t)),r(e))return"email"===e.type&&(t=u("email"+(e.multiple?":multiple":""),t)),e.pattern&&(t=u({regex:e.pattern},t)),e.maxLength>=0&&e.maxLength<524288&&(t=u("max:"+e.maxLength,t)),e.minLength>0&&(t=u("min:"+e.minLength,t)),"number"===e.type&&(t=u("decimal",t),""!==e.min&&(t=u("min_value:"+e.min,t)),""!==e.max&&(t=u("max_value:"+e.max,t))),t;if(function(e){return L(["date","week","month","datetime-local","time"],e.type)}(e)){var i=e.step&&Number(e.step)<60?"HH:mm:ss":"HH:mm";if("date"===e.type)return u("date_format:YYYY-MM-DD",t);if("datetime-local"===e.type)return u("date_format:YYYY-MM-DDT"+i,t);if("month"===e.type)return u("date_format:YYYY-MM",t);if("week"===e.type)return u("date_format:YYYY-[W]WW",t);if("time"===e.type)return u("date_format:"+i,t)}return t},F=function(e){return _(Object.values)?Object.values(e):Object.keys(e).map((function(t){return e[t]}))},L=function(e,t){return-1!==e.indexOf(t)},D=function(e){return Array.isArray(e)&&0===e.length},w="en",A=function(e){void 0===e&&(e={}),this.container={},this.merge(e)},O={locale:{configurable:!0}};O.locale.get=function(){return w},O.locale.set=function(e){w=e||"en"},A.prototype.hasLocale=function(e){return!!this.container[e]},A.prototype.setDateFormat=function(e,t){this.container[e]||(this.container[e]={}),this.container[e].dateFormat=t},A.prototype.getDateFormat=function(e){return this.container[e]&&this.container[e].dateFormat?this.container[e].dateFormat:null},A.prototype.getMessage=function(e,t,i){var r=null;return r=this.hasMessage(e,t)?this.container[e].messages[t]:this._getDefaultMessage(e),_(r)?r.apply(void 0,i):r},A.prototype.getFieldMessage=function(e,t,i,r){if(!this.hasLocale(e))return this.getMessage(e,i,r);var n=this.container[e].custom&&this.container[e].custom[t];if(!n||!n[i])return this.getMessage(e,i,r);var a=n[i];return _(a)?a.apply(void 0,r):a},A.prototype._getDefaultMessage=function(e){return this.hasMessage(e,"_default")?this.container[e].messages._default:this.container.en.messages._default},A.prototype.getAttribute=function(e,t,i){return void 0===i&&(i=""),this.hasAttribute(e,t)?this.container[e].attributes[t]:i},A.prototype.hasMessage=function(e,t){return!!(this.hasLocale(e)&&this.container[e].messages&&this.container[e].messages[t])},A.prototype.hasAttribute=function(e,t){return!!(this.hasLocale(e)&&this.container[e].attributes&&this.container[e].attributes[t])},A.prototype.merge=function(e){E(this.container,e)},A.prototype.setMessage=function(e,t,i){this.hasLocale(e)||(this.container[e]={messages:{},attributes:{}}),this.container[e].messages[t]=i},A.prototype.setAttribute=function(e,t,i){this.hasLocale(e)||(this.container[e]={messages:{},attributes:{}}),this.container[e].attributes[t]=i},Object.defineProperties(A.prototype,O);var x={default:new A({en:{messages:{},attributes:{},custom:{}}})},N="default",M=function(){};M._checkDriverName=function(e){if(!e)throw g("you must provide a name to the dictionary driver")},M.setDriver=function(e,t){void 0===t&&(t=null),this._checkDriverName(e),t&&(x[e]=t),N=e},M.getDriver=function(){return x[N]};var R=function e(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.vmId=i||null,this.items=t&&t instanceof e?t.items:[]};function V(e){return e.data?e.data.model?e.data.model:!!e.data.directives&&T(e.data.directives,(function(e){return"model"===e.name})):null}function G(e){return V(e)?[e]:function(e){return Array.isArray(e)?e:Array.isArray(e.children)?e.children:e.componentOptions&&Array.isArray(e.componentOptions.children)?e.componentOptions.children:[]}(e).reduce((function(e,t){var i=G(t);return i.length&&e.push.apply(e,i),e}),[])}function z(e){return e.componentOptions?e.componentOptions.Ctor.options.model:null}function B(e,t,i){if(_(e[t])){var r=e[t];e[t]=[r]}Array.isArray(e[t])?e[t].push(i):o(e[t])&&(e[t]=[i])}function U(e,t,i){e.componentOptions&&function(e,t,i){e.componentOptions.listeners||(e.componentOptions.listeners={}),B(e.componentOptions.listeners,t,i)}(e,t,i),function(e,t,i){o(e.data.on)&&(e.data.on={}),B(e.data.on,t,i)}(e,t,i)}function Y(e,t){return e.componentOptions?(z(e)||{event:"input"}).event:t&&t.modifiers&&t.modifiers.lazy?"change":e.data.attrs&&r({type:e.data.attrs.type||"text"})?"input":"change"}function H(e,t){return Array.isArray(t)&&1===t.length?t[0]:t}R.prototype["function"==typeof Symbol?Symbol.iterator:"@@iterator"]=function(){var e=this,t=0;return{next:function(){return{value:e.items[t++],done:t>e.items.length}}}},R.prototype.add=function(e){var t;(t=this.items).push.apply(t,this._normalizeError(e))},R.prototype._normalizeError=function(e){var t=this;return Array.isArray(e)?e.map((function(e){return e.scope=o(e.scope)?null:e.scope,e.vmId=o(e.vmId)?t.vmId||null:e.vmId,e})):(e.scope=o(e.scope)?null:e.scope,e.vmId=o(e.vmId)?this.vmId||null:e.vmId,[e])},R.prototype.regenerate=function(){this.items.forEach((function(e){e.msg=_(e.regenerate)?e.regenerate():e.msg}))},R.prototype.update=function(e,t){var i=T(this.items,(function(t){return t.id===e}));if(i){var r=this.items.indexOf(i);this.items.splice(r,1),i.scope=t.scope,this.items.push(i)}},R.prototype.all=function(e){var t=this;return this.items.filter((function(i){var r=!0,n=!0;return o(e)||(r=i.scope===e),o(t.vmId)||(n=i.vmId===t.vmId),n&&r})).map((function(e){return e.msg}))},R.prototype.any=function(e){var t=this;return!!this.items.filter((function(i){var r=!0,n=!0;return o(e)||(r=i.scope===e),o(t.vmId)||(n=i.vmId===t.vmId),n&&r})).length},R.prototype.clear=function(e){var t=this,i=o(this.vmId)?function(){return!0}:function(e){return e.vmId===t.vmId};o(e)&&(e=null);for(var r=0;r<this.items.length;++r)i(this.items[r])&&this.items[r].scope===e&&(this.items.splice(r,1),--r)},R.prototype.collect=function(e,t,i){var r=this;void 0===i&&(i=!0);var n=!o(e)&&!e.includes("*"),a=function(e){var t=e.reduce((function(e,t){return o(r.vmId)||t.vmId===r.vmId?(e[t.field]||(e[t.field]=[]),e[t.field].push(i?t.msg:t),e):e}),{});return n?F(t)[0]||[]:t};if(o(e))return a(this.items);var s=o(t)?String(e):t+"."+e,l=this._makeCandidateFilters(s),d=l.isPrimary,c=l.isAlt,u=this.items.reduce((function(e,t){return d(t)&&e.primary.push(t),c(t)&&e.alt.push(t),e}),{primary:[],alt:[]});return a(u=u.primary.length?u.primary:u.alt)},R.prototype.count=function(){var e=this;return this.vmId?this.items.filter((function(t){return t.vmId===e.vmId})).length:this.items.length},R.prototype.firstById=function(e){var t=T(this.items,(function(t){return t.id===e}));return t?t.msg:void 0},R.prototype.first=function(e,t){void 0===t&&(t=null);var i=o(t)?e:t+"."+e,r=this._match(i);return r&&r.msg},R.prototype.firstRule=function(e,t){var i=this.collect(e,t,!1);return i.length&&i[0].rule||void 0},R.prototype.has=function(e,t){return void 0===t&&(t=null),!!this.first(e,t)},R.prototype.firstByRule=function(e,t,i){void 0===i&&(i=null);var r=this.collect(e,i,!1).filter((function(e){return e.rule===t}))[0];return r&&r.msg||void 0},R.prototype.firstNot=function(e,t,i){void 0===t&&(t="required"),void 0===i&&(i=null);var r=this.collect(e,i,!1).filter((function(e){return e.rule!==t}))[0];return r&&r.msg||void 0},R.prototype.removeById=function(e){var t=function(t){return t.id===e};Array.isArray(e)&&(t=function(t){return-1!==e.indexOf(t.id)});for(var i=0;i<this.items.length;++i)t(this.items[i])&&(this.items.splice(i,1),--i)},R.prototype.remove=function(e,t,i){if(!o(e))for(var r,n=o(t)?String(e):t+"."+e,a=this._makeCandidateFilters(n),s=a.isPrimary,l=a.isAlt,d=function(e){return s(e)||l(e)},c=0;c<this.items.length;++c)r=this.items[c],(o(i)?d(r):d(r)&&r.vmId===i)&&(this.items.splice(c,1),--c)},R.prototype._makeCandidateFilters=function(e){var t=this,i=function(){return!0},r=function(){return!0},n=function(){return!0},a=function(){return!0},s=function(e){var t=null;if(L(e,":")&&(t=e.split(":").pop(),e=e.replace(":"+t,"")),"#"===e[0])return{id:e.slice(1),rule:t,name:null,scope:null};var i=null,r=e;if(L(e,".")){var n=e.split(".");i=n[0],r=n.slice(1).join(".")}return{id:null,scope:i,name:r,rule:t}}(e),l=s.id,d=s.rule,c=s.scope,u=s.name;if(d&&(i=function(e){return e.rule===d}),l)return{isPrimary:function(e){return i(e)&&function(e){return l===e.id}},isAlt:function(){return!1}};r=o(c)?function(e){return o(e.scope)}:function(e){return e.scope===c},o(u)||"*"===u||(n=function(e){return e.field===u}),o(this.vmId)||(a=function(e){return e.vmId===t.vmId});return{isPrimary:function(e){return a(e)&&n(e)&&i(e)&&r(e)},isAlt:function(e){return a(e)&&i(e)&&e.field===c+"."+u}}},R.prototype._match=function(e){if(!o(e)){var t=this._makeCandidateFilters(e),i=t.isPrimary,r=t.isAlt;return this.items.reduce((function(e,t,n,a){var o=n===a.length-1;return e.primary?o?e.primary:e:(i(t)&&(e.primary=t),r(t)&&(e.alt=t),o?e.primary||e.alt:e)}),{})}};var q=function(){};q.generate=function(e,t,i){var r=q.resolveModel(t,i),n=Fe.resolveConfig(i.context);return{name:q.resolveName(e,i),el:e,listen:!t.modifiers.disable,bails:!!t.modifiers.bails||!0!==t.modifiers.continues&&void 0,scope:q.resolveScope(e,t,i),vm:q.makeVM(i.context),expression:t.value,component:i.componentInstance,classes:n.classes,classNames:n.classNames,getter:q.resolveGetter(e,i,r),events:q.resolveEvents(e,i)||n.events,model:r,delay:q.resolveDelay(e,i,n),rules:q.resolveRules(e,t,i),immediate:!!t.modifiers.initial||!!t.modifiers.immediate,validity:n.validity,aria:n.aria,initialValue:q.resolveInitialValue(i)}},q.getCtorConfig=function(e){return e.componentInstance?d("componentInstance.$options.$_veeValidate",e):null},q.resolveRules=function(e,t,i){var r="";if(t.value||t&&t.expression||(r=a(e,"rules")),t.value&&L(["string","object"],typeof t.value.rules)?r=t.value.rules:t.value&&(r=t.value),i.componentInstance)return r;var n=h(r);return Fe.config.validity?v({},S(e,{}),n):n},q.resolveInitialValue=function(e){var t=e.data.model||T(e.data.directives,(function(e){return"model"===e.name}));return t&&t.value},q.makeVM=function(e){return{get $el(){return e.$el},get $refs(){return e.$refs},$watch:e.$watch?e.$watch.bind(e):function(){},$validator:e.$validator?{errors:e.$validator.errors,validate:e.$validator.validate.bind(e.$validator),update:e.$validator.update.bind(e.$validator)}:null}},q.resolveDelay=function(e,t,i){var r=a(e,"delay"),n=i&&"delay"in i?i.delay:0;return!r&&t.componentInstance&&t.componentInstance.$attrs&&(r=t.componentInstance.$attrs["data-vv-delay"]),m(n)?(o(r)||(n.input=r),k(n)):k(r||n)},q.resolveEvents=function(e,t){var i=a(e,"validate-on");if(!i&&t.componentInstance&&t.componentInstance.$attrs&&(i=t.componentInstance.$attrs["data-vv-validate-on"]),!i&&t.componentInstance){var r=q.getCtorConfig(t);i=r&&r.events}if(!i&&Fe.config.events&&(i=Fe.config.events),i&&t.componentInstance&&L(i,"input")){var n=(t.componentInstance.$options.model||{event:"input"}).event;if(!n)return i;i=i.replace("input",n)}return i},q.resolveScope=function(e,t,i){void 0===i&&(i={});var r=null;return i.componentInstance&&o(r)&&(r=i.componentInstance.$attrs&&i.componentInstance.$attrs["data-vv-scope"]),o(r)?function(e){var t=a(e,"scope");if(o(t)){var i=l(e);i&&(t=a(i,"scope"))}return o(t)?null:t}(e):r},q.resolveModel=function(e,t){if(e.arg)return{expression:e.arg};var i=V(t);if(!i)return null;var r=!/[^\w.$]/.test(i.expression)&&function(e,t){var i=t;return e.split(".").every((function(e){return e in i&&(i=i[e],!0)}))}(i.expression,t.context),n=!(!i.modifiers||!i.modifiers.lazy);return r?{expression:i.expression,lazy:n}:{expression:null,lazy:n}},q.resolveName=function(e,t){var i=a(e,"name");if(!i&&!t.componentInstance)return e.name;if(!i&&t.componentInstance&&t.componentInstance.$attrs&&(i=t.componentInstance.$attrs["data-vv-name"]||t.componentInstance.$attrs.name),!i&&t.componentInstance){var r=q.getCtorConfig(t);return r&&_(r.name)?r.name.bind(t.componentInstance)():t.componentInstance.name}return i},q.resolveGetter=function(e,t,i){if(i&&i.expression)return function(){return d(i.expression,t.context)};if(t.componentInstance){var r=a(e,"value-path")||t.componentInstance.$attrs&&t.componentInstance.$attrs["data-vv-value-path"];if(r)return function(){return d(r,t.componentInstance)};var n=q.getCtorConfig(t);if(n&&_(n.value)){var o=n.value.bind(t.componentInstance);return function(){return o()}}var s=(t.componentInstance.$options.model||{prop:"value"}).prop;return function(){return t.componentInstance[s]}}switch(e.type){case"checkbox":return function(){var t=document.querySelectorAll('input[name="'+e.name+'"]');if((t=y(t).filter((function(e){return e.checked}))).length)return t.map((function(e){return e.value}))};case"radio":return function(){var t=document.querySelectorAll('input[name="'+e.name+'"]'),i=T(t,(function(e){return e.checked}));return i&&i.value};case"file":return function(t){return y(e.files)};case"select-multiple":return function(){return y(e.options).filter((function(e){return e.selected})).map((function(e){return e.value}))};default:return function(){return e&&e.value}}};var W={},j=function(){},$={rules:{configurable:!0}};j.add=function(e,t){var i=t.validate,r=t.options,n=t.paramNames;W[e]={validate:i,options:r,paramNames:n}},$.rules.get=function(){return W},j.has=function(e){return!!W[e]},j.isImmediate=function(e){return!(!W[e]||!W[e].options.immediate)},j.isTargetRule=function(e){return!(!W[e]||!W[e].options.hasTarget)},j.remove=function(e){delete W[e]},j.getParamNames=function(e){return W[e]&&W[e].paramNames},j.getOptions=function(e){return W[e]&&W[e].options},j.getValidatorMethod=function(e){return W[e]?W[e].validate:null},Object.defineProperties(j,$);var Z=function(e){return"undefined"!=typeof Event&&_(Event)&&e instanceof Event||e&&e.srcElement},Q=function(e){return e?"string"==typeof e?e.split("|"):e:[]},K=!0,X=function(e,t,i){e.addEventListener(t,i,!!K&&{passive:!0})},J={targetOf:null,immediate:!1,scope:null,listen:!0,name:null,rules:{},vm:null,classes:!1,validity:!0,aria:!0,events:"input|blur",delay:0,classNames:{touched:"touched",untouched:"untouched",valid:"valid",invalid:"invalid",pristine:"pristine",dirty:"dirty"}},ee=function(e){void 0===e&&(e={}),this.id=(b>=9999&&(b=0,C=C.replace("{id}","_{id}")),b++,C.replace("{id}",String(b))),this.el=e.el,this.updated=!1,this.dependencies=[],this.vmId=e.vmId,this.watchers=[],this.events=[],this.delay=0,this.rules={},this._cacheId(e),this.classNames=v({},J.classNames),e=v({},J,e),this._delay=o(e.delay)?0:e.delay,this.validity=e.validity,this.aria=e.aria,this.flags={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1},this.vm=e.vm,this.componentInstance=e.component,this.ctorConfig=this.componentInstance?d("$options.$_veeValidate",this.componentInstance):void 0,this.update(e),this.initialValue=this.value,this.updated=!1},te={validator:{configurable:!0},isRequired:{configurable:!0},isDisabled:{configurable:!0},alias:{configurable:!0},value:{configurable:!0},bails:{configurable:!0},rejectsFalse:{configurable:!0}};te.validator.get=function(){return this.vm&&this.vm.$validator?this.vm.$validator:{validate:function(){}}},te.isRequired.get=function(){return!!this.rules.required},te.isDisabled.get=function(){return!(!this.componentInstance||!this.componentInstance.disabled)||!(!this.el||!this.el.disabled)},te.alias.get=function(){if(this._alias)return this._alias;var e=null;return this.ctorConfig&&this.ctorConfig.alias&&(e=_(this.ctorConfig.alias)?this.ctorConfig.alias.call(this.componentInstance):this.ctorConfig.alias),!e&&this.el&&(e=a(this.el,"as")),!e&&this.componentInstance?this.componentInstance.$attrs&&this.componentInstance.$attrs["data-vv-as"]:e},te.value.get=function(){if(_(this.getter))return this.getter()},te.bails.get=function(){return this._bails},te.rejectsFalse.get=function(){return this.componentInstance&&this.ctorConfig?!!this.ctorConfig.rejectsFalse:!!this.el&&"checkbox"===this.el.type},ee.prototype.matches=function(e){var t=this;return!e||(e.id?this.id===e.id:!!(o(e.vmId)?function(){return!0}:function(e){return e===t.vmId})(e.vmId)&&(void 0===e.name&&void 0===e.scope||(void 0===e.scope?this.name===e.name:void 0===e.name?this.scope===e.scope:e.name===this.name&&e.scope===this.scope)))},ee.prototype._cacheId=function(e){this.el&&!e.targetOf&&(this.el._veeValidateId=this.id)},ee.prototype.waitFor=function(e){this._waitingFor=e},ee.prototype.isWaitingFor=function(e){return this._waitingFor===e},ee.prototype.update=function(e){var t,i,r;this.targetOf=e.targetOf||null,this.immediate=e.immediate||this.immediate||!1,!o(e.scope)&&e.scope!==this.scope&&_(this.validator.update)&&this.validator.update(this.id,{scope:e.scope}),this.scope=o(e.scope)?o(this.scope)?null:this.scope:e.scope,this.name=(o(e.name)?e.name:String(e.name))||this.name||null,this.rules=void 0!==e.rules?h(e.rules):this.rules,this._bails=void 0!==e.bails?e.bails:this._bails,this.model=e.model||this.model,this.listen=void 0!==e.listen?e.listen:this.listen,this.classes=!(!e.classes&&!this.classes)&&!this.componentInstance,this.classNames=m(e.classNames)?E(this.classNames,e.classNames):this.classNames,this.getter=_(e.getter)?e.getter:this.getter,this._alias=e.alias||this._alias,this.events=e.events?Q(e.events):this.events,this.delay=(t=this.events,i=e.delay||this.delay,r=this._delay,"number"==typeof i?t.reduce((function(e,t){return e[t]=i,e}),{}):t.reduce((function(e,t){return"object"==typeof i&&t in i?(e[t]=i[t],e):"number"==typeof r?(e[t]=r,e):(e[t]=r&&r[t]||0,e)}),{})),this.updateDependencies(),this.addActionListeners(),void 0!==e.rules&&(this.flags.required=this.isRequired),this.flags.validated&&void 0!==e.rules&&this.updated&&this.validator.validate("#"+this.id),this.updated=!0,this.addValueListeners(),this.el&&(this.updateClasses(),this.updateAriaAttrs())},ee.prototype.reset=function(){var e=this;this._cancellationToken&&(this._cancellationToken.cancelled=!0,delete this._cancellationToken);var t={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1};Object.keys(this.flags).filter((function(e){return"required"!==e})).forEach((function(i){e.flags[i]=t[i]})),this.addValueListeners(),this.addActionListeners(),this.updateClasses(!0),this.updateAriaAttrs(),this.updateCustomValidity()},ee.prototype.setFlags=function(e){var t=this,i={pristine:"dirty",dirty:"pristine",valid:"invalid",invalid:"valid",touched:"untouched",untouched:"touched"};Object.keys(e).forEach((function(r){t.flags[r]=e[r],i[r]&&void 0===e[i[r]]&&(t.flags[i[r]]=!e[r])})),void 0===e.untouched&&void 0===e.touched&&void 0===e.dirty&&void 0===e.pristine||this.addActionListeners(),this.updateClasses(),this.updateAriaAttrs(),this.updateCustomValidity()},ee.prototype.updateDependencies=function(){var e=this;this.dependencies.forEach((function(e){return e.field.destroy()})),this.dependencies=[];var t=Object.keys(this.rules).reduce((function(t,i){return j.isTargetRule(i)&&t.push({selector:e.rules[i][0],name:i}),t}),[]);t.length&&this.vm&&this.vm.$el&&t.forEach((function(t){var i=t.selector,r=t.name,n=e.vm.$refs[i],a=Array.isArray(n)?n[0]:n;if(a){var o={vm:e.vm,classes:e.classes,classNames:e.classNames,delay:e.delay,scope:e.scope,events:e.events.join("|"),immediate:e.immediate,targetOf:e.id};_(a.$watch)?(o.component=a,o.el=a.$el,o.getter=q.resolveGetter(a.$el,a.$vnode)):(o.el=a,o.getter=q.resolveGetter(a,{})),e.dependencies.push({name:r,field:new ee(o)})}}))},ee.prototype.unwatch=function(e){if(void 0===e&&(e=null),!e)return this.watchers.forEach((function(e){return e.unwatch()})),void(this.watchers=[]);this.watchers.filter((function(t){return e.test(t.tag)})).forEach((function(e){return e.unwatch()})),this.watchers=this.watchers.filter((function(t){return!e.test(t.tag)}))},ee.prototype.updateClasses=function(e){var t=this;if(void 0===e&&(e=!1),this.classes&&!this.isDisabled){var i=function(i){f(i,t.classNames.dirty,t.flags.dirty),f(i,t.classNames.pristine,t.flags.pristine),f(i,t.classNames.touched,t.flags.touched),f(i,t.classNames.untouched,t.flags.untouched),e&&(f(i,t.classNames.valid,!1),f(i,t.classNames.invalid,!1)),!o(t.flags.valid)&&t.flags.validated&&f(i,t.classNames.valid,t.flags.valid),!o(t.flags.invalid)&&t.flags.validated&&f(i,t.classNames.invalid,t.flags.invalid)};if(n(this.el)){var r=document.querySelectorAll('input[name="'+this.el.name+'"]');y(r).forEach(i)}else i(this.el)}},ee.prototype.addActionListeners=function(){var e=this;if(this.unwatch(/class/),this.el){var t=function(){e.flags.touched=!0,e.flags.untouched=!1,e.classes&&(f(e.el,e.classNames.touched,!0),f(e.el,e.classNames.untouched,!1)),e.unwatch(/^class_blur$/)},i=r(this.el)?"input":"change",a=function(){e.flags.dirty=!0,e.flags.pristine=!1,e.classes&&(f(e.el,e.classNames.pristine,!1),f(e.el,e.classNames.dirty,!0)),e.unwatch(/^class_input$/)};if(this.componentInstance&&_(this.componentInstance.$once))return this.componentInstance.$once("input",a),this.componentInstance.$once("blur",t),this.watchers.push({tag:"class_input",unwatch:function(){e.componentInstance.$off("input",a)}}),void this.watchers.push({tag:"class_blur",unwatch:function(){e.componentInstance.$off("blur",t)}});if(this.el){X(this.el,i,a);var o=n(this.el)?"change":"blur";X(this.el,o,t),this.watchers.push({tag:"class_input",unwatch:function(){e.el.removeEventListener(i,a)}}),this.watchers.push({tag:"class_blur",unwatch:function(){e.el.removeEventListener(o,t)}})}}},ee.prototype.checkValueChanged=function(){return(null!==this.initialValue||""!==this.value||!r(this.el))&&this.value!==this.initialValue},ee.prototype._determineInputEvent=function(){return this.componentInstance?this.componentInstance.$options.model&&this.componentInstance.$options.model.event||"input":this.model&&this.model.lazy?"change":r(this.el)?"input":"change"},ee.prototype._determineEventList=function(e){var t=this;return!this.events.length||this.componentInstance||r(this.el)?[].concat(this.events).map((function(e){return"input"===e&&t.model&&t.model.lazy?"change":e})):this.events.map((function(t){return"input"===t?e:t}))},ee.prototype.addValueListeners=function(){var e=this;if(this.unwatch(/^input_.+/),this.listen&&this.el){var t={cancelled:!1},i=this.targetOf?function(){e.flags.changed=e.checkValueChanged(),e.validator.validate("#"+e.targetOf)}:function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];(0===t.length||Z(t[0]))&&(t[0]=e.value),e.flags.changed=e.checkValueChanged(),e.validator.validate("#"+e.id,t[0])},r=this._determineInputEvent(),n=this._determineEventList(r);if(this.model&&L(n,r)){var a=null,o=this.model.expression;if(this.model.expression&&(a=this.vm,o=this.model.expression),!o&&this.componentInstance&&this.componentInstance.$options.model&&(a=this.componentInstance,o=this.componentInstance.$options.model.prop||"value"),a&&o){var s=c(i,this.delay[r],t),l=a.$watch(o,(function(){for(var i=[],r=arguments.length;r--;)i[r]=arguments[r];e.flags.pending=!0,e._cancellationToken=t,s.apply(void 0,i)}));this.watchers.push({tag:"input_model",unwatch:l}),n=n.filter((function(e){return e!==r}))}}n.forEach((function(r){var n=c(i,e.delay[r],t),a=function(){for(var i=[],r=arguments.length;r--;)i[r]=arguments[r];e.flags.pending=!0,e._cancellationToken=t,n.apply(void 0,i)};e._addComponentEventListener(r,a),e._addHTMLEventListener(r,a)}))}},ee.prototype._addComponentEventListener=function(e,t){var i=this;this.componentInstance&&(this.componentInstance.$on(e,t),this.watchers.push({tag:"input_vue",unwatch:function(){i.componentInstance.$off(e,t)}}))},ee.prototype._addHTMLEventListener=function(e,t){var i=this;if(this.el&&!this.componentInstance){var r=function(r){X(r,e,t),i.watchers.push({tag:"input_native",unwatch:function(){r.removeEventListener(e,t)}})};if(r(this.el),n(this.el)){var a=document.querySelectorAll('input[name="'+this.el.name+'"]');y(a).forEach((function(e){e._veeValidateId&&e!==i.el||r(e)}))}}},ee.prototype.updateAriaAttrs=function(){var e=this;if(this.aria&&this.el&&_(this.el.setAttribute)){var t=function(t){t.setAttribute("aria-required",e.isRequired?"true":"false"),t.setAttribute("aria-invalid",e.flags.invalid?"true":"false")};if(n(this.el)){var i=document.querySelectorAll('input[name="'+this.el.name+'"]');y(i).forEach(t)}else t(this.el)}},ee.prototype.updateCustomValidity=function(){this.validity&&this.el&&_(this.el.setCustomValidity)&&this.validator.errors&&this.el.setCustomValidity(this.flags.valid?"":this.validator.errors.firstById(this.id)||"")},ee.prototype.destroy=function(){this._cancellationToken&&(this._cancellationToken.cancelled=!0),this.unwatch(),this.dependencies.forEach((function(e){return e.field.destroy()})),this.dependencies=[]},Object.defineProperties(ee.prototype,te);var ie=function(e){void 0===e&&(e=[]),this.items=e||[]},re={length:{configurable:!0}};ie.prototype["function"==typeof Symbol?Symbol.iterator:"@@iterator"]=function(){var e=this,t=0;return{next:function(){return{value:e.items[t++],done:t>e.items.length}}}},re.length.get=function(){return this.items.length},ie.prototype.find=function(e){return T(this.items,(function(t){return t.matches(e)}))},ie.prototype.filter=function(e){return Array.isArray(e)?this.items.filter((function(t){return e.some((function(e){return t.matches(e)}))})):this.items.filter((function(t){return t.matches(e)}))},ie.prototype.map=function(e){return this.items.map(e)},ie.prototype.remove=function(e){var t=null;if(!(t=e instanceof ee?e:this.find(e)))return null;var i=this.items.indexOf(t);return this.items.splice(i,1),t},ie.prototype.push=function(e){if(!(e instanceof ee))throw g("FieldBag only accepts instances of Field that has an id defined.");if(!e.id)throw g("Field id must be defined.");if(this.find({id:e.id}))throw g("Field with id "+e.id+" is already added.");this.items.push(e)},Object.defineProperties(ie.prototype,re);var ne=function(e,t){this.id=t._uid,this._base=e,this._paused=!1,this.errors=new R(e.errors,this.id)},ae={flags:{configurable:!0},rules:{configurable:!0},fields:{configurable:!0},dictionary:{configurable:!0},locale:{configurable:!0}};ae.flags.get=function(){var e=this;return this._base.fields.items.filter((function(t){return t.vmId===e.id})).reduce((function(e,t){return t.scope&&(e["$"+t.scope]||(e["$"+t.scope]={}),e["$"+t.scope][t.name]=t.flags),e[t.name]=t.flags,e}),{})},ae.rules.get=function(){return this._base.rules},ae.fields.get=function(){return new ie(this._base.fields.filter({vmId:this.id}))},ae.dictionary.get=function(){return this._base.dictionary},ae.locale.get=function(){return this._base.locale},ae.locale.set=function(e){this._base.locale=e},ne.prototype.localize=function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];return(e=this._base).localize.apply(e,t)},ne.prototype.update=function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];return(e=this._base).update.apply(e,t)},ne.prototype.attach=function(e){var t=v({},e,{vmId:this.id});return this._base.attach(t)},ne.prototype.pause=function(){this._paused=!0},ne.prototype.resume=function(){this._paused=!1},ne.prototype.remove=function(e){return this._base.remove(e)},ne.prototype.detach=function(e,t){return this._base.detach(e,t,this.id)},ne.prototype.extend=function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];return(e=this._base).extend.apply(e,t)},ne.prototype.validate=function(e,t,i){return void 0===i&&(i={}),this._paused?Promise.resolve(!0):this._base.validate(e,t,v({},{vmId:this.id},i||{}))},ne.prototype.validateAll=function(e,t){return void 0===t&&(t={}),this._paused?Promise.resolve(!0):this._base.validateAll(e,v({},{vmId:this.id},t||{}))},ne.prototype.validateScopes=function(e){return void 0===e&&(e={}),this._paused?Promise.resolve(!0):this._base.validateScopes(v({},{vmId:this.id},e||{}))},ne.prototype.destroy=function(){delete this.id,delete this._base},ne.prototype.reset=function(e){return this._base.reset(Object.assign({},e||{},{vmId:this.id}))},ne.prototype.flag=function(){for(var e,t=[],i=arguments.length;i--;)t[i]=arguments[i];return(e=this._base).flag.apply(e,t.concat([this.id]))},Object.defineProperties(ne.prototype,ae);var oe={provide:function(){return this.$validator&&!I(this.$vnode)?{$validator:this.$validator}:{}},beforeCreate:function(){if(!I(this.$vnode)&&!1!==this.$options.$__veeInject){this.$parent||Fe.configure(this.$options.$_veeValidate||{});var e=Fe.resolveConfig(this);(!this.$parent||this.$options.$_veeValidate&&/new/.test(this.$options.$_veeValidate.validator))&&(this.$validator=new ne(Fe._validator,this));var t,i=(t=this.$options.inject,!(!m(t)||!t.$validator));if(this.$validator||!e.inject||i||(this.$validator=new ne(Fe._validator,this)),i||this.$validator){if(!i&&this.$validator)this.$options._base.util.defineReactive(this.$validator,"errors",this.$validator.errors);this.$options.computed||(this.$options.computed={}),this.$options.computed[e.errorBagName||"errors"]=function(){return this.$validator.errors},this.$options.computed[e.fieldsBagName||"fields"]=function(){return this.$validator.fields.items.reduce((function(e,t){return t.scope?(e["$"+t.scope]||(e["$"+t.scope]={}),e["$"+t.scope][t.name]=t.flags,e):(e[t.name]=t.flags,e)}),{})}}}},beforeDestroy:function(){this.$validator&&this._uid===this.$validator.id&&this.$validator.errors.clear()}};function se(e,t){return t&&t.$validator?t.$validator.fields.find({id:e._veeValidateId}):null}var le={bind:function(e,t,i){var r=i.context.$validator;if(r){var n=q.generate(e,t,i);r.attach(n)}},inserted:function(e,t,i){var r=se(e,i.context),n=q.resolveScope(e,t,i);r&&n!==r.scope&&(r.update({scope:n}),r.updated=!1)},update:function(e,t,i){var r=se(e,i.context);if(!(!r||r.updated&&s(t.value,t.oldValue))){var n=q.resolveScope(e,t,i),a=q.resolveRules(e,t,i);r.update({scope:n,rules:a})}},unbind:function(e,t,i){var r=i.context,n=se(e,r);n&&r.$validator.detach(n)}},de=function(e,t){void 0===t&&(t={fastExit:!0}),this.errors=new R,this.fields=new ie,this._createFields(e),this.paused=!1,this.fastExit=!!o(t&&t.fastExit)||t.fastExit},ce={rules:{configurable:!0},dictionary:{configurable:!0},flags:{configurable:!0},locale:{configurable:!0}},ue={rules:{configurable:!0},dictionary:{configurable:!0},locale:{configurable:!0}};ue.rules.get=function(){return j.rules},ce.rules.get=function(){return j.rules},ce.dictionary.get=function(){return De.i18nDriver},ue.dictionary.get=function(){return De.i18nDriver},ce.flags.get=function(){return this.fields.items.reduce((function(e,t){var i;return t.scope?(e["$"+t.scope]=((i={})[t.name]=t.flags,i),e):(e[t.name]=t.flags,e)}),{})},ce.locale.get=function(){return de.locale},ce.locale.set=function(e){de.locale=e},ue.locale.get=function(){return De.i18nDriver.locale},ue.locale.set=function(e){var t=e!==De.i18nDriver.locale;De.i18nDriver.locale=e,t&&De.instance&&De.instance._vm&&De.instance._vm.$emit("localeChanged")},de.create=function(e,t){return new de(e,t)},de.extend=function(e,t,i){void 0===i&&(i={}),de._guardExtend(e,t),de._merge(e,{validator:t,paramNames:i&&i.paramNames,options:v({},{hasTarget:!1,immediate:!0},i||{})})},de.remove=function(e){j.remove(e)},de.isTargetRule=function(e){return j.isTargetRule(e)},de.prototype.localize=function(e,t){de.localize(e,t)},de.localize=function(e,t){var i;if(m(e))De.i18nDriver.merge(e);else{if(t){var r=e||t.name;t=v({},t),De.i18nDriver.merge(((i={})[r]=t,i))}e&&(de.locale=e)}},de.prototype.attach=function(e){var t=this,i=e.initialValue,r=new ee(e);return this.fields.push(r),r.immediate?De.instance._vm.$nextTick((function(){return t.validate("#"+r.id,i||r.value,{vmId:e.vmId})})):this._validate(r,i||r.value,{initial:!0}).then((function(e){r.flags.valid=e.valid,r.flags.invalid=!e.valid})),r},de.prototype.flag=function(e,t,i){void 0===i&&(i=null);var r=this._resolveField(e,void 0,i);r&&t&&r.setFlags(t)},de.prototype.detach=function(e,t,i){var r=_(e.destroy)?e:this._resolveField(e,t,i);r&&(r.destroy(),this.errors.remove(r.name,r.scope,r.vmId),this.fields.remove(r))},de.prototype.extend=function(e,t,i){void 0===i&&(i={}),de.extend(e,t,i)},de.prototype.reset=function(e){var t=this;return De.instance._vm.$nextTick().then((function(){return De.instance._vm.$nextTick()})).then((function(){t.fields.filter(e).forEach((function(i){i.waitFor(null),i.reset(),t.errors.remove(i.name,i.scope,e&&e.vmId)}))}))},de.prototype.update=function(e,t){var i=t.scope;this._resolveField("#"+e)&&this.errors.update(e,{scope:i})},de.prototype.remove=function(e){de.remove(e)},de.prototype.validate=function(e,t,i){var r=this;void 0===i&&(i={});var n=i.silent,a=i.vmId;if(this.paused)return Promise.resolve(!0);if(o(e))return this.validateScopes({silent:n,vmId:a});if("*"===e)return this.validateAll(void 0,{silent:n,vmId:a});if(/^(.+)\.\*$/.test(e)){var s=e.match(/^(.+)\.\*$/)[1];return this.validateAll(s)}var l=this._resolveField(e);if(!l)return this._handleFieldNotFound(name);n||(l.flags.pending=!0),void 0===t&&(t=l.value);var d=this._validate(l,t);return l.waitFor(d),d.then((function(e){return!n&&l.isWaitingFor(d)&&(l.waitFor(null),r._handleValidationResults([e],a)),e.valid}))},de.prototype.pause=function(){return this.paused=!0,this},de.prototype.resume=function(){return this.paused=!1,this},de.prototype.validateAll=function(e,t){var i=this;void 0===t&&(t={});var r=t.silent,n=t.vmId;if(this.paused)return Promise.resolve(!0);var a=null,o=!1;return"string"==typeof e?a={scope:e,vmId:n}:m(e)?(a=Object.keys(e).map((function(e){return{name:e,vmId:n,scope:null}})),o=!0):a=Array.isArray(e)?e.map((function(e){return{name:e,vmId:n}})):{scope:null,vmId:n},Promise.all(this.fields.filter(a).map((function(t){return i._validate(t,o?e[t.name]:t.value)}))).then((function(e){return r||i._handleValidationResults(e,n),e.every((function(e){return e.valid}))}))},de.prototype.validateScopes=function(e){var t=this;void 0===e&&(e={});var i=e.silent,r=e.vmId;return this.paused?Promise.resolve(!0):Promise.all(this.fields.filter({vmId:r}).map((function(e){return t._validate(e,e.value)}))).then((function(e){return i||t._handleValidationResults(e,r),e.every((function(e){return e.valid}))}))},de.prototype.verify=function(e,t,i){void 0===i&&(i={});var r={name:i&&i.name||"{field}",rules:h(t),bails:d("bails",i,!0)};r.isRequired=r.rules.required;var n=Object.keys(r.rules).filter(de.isTargetRule);return n.length&&i&&m(i.values)&&n.forEach((function(e){var t=r.rules[e],n=t[0],a=t.slice(1);r.rules[e]=[i.values[n]].concat(a)})),this._validate(r,e).then((function(e){return{valid:e.valid,errors:e.errors.map((function(e){return e.msg}))}}))},de.prototype.destroy=function(){De.instance._vm.$off("localeChanged")},de.prototype._createFields=function(e){var t=this;e&&Object.keys(e).forEach((function(i){var r=v({},{name:i,rules:e[i]});t.attach(r)}))},de.prototype._getDateFormat=function(e){var t=null;return e.date_format&&Array.isArray(e.date_format)&&(t=e.date_format[0]),t||De.i18nDriver.getDateFormat(this.locale)},de.prototype._formatErrorMessage=function(e,t,i,r){void 0===i&&(i={}),void 0===r&&(r=null);var n=this._getFieldDisplayName(e),a=this._getLocalizedParams(t,r);return De.i18nDriver.getFieldMessage(this.locale,e.name,t.name,[n,a,i])},de.prototype._convertParamObjectToArray=function(e,t){if(Array.isArray(e))return e;var i=j.getParamNames(t);return i&&m(e)?i.reduce((function(t,i){return i in e&&t.push(e[i]),t}),[]):e},de.prototype._getLocalizedParams=function(e,t){void 0===t&&(t=null);var i=this._convertParamObjectToArray(e.params,e.name);return e.options.hasTarget&&i&&i[0]?[t||De.i18nDriver.getAttribute(this.locale,i[0],i[0])].concat(i.slice(1)):i},de.prototype._getFieldDisplayName=function(e){return e.alias||De.i18nDriver.getAttribute(this.locale,e.name,e.name)},de.prototype._convertParamArrayToObj=function(e,t){var i=j.getParamNames(t);if(!i)return e;if(m(e)){if(i.some((function(t){return-1!==Object.keys(e).indexOf(t)})))return e;e=[e]}return e.reduce((function(e,t,r){return e[i[r]]=t,e}),{})},de.prototype._test=function(e,t,i){var r=this,n=j.getValidatorMethod(i.name),a=Array.isArray(i.params)?y(i.params):i.params;a||(a=[]);var o=null;if(!n||"function"!=typeof n)return Promise.reject(g("No such validator '"+i.name+"' exists."));if(i.options.hasTarget&&e.dependencies){var s=T(e.dependencies,(function(e){return e.name===i.name}));s&&(o=s.field.alias,a=[s.field.value].concat(a.slice(1)))}else"required"===i.name&&e.rejectsFalse&&(a=a.length?a:[!0]);if(i.options.isDate){var l=this._getDateFormat(e.rules);"date_format"!==i.name&&a.push(l)}var d=n(t,this._convertParamArrayToObj(a,i.name));return _(d.then)?d.then((function(t){var n=!0,a={};return Array.isArray(t)?n=t.every((function(e){return m(e)?e.valid:e})):(n=m(t)?t.valid:t,a=t.data),{valid:n,errors:n?[]:[r._createFieldError(e,i,a,o)]}})):(m(d)||(d={valid:d,data:{}}),{valid:d.valid,errors:d.valid?[]:[this._createFieldError(e,i,d.data,o)]})},de._merge=function(e,t){var i=t.validator,r=t.options,n=t.paramNames,a=_(i)?i:i.validate;i.getMessage&&De.i18nDriver.setMessage(de.locale,e,i.getMessage),j.add(e,{validate:a,options:r,paramNames:n})},de._guardExtend=function(e,t){if(!_(t)&&!_(t.validate))throw g("Extension Error: The validator '"+e+"' must be a function or have a 'validate' method.")},de.prototype._createFieldError=function(e,t,i,r){var n=this;return{id:e.id,vmId:e.vmId,field:e.name,msg:this._formatErrorMessage(e,t,i,r),rule:t.name,scope:e.scope,regenerate:function(){return n._formatErrorMessage(e,t,i,r)}}},de.prototype._resolveField=function(e,t,i){if("#"===e[0])return this.fields.find({id:e.slice(1)});if(!o(t))return this.fields.find({name:e,scope:t,vmId:i});if(L(e,".")){var r=e.split("."),n=r[0],a=r.slice(1),s=this.fields.find({name:a.join("."),scope:n,vmId:i});if(s)return s}return this.fields.find({name:e,scope:null,vmId:i})},de.prototype._handleFieldNotFound=function(e,t){var i=o(t)?e:(o(t)?"":t+".")+e;return Promise.reject(g('Validating a non-existent field: "'+i+'". Use "attach()" first.'))},de.prototype._handleValidationResults=function(e,t){var i=this,r=e.map((function(e){return{id:e.id}}));this.errors.removeById(r.map((function(e){return e.id}))),e.forEach((function(e){i.errors.remove(e.field,e.scope,t)}));var n=e.reduce((function(e,t){return e.push.apply(e,t.errors),e}),[]);this.errors.add(n),this.fields.filter(r).forEach((function(t){var i=T(e,(function(e){return e.id===t.id}));t.setFlags({pending:!1,valid:i.valid,validated:!0})}))},de.prototype._shouldSkip=function(e,t){return!1!==e.bails&&(!!e.isDisabled||!e.isRequired&&(o(t)||""===t||D(t)))},de.prototype._shouldBail=function(e){return void 0!==e.bails?e.bails:this.fastExit},de.prototype._validate=function(e,t,i){var r=this;void 0===i&&(i={});var n=i.initial;if(this._shouldSkip(e,t))return Promise.resolve({valid:!0,id:e.id,field:e.name,scope:e.scope,errors:[]});var a=[],o=[],s=!1;return Object.keys(e.rules).filter((function(e){return!n||!j.has(e)||j.isImmediate(e)})).some((function(i){var n=j.getOptions(i),l=r._test(e,t,{name:i,params:e.rules[i],options:n});return _(l.then)?a.push(l):!l.valid&&r._shouldBail(e)?(o.push.apply(o,l.errors),s=!0):a.push(new Promise((function(e){return e(l)}))),s})),s?Promise.resolve({valid:!1,errors:o,id:e.id,field:e.name,scope:e.scope}):Promise.all(a).then((function(t){return t.reduce((function(e,t){var i;return t.valid||(i=e.errors).push.apply(i,t.errors),e.valid=e.valid&&t.valid,e}),{valid:!0,errors:o,id:e.id,field:e.name,scope:e.scope})}))},Object.defineProperties(de.prototype,ce),Object.defineProperties(de,ue);var he=function(e,t){var i={pristine:function(e,t){return e&&t},dirty:function(e,t){return e||t},touched:function(e,t){return e||t},untouched:function(e,t){return e&&t},valid:function(e,t){return e&&t},invalid:function(e,t){return e||t},pending:function(e,t){return e||t},required:function(e,t){return e||t},validated:function(e,t){return e&&t}};return Object.keys(i).reduce((function(r,n){return r[n]=i[n](e[n],t[n]),r}),{})},pe=function(e,t){return void 0===t&&(t=!0),Object.keys(e).reduce((function(i,r){if(!i)return i=v({},e[r]);var n=0===r.indexOf("$");return t&&n?he(pe(e[r]),i):!t&&n?i:i=he(i,e[r])}),null)},ge=null,me=0;function _e(e){return{errors:e.messages,flags:e.flags,classes:e.classes,valid:e.isValid,reset:function(){return e.reset()},validate:function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e.validate.apply(e,t)},aria:{"aria-invalid":e.flags.invalid?"true":"false","aria-required":e.isRequired?"true":"false"}}}function Pe(e){var t=this,i=this.value!==e.value||this._needsValidation,r=this.flags.validated;if(this.initialized||(this.initialValue=e.value),this.initialized||void 0!==e.value||(i=!0),i){this.value=e.value,this.validateSilent().then(this.immediate||r?this.applyResult:function(e){var i=e.valid;t.setFlags({valid:i,invalid:!i})})}this._needsValidation=!1}function fe(e){return{onInput:function(t){e.syncValue(t),e.setFlags({dirty:!0,pristine:!1})},onBlur:function(){e.setFlags({touched:!0,untouched:!1})},onValidate:c((function(){var t=e.validate();e._waiting=t,t.then((function(i){t===e._waiting&&(e.applyResult(i),e._waiting=null)}))}),e.debounce)}}function ye(e){var t=V(e);this._inputEventName=this._inputEventName||Y(e,t),Pe.call(this,t);var i=fe(this),r=i.onInput,n=i.onBlur,a=i.onValidate;U(e,this._inputEventName,r),U(e,"blur",n),this.normalizedEvents.forEach((function(t){U(e,t,a)})),this.initialized=!0}var ve={$__veeInject:!1,inject:{$_veeObserver:{from:"$_veeObserver",default:function(){return this.$vnode.context.$_veeObserver||(this.$vnode.context.$_veeObserver={refs:{},$subscribe:function(e){this.refs[e.vid]=e},$unsubscribe:function(e){delete this.refs[e.vid]}}),this.$vnode.context.$_veeObserver}}},props:{vid:{type:[String,Number],default:function(){return++me}},name:{type:String,default:null},events:{type:[Array,String],default:function(){return["input"]}},rules:{type:[Object,String],default:null},immediate:{type:Boolean,default:!1},bails:{type:Boolean,default:function(){return De.config.fastExit}},debounce:{type:Number,default:function(){return De.config.delay||0}}},watch:{rules:{deep:!0,handler:function(){this._needsValidation=!0}}},data:function(){return{messages:[],value:void 0,initialized:!1,initialValue:void 0,flags:{untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1},id:null}},methods:{setFlags:function(e){var t=this;Object.keys(e).forEach((function(i){t.flags[i]=e[i]}))},syncValue:function(e){var t=Z(e)?e.target.value:e;this.value=t,this.flags.changed=this.initialValue===t},reset:function(){this.messages=[],this._waiting=null,this.initialValue=this.value;var e={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1};this.setFlags(e)},validate:function(){for(var e=this,t=[],i=arguments.length;i--;)t[i]=arguments[i];return t[0]&&this.syncValue(t[0]),this.validateSilent().then((function(t){return e.applyResult(t),t}))},validateSilent:function(){var e,t,i=this;return this.setFlags({pending:!0}),ge.verify(this.value,this.rules,{name:this.name,values:(e=this,t=e.$_veeObserver.refs,e.fieldDeps.reduce((function(e,i){return t[i]?(e[i]=t[i].value,e):e}),{})),bails:this.bails}).then((function(e){return i.setFlags({pending:!1}),e}))},applyResult:function(e){var t=e.errors;this.messages=t,this.setFlags({valid:!t.length,changed:this.value!==this.initialValue,invalid:!!t.length,validated:!0})},registerField:function(){ge||(ge=De.instance._validator),function(e){o(e.id)&&e.id===e.vid&&(e.id=me,me++);var t=e.id,i=e.vid;t===i&&e.$_veeObserver.refs[t]||(t!==i&&e.$_veeObserver.refs[t]===e&&e.$_veeObserver.$unsubscribe(e),e.$_veeObserver.$subscribe(e),e.id=i)}(this)}},computed:{isValid:function(){return this.flags.valid},fieldDeps:function(){var e=this,t=h(this.rules),i=this.$_veeObserver.refs;return Object.keys(t).filter(j.isTargetRule).map((function(r){var n=t[r][0],a="$__"+n;return _(e[a])||(e[a]=i[n].$watch("value",(function(){e.validate()}))),n}))},normalizedEvents:function(){var e=this;return Q(this.events).map((function(t){return"input"===t?e._inputEventName:t}))},isRequired:function(){return!!h(this.rules).required},classes:function(){var e=this,t=De.config.classNames;return Object.keys(this.flags).reduce((function(i,r){var n=t&&t[r]||r;return"invalid"===r?(i[n]=!!e.messages.length,i):"valid"===r?(i[n]=!e.messages.length,i):(n&&(i[n]=e.flags[r]),i)}),{})}},render:function(e){var t=this;this.registerField();var i=_e(this),r=this.$scopedSlots.default;if(!_(r))return H(0,this.$slots.default);var n=r(i);return G(n).forEach((function(e){ye.call(t,e)})),H(0,n)},beforeDestroy:function(){this.$_veeObserver.$unsubscribe(this)}},be={pristine:"every",dirty:"some",touched:"some",untouched:"every",valid:"every",invalid:"some",pending:"some",validated:"every"};var Ce={name:"ValidationObserver",provide:function(){return{$_veeObserver:this}},data:function(){return{refs:{}}},methods:{$subscribe:function(e){var t;this.refs=Object.assign({},this.refs,((t={})[e.vid]=e,t))},$unsubscribe:function(e){var t=e.vid;delete this.refs[t],this.refs=Object.assign({},this.refs)},validate:function(){return Promise.all(F(this.refs).map((function(e){return e.validate()}))).then((function(e){return e.every((function(e){return e.valid}))}))},reset:function(){return F(this.refs).forEach((function(e){return e.reset()}))}},computed:{ctx:function(){var e=this,t={errors:{},validate:function(){var t=e.validate();return{then:function(e){t.then((function(t){return t&&_(e)?Promise.resolve(e()):Promise.resolve(t)}))}}},reset:function(){return e.reset()}};return F(this.refs).reduce((function(e,t){return Object.keys(be).forEach((function(i){var r,n;i in e?e[i]=(r=e[i],n=t.flags[i],[r,n][be[i]]((function(e){return e}))):e[i]=t.flags[i]})),e.errors[t.vid]=t.messages,e}),t)}},render:function(e){var t=this.$scopedSlots.default;return _(t)?H(0,t(this.ctx)):H(0,this.$slots.default)}};var Te=function(e){return m(e)?Object.keys(e).reduce((function(t,i){return t[i]=Te(e[i]),t}),{}):_(e)?e("{0}",["{1}","{2}","{3}"]):e},Ie=function(e,t){this.i18n=e,this.rootKey=t},ke={locale:{configurable:!0}};ke.locale.get=function(){return this.i18n.locale},ke.locale.set=function(e){p("Cannot set locale from the validator when using vue-i18n, use i18n.locale setter instead")},Ie.prototype.getDateFormat=function(e){return this.i18n.getDateTimeFormat(e||this.locale)},Ie.prototype.setDateFormat=function(e,t){this.i18n.setDateTimeFormat(e||this.locale,t)},Ie.prototype.getMessage=function(e,t,i){var r=this.rootKey+".messages."+t;return this.i18n.te(r)?this.i18n.t(r,i):this.i18n.te(r,this.i18n.fallbackLocale)?this.i18n.t(r,this.i18n.fallbackLocale,i):this.i18n.t(this.rootKey+".messages._default",i)},Ie.prototype.getAttribute=function(e,t,i){void 0===i&&(i="");var r=this.rootKey+".attributes."+t;return this.i18n.te(r)?this.i18n.t(r):i},Ie.prototype.getFieldMessage=function(e,t,i,r){var n=this.rootKey+".custom."+t+"."+i;return this.i18n.te(n)?this.i18n.t(n,r):this.getMessage(e,i,r)},Ie.prototype.merge=function(e){var t=this;Object.keys(e).forEach((function(i){var r,n=E({},d(i+"."+t.rootKey,t.i18n.messages,{})),a=E(n,function(e){var t={};return e.messages&&(t.messages=Te(e.messages)),e.custom&&(t.custom=Te(e.custom)),e.attributes&&(t.attributes=e.attributes),o(e.dateFormat)||(t.dateFormat=e.dateFormat),t}(e[i]));t.i18n.mergeLocaleMessage(i,((r={})[t.rootKey]=a,r)),a.dateFormat&&t.i18n.setDateTimeFormat(i,a.dateFormat)}))},Ie.prototype.setMessage=function(e,t,i){var r,n;this.merge(((n={})[e]={messages:(r={},r[t]=i,r)},n))},Ie.prototype.setAttribute=function(e,t,i){var r,n;this.merge(((n={})[e]={attributes:(r={},r[t]=i,r)},n))},Object.defineProperties(Ie.prototype,ke);var Ee,Se,Fe,Le=v({},{locale:"en",delay:0,errorBagName:"errors",dictionary:null,fieldsBagName:"fields",classes:!1,classNames:null,events:"input",inject:!0,fastExit:!0,aria:!0,validity:!1,i18n:null,i18nRootKey:"validation"}),De=function(e,t){this.configure(e),Fe=this,t&&(Ee=t),this._validator=new de(null,{fastExit:e&&e.fastExit}),this._initVM(this.config),this._initI18n(this.config)},we={i18nDriver:{configurable:!0},config:{configurable:!0}},Ae={instance:{configurable:!0},i18nDriver:{configurable:!0},config:{configurable:!0}};De.setI18nDriver=function(e,t){M.setDriver(e,t)},De.configure=function(e){Le=v({},Le,e)},De.use=function(e,t){return void 0===t&&(t={}),_(e)?Fe?void e({Validator:de,ErrorBag:R,Rules:de.rules},t):(Se||(Se=[]),void Se.push({plugin:e,options:t})):p("The plugin must be a callable function")},De.install=function(e,t){Ee&&e===Ee||(Ee=e,Fe=new De(t),function(){try{var e=Object.defineProperty({},"passive",{get:function(){K=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){K=!1}}(),Ee.mixin(oe),Ee.directive("validate",le),Se&&(Se.forEach((function(e){var t=e.plugin,i=e.options;De.use(t,i)})),Se=null))},Ae.instance.get=function(){return Fe},we.i18nDriver.get=function(){return M.getDriver()},Ae.i18nDriver.get=function(){return M.getDriver()},we.config.get=function(){return Le},Ae.config.get=function(){return Le},De.prototype._initVM=function(e){var t=this;this._vm=new Ee({data:function(){return{errors:t._validator.errors,fields:t._validator.fields}}})},De.prototype._initI18n=function(e){var t=this,i=e.dictionary,r=e.i18n,n=e.i18nRootKey,a=e.locale,o=function(){t._validator.errors.regenerate()};r?(De.setI18nDriver("i18n",new Ie(r,n)),r._vm.$watch("locale",o)):"undefined"!=typeof window&&this._vm.$on("localeChanged",o),i&&this.i18nDriver.merge(i),a&&!r&&this._validator.localize(a)},De.prototype.configure=function(e){De.configure(e)},De.prototype.resolveConfig=function(e){var t=d("$options.$_veeValidate",e,{});return v({},this.config,t)},Object.defineProperties(De.prototype,we),Object.defineProperties(De,Ae),De.version="2.1.5",De.mixin=oe,De.directive=le,De.Validator=de,De.ErrorBag=R,De.mapFields=function(e){if(!e)return function(){return pe(this.$validator.flags)};var t=function(e){return Array.isArray(e)?e.reduce((function(e,t){return L(t,".")?e[t.split(".")[1]]=t:e[t]=t,e}),{}):e}(e);return Object.keys(t).reduce((function(e,i){var r=t[i];return e[i]=function(){if(this.$validator.flags[r])return this.$validator.flags[r];if("*"===t[i])return pe(this.$validator.flags,!1);if(r.indexOf(".")<=0)return{};var e=r.split("."),n=e[0],a=e.slice(1);return n=this.$validator.flags["$"+n],"*"===(a=a.join("."))&&n?pe(n):n&&n[a]?n[a]:{}},e}),{})},De.ValidationProvider=ve,De.ValidationObserver=Ce,De.withValidation=function(e,t){void 0===t&&(t=null);var i=_(e)?e.options:e;i.$__veeInject=!1;var r={name:(i.name||"AnonymousHoc")+"WithValidation",props:v({},ve.props),data:ve.data,computed:v({},ve.computed),methods:v({},ve.methods),$__veeInject:!1,beforeDestroy:ve.beforeDestroy,inject:ve.inject};t||(t=function(e){return e});var n=i.model&&i.model.event||"input";return r.render=function(e){var r;this.registerField();var a=_e(this),o=v({},this.$listeners),s=V(this.$vnode);this._inputEventName=this._inputEventName||Y(this.$vnode,s),Pe.call(this,s);var l=fe(this),d=l.onInput,c=l.onBlur,u=l.onValidate;B(o,n,d),B(o,"blur",c),this.normalizedEvents.forEach((function(e,t){B(o,e,u)}));var h,p,g=(z(this.$vnode)||{prop:"value"}).prop,m=v({},this.$attrs,((r={})[g]=s.value,r),t(a));return e(i,{attrs:this.$attrs,props:m,on:o},(h=this.$slots,p=this.$vnode.context,Object.keys(h).reduce((function(e,t){return h[t].forEach((function(e){e.context||(h[t].context=p,e.data||(e.data={}),e.data.slot=t)})),e.concat(h[t])}),[])))},r};var Oe,xe={name:"en",messages:{_default:function(e){return"The "+e+" value is not valid."},after:function(e,t){var i=t[0];return"The "+e+" must be after "+(t[1]?"or equal to ":"")+i+"."},alpha:function(e){return"The "+e+" field may only contain alphabetic characters."},alpha_dash:function(e){return"The "+e+" field may contain alpha-numeric characters as well as dashes and underscores."},alpha_num:function(e){return"The "+e+" field may only contain alpha-numeric characters."},alpha_spaces:function(e){return"The "+e+" field may only contain alphabetic characters as well as spaces."},before:function(e,t){var i=t[0];return"The "+e+" must be before "+(t[1]?"or equal to ":"")+i+"."},between:function(e,t){return"The "+e+" field must be between "+t[0]+" and "+t[1]+"."},confirmed:function(e){return"The "+e+" confirmation does not match."},credit_card:function(e){return"The "+e+" field is invalid."},date_between:function(e,t){return"The "+e+" must be between "+t[0]+" and "+t[1]+"."},date_format:function(e,t){return"The "+e+" must be in the format "+t[0]+"."},decimal:function(e,t){void 0===t&&(t=[]);var i=t[0];return void 0===i&&(i="*"),"The "+e+" field must be numeric and may contain "+(i&&"*"!==i?i:"")+" decimal points."},digits:function(e,t){return"The "+e+" field must be numeric and exactly contain "+t[0]+" digits."},dimensions:function(e,t){return"The "+e+" field must be "+t[0]+" pixels by "+t[1]+" pixels."},email:function(e){return"The "+e+" field must be a valid email."},excluded:function(e){return"The "+e+" field must be a valid value."},ext:function(e){return"The "+e+" field must be a valid file."},image:function(e){return"The "+e+" field must be an image."},included:function(e){return"The "+e+" field must be a valid value."},integer:function(e){return"The "+e+" field must be an integer."},ip:function(e){return"The "+e+" field must be a valid ip address."},length:function(e,t){var i=t[0],r=t[1];return r?"The "+e+" length must be between "+i+" and "+r+".":"The "+e+" length must be "+i+"."},max:function(e,t){return"The "+e+" field may not be greater than "+t[0]+" characters."},max_value:function(e,t){return"The "+e+" field must be "+t[0]+" or less."},mimes:function(e){return"The "+e+" field must have a valid file type."},min:function(e,t){return"The "+e+" field must be at least "+t[0]+" characters."},min_value:function(e,t){return"The "+e+" field must be "+t[0]+" or more."},numeric:function(e){return"The "+e+" field may only contain numeric characters."},regex:function(e){return"The "+e+" field format is invalid."},required:function(e){return"The "+e+" field is required."},size:function(e,t){return"The "+e+" size must be less than "+function(e){var t=0===(e=1024*Number(e))?0:Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["Byte","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}(t[0])+"."},url:function(e){return"The "+e+" field is not a valid URL."}},attributes:{}};"undefined"!=typeof VeeValidate&&VeeValidate.Validator.localize(((Oe={})[xe.name]=xe,Oe));var Ne=36e5,Me=6e4,Re=2,Ve={dateTimeDelimeter:/[T ]/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-])(\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function Ge(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var i=t||{},r=void 0===i.additionalDigits?Re:Number(i.additionalDigits);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date)return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=function(e){var t,i={},r=e.split(Ve.dateTimeDelimeter);Ve.plainTime.test(r[0])?(i.date=null,t=r[0]):(i.date=r[0],t=r[1]);if(t){var n=Ve.timezone.exec(t);n?(i.time=t.replace(n[1],""),i.timezone=n[1]):i.time=t}return i}(e),a=function(e,t){var i,r=Ve.YYY[t],n=Ve.YYYYY[t];if(i=Ve.YYYY.exec(e)||n.exec(e)){var a=i[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(i=Ve.YY.exec(e)||r.exec(e)){var o=i[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(n.date,r),o=a.year,s=function(e,t){if(null===t)return null;var i,r,n,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(i=Ve.MM.exec(e))return r=new Date(0),n=parseInt(i[1],10)-1,r.setUTCFullYear(t,n),r;if(i=Ve.DDD.exec(e)){r=new Date(0);var o=parseInt(i[1],10);return r.setUTCFullYear(t,0,o),r}if(i=Ve.MMDD.exec(e)){r=new Date(0),n=parseInt(i[1],10)-1;var s=parseInt(i[2],10);return r.setUTCFullYear(t,n,s),r}if(i=Ve.Www.exec(e))return a=parseInt(i[1],10)-1,ze(t,a);if(i=Ve.WwwD.exec(e)){a=parseInt(i[1],10)-1;var l=parseInt(i[2],10)-1;return ze(t,a,l)}return null}(a.restDateString,o);if(s){var l,d=s.getTime(),c=0;return n.time&&(c=function(e){var t,i,r;if(t=Ve.HH.exec(e))return(i=parseFloat(t[1].replace(",",".")))%24*Ne;if(t=Ve.HHMM.exec(e))return i=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),i%24*Ne+r*Me;if(t=Ve.HHMMSS.exec(e)){i=parseInt(t[1],10),r=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return i%24*Ne+r*Me+1e3*n}return null}(n.time)),n.timezone?l=function(e){var t,i;if(t=Ve.timezoneZ.exec(e))return 0;if(t=Ve.timezoneHH.exec(e))return i=60*parseInt(t[2],10),"+"===t[1]?-i:i;if(t=Ve.timezoneHHMM.exec(e))return i=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-i:i;return 0}(n.timezone):(l=new Date(d+c).getTimezoneOffset(),l=new Date(d+c+l*Me).getTimezoneOffset()),new Date(d+c+l*Me)}return new Date(e)}function ze(e,t,i){t=t||0,i=i||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var n=7*t+i+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+n),r}function Be(e){e=e||{};var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}var Ue=6e4;function Ye(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");return function(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=Ge(e,i).getTime(),n=Number(t);return new Date(r+n)}(e,Number(t)*Ue,i)}function He(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var i=Ge(e,t);return!isNaN(i)}var qe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};var We=/MMMM|MM|DD|dddd/g;function je(e){return e.replace(We,(function(e){return e.slice(1)}))}var $e=function(e){var t={LTS:e.LTS,LT:e.LT,L:e.L,LL:e.LL,LLL:e.LLL,LLLL:e.LLLL,l:e.l||je(e.L),ll:e.ll||je(e.LL),lll:e.lll||je(e.LLL),llll:e.llll||je(e.LLLL)};return function(e){return t[e]}}({LT:"h:mm aa",LTS:"h:mm:ss aa",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY h:mm aa",LLLL:"dddd, MMMM D YYYY h:mm aa"}),Ze={lastWeek:"[last] dddd [at] LT",yesterday:"[yesterday at] LT",today:"[today at] LT",tomorrow:"[tomorrow at] LT",nextWeek:"dddd [at] LT",other:"L"};function Qe(e,t,i){return function(r,n){var a=n||{},o=a.type?String(a.type):t;return(e[o]||e[t])[i?i(Number(r)):Number(r)]}}function Ke(e,t){return function(i){var r=i||{},n=r.type?String(r.type):t;return e[n]||e[t]}}var Xe={narrow:["Su","Mo","Tu","We","Th","Fr","Sa"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Je={short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long:["January","February","March","April","May","June","July","August","September","October","November","December"]},et={uppercase:["AM","PM"],lowercase:["am","pm"],long:["a.m.","p.m."]};function tt(e,t){return function(i,r){var n=r||{},a=n.type?String(n.type):t,o=e[a]||e[t];return String(i).match(o)}}function it(e,t){return function(i,r){var n=r||{},a=n.type?String(n.type):t,o=e[a]||e[t],s=i[1];return o.findIndex((function(e){return e.test(s)}))}}var rt,nt={formatDistance:function(e,t,i){var r;return i=i||{},r="string"==typeof qe[e]?qe[e]:1===t?qe[e].one:qe[e].other.replace("{{count}}",t),i.addSuffix?i.comparison>0?"in "+r:r+" ago":r},formatLong:$e,formatRelative:function(e,t,i,r){return Ze[e]},localize:{ordinalNumber:function(e,t){var i=Number(e),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},weekday:Qe(Xe,"long"),weekdays:Ke(Xe,"long"),month:Qe(Je,"long"),months:Ke(Je,"long"),timeOfDay:Qe(et,"long",(function(e){return e/12>=1?1:0})),timesOfDay:Ke(et,"long")},match:{ordinalNumbers:(rt=/^(\d+)(th|st|nd|rd)?/i,function(e){return String(e).match(rt)}),ordinalNumber:function(e){return parseInt(e[1],10)},weekdays:tt({narrow:/^(su|mo|tu|we|th|fr|sa)/i,short:/^(sun|mon|tue|wed|thu|fri|sat)/i,long:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},"long"),weekday:it({any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},"any"),months:tt({short:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,long:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},"long"),month:it({any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},"any"),timesOfDay:tt({short:/^(am|pm)/i,long:/^([ap]\.?\s?m\.?)/i},"long"),timeOfDay:it({any:[/^a/i,/^p/i]},"any")},options:{weekStartsOn:0,firstWeekContainsDate:1}},at=864e5;function ot(e,t){var i=Ge(e,t),r=i.getTime();i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0);var n=r-i.getTime();return Math.floor(n/at)+1}function st(e,t){var i=Ge(e,t),r=i.getUTCDay(),n=(r<1?7:0)+r-1;return i.setUTCDate(i.getUTCDate()-n),i.setUTCHours(0,0,0,0),i}function lt(e,t){var i=Ge(e,t),r=i.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var a=st(n,t),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var s=st(o,t);return i.getTime()>=a.getTime()?r+1:i.getTime()>=s.getTime()?r:r-1}function dt(e,t){var i=lt(e,t),r=new Date(0);return r.setUTCFullYear(i,0,4),r.setUTCHours(0,0,0,0),st(r,t)}var ct=6048e5;function ut(e,t){var i=Ge(e,t),r=st(i,t).getTime()-dt(i,t).getTime();return Math.round(r/ct)+1}var ht={M:function(e){return e.getUTCMonth()+1},Mo:function(e,t){var i=e.getUTCMonth()+1;return t.locale.localize.ordinalNumber(i,{unit:"month"})},MM:function(e){return gt(e.getUTCMonth()+1,2)},MMM:function(e,t){return t.locale.localize.month(e.getUTCMonth(),{type:"short"})},MMMM:function(e,t){return t.locale.localize.month(e.getUTCMonth(),{type:"long"})},Q:function(e){return Math.ceil((e.getUTCMonth()+1)/3)},Qo:function(e,t){var i=Math.ceil((e.getUTCMonth()+1)/3);return t.locale.localize.ordinalNumber(i,{unit:"quarter"})},D:function(e){return e.getUTCDate()},Do:function(e,t){return t.locale.localize.ordinalNumber(e.getUTCDate(),{unit:"dayOfMonth"})},DD:function(e){return gt(e.getUTCDate(),2)},DDD:function(e){return ot(e)},DDDo:function(e,t){return t.locale.localize.ordinalNumber(ot(e),{unit:"dayOfYear"})},DDDD:function(e){return gt(ot(e),3)},dd:function(e,t){return t.locale.localize.weekday(e.getUTCDay(),{type:"narrow"})},ddd:function(e,t){return t.locale.localize.weekday(e.getUTCDay(),{type:"short"})},dddd:function(e,t){return t.locale.localize.weekday(e.getUTCDay(),{type:"long"})},d:function(e){return e.getUTCDay()},do:function(e,t){return t.locale.localize.ordinalNumber(e.getUTCDay(),{unit:"dayOfWeek"})},E:function(e){return e.getUTCDay()||7},W:function(e){return ut(e)},Wo:function(e,t){return t.locale.localize.ordinalNumber(ut(e),{unit:"isoWeek"})},WW:function(e){return gt(ut(e),2)},YY:function(e){return gt(e.getUTCFullYear(),4).substr(2)},YYYY:function(e){return gt(e.getUTCFullYear(),4)},GG:function(e){return String(lt(e)).substr(2)},GGGG:function(e){return lt(e)},H:function(e){return e.getUTCHours()},HH:function(e){return gt(e.getUTCHours(),2)},h:function(e){var t=e.getUTCHours();return 0===t?12:t>12?t%12:t},hh:function(e){return gt(ht.h(e),2)},m:function(e){return e.getUTCMinutes()},mm:function(e){return gt(e.getUTCMinutes(),2)},s:function(e){return e.getUTCSeconds()},ss:function(e){return gt(e.getUTCSeconds(),2)},S:function(e){return Math.floor(e.getUTCMilliseconds()/100)},SS:function(e){return gt(Math.floor(e.getUTCMilliseconds()/10),2)},SSS:function(e){return gt(e.getUTCMilliseconds(),3)},Z:function(e,t){return pt((t._originalDate||e).getTimezoneOffset(),":")},ZZ:function(e,t){return pt((t._originalDate||e).getTimezoneOffset())},X:function(e,t){var i=t._originalDate||e;return Math.floor(i.getTime()/1e3)},x:function(e,t){return(t._originalDate||e).getTime()},A:function(e,t){return t.locale.localize.timeOfDay(e.getUTCHours(),{type:"uppercase"})},a:function(e,t){return t.locale.localize.timeOfDay(e.getUTCHours(),{type:"lowercase"})},aa:function(e,t){return t.locale.localize.timeOfDay(e.getUTCHours(),{type:"long"})}};function pt(e,t){t=t||"";var i=e>0?"-":"+",r=Math.abs(e),n=r%60;return i+gt(Math.floor(r/60),2)+t+gt(n,2)}function gt(e,t){for(var i=Math.abs(e).toString();i.length<t;)i="0"+i;return i}var mt=/(\[[^[]*])|(\\)?(LTS|LT|LLLL|LLL|LL|L|llll|lll|ll|l)/g,_t=/(\[[^[]*])|(\\)?(x|ss|s|mm|m|hh|h|do|dddd|ddd|dd|d|aa|a|ZZ|Z|YYYY|YY|X|Wo|WW|W|SSS|SS|S|Qo|Q|Mo|MMMM|MMM|MM|M|HH|H|GGGG|GG|E|Do|DDDo|DDDD|DDD|DD|D|A|.)/g;function Pt(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=String(t),n=i||{},a=n.locale||nt;if(!a.localize)throw new RangeError("locale must contain localize property");if(!a.formatLong)throw new RangeError("locale must contain formatLong property");var o=a.formatters||{},s=a.formattingTokensRegExp||_t,l=a.formatLong,d=Ge(e,n);if(!He(d,n))return"Invalid Date";var c=d.getTimezoneOffset(),u=function(e,t,i){var r=Ge(e,i),n=Number(t);return r.setUTCMinutes(r.getUTCMinutes()+n),r}(d,-c,n),h=Be(n);return h.locale=a,h.formatters=ht,h._originalDate=d,r.replace(mt,(function(e){return"["===e[0]?e:"\\"===e[0]?ft(e):l(e)})).replace(s,(function(e){var t=o[e]||ht[e];return t?t(u,h):ft(e)}))}function ft(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function yt(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=Ge(e,i),n=Ge(t,i);return r.getTime()>n.getTime()}function vt(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=Ge(e,i),n=Ge(t,i);return r.getTime()<n.getTime()}function bt(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=Ge(e,i),n=Ge(t,i);return r.getTime()===n.getTime()}var Ct={M:/^(1[0-2]|0?\d)/,D:/^(3[0-1]|[0-2]?\d)/,DDD:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,W:/^(5[0-3]|[0-4]?\d)/,YYYY:/^(\d{1,4})/,H:/^(2[0-3]|[0-1]?\d)/,m:/^([0-5]?\d)/,Z:/^([+-])(\d{2}):(\d{2})/,ZZ:/^([+-])(\d{2})(\d{2})/,singleDigit:/^(\d)/,twoDigits:/^(\d{2})/,threeDigits:/^(\d{3})/,fourDigits:/^(\d{4})/,anyDigits:/^(\d+)/};function Tt(e){return parseInt(e[1],10)}var It={YY:{unit:"twoDigitYear",match:Ct.twoDigits,parse:function(e){return Tt(e)}},YYYY:{unit:"year",match:Ct.YYYY,parse:Tt},GG:{unit:"isoYear",match:Ct.twoDigits,parse:function(e){return Tt(e)+1900}},GGGG:{unit:"isoYear",match:Ct.YYYY,parse:Tt},Q:{unit:"quarter",match:Ct.singleDigit,parse:Tt},Qo:{unit:"quarter",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"quarter"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"quarter"})}},M:{unit:"month",match:Ct.M,parse:function(e){return Tt(e)-1}},Mo:{unit:"month",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"month"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"month"})-1}},MM:{unit:"month",match:Ct.twoDigits,parse:function(e){return Tt(e)-1}},MMM:{unit:"month",match:function(e,t){return t.locale.match.months(e,{type:"short"})},parse:function(e,t){return t.locale.match.month(e,{type:"short"})}},MMMM:{unit:"month",match:function(e,t){return t.locale.match.months(e,{type:"long"})||t.locale.match.months(e,{type:"short"})},parse:function(e,t){var i=t.locale.match.month(e,{type:"long"});return null==i&&(i=t.locale.match.month(e,{type:"short"})),i}},W:{unit:"isoWeek",match:Ct.W,parse:Tt},Wo:{unit:"isoWeek",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"isoWeek"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"isoWeek"})}},WW:{unit:"isoWeek",match:Ct.twoDigits,parse:Tt},d:{unit:"dayOfWeek",match:Ct.singleDigit,parse:Tt},do:{unit:"dayOfWeek",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"dayOfWeek"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"dayOfWeek"})}},dd:{unit:"dayOfWeek",match:function(e,t){return t.locale.match.weekdays(e,{type:"narrow"})},parse:function(e,t){return t.locale.match.weekday(e,{type:"narrow"})}},ddd:{unit:"dayOfWeek",match:function(e,t){return t.locale.match.weekdays(e,{type:"short"})||t.locale.match.weekdays(e,{type:"narrow"})},parse:function(e,t){var i=t.locale.match.weekday(e,{type:"short"});return null==i&&(i=t.locale.match.weekday(e,{type:"narrow"})),i}},dddd:{unit:"dayOfWeek",match:function(e,t){return t.locale.match.weekdays(e,{type:"long"})||t.locale.match.weekdays(e,{type:"short"})||t.locale.match.weekdays(e,{type:"narrow"})},parse:function(e,t){var i=t.locale.match.weekday(e,{type:"long"});return null==i&&null==(i=t.locale.match.weekday(e,{type:"short"}))&&(i=t.locale.match.weekday(e,{type:"narrow"})),i}},E:{unit:"dayOfISOWeek",match:Ct.singleDigit,parse:function(e){return Tt(e)}},D:{unit:"dayOfMonth",match:Ct.D,parse:Tt},Do:{unit:"dayOfMonth",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"dayOfMonth"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"dayOfMonth"})}},DD:{unit:"dayOfMonth",match:Ct.twoDigits,parse:Tt},DDD:{unit:"dayOfYear",match:Ct.DDD,parse:Tt},DDDo:{unit:"dayOfYear",match:function(e,t){return t.locale.match.ordinalNumbers(e,{unit:"dayOfYear"})},parse:function(e,t){return t.locale.match.ordinalNumber(e,{unit:"dayOfYear"})}},DDDD:{unit:"dayOfYear",match:Ct.threeDigits,parse:Tt},A:{unit:"timeOfDay",match:function(e,t){return t.locale.match.timesOfDay(e,{type:"short"})},parse:function(e,t){return t.locale.match.timeOfDay(e,{type:"short"})}},aa:{unit:"timeOfDay",match:function(e,t){return t.locale.match.timesOfDay(e,{type:"long"})||t.locale.match.timesOfDay(e,{type:"short"})},parse:function(e,t){var i=t.locale.match.timeOfDay(e,{type:"long"});return null==i&&(i=t.locale.match.timeOfDay(e,{type:"short"})),i}},H:{unit:"hours",match:Ct.H,parse:Tt},HH:{unit:"hours",match:Ct.twoDigits,parse:Tt},h:{unit:"timeOfDayHours",match:Ct.M,parse:Tt},hh:{unit:"timeOfDayHours",match:Ct.twoDigits,parse:Tt},m:{unit:"minutes",match:Ct.m,parse:Tt},mm:{unit:"minutes",match:Ct.twoDigits,parse:Tt},s:{unit:"seconds",match:Ct.m,parse:Tt},ss:{unit:"seconds",match:Ct.twoDigits,parse:Tt},S:{unit:"milliseconds",match:Ct.singleDigit,parse:function(e){return 100*Tt(e)}},SS:{unit:"milliseconds",match:Ct.twoDigits,parse:function(e){return 10*Tt(e)}},SSS:{unit:"milliseconds",match:Ct.threeDigits,parse:Tt},Z:{unit:"timezone",match:Ct.Z,parse:function(e){var t=e[1],i=60*parseInt(e[2],10)+parseInt(e[3],10);return"+"===t?i:-i}},ZZ:{unit:"timezone",match:Ct.ZZ,parse:function(e){var t=e[1],i=60*parseInt(e[2],10)+parseInt(e[3],10);return"+"===t?i:-i}},X:{unit:"timestamp",match:Ct.anyDigits,parse:function(e){return 1e3*Tt(e)}},x:{unit:"timestamp",match:Ct.anyDigits,parse:Tt}};It.a=It.A;var kt=864e5;var Et={twoDigitYear:{priority:10,set:function(e,t){var i=100*Math.floor(e.date.getUTCFullYear()/100)+t;return e.date.setUTCFullYear(i,0,1),e.date.setUTCHours(0,0,0,0),e}},year:{priority:10,set:function(e,t){return e.date.setUTCFullYear(t,0,1),e.date.setUTCHours(0,0,0,0),e}},isoYear:{priority:10,set:function(e,t,i){var r,n,a,o,s,l,d,c;return e.date=dt((r=e.date,n=t,o=Ge(r,a=i),s=Number(n),l=dt(o,a),d=Math.floor((o.getTime()-l.getTime())/kt),(c=new Date(0)).setUTCFullYear(s,0,4),c.setUTCHours(0,0,0,0),(o=dt(c,a)).setUTCDate(o.getUTCDate()+d),o),i),e}},quarter:{priority:20,set:function(e,t){return e.date.setUTCMonth(3*(t-1),1),e.date.setUTCHours(0,0,0,0),e}},month:{priority:30,set:function(e,t){return e.date.setUTCMonth(t,1),e.date.setUTCHours(0,0,0,0),e}},isoWeek:{priority:40,set:function(e,t,i){var r,n,a,o,s,l;return e.date=st((r=e.date,n=t,o=Ge(r,a=i),s=Number(n),l=ut(o,a)-s,o.setUTCDate(o.getUTCDate()-7*l),o),i),e}},dayOfWeek:{priority:50,set:function(e,t,i){return e.date=function(e,t,i){var r=i||{},n=r.locale,a=n&&n.options&&n.options.weekStartsOn,o=void 0===a?0:Number(a),s=void 0===r.weekStartsOn?o:Number(r.weekStartsOn);if(!(s>=0&&s<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=Ge(e,i),d=Number(t),c=((d%7+7)%7<s?7:0)+d-l.getUTCDay();return l.setUTCDate(l.getUTCDate()+c),l}(e.date,t,i),e.date.setUTCHours(0,0,0,0),e}},dayOfISOWeek:{priority:50,set:function(e,t,i){return e.date=function(e,t,i){var r=Number(t);r%7==0&&(r-=7);var n=Ge(e,i),a=((r%7+7)%7<1?7:0)+r-n.getUTCDay();return n.setUTCDate(n.getUTCDate()+a),n}(e.date,t,i),e.date.setUTCHours(0,0,0,0),e}},dayOfMonth:{priority:50,set:function(e,t){return e.date.setUTCDate(t),e.date.setUTCHours(0,0,0,0),e}},dayOfYear:{priority:50,set:function(e,t){return e.date.setUTCMonth(0,t),e.date.setUTCHours(0,0,0,0),e}},timeOfDay:{priority:60,set:function(e,t,i){return e.timeOfDay=t,e}},hours:{priority:70,set:function(e,t,i){return e.date.setUTCHours(t,0,0,0),e}},timeOfDayHours:{priority:70,set:function(e,t,i){var r=e.timeOfDay;return null!=r&&(t=function(e,t){if(0===t){if(12===e)return 0}else if(12!==e)return 12+e;return e}(t,r)),e.date.setUTCHours(t,0,0,0),e}},minutes:{priority:80,set:function(e,t){return e.date.setUTCMinutes(t,0,0),e}},seconds:{priority:90,set:function(e,t){return e.date.setUTCSeconds(t,0),e}},milliseconds:{priority:100,set:function(e,t){return e.date.setUTCMilliseconds(t),e}},timezone:{priority:110,set:function(e,t){return e.date=new Date(e.date.getTime()-6e4*t),e}},timestamp:{priority:120,set:function(e,t){return e.date=new Date(t),e}}},St=110,Ft=6e4,Lt=/(\[[^[]*])|(\\)?(LTS|LT|LLLL|LLL|LL|L|llll|lll|ll|l)/g,Dt=/(\[[^[]*])|(\\)?(x|ss|s|mm|m|hh|h|do|dddd|ddd|dd|d|aa|a|ZZ|Z|YYYY|YY|X|Wo|WW|W|SSS|SS|S|Qo|Q|Mo|MMMM|MMM|MM|M|HH|H|GGGG|GG|E|Do|DDDo|DDDD|DDD|DD|D|A|.)/g;function wt(e,t,i,r){if(arguments.length<3)throw new TypeError("3 arguments required, but only "+arguments.length+" present");var n=String(e),a=r||{},o=void 0===a.weekStartsOn?0:Number(a.weekStartsOn);if(!(o>=0&&o<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=a.locale||nt,l=s.parsers||{},d=s.units||{};if(!s.match)throw new RangeError("locale must contain match property");if(!s.formatLong)throw new RangeError("locale must contain formatLong property");var c=String(t).replace(Lt,(function(e){return"["===e[0]?e:"\\"===e[0]?function(e){if(e.match(/\[[\s\S]/))return e.replace(/^\[|]$/g,"");return e.replace(/\\/g,"")}(e):s.formatLong(e)}));if(""===c)return""===n?Ge(i,a):new Date(NaN);var u=Be(a);u.locale=s;var h,p=c.match(s.parsingTokensRegExp||Dt),g=p.length,m=[{priority:St,set:At,index:0}];for(h=0;h<g;h++){var _=p[h],P=l[_]||It[_];if(P){var f;if(!(f=P.match instanceof RegExp?P.match.exec(n):P.match(n,u)))return new Date(NaN);var y=P.unit,v=d[y]||Et[y];m.push({priority:v.priority,set:v.set,value:P.parse(f,u),index:m.length});var b=f[0];n=n.slice(b.length)}else{var C=p[h].match(/^\[.*]$/)?p[h].replace(/^\[|]$/g,""):p[h];if(0!==n.indexOf(C))return new Date(NaN);n=n.slice(C.length)}}var T=m.map((function(e){return e.priority})).sort((function(e,t){return e-t})).filter((function(e,t,i){return i.indexOf(e)===t})).map((function(e){return m.filter((function(t){return t.priority===e})).reverse()})).map((function(e){return e[0]})),I=Ge(i,a);if(isNaN(I))return new Date(NaN);var k={date:function(e,t,i){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");return Ye(e,-Number(t),i)}(I,I.getTimezoneOffset())},E=T.length;for(h=0;h<E;h++){var S=T[h];k=S.set(k,S.value,u)}return k.date}function At(e){var t=e.date,i=t.getTime(),r=t.getTimezoneOffset();return r=new Date(i+r*Ft).getTimezoneOffset(),e.date=new Date(i+r*Ft),e}function Ot(e,t){if("string"!=typeof e)return He(e)?e:null;var i=wt(e,t,new Date);return He(i)&&Pt(i,t)===e?i:null}var xt={validate:function(e,t){void 0===t&&(t={});var i=t.targetValue,r=t.inclusion;void 0===r&&(r=!1);var n=t.format;return void 0===n&&(n=r,r=!1),e=Ot(e,n),i=Ot(i,n),!(!e||!i)&&(yt(e,i)||r&&bt(e,i))},options:{hasTarget:!0,isDate:!0},paramNames:["targetValue","inclusion","format"]},Nt={en:/^[A-Z]*$/i,cs:/^[A-Z]*$/i,da:/^[A-Z]*$/i,de:/^[A-Z]*$/i,es:/^[A-Z]*$/i,fr:/^[A-Z]*$/i,lt:/^[A-Z]*$/i,nl:/^[A-Z]*$/i,hu:/^[A-Z]*$/i,pl:/^[A-Z]*$/i,pt:/^[A-Z]*$/i,ru:/^[-]*$/i,sk:/^[A-Z]*$/i,sr:/^[A-Z]*$/i,sv:/^[A-Z]*$/i,tr:/^[A-Z]*$/i,uk:/^[-]*$/i,ar:/^[]*$/},Mt={en:/^[A-Z\s]*$/i,cs:/^[A-Z\s]*$/i,da:/^[A-Z\s]*$/i,de:/^[A-Z\s]*$/i,es:/^[A-Z\s]*$/i,fr:/^[A-Z\s]*$/i,lt:/^[A-Z\s]*$/i,nl:/^[A-Z\s]*$/i,hu:/^[A-Z\s]*$/i,pl:/^[A-Z\s]*$/i,pt:/^[A-Z\s]*$/i,ru:/^[-\s]*$/i,sk:/^[A-Z\s]*$/i,sr:/^[A-Z\s]*$/i,sv:/^[A-Z\s]*$/i,tr:/^[A-Z\s]*$/i,uk:/^[-\s]*$/i,ar:/^[\s]*$/},Rt={en:/^[0-9A-Z]*$/i,cs:/^[0-9A-Z]*$/i,da:/^[0-9A-Z]$/i,de:/^[0-9A-Z]*$/i,es:/^[0-9A-Z]*$/i,fr:/^[0-9A-Z]*$/i,lt:/^[0-9A-Z]*$/i,hu:/^[0-9A-Z]*$/i,nl:/^[0-9A-Z]*$/i,pl:/^[0-9A-Z]*$/i,pt:/^[0-9A-Z]*$/i,ru:/^[0-9-]*$/i,sk:/^[0-9A-Z]*$/i,sr:/^[0-9A-Z]*$/i,sv:/^[0-9A-Z]*$/i,tr:/^[0-9A-Z]*$/i,uk:/^[0-9-]*$/i,ar:/^[0-9]*$/},Vt={en:/^[0-9A-Z_-]*$/i,cs:/^[0-9A-Z_-]*$/i,da:/^[0-9A-Z_-]*$/i,de:/^[0-9A-Z_-]*$/i,es:/^[0-9A-Z_-]*$/i,fr:/^[0-9A-Z_-]*$/i,lt:/^[0-9A-Z_-]*$/i,nl:/^[0-9A-Z_-]*$/i,hu:/^[0-9A-Z_-]*$/i,pl:/^[0-9A-Z_-]*$/i,pt:/^[0-9A-Z_-]*$/i,ru:/^[0-9-_-]*$/i,sk:/^[0-9A-Z_-]*$/i,sr:/^[0-9A-Z_-]*$/i,sv:/^[0-9A-Z_-]*$/i,tr:/^[0-9A-Z_-]*$/i,uk:/^[0-9-_-]*$/i,ar:/^[0-9_-]*$/},Gt=function(e,t){void 0===t&&(t={});var i=t.locale;return Array.isArray(e)?e.every((function(e){return Gt(e,[i])})):i?(Nt[i]||Nt.en).test(e):Object.keys(Nt).some((function(t){return Nt[t].test(e)}))},zt={validate:Gt,paramNames:["locale"]},Bt=function(e,t){void 0===t&&(t={});var i=t.locale;return Array.isArray(e)?e.every((function(e){return Bt(e,[i])})):i?(Vt[i]||Vt.en).test(e):Object.keys(Vt).some((function(t){return Vt[t].test(e)}))},Ut={validate:Bt,paramNames:["locale"]},Yt=function(e,t){void 0===t&&(t={});var i=t.locale;return Array.isArray(e)?e.every((function(e){return Yt(e,[i])})):i?(Rt[i]||Rt.en).test(e):Object.keys(Rt).some((function(t){return Rt[t].test(e)}))},Ht={validate:Yt,paramNames:["locale"]},qt=function(e,t){void 0===t&&(t={});var i=t.locale;return Array.isArray(e)?e.every((function(e){return qt(e,[i])})):i?(Mt[i]||Mt.en).test(e):Object.keys(Mt).some((function(t){return Mt[t].test(e)}))},Wt={validate:qt,paramNames:["locale"]},jt={validate:function(e,t){void 0===t&&(t={});var i=t.targetValue,r=t.inclusion;void 0===r&&(r=!1);var n=t.format;return void 0===n&&(n=r,r=!1),e=Ot(e,n),i=Ot(i,n),!(!e||!i)&&(vt(e,i)||r&&bt(e,i))},options:{hasTarget:!0,isDate:!0},paramNames:["targetValue","inclusion","format"]},$t=function(e,t){void 0===t&&(t={});var i=t.min,r=t.max;return Array.isArray(e)?e.every((function(e){return $t(e,{min:i,max:r})})):Number(i)<=e&&Number(r)>=e},Zt={validate:$t,paramNames:["min","max"]},Qt={validate:function(e,t){var i=t.targetValue;return String(e)===String(i)},options:{hasTarget:!0},paramNames:["targetValue"]};function Kt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Xt(e,t){return e(t={exports:{}},t.exports),t.exports}var Jt=Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e){if(!("string"==typeof e||e instanceof String)){var t=void 0;throw t=null===e?"null":"object"===(t=void 0===e?"undefined":i(e))&&e.constructor&&e.constructor.hasOwnProperty("name")?e.constructor.name:"a "+t,new TypeError("Expected string but received "+t+".")}},e.exports=t.default}));Kt(Jt);var ei=Kt(Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,i.default)(e);var t=e.replace(/[- ]+/g,"");if(!r.test(t))return!1;for(var n=0,a=void 0,o=void 0,s=void 0,l=t.length-1;l>=0;l--)a=t.substring(l,l+1),o=parseInt(a,10),n+=s&&(o*=2)>=10?o%10+1:o,s=!s;return!(n%10!=0||!t)};var i=function(e){return e&&e.__esModule?e:{default:e}}(Jt);var r=/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11}|6[27][0-9]{14})$/;e.exports=t.default}))),ti={validate:function(e){return ei(String(e))}},ii={validate:function(e,t){void 0===t&&(t={});var i=t.min,r=t.max,n=t.inclusivity;void 0===n&&(n="()");var a=t.format;void 0===a&&(a=n,n="()");var o=Ot(String(i),a),s=Ot(String(r),a),l=Ot(String(e),a);return!!(o&&s&&l)&&("()"===n?yt(l,o)&&vt(l,s):"(]"===n?yt(l,o)&&(bt(l,s)||vt(l,s)):"[)"===n?vt(l,s)&&(bt(l,o)||yt(l,o)):bt(l,s)||bt(l,o)||vt(l,s)&&yt(l,o))},options:{isDate:!0},paramNames:["min","max","inclusivity","format"]},ri={validate:function(e,t){return!!Ot(e,t.format)},options:{isDate:!0},paramNames:["format"]},ni=function(e,t){void 0===t&&(t={});var i=t.decimals;void 0===i&&(i="*");var r=t.separator;if(void 0===r&&(r="."),Array.isArray(e))return e.every((function(e){return ni(e,{decimals:i,separator:r})}));if(null==e||""===e)return!1;if(0===Number(i))return/^-?\d*$/.test(e);if(!new RegExp("^[-+]?\\d*(\\"+r+"\\d"+("*"===i?"+":"{1,"+i+"}")+")?$").test(e))return!1;var n=parseFloat(e);return n==n},ai={validate:ni,paramNames:["decimals","separator"]},oi=function(e,t){var i=t[0];if(Array.isArray(e))return e.every((function(e){return oi(e,[i])}));var r=String(e);return/^[0-9]*$/.test(r)&&r.length===Number(i)},si={validate:oi},li={validate:function(e,t){for(var i=t[0],r=t[1],n=[],a=0;a<e.length;a++){if(!/\.(jpg|svg|jpeg|png|bmp|gif)$/i.test(e[a].name))return!1;n.push(e[a])}return Promise.all(n.map((function(e){return function(e,t,i){var r=window.URL||window.webkitURL;return new Promise((function(n){var a=new Image;a.onerror=function(){return n({valid:!1})},a.onload=function(){return n({valid:a.width===Number(t)&&a.height===Number(i)})},a.src=r.createObjectURL(e)}))}(e,i,r)})))}},di=Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];for(var i in t)void 0===e[i]&&(e[i]=t[i]);return e},e.exports=t.default}));Kt(di);var ci=Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){(0,r.default)(e);var n=void 0,a=void 0;"object"===(void 0===t?"undefined":i(t))?(n=t.min||0,a=t.max):(n=arguments[1],a=arguments[2]);var o=encodeURI(e).split(/%..|./).length-1;return o>=n&&(void 0===a||o<=a)};var r=function(e){return e&&e.__esModule?e:{default:e}}(Jt);e.exports=t.default}));Kt(ci);var ui=Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,i.default)(e),(t=(0,r.default)(t,a)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1));for(var n=e.split("."),o=0;o<n.length;o++)if(n[o].length>63)return!1;if(t.require_tld){var s=n.pop();if(!n.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(s))return!1;if(/[\s\u2002-\u200B\u202F\u205F\u3000\uFEFF\uDB40\uDC20]/.test(s))return!1}for(var l,d=0;d<n.length;d++){if(l=n[d],t.allow_underscores&&(l=l.replace(/_/g,"")),!/^[a-z\u00a1-\uffff0-9-]+$/i.test(l))return!1;if(/[\uff01-\uff5e]/.test(l))return!1;if("-"===l[0]||"-"===l[l.length-1])return!1}return!0};var i=n(Jt),r=n(di);function n(e){return e&&e.__esModule?e:{default:e}}var a={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1};e.exports=t.default}));Kt(ui);var hi=Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";(0,i.default)(t);a=String(a);if(!a)return e(t,4)||e(t,6);if("4"===a)return!!r.test(t)&&t.split(".").sort((function(e,t){return e-t}))[3]<=255;if("6"===a){var o=t.split(":"),s=!1,l=e(o[o.length-1],4),d=l?7:8;if(o.length>d)return!1;if("::"===t)return!0;"::"===t.substr(0,2)?(o.shift(),o.shift(),s=!0):"::"===t.substr(t.length-2)&&(o.pop(),o.pop(),s=!0);for(var c=0;c<o.length;++c)if(""===o[c]&&c>0&&c<o.length-1){if(s)return!1;s=!0}else if(l&&c===o.length-1);else if(!n.test(o[c]))return!1;return s?o.length>=1:o.length===d}return!1};var i=function(e){return e&&e.__esModule?e:{default:e}}(Jt);var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,n=/^[0-9A-F]{1,4}$/i;e.exports=t.default})),pi=Kt(hi),gi=Kt(Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),(t=(0,r.default)(t,l)).require_display_name||t.allow_display_name){var s=e.match(d);if(s)e=s[1];else if(t.require_display_name)return!1}var m=e.split("@"),_=m.pop(),P=m.join("@"),f=_.toLowerCase();if(t.domain_specific_validation&&("gmail.com"===f||"googlemail.com"===f)){var y=(P=P.toLowerCase()).split("+")[0];if(!(0,n.default)(y.replace(".",""),{min:6,max:30}))return!1;for(var v=y.split("."),b=0;b<v.length;b++)if(!u.test(v[b]))return!1}if(!(0,n.default)(P,{max:64})||!(0,n.default)(_,{max:254}))return!1;if(!(0,a.default)(_,{require_tld:t.require_tld})){if(!t.allow_ip_domain)return!1;if(!(0,o.default)(_)){if(!_.startsWith("[")||!_.endsWith("]"))return!1;var C=_.substr(1,_.length-2);if(0===C.length||!(0,o.default)(C))return!1}}if('"'===P[0])return P=P.slice(1,P.length-1),t.allow_utf8_local_part?g.test(P):h.test(P);for(var T=t.allow_utf8_local_part?p:c,I=P.split("."),k=0;k<I.length;k++)if(!T.test(I[k]))return!1;return!0};var i=s(Jt),r=s(di),n=s(ci),a=s(ui),o=s(hi);function s(e){return e&&e.__esModule?e:{default:e}}var l={allow_display_name:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0},d=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\,\.\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF\s]*<(.+)>$/i,c=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,u=/^[a-z\d]+$/,h=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,p=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,g=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i;e.exports=t.default}))),mi={validate:function(e,t){return void 0===t&&(t={}),t.multiple&&(e=e.split(",").map((function(e){return e.trim()}))),Array.isArray(e)?e.every((function(e){return gi(String(e),t)})):gi(String(e),t)}},_i=function(e,t){return Array.isArray(e)?e.every((function(e){return _i(e,t)})):y(t).some((function(t){return t==e}))},Pi={validate:_i},fi={validate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return!_i.apply(void 0,e)}},yi={validate:function(e,t){var i=new RegExp(".("+t.join("|")+")$","i");return e.every((function(e){return i.test(e.name)}))}},vi={validate:function(e){return e.every((function(e){return/\.(jpg|svg|jpeg|png|bmp|gif)$/i.test(e.name)}))}},bi={validate:function(e){return Array.isArray(e)?e.every((function(e){return/^-?[0-9]+$/.test(String(e))})):/^-?[0-9]+$/.test(String(e))}},Ci={validate:function(e,t){void 0===t&&(t={});var i=t.version;return void 0===i&&(i=4),o(e)&&(e=""),Array.isArray(e)?e.every((function(e){return pi(e,i)})):pi(e,i)},paramNames:["version"]},Ti={validate:function(e,t){return void 0===t&&(t=[]),e===t[0]}},Ii={validate:function(e,t){return void 0===t&&(t=[]),e!==t[0]}},ki={validate:function(e,t){var i=t[0],r=t[1];return void 0===r&&(r=void 0),i=Number(i),null!=e&&("number"==typeof e&&(e=String(e)),e.length||(e=y(e)),function(e,t,i){return void 0===i?e.length===t:(i=Number(i),e.length>=t&&e.length<=i)}(e,i,r))}},Ei=function(e,t){var i=t[0];return null==e?i>=0:Array.isArray(e)?e.every((function(e){return Ei(e,[i])})):String(e).length<=i},Si={validate:Ei},Fi=function(e,t){var i=t[0];return null!=e&&""!==e&&(Array.isArray(e)?e.length>0&&e.every((function(e){return Fi(e,[i])})):Number(e)<=i)},Li={validate:Fi},Di={validate:function(e,t){var i=new RegExp(t.join("|").replace("*",".+")+"$","i");return e.every((function(e){return i.test(e.type)}))}},wi=function(e,t){var i=t[0];return null!=e&&(Array.isArray(e)?e.every((function(e){return wi(e,[i])})):String(e).length>=i)},Ai={validate:wi},Oi=function(e,t){var i=t[0];return null!=e&&""!==e&&(Array.isArray(e)?e.length>0&&e.every((function(e){return Oi(e,[i])})):Number(e)>=i)},xi={validate:Oi},Ni={validate:function(e){return Array.isArray(e)?e.every((function(e){return/^[0-9]+$/.test(String(e))})):/^[0-9]+$/.test(String(e))}},Mi=function(e,t){var i=t.expression;return"string"==typeof i&&(i=new RegExp(i)),Array.isArray(e)?e.every((function(e){return Mi(e,{expression:i})})):i.test(String(e))},Ri={validate:Mi,paramNames:["expression"]},Vi={validate:function(e,t){void 0===t&&(t=[]);var i=t[0];return void 0===i&&(i=!1),!D(e)&&((!1!==e||!i)&&(null!=e&&!!String(e).trim().length))}},Gi={validate:function(e,t){var i=t[0];if(isNaN(i))return!1;for(var r=1024*Number(i),n=0;n<e.length;n++)if(e[n].size>r)return!1;return!0}},zi=Kt(Xt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),!e||e.length>=2083||/[\s<>]/.test(e))return!1;if(0===e.indexOf("mailto:"))return!1;t=(0,a.default)(t,s);var o=void 0,d=void 0,u=void 0,h=void 0,p=void 0,g=void 0,m=void 0,_=void 0;if(m=e.split("#"),e=m.shift(),m=e.split("?"),e=m.shift(),(m=e.split("://")).length>1){if(o=m.shift().toLowerCase(),t.require_valid_protocol&&-1===t.protocols.indexOf(o))return!1}else{if(t.require_protocol)return!1;if("//"===e.substr(0,2)){if(!t.allow_protocol_relative_urls)return!1;m[0]=e.substr(2)}}if(""===(e=m.join("://")))return!1;if(m=e.split("/"),""===(e=m.shift())&&!t.require_host)return!0;if((m=e.split("@")).length>1&&(d=m.shift()).indexOf(":")>=0&&d.split(":").length>2)return!1;h=m.join("@"),g=null,_=null;var P=h.match(l);P?(u="",_=P[1],g=P[2]||null):(m=h.split(":"),u=m.shift(),m.length&&(g=m.join(":")));if(null!==g&&(p=parseInt(g,10),!/^[0-9]+$/.test(g)||p<=0||p>65535))return!1;if(!((0,n.default)(u)||(0,r.default)(u,t)||_&&(0,n.default)(_,6)))return!1;if(u=u||_,t.host_whitelist&&!c(u,t.host_whitelist))return!1;if(t.host_blacklist&&c(u,t.host_blacklist))return!1;return!0};var i=o(Jt),r=o(ui),n=o(hi),a=o(di);function o(e){return e&&e.__esModule?e:{default:e}}var s={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1},l=/^\[([^\]]+)\](?::([0-9]+))?$/;function d(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function c(e,t){for(var i=0;i<t.length;i++){var r=t[i];if(e===r||d(r)&&r.test(e))return!0}return!1}e.exports=t.default}))),Bi={validate:function(e,t){return void 0===t&&(t={}),o(e)&&(e=""),Array.isArray(e)?e.every((function(e){return zi(e,t)})):zi(e,t)}},Ui=Object.freeze({after:xt,alpha_dash:Ut,alpha_num:Ht,alpha_spaces:Wt,alpha:zt,before:jt,between:Zt,confirmed:Qt,credit_card:ti,date_between:ii,date_format:ri,decimal:ai,digits:si,dimensions:li,email:mi,ext:yi,image:vi,included:Pi,integer:bi,length:ki,ip:Ci,is_not:Ii,is:Ti,max:Si,max_value:Li,mimes:Di,min:Ai,min_value:xi,excluded:fi,numeric:Ni,regex:Ri,required:Vi,size:Gi,url:Bi});Object.keys(Ui).forEach((function(e){de.extend(e,Ui[e].validate,v({},Ui[e].options,{paramNames:Ui[e].paramNames}))})),de.localize({en:xe});De.install;t.a=De},eQsQ:function(e,t){!function(){"use strict";PF.ProductPush.StockManagement.ProductPushWrapper=Class({__construct:function(e){if(this._par=e,this._designData=e.designData,this._componentParams=null,!this._designData.store.canManageStock())throw new Error(dlang("dashboard","Store doesn't support stock management."));this.node=tag("div","product-push-stock-management-wrapper",[]),this._render()},_render:function(){mkE.clearNode(this.node),this._nodeFooter=tag("div","navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[this._continueButton=tag("a",{className:"btn btn-danger disabled",onclick:this._submit.bind(this)},dlang("dashboard","Submit to store"))])]),this._componentParams={prices:this._getVariantPrices(),store:this._designData.store,quantities:this._designData.quantities,isCustomProduct:this._designData.isCustomProduct(),onUpdate:this._onComponentUpdate.bind(this)},this._component=new PF.ProductPush.StockManagement(this._componentParams),this._onComponentUpdate(),this.container=tag("div",null,[this._createBreadCrumbsNode(),this._component]),this.container.append(this.node)},_updateContinueButtonState:function(){this._component.isValid()?mkE.removeClassName(this._continueButton,"disabled"):mkE.addClassName(this._continueButton,"disabled")},_onComponentUpdate:function(){this._component&&(this._designData.quantities=this._component.getCurrentQuantities(),this._updateContinueButtonState())},_submit:function(){this._component.isValid()&&(this._par.callback(this._designData),mkE.addClassName(this._continueButton,"disabled"))},_createBreadCrumbsNode:function(){if(!this._par.breadcrumbs)return"";var e=this._par.breadcrumbs.clone();return e.add({title:dclang("dashboard","Push breadcrumb","Stock")}),tag("div",null,[e])},_getVariantPrices:function(){if(!this._designData||!this._designData.prices)return null;var e=this._designData.colors||[];if(!e.length||this._designData.isCustomProduct())return this._designData.prices;var t=[];return e.forEach(function(e){this._designData.prices.forEach((function(i){var r=new PF.Items.BaseGeneratorPriceItem;r.title="all"===i.priceKey?e:e+" / "+i.title,r.priceKey=e+"-"+i.priceKey,r.retailPrice=i.retailPrice,t.push(r)}))}.bind(this)),t}},mkE.Base)}()},gY30:function(e,t){!function(){"use strict";PF.ProductPush.SizePicker=Class({__NAME:"PF.ProductPush.SizePicker",_params:null,callback:null,sizes:[],_unavailableSizes:[],selectedSizes:[],node:null,nodeCheckboxes:null,buttonPicker:null,_nodeCheckboxCheckAll:null,nodeError:null,_sizeGuide:null,__construct:function(e,t){this._params=e,this._additionalPar=t||{},this.callback=e.onChangedCallback,this.designData=e.designData,this.selectedSizes=e.selectedValues.length>0?e.selectedValues.slice():[],this._sizeGuide=new PF.ProductPush.SizeGuide(e.productId,this._params.isSizeGuideVisible);var i=this._canHaveMultipleSizes();this.sizes=i?e.values.slice().sort(PF.Utils.Product.sizeSortingCallback):e.allValues.slice().sort(PF.Utils.Product.sizeSortingCallback);var r=lang("Select size(s):");this.designData.product.isPhoneCase()&&(r=lang("Select model(s):")),i||(this.selectedSizes=e.selectedValues.length?[e.selectedValues[0]]:[],r=lang("Select size:"),this.designData.product.isPhoneCase()&&(r=lang("Select model:"))),this.node=mkE({tag:"div",className:"generator-size-picker"});var n="";if(this.sizes.length>3&&i){var a=mkE({tag:"input",type:"checkbox",prop:{checked:this.sizes.length===this.selectedSizes.length}});a.onchange=this._onToggleAll.bind(this,a),n={tag:"label",className:"margin-bottom-5",style:{fontWeight:"normal"},els:[a,{tag:"span",className:"margin-left-10",text:lang("Select all sizes")}]},this._nodeCheckboxCheckAll=a}this.nodeSelector=tag("div"),this.sizeNodeTitle=tag("div"),this._params.isSizeNodeTitleVisible&&(this.sizeNodeTitle=tag("div",{className:"margin-vertical-10",style:{lineHeight:"20px"}},[tag("h6","",r),this._sizeGuide.getButton()])),tag("div","",[this.sizeNodeTitle,this.sizeCheckboxSelector=tag("div","",[n,this.nodeSelector,this.nodeError=tag("div","alert alert-danger text-center hidden padding-10",lang("Please select at least one size!"))])]).append(this.node),this._render()},_render:function(){if(mkE.clearNode(this.nodeSelector),this._canHaveMultipleSizes())for(var e in this.sizes){var t=this.sizes[e],i=mkE({tag:"input",type:"checkbox",className:"margin-right-5",prop:{checked:this.selectedSizes.indexOf(t)>-1,name:"size",value:t},style:{verticalAlign:"text-top"}});i.onchange=this._onSizeChanged.bind(this,t,i),mkE({tag:"label",className:"one-size",els:[i,{tag:"span",text:t}]}).append(this.nodeSelector)}else this._renderButtonPicker()},_renderButtonPicker:function(){mkE.addClassName(this.nodeSelector,"button-picker");var e=this.selectedSizes.length>0?this.selectedSizes[0]:null,t=new PF.Components.ButtonPicker.Par;t.values=this.sizes.map((function(e){return{value:e,title:e}})),t.onChanged=this._onSizeChanged,t.activeValue=e,t.valuesDisabled=this._unavailableSizes,t.valuesHidden=this._hiddenSizes||[],this.buttonPicker=new PF.Components.ButtonPicker(t),this.buttonPicker._nodeItems.append(this.nodeSelector)},_onSizeChanged:function(e,t){if(this._canHaveMultipleSizes()){var i=this.selectedSizes.indexOf(e);i>-1&&this.selectedSizes.splice(i,1)}else this.selectedSizes=[],this.designData.title=this.designData.product.title+" - "+e;t&&!t.checked||(this.selectedSizes.push(e),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Check one size",eventLabel:e})),this._nodeCheckboxCheckAll&&(this._nodeCheckboxCheckAll.checked=this.selectedSizes.length===this.sizes.length),this.updateErrorStatus(),this.callback(this.selectedSizes.slice())},_onToggleAll:function(e){this.selectedSizes=[],e.checked&&(this.selectedSizes=this.sizes.slice(),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Check all sizes"})),this._render(),this.callback(this.selectedSizes.slice())},_canHaveMultipleSizes:function(){var e=this.designData.store,t=this.designData.product;return 1!==this._params.selectedLimit&&(e.type!==PF.Items.StoreItem.TYPE_AMAZON||t.type!==PF.Items.ProductItem.TYPE_PHONE_CASE)},validateSelectedSize:function(e,t,i,r,n){if(!this._params.isPopoverEnabled)return!0;t&&this.setSelectedRegionDisabledValues(i,r,"size",e);var a="",o="",s=!0;return this._isSizeDiscontinued(t)?(a=this._params.POPOVER.DISCONTINUED.TITLE,o=this._params.POPOVER.DISCONTINUED.DESC,s=!1):this._isSizeSampleDisabled(t)?(a=this._params.POPOVER.SAMPLE.TITLE,o=this._params.POPOVER.SAMPLE.DESC,s=!1):this._isSizeInactive(t)?(a=this._params.POPOVER.REGION.TITLE.replace("{region}",this.getAvailableAttributeRegion(t,"size")),o=this._params.POPOVER.REGION.DESC,s=!1):this._isSizeOutOfStock(t)&&(a=this._params.POPOVER.UNAVAILABLE.TITLE,o=this._params.POPOVER.UNAVAILABLE.DESC),a&&o&&this.buttonPicker&&this.buttonPicker.togglePopover(t,a,o,n),s},_getCurrentlySettableSizes:function(){var e=(this.sizes||[]).slice();if(!e||!e.length)return e;var t=this.buttonPicker?this.buttonPicker.getUnavailableItems()||[]:this._unavailableSizes||[],i=[];return e.forEach((function(e){t.indexOf(e)>-1||i.push(e)})),i},_isSizeDiscontinued:function(e){return this._unavailableSizes.indexOf(e)>-1},getValueCount:function(){return this.sizes.length},isSelectAllChecked:function(){return this._nodeCheckboxCheckAll&&this._nodeCheckboxCheckAll.checked},isValuePicked:function(){return this.selectedSizes.length>0||this._additionalPar.allowNoSelectedSizes},hasAtLeastOneValue:function(){return!!this.getValueCount()},setSizes:function(e){return this.selectedSizes=e.slice(),this},setUnavailableSizes:function(e){return this.buttonPicker&&this.buttonPicker.setUnavailableItems(e),this._unavailableSizes=e,this},setHiddenSizes:function(e){return this.buttonPicker&&this.buttonPicker.setHiddenItems(e),this._hiddenSizes=e,this},setInactiveSizes:function(e){return this.buttonPicker&&this.buttonPicker.setInactiveItems(e),this},setUnavailableSampleSizes:function(e){return this.buttonPicker&&this.buttonPicker.setDisabledSampleSizes(e),this},render:function(){return this._render(),this},_isSizeInactive:function(e){return!!this.buttonPicker&&this.buttonPicker.getInactiveItems().indexOf(e)>-1},_isSizeOutOfStock:function(e){return!!this.buttonPicker&&this.buttonPicker.getUnavailableItems().indexOf(e)>-1},_isSizeSampleDisabled:function(e){return!!this.buttonPicker&&this.buttonPicker.getDisabledSampleSizes().indexOf(e)>-1}},PF.VariantPicker.BasePicker)}()},ggRW:function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.SizeGuide=Class({_designData:null,_unitsAllowed:[],__construct:function(e){this._designData=e,!this._designData.sizeGuideUnits||-1==this._designData.sizeGuideUnits.indexOf(PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_METRIC)||this._designData.store instanceof PF.Items.StoreItems.EbayStoreItem||(this._isMetricSizeGuideEnabled=!0),this._designData.sizeGuideUnits&&-1!=this._designData.sizeGuideUnits.indexOf(PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_IMPERIAL)&&(this._isImperialSizeGuideEnabled=!0),this._unitsAllowed=[PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_IMPERIAL,PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_METRIC],this._render()},_render:function(){var e,t=" "+lang("Attach size guide to the product description");this._designData.store&&this._designData.store.type===PF.Items.StoreItem.TYPE_ETSY&&(t=" "+lang("Add size guide as an image")),this.node=mkE({tag:"div",els:[{tag:"div",els:[{tag:"label",els:[lang("Size guide"),e=mkE({tag:"span",className:"glyphicon glyphicon-info-sign",attr:{title:lang("You can edit the size guide in your store's platform.")}})]},{tag:"label",className:"inline-radio",els:[this.inputWithSizeGuide=mkE({tag:"input",type:"checkbox",prop:{checked:this._designData.withSizeGuide,onclick:this._showSizeGuide}}),t]}]},this.sizeGuideBlock=mkE({tag:"div",className:"product-push product-push__size-guide margin-bottom-20"})]}),$(e).tooltip(),this._designData.withSizeGuide&&this._showSizeGuide()},_showSizeGuide:function(){if(mkE.clearNode(this.sizeGuideBlock),this.inputWithSizeGuide&&this.inputWithSizeGuide.checked){var e=!1;if(this._unitsAllowed)if(1===this._unitsAllowed.length)this._unitsAllowed[0]===PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_METRIC?(this._isMetricSizeGuideEnabled=!0,this._isImperialSizeGuideEnabled=!1):(this._isImperialSizeGuideEnabled=!0,this._isMetricSizeGuideEnabled=!1);else this._designData.useSizeConversion&&this._unitsAllowed.length>=2&&(e=!0);e&&[{tag:"label",text:lang("Choose the size guides measurement system")},{tag:"label",className:"inline-radio",els:[{tag:"input",type:"checkbox",name:"sizeGuideUnits",prop:{checked:!!this._isImperialSizeGuideEnabled,onclick:function(){this._isImperialSizeGuideEnabled=!this._isImperialSizeGuideEnabled,this._showSizeGuide()}.bind(this)}}," "+clang("measurement system","Imperial")]},{tag:"label",className:"inline-radio",els:[{tag:"input",type:"checkbox",name:"sizeGuideUnits",prop:{checked:!!this._isMetricSizeGuideEnabled,onclick:function(){this._isMetricSizeGuideEnabled=!this._isMetricSizeGuideEnabled,this._showSizeGuide()}.bind(this)}}," "+clang("measurement system","Metric")]}].forEach(function(e){mkE(e).append(this.sizeGuideBlock)}.bind(this)),(this._isImperialSizeGuideEnabled||this._isMetricSizeGuideEnabled)&&RPC("products/get-size-guide",{productId:this._designData.productId,sizeGuideUnits:this.getSizeGuideUnits(),sizes:this._designData.sizes,forPreview:1},function(e){e&&mkE({tag:"div",className:"product-push__size-guide--inner margin-top-20",innerHTML:e.sizeGuide}).append(this.sizeGuideBlock)}.bind(this))}},getSizeGuideUnits:function(){var e=[];return this._isImperialSizeGuideEnabled&&e.push(PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_IMPERIAL),this._isMetricSizeGuideEnabled&&e.push(PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_METRIC),e},getSizeGuideEnabled:function(){return this.inputWithSizeGuide.checked}},mkE.Base),PF.ProductPush.MockupPicker.SizeGuide.allowSizeGuidePush=function(e){return-1===[PF.Items.StoreItem.TYPE_AMAZON,PF.Items.StoreItem.TYPE_WEEBLY,PF.Items.StoreItem.TYPE_NATIVE,PF.Items.StoreItem.TYPE_API_3DCART,PF.Items.StoreItem.TYPE_API_LAUNCHCART,PF.Items.StoreItem.TYPE_WISH,PF.Items.StoreItem.TYPE_WIX].indexOf(e)},PF.ProductPush.MockupPicker.SizeGuide.allowSizeGuideEditing=function(e){return-1!==[PF.Items.StoreItem.TYPE_SHOPIFY].indexOf(e)},PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_METRIC="metric",PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_IMPERIAL="imperial"}()},gqyd:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.ClipartLayer=Class({fillColor:"",clipartItem:null,_getNewLayer:function(){return new PF.Components.GeneratorMockup.ClipartLayer},getType:function(){return PF.Components.GeneratorMockup.ClipartLayer.TYPE},isClipartLayer:function(){return!0},getOriginalClone:function(e){var t=this._getNewLayer();return e||(t.uniqueId=this.uniqueId),t.fillColor=this.fillColor,t.clipartItem=this.clipartItem,t.overrideImage=this.overrideImage,t.position=this.position.getFromOriginalRatio(),t.originalPosition=this.originalPosition,t.parentLayerUniqueId=this.parentLayerUniqueId,t.patternType=this.patternType,t.patternSpacing=this.patternSpacing,t.flipX=this.flipX,t.flipY=this.flipY,t},getSourceWidth:function(){return this.clipartItem.width},getSourceHeight:function(){return this.clipartItem.height},isVector:function(){return!0},isSimple:function(){return!1},toArray:function(e,t){return{type:PF.Components.GeneratorMockup.ClipartLayer.TYPE,fillColor:this.fillColor,clipartItemId:this.clipartItem?this.clipartItem.id:null,url:this._getUrl(e),svg:t?this.clipartItem.svg:null,position:this.position?this.position.toArray():{},isCustomizable:this.isCustomizable?1:0,customizeKey:this.customizeKey,uniqueId:this.uniqueId,parentLayerUniqueId:this.parentLayerUniqueId,overrideImage:this.overrideImage,patternType:this.patternType,patternSpacing:this.patternSpacing,flipX:this.flipX,flipY:this.flipY}},_getUrl:function(e){var t=null;return this.clipartItem&&this.clipartItem.image&&(t=this.clipartItem.image.urlLarge),e&&this.clipartItem&&this.clipartItem.image&&(t=this.clipartItem.image.urlThumb),t},getInitialScale:function(e){return e===PF.Items.ProductItem.TECHNIQUE_ENGRAVING?1.08:4}},PF.Components.GeneratorMockup.Layer),PF.Components.GeneratorMockup.ClipartLayer.TYPE="clipart",PF.Components.GeneratorMockup.ClipartLayer.fromClipartItem=function(e){var t=new PF.Components.GeneratorMockup.ClipartLayer;return t.clipartItem=e,t.originalPosition=new PF.Items.GeneratorPositionItem,t.position=t.originalPosition.getClone(),t}}()},hdKH:function(e,t){!function(){"use strict";PF.ProductPush.LayerPicker.Item=Class({__NAME:"PF.ProductPush.LayerPicker.Item",_layer:null,_customizableLabel:null,_par:null,_placementsWithMaxImages:null,__construct:function(e){this._par=e,this._layer=this._par.layer,this._colorDropdown=null,this.isClipartLayer()&&(this._needsDefaultColor()&&(this._layer.fillColor=this._layer.getDefaultColor(this._par.product)),this._needsColorUpdate()&&this._par.onColorChanged(this._layer),this._colorDropdownPar=new PF.Components.ColorDropdown.Par,this._colorDropdownPar.color=this._layer.fillColor,this._colorDropdownPar.colors=this._getColors(),this._colorDropdownPar.hideRGB=this._par.product.isEmbroidery(),this._colorDropdownPar.onChange=this._onColorChanged,this._colorDropdown=new PF.Components.ColorDropdown(this._colorDropdownPar)),this._customizableLabel=new PF.ProductPush.CustomizableLabel,this._layer.isCustomizable&&e.allowCustomizableLayers||this._customizableLabel.hide();var t="";if(this._isAddingLayerCustomizationAllowed(this._layer)){var i=new PF.ProductPush.CanCustomizeCheckbox.Par;i.isChecked=this._layer.isCustomizable,i.onChange=this._onChangeIsCustomizable,i.layerType=this._layer instanceof PF.Components.GeneratorMockup.TextLayer?PF.Components.GeneratorMockup.TextLayer.TYPE:this._layer instanceof PF.Components.GeneratorMockup.TextboxLayer?PF.Components.GeneratorMockup.TextboxLayer.TYPE:PF.Components.GeneratorMockup.ImageLayer.TYPE,t=new PF.ProductPush.CanCustomizeCheckbox(i)}var r=new PF.Forms.Range.Par;r.title=dlang("dashboard","Rotate:"),r.className=" ",r.value=this._layer.position.rotation>180?this._layer.position.rotation-360:this._layer.position.rotation,r.minValue=-180,r.maxValue=180,r.fractionDigits=0,r.incrementStep=1,r.hasNumberInput=!0,r.onValueChanged=this._par.onRequestRotate,r.onSlide=this._par.onRequestRotate,this._rotationInput=PF.Forms.Range(r);var n=this._layer.parentLayerUniqueId;this.node=tag("div",{className:n?"pf-d-none":"layer-picker__item pf-border-bottom",onclick:this._par.onClicked.bind(null,this),attr:{"data-layer-id":this.getLayer().uniqueId}},[tag("div","row no-gutters",[tag("div","col-auto",[tag("div","layer-picker__item__handle-wrap pf-py-16 pf-pl-24 pf-pr-12",[tag("div","layer-picker__item__thumb pf-border",[this._thumbNode=this._getThumbNode()])])]),tag("div","col pf-ui-caption",[tag("div","layer-picker__item__handle-wrap pf-pt-16",[this._customizableLabel,this._titleNode=this._getTitleNode(),this._printQualityNode=this._getPrintQualityNode(),this._selectedEmbroideryColorsNode=this._par.product.isEmbroidery()?this._getSelectedEmbroideryColors():"",this._sizeNode=this._getSizeNode()]),tag("div","layer-picker__item__controls row",[this._renderEditButton()?tag("div","col-12 pf-mt-12",[tag("button",{className:"pf-btn pf-btn-secondary pf-btn-block",onclick:this._par.onEdit.bind(null,this)},dlang("generator","Edit"))]):"",tag("div","col-12 pf-mt-12",[this._rotationInput]),tag("div","col-auto pf-mt-12",[tag("div","pf-bold pf-mb-8",lang("Align")+":"),tag("a",{className:"btn btn-empty pf-px-12 pf-mr-12",attr:{title:lang("Vertically center"),"data-toggle":"tooltip"},onclick:this._par.onRequestCenterVertically},[tag("i","pf-i pf-i-format-vertical-align-center pf-i-18")]),tag("a",{className:"btn btn-empty pf-px-12",attr:{title:lang("Horizontally center"),"data-toggle":"tooltip"},onclick:this._par.onRequestCenterHorizontally},[tag("i","pf-i pf-i-format-horizontal-align-center pf-i-18")])]),this._showFlipControls()?tag("div","col-auto pf-mt-12",[tag("div","pf-bold pf-mb-8",dlang("generator","Flip")+":"),tag("a",{className:"btn btn-empty pf-px-12 pf-mr-12",attr:{title:dlang("generator","Flip horizontally"),"data-toggle":"tooltip"},onclick:this._par.onRequestFlipHorizontally},[tag("i","pf-i pf-i-reflect-horizontal pf-i-18")]),tag("a",{className:"btn btn-empty pf-px-12",attr:{title:dlang("generator","Flip vertically"),"data-toggle":"tooltip"},onclick:this._par.onRequestFlipVertically},[tag("i","pf-i pf-i-reflect-horizontal pf-i-rotate-90 pf-i-18")])]):"",t?tag("div","col-12 pf-mt-12",[t]):"",this._colorDropdown?tag("div","col-12 pf-mt-12 "+(this._needsColorDropdown()?"":"pf-d-none"),[tag("div","pf-bold pf-mb-8",lang("Choose art color")+":"),this._colorDropdown]):"",this._renderPatternButton()?tag("div","col-12 pf-mt-12",[tag("a",{className:"btn btn-block btn-empty pf-px-8",onclick:this._par.onEdit.bind(null,this)},[tag("img",{className:"pf-d-inline-block",src:PF.ASSETS_URL+"/generator/pattern-halfdrop.svg",style:{height:"24px"}}),tag("span","pf-px-4 pf-px-xs-12 pf-px-md-8 pf-px-lg-12",this._layer.patternType?dlang("generator","Edit pattern"):dlang("generator","Make a pattern")),this._layer.patternType?"":tag("span","pf-badge pf-badge-small pf-badge--primary",clang("Badge","New"))])]):"",tag("div","col-12 pf-my-12",[this._getPlacementDropdown()])])]),tag("span","layer-picker__item__handle",[tag("i","pf-i pf-i-drag pf-i-18")]),tag("span",{className:"layer-picker__item__delete",onclick:function(e){e.stopPropagation(),$(this.node).find('[data-toggle="tooltip"]').tooltip("hide"),this._par.onRequestRemoval(e)}.bind(this),attr:{title:lang("Delete"),"data-toggle":"tooltip"}},[tag("i","pf-i pf-i-trash-can-outline pf-i-18")]),tag("span",{className:"layer-picker__item__reset",onclick:function(e){e.stopPropagation(),$(this.node).find('[data-toggle="tooltip"]').tooltip("hide"),this._par.onRequestPositionReset(e),PF.MockupGenerator.Tracking._track("Reset position button",PF.MockupGenerator.Tracking._getCustomerLabel(),this._getType())}.bind(this),attr:{title:dlang("dashboard","Reset"),"data-toggle":"tooltip"}},[tag("i","pf-i pf-i-restore pf-i-18")])])])},hasLayer:function(e){return!!this._layer&&this._layer.uniqueId===e.uniqueId},updateRotationInput:function(e){this._rotationInput&&(e>180&&(e-=360),this._rotationInput.setValue(e))},_renderEditButton:function(){return this._par.onEdit&&(this.isTextLayer()||this.isImageLayer()&&(this._par.product.isEmbroidery()||this._par.templates.getTechnique()===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY)&&PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker())},_renderPatternButton:function(){var e=this._par.templates.getActiveTemplate(this._par.activePlacementId).getMirroredLayer(this._layer),t=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_HANG_TAG].indexOf(this._par.activePlacementId)<0;return this._par.onEdit&&this._par.showPatternPicker&&!e&&t&&!this.isTextLayer()&&(this.isImageLayer()||this.isClipartLayer())},_renderPlacementDropdown:function(){var e=this._par.templates.getActiveTemplate(this._par.activePlacementId).getMirroredLayer(this._layer),t=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_HANG_TAG].indexOf(this._par.activePlacementId)<0;return this._par.isAllOver(!0)&&!e&&t},_showFlipControls:function(){return(this.isImageLayer()||this.isClipartLayer())&&!this._par.product.isEmbroidery()&&PF.Utils.BetaAccess().hasPatternPicker()},updateLayer:function(e){this._layer=e,mkE.clearNode(this._sizeNode),this._getSizeNode().append(this._sizeNode),this.isImageLayer()?(mkE.clearNode(this._printQualityNode),this._getPrintQualityNode().append(this._printQualityNode),this._selectedEmbroideryColorsNode&&(mkE.clearNode(this._selectedEmbroideryColorsNode),this._getSelectedEmbroideryColors().append(this._selectedEmbroideryColorsNode))):this.isClipartLayer()&&(mkE.clearNode(this._thumbNode),this._getThumbNode().append(this._thumbNode))},_requestFilePicking:function(e){var t=this._par.product;t&&!e&&t.isEmbroidery()?PF.FileLibrary.EmbroideryWarning.showPopup(this._requestFilePicking.bind(this,!0)):this._par.onRequestFilePicking()},getLayer:function(){return this._par.layer},setActive:function(e){e?(this._par.onActive&&this._par.onActive(),mkE.addClassName(this.node,"active")):(this._colorDropdown&&this._colorDropdown.closeDropdown(),mkE.removeClassName(this.node,"active"))},_onChangeIsCustomizable:function(e){e?this._customizableLabel.show():this._customizableLabel.hide(),this._par.onChangeIsCustomizable&&this._par.onChangeIsCustomizable()},isImageLayer:function(){return this._layer.isImageLayer()},isTextLayer:function(){return this._layer.isTextLayer()},isClipartLayer:function(){return this._layer.isClipartLayer()},_getThumbNode:function(){var e=tag("div");if(this.isImageLayer()){var t=this._par.layer.shouldUseTempFile?this._par.layer.temporaryFileItem:this._par.layer.fileItem;e=tag("img",{className:"layer-picker__item__image",src:t.urlThumb})}else this.isTextLayer()?e=tag("i",{className:"pf-i pf-i-format-font pf-i-24 pf-p-12",style:{color:this._layer.color}}):this.isClipartLayer()&&(e=tag("img",{className:"layer-picker__item__image",src:this._layer.overrideImage||this._layer.clipartItem.image.urlThumb}));return e},_getTitleNode:function(){var e="";this.isImageLayer()?e=(this._par.layer.shouldUseTempFile?this._par.layer.temporaryFileItem:this._par.layer.fileItem).filename:this.isTextLayer()?e=PF.Utils.String.shortenString(this._layer.text,50):this.isClipartLayer()&&(e=this._layer.clipartItem.name);return tag("div","layer-picker__item__title pf-pr-40",[tag("span","layer-picker__item__badge",this._getType()),e])},_getPrintQualityNode:function(){if(this.isImageLayer())var e=this._layer.getDPI(),t=this._par.templates.getQuality(),i=t.getQualityPercent(this._layer),r=t.getQualityKey(i),n=this._layer.isVector()?dlang("generator","Vector"):e+lang(" DPI");else r=PF.ProductPush.TemplateQuality.QUALITY_GOOD,n=dlang("generator","Vector");var a=PF.Components.GeneratorMockup.getQualityMap()[r];return tag("div","pf-bold pf-mt-2",[dlang("generator","Print quality")+": ",tag("span",a[0],a[1]+" / "+n),this._shouldShowTransparencyInfo()?tag("div",{className:"pf-text-yellow-dark",innerHTML:dlang("generator",'File contains <a href="{url}" target="_blank">semi-transparent elements</a>').replace("{url}",langUrl("/transparency-in-dtg-files"))}):""])},_shouldShowTransparencyInfo:function(){return this._par.product&&(this._par.product.isDtgShirt()||this._par.product.isDtgTote())&&this.isImageLayer()&&this._par.templates&&this._par.templates.getTechnique()!==PF.Items.ProductItem.TECHNIQUE_EMBROIDERY&&this._layer.hasTransparencyIssues()},_getSelectedEmbroideryColors:function(){var e=[];if(this._layer&&this._layer.overrideColors){var t=Object.values(this._layer.overrideColors);e=t.filter((function(e,i){return e&&t.indexOf(e)==i}))}else this._layer&&this._layer.color&&e.push(this._layer.color);var i=new PF.Components.ColorPicker.Par;i.colors=e,i.nodeClass="pf-d-inline-block pf-pl-2";var r=new PF.Components.ColorPicker(i);return tag("div","pf-bold pf-mt-2",[dlang("generator","Thread colors")+": ",r])},_getSizeNode:function(){return tag("div","pf-mt-2",[tag("span","pf-bold",dlang("generator","Width:"))," "+this._layer.position.width.toFixed(2)+" ",tag("span","pf-bold",dlang("dashboard","Height:"))," "+this._layer.position.height.toFixed(2)])},_getPlacementDropdown:function(){var e=this._renderPlacementDropdown(),t=this._getAvailablePlacementsForCopy();this._placementsWithMaxImages=[],this._layer.isImageLayer()&&t.forEach(function(e){this._par.templates.getLayersByType(PF.Components.GeneratorMockup.ImageLayer,e.id,!1).length>=this._par.fileCountLimit&&this._placementsWithMaxImages.push(e)}.bind(this));var i=t.map(function(e){return this._placementsWithMaxImages.filter((function(t){return t.id===e.id})).length?tag("li","",[tag("div",{className:"pf-pl-40 pf-py-12 pf-ui-body pf-text-muted"},[e.title,tag("div","pf-ui-caption",dlang("generator","The limit is {number} File layers per placement.").replace("{number}",this._par.fileCountLimit))])]):tag("li","",[tag("a",{className:"pf-pl-40 pf-py-12 pf-ui-body",onclick:function(e,t){t.stopPropagation(),this._copyLayerToPlacements([e])}.bind(this,e)},e.title)])}.bind(this));return i.length<1&&(e=!1),tag("div","row no-gutters dropdown",[tag("a",{className:"btn "+(e?"col-10":"col-12")+" btn-block btn-empty "+(this._par.validateAddingLayer(this._layer)?"":"disabled"),onclick:function(e){e.stopPropagation(),this._par.onDuplicate(e)}.bind(this)},[tag("i","pf-i pf-i-content-copy pf-i-18 pf-text-gray pf-mb-2"),tag("span","pf-pl-4",dlang("dashboard","Duplicate"))]),e?tag("a",{className:"btn col-2 pf-px-4 btn-empty dropdown-toggle "+(this._par.validateAddingLayer(this._layer)?"":"disabled"),onclick:function(e){e.stopPropagation()},attr:{"data-toggle":"dropdown"}},[tag("i","pf-i pf-i-chevron-down pf-i-24 pf-text-gray")]):"",e?tag("ul","dropdown-menu dropdown-menu-right pf-border pf-p-0 pf-m-0",[tag("li","",[tag("div","pf-p-12 pf-ui-caption pf-bg-lighter pf-text-muted",[tag("span","pf-i pf-i-content-duplicate pf-i-18 pf-pr-8"),tag("span","",dlang("generator","Duplicate on"))])]),i.length>1?tag("li","",[tag(this._placementsWithMaxImages.length?"div":"a",{className:"pf-pl-40 pf-py-12 pf-ui-body"+(this._placementsWithMaxImages.length?" pf-text-muted":""),onclick:function(e){e.stopPropagation(),this._placementsWithMaxImages.length||this._copyLayerToPlacements(this._getAvailablePlacementsForCopy())}.bind(this)},[dlang("generator","All placements"),this._placementsWithMaxImages.length?tag("div","pf-ui-caption",dlang("generator","The limit is {number} File layers per placement.").replace("{number}",this._par.fileCountLimit)):""])]):""].concat(i)):""])},_getAvailablePlacementsForCopy:function(){var e=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_HANG_TAG];return e.indexOf(this._par.activePlacementId)<0?this._par.placements.filter(function(t){return e.concat([this._par.activePlacementId]).indexOf(t.id)<0}.bind(this)):[]},_copyLayerToPlacements:function(e){this._placementsWithMaxImages.length&&this._layer.isImageLayer()&&(e=e.filter(function(e){return 0===this._placementsWithMaxImages.filter((function(t){return t.id===e.id})).length}.bind(this))),this._par.templates.copyLayerToPlacementTemplates(this._layer,e);var t=$(".modal-content").length?$(".modal-content"):$("body"),i=dlang("generator","Layer duplicated on {placements}").replace("{placements}",e.map((function(e){return e.title})).join(", "));new PF.Components.StatusMessage(i,PF.Components.StatusMessage.TYPE_SUCCESS,3e3).append(t[0])},_onColorChanged:function(e){this._layer.clipartItem.customizable&&(this._layer.fillColor=e,this._par.onColorChanged&&this._par.onColorChanged(this._layer))},_needsColorDropdown:function(){return this._layer.clipartItem.customizable&&!this._par.product.isJewelry()},_needsDefaultColor:function(){return!(this._layer.fillColor&&!(this._layer.fillColor.length<1)||!this._layer.clipartItem.customizable)},_needsColorUpdate:function(){return!(this._layer.fillColor&&!(this._layer.fillColor.length<1)||this._layer.overrideImage||this._layer.overrideImagePulse||!this._par.onColorChanged||!this._layer.clipartItem.customizable)},_getColors:function(){if(this._par.isAllOver&&this._par.isAllOver())return PF.Components.ColorDropdown.allOverColors();var e=PF.Components.ColorDropdown.defaultColors();return this._par.product.isWhiteDtgTote()&&delete e.White,this._par.product.isBlackMug()&&delete e.Black,e},_getType:function(){switch(!0){case this.isClipartLayer():return dlang("generator","Clipart");case this.isTextLayer():return dlang("generator","Text");case this.isImageLayer():return dlang("generator","File");default:return""}},_isAddingLayerCustomizationAllowed:function(e){return!(!this._par.allowCustomizableLayers||this.isClipartLayer())&&(this._par.templates.getTemplateByLayer(e).technique!==PF.Items.ProductItem.TECHNIQUE_EMBROIDERY||this.isTextLayer())},append:function(e){return this.node.append(e),$(this.node).find('[data-toggle="tooltip"]').tooltip({container:document.body}).on("click",(function(e){$(this).tooltip("hide")})),$(this.node).find('[data-toggle="dropdown"]').dropdown(),this}},mkE.Base)}()},herG:function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var r=i("jYDD"),n=i("L2JU"),a=i("dhaL"),o=i("alOy"),s=i("Gfrr"),l=i("LvDl"),d=i.n(l);function c(e,t){var i=new r.b;i.loadAttributesFromDesignData(t),e.commit(Object(s.b)(s.h),i)}function u(e,t){var i=e.getters[Object(s.b)(s.c)];i&&(t.prices=d.a.values(i))}function h(){return new n.b.Store({modules:{push:a.a},plugins:[o.a]})}},iv3r:function(e,t,i){"use strict";i.r(t);var r=i("QxQC"),n=i("HSPo"),a=i("j3JC"),o=(i("dhaL"),i("alOy"),i("L2JU"),i("jYDD"),i("Gfrr"),i("herG"));PF.ProductPush=Class({_links:{storenvy:"/faq/storenvy/168-how-do-i-configure-and-sync-my-storenvy-products-",shopify:"/faq/shopify/138-how-do-i-configure-and-sync-my-shopify-products-",amazon:"/faq/products/195-how-do-i-add-and-sync-products-on-amazon-",bigcartel:"/faq/video-tips/144-how-do-i-connect-big-cartel-with-printful-",woocommerce:"/faq/video-tips/57-how-do-i-configure-and-sync-my-woocommerce-products-"},_mockupPicker:null,_additionalPar:void 0,_steps:void 0,productDesigner:void 0,designData:void 0,vuexStore:void 0,__construct:function(e,t,i,r,n){this.store=e,this.product=t,this.onProductPushedCallback=i,this._hideSyncedItemsTab=!!r,this._additionalPar=n,(new PF.Repositories.StoreRepository).hasProductPushPermission(this.store.storeId,this._pushPermissionChecked.bind(this))},_pushPermissionChecked:function(e,t){e?this._initPushFlow():this._showPermissionRequest(t)},_showPermissionRequest:function(e){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"See permission popup"});var t=new PF.Modal.Par;t.title="Authorize Printful";var i=mkE({tag:"div",className:"text-center margin-bottom-20 margin-top-10",els:[{tag:"p",className:"margin-bottom-20",els:["We dont have permissions to add products to your online store.",{tag:"br"},"You have to click the button below to grant product managing permission.",{tag:"br"},"Youll be asked to sign in to your store."]},{tag:"a",className:"btn btn-danger",text:"Continue",href:e,attr:{target:"_top"},onclick:function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:'Press "Continue" in permission popup'})}}]}),r=new PF.Modal(t);r.setContent(i),r.show()},_initPushFlow:function(){var e=new PF.OrderFlow.Par;e.storeId=this.store.storeId,e.currency=this.store.currency,e.shouldCloseModalAfterCallbacks=!1,e.isUsedForProductPush=!0,e.onProductPickedCallback=this._productPicked,e.onCustomProductPickedCallback=this._onCustomProductPicked,e.onCustomProductVariantPickedCallback=this._onCustomProductVariantPicked,e.isSearchAvailable=!0,e.onSyncedProductsPushedCallback=this.onProductPushedCallback,e.hideSyncedItemsTab=this._hideSyncedItemsTab,e.scenario=PF.OrderFlow.Par.SCENARIO_PRODUCT_PUSH,e.isVariantSyncFlow=!0,e.topAlertContents=null,e.existingModal=this._additionalPar&&this._additionalPar.existingModal?this._additionalPar.existingModal:null,e.onProductDesigned=this._onProductDesigned.bind(this),e.onCloseInit=function(){return this._showCloseWarning(),!1}.bind(this),e.onModalStepChange=function(e){this._setStepFromOrderFlowStep(e),-1!==PF.ProductPush.getPreDesignerOrderFlowSteps().indexOf(e)&&this._eraseComponentsAfterGoingBackBeforeDesigner()}.bind(this),e.allowSteps=!0,this._additionalPar&&this._additionalPar.initWithProductTemplate&&(e.initWithProductTemplate=this._additionalPar.initWithProductTemplate),this.flow=PF.OrderFlow.getInstance(e),this._renderSteps(),this.product?this._productPicked(this.product):this._requireProduct()},_renderSteps:function(){this.flow&&(this._steps=this._initSteps(),this.flow.setSteps(this._steps))},_initSteps:function(){var e=this,t=[lang("Product"),lang("Design"),lang("Mockups"),lang("Description"),lang("Pricing")];return this.store.canManageStock()&&t.push(lang("Stock")),new PF.Components.Steps(t,(function(t){e._switchToStep(t+1)}),[],{additionalClasses:"pf-steps--small pf-steps--clickable pf-justify-content-center pf-justify-content-md-end"})},_setStepFromOrderFlowStep:function(e){-1!==PF.ProductPush.getOrderFlowStepsWithoutHeaderSteps().indexOf(e)?this._steps&&(this._steps=null,this.flow.setSteps(null)):this._steps||this._renderSteps(),this._steps&&(-1===PF.ProductPush.getPreDesignerOrderFlowSteps().indexOf(e)?e===PF.OrderFlow.MODAL_STEPS.STEP_PUSH_DESIGNER||e===PF.OrderFlow.MODAL_STEPS.STEP_PRODUCT_TEMPLATE_DETAILS?this._steps.setStep(PF.ProductPush.STEP_PRODUCT_DESIGN):e===PF.OrderFlow.MODAL_STEPS.STEP_PUSH_MOCKUP_PICKER?this._steps.setStep(PF.ProductPush.STEP_PRODUCT_MOCKUPS):e===PF.OrderFlow.MODAL_STEPS.STEP_PUSH_DESCRIPTION?this._steps.setStep(PF.ProductPush.STEP_PRODUCT_DESCRIPTION):e===PF.OrderFlow.MODAL_STEPS.STEP_PUSH_PRICING?this._steps.setStep(PF.ProductPush.STEP_PRODUCT_PRICING):e===PF.OrderFlow.MODAL_STEPS.STEP_PUSH_STOCK&&this._steps.setStep(PF.ProductPush.STEP_PRODUCT_STOCK):this._steps.setStep(PF.ProductPush.STEP_PRODUCT_CHOOSE))},_eraseComponentsAfterGoingBackBeforeDesigner:function(){this.vuexStore=this.productDesigner=this.designData=this._mockupPicker=this.productItem=null},_switchToStep:function(e,t){var i;if(t=t||this.designData,e===PF.ProductPush.STEP_PRODUCT_CHOOSE)this.flow.requestProductsCatalog(),i=!0;else if(e===PF.ProductPush.STEP_PRODUCT_DESIGN){var r,n;if(this.productItem)this.flow.productPicked(this.productItem),i=!0;else if(null===(r=this.productDesigner)||void 0===r?void 0:null===(n=r._par.productTemplateEditorState)||void 0===n?void 0:n.sourceProductTemplate){var a=this.productDesigner._par.productTemplateEditorState.sourceProductTemplate;this.flow.requestProductTemplateDetails(a),i=!0}}else e===PF.ProductPush.STEP_PRODUCT_MOCKUPS?t&&this._mockupPicker&&(this._onProductDesigned(t,null),i=!0):e===PF.ProductPush.STEP_PRODUCT_DESCRIPTION?t&&this._mockupPicker&&(this._mockupPicker.renderDescription(),i=!0):e===PF.ProductPush.STEP_PRODUCT_PRICING&&t&&this._mockupPicker&&(this._onMockupsPicked(t),i=!0);i&&this._steps.setStep(e)},_showCloseWarning:function(){var e=this.productDesigner&&this.productDesigner._templates.hasLayers(),t=this.productDesigner&&!this.productDesigner._par.productTemplateEditorState,i=e&&t?this.designData||this.productDesigner.getDesignData():null;if(i){var a=new PF.Components.WarningDialog.Par;a.onSecondaryBtnClick=this._closeAsUser.bind(this),a.modalTitle=dlang("dashboard","Close product builder"),a.contentTitle=dlang("dashboard","Do you want to save your work as a product template?"),a.contentText=dlang("dashboard","You can finish the product template later and use it to add products to your Store."),a.primaryBtnText=dlang("dashboard","Save as template"),a.secondaryBtnText=dlang("dashboard","Discard changes"),a.onPrimaryBtnClick=function(){var e=this,t=this.productDesigner&&this.productDesigner.getGeneratorParams();t&&PF.ProductTemplates.adjustGeneratorVariantIdsToSave(i,t);var a=(i.colors||[]).filter((function(e){return!!e}));i.canHaveColorPicker()&&a.length||(i.templateSelectedSizes=i.sizes),Object(n.g)({designData:i,forceDraft:!0,saveFlowType:n.a.SYNC_PRODUCT_DRAFT}).then((function(){new r.a(dlang("dashboard","A product template draft created. Finish it any time!"),r.a.TYPE_SUCCESS,6e3),e._closeAsUser()})).catch((function(t){console.error(t),new r.a(dlang("dashboard","Error while saving product template! Please contact support!"),r.a.TYPE_ERROR,6e3),e._closeAsUser()}))}.bind(this),new PF.Components.WarningDialog(a)}else this._closeAsUser()},_closeAsUser:function(){PF.Events.emit(PF.Events.PRODUCT_PUSH_MODAL_CLOSED),this.flow.close()},_requireProduct:function(){this.flow.forgetProduct(),this.flow.proceed()},_initPushState:function(){this.vuexStore||(this.vuexStore=Object(o.a)(),Object(o.c)(this.vuexStore,this.designData))},_productPicked:function(e){if(this.productDesigner&&this.productItem&&this.productItem.productId===e.productId)setTimeout(function(){this.productDesigner.resizeMockupArea()}.bind(this),50);else{this.productItem=e;var t=new PF.ProductPush.Designer.Par;t.store=this.store,t.product=this.productItem,t.ctaText=dlang("dashboard","Proceed to mockups"),t.onProductDesigned=this._onProductDesigned,t.isProductPushMode=!0,t.updateStickyButtonHeight=this.flow.updateNodeStickyButtonsHeight.bind(this.flow),t.isCustomizerEnabledJS=!0,t.isModalDesigner=!0,t.onBack=function(){this._switchToStep(PF.ProductPush.STEP_PRODUCT_CHOOSE)}.bind(this),this.productDesigner=new PF.ProductPush.Designer(t)}var i=tag("div","",[this.productDesigner]);this.productDesigner.registerReplaceableParent(i),this.flow.par.isSearchAvailable=!0,this.flow.par.topAlertContents=null,this.flow.par.showSwitchTabs=!1,this.flow.showModal(i,dlang("dashboard","Configure design"),!1,this.productDesigner._nodeFooter,PF.OrderFlow.MODAL_STEPS.STEP_PUSH_DESIGNER),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Product picked"})},_onProductDesigned:function(e,t,i){var r="renderDescription"===t,n=r?lang("Add description"):lang("Choose mockup images");ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Product designed"}),this.productDesigner=this.productDesigner||i,this.designData=e,this.flow.par.topAlertContents=null,this.flow.par.isSearchAvailable=!1;var a=new PF.ProductPush.MockupPicker.Par;a.designData=e,a.generatorParams=this.productDesigner.getGeneratorParams(),a.breadcrumbs=this.flow.getCategoryBreadcrumbs(),a.stickyButtonNodeUpdate=this.flow.updateNodeStickyButtons.bind(this.flow),a.modalTitleNodeUpdate=this.flow.updateNodeTitle.bind(this.flow),a.onMockupBack=function(){this._switchToStep(PF.ProductPush.STEP_PRODUCT_DESIGN)}.bind(this),a.onMockupNext=function(){this._switchToStep(PF.ProductPush.STEP_PRODUCT_DESCRIPTION)}.bind(this),a.onDescriptionBack=function(){this._switchToStep(PF.ProductPush.STEP_PRODUCT_MOCKUPS)}.bind(this),a.onDescriptionNext=function(e){this._switchToStep(PF.ProductPush.STEP_PRODUCT_PRICING,e)}.bind(this),a.progressSteps=this.flow._steps,a.modalContentNodeUpdate=this.flow.updateNodeContent.bind(this.flow),this._mockupPicker=new PF.ProductPush.MockupPicker(a),t&&this._mockupPicker.hasOwnProperty(t)&&this._mockupPicker[t](),this.flow.showModal(this._mockupPicker,n,!1,this._mockupPicker._nodeFooter,r?PF.OrderFlow.MODAL_STEPS.STEP_PUSH_DESCRIPTION:PF.OrderFlow.MODAL_STEPS.STEP_PUSH_MOCKUP_PICKER)},_onMockupsPicked:function(e){this.designData=e,PF.LoadingOverlay.show(mkE({tag:"div"}),{minHeight:400}),(new PF.Repositories.GeneratorRepository).calculatePrices(e,this._onPricesLoaded.bind(this,e))},_onPricesLoaded:function(e,t){this.designData=e,e.setPrices(t);var i=this.flow.getCategoryBreadcrumbs();for(var r in this._mockupPicker.breadcrumbItems){var n=this._mockupPicker.breadcrumbItems[r];i.add({title:n.title,onclick:this._onProductDesigned.bind(this,e,n.publicAction)})}i.add({title:dclang("dashboard","Product push breadcrumb","Pricing")}),this._initPushState();var o=new a.b;o.vuexStore=this.vuexStore,o.onUpdate=this._onPriceChange.bind(this),this.newProductPushPricing=new a.a(o);var s=this.designData.store.canManageStock()?dclang("dashboard","Product push - edit stock quantities","Edit quantities"):this.designData.store.isNative()?dlang("dashboard","Save product"):dlang("dashboard","Submit to store");this.flow.showModal(this.newProductPushPricing,dclang("dashboard","Product push title","Edit prices and description"),!1,tag("div","footer-block navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[tag("a",{className:"pf-btn pf-btn-secondary pf-mr-12",onclick:function(){this._switchToStep(PF.ProductPush.STEP_PRODUCT_DESCRIPTION)}.bind(this)},[dlang("products","Back")]),this.nodeSubmitToStore=tag("a",{className:"pf-btn pf-btn-primary",onclick:this._onPricingDone},[s])])]),PF.OrderFlow.MODAL_STEPS.STEP_PUSH_PRICING)},_onPriceChange:function(e){e.isValid?mkE.removeClassName(this.nodeSubmitToStore,"disabled"):mkE.addClassName(this.nodeSubmitToStore,"disabled")},_onPricingDone:function(){if(!this.vuexStore)throw new Error("Product push Vuex Store is null/undefined.");if(mkE.addClassName(this.nodeSubmitToStore,"disabled"),Object(o.b)(this.vuexStore,this.designData),this.designData.store.canManageStock()){this.flow._steps.setStep(PF.ProductPush.STEP_PRODUCT_STOCK);var e=new PF.ProductPush.StockManagement.ProductPushWrapper({callback:this._onProductPush,designData:this.designData});this.flow.showModal(e,dclang("dashboard","Product push title","Edit stock quantities"),!1,e._nodeFooter,PF.OrderFlow.MODAL_STEPS.STEP_PUSH_STOCK)}else this._onProductPush(this.designData)},_onProductPush:function(e){this.designData=e,(new PF.Repositories.GeneratorRepository).pushProduct(e,this._onProductPushRe),ga("send",{hitType:"event",eventCategory:"Mockup Pushed",eventAction:e.productId.toString(),eventLabel:e.optionGroup||"Default"})},_onProductPushRe:function(e){this.flow.modal.remove(),this.onProductPushedCallback(e)},_onCustomProductPicked:function(e){var t=new PF.ProductPush.AddCustomProduct.Par;t.customProduct=e,t.store=this.store,t.onPushCallback=this._onCustomProductPush,t.breadcrumbs=this.flow.getCategoryBreadcrumbs(!0),t.stickyButtonNodeUpdate=this.flow.updateNodeStickyButtons.bind(this.flow);var i=new PF.ProductPush.AddCustomProduct(t),r=tag("div","",[i]);this.flow.par.topAlertContents=null,this.flow.par.isSearchAvailable=!1,this.flow.par.showSwitchTabs=!1,this.flow.showModal(r,"Edit prices and description",!1,i._nodeFooter,PF.OrderFlow.MODAL_STEPS.STEP_PUSH_WH_DETAILS)},_onCustomProductVariantPicked:function(e){this._onCustomProductPicked(e.customProduct)},_onCustomProductPush:function(e){this.designData=e,(new PF.Repositories.GeneratorRepository).pushCustomProduct(e,this._onProductPushRe),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Custom product pushed"})}}),PF.ProductPush.onProductPushedEvent=function(e,t){PF.Pusher.subscribeStore(e,PF.Pusher.CHANNEL_SYNC,PF.Pusher.EVENT_PRODUCT_PUSHED,(function(e){PF.Events.emit(PF.Events.PRODUCT_PUSH_COMPLETE,e)})),PF.ProductPush.AddBlock.DispatchPushStartedEvent(t)},PF.ProductPush.getPreDesignerOrderFlowSteps=function(){return[PF.OrderFlow.MODAL_STEPS.STEP_STORE_PICKER,PF.OrderFlow.MODAL_STEPS.STEP_ORDER_TYPE,PF.OrderFlow.MODAL_STEPS.STEP_PRODUCTS_CATALOG,PF.OrderFlow.MODAL_STEPS.STEP_PRODUCT_TEMPLATES,PF.OrderFlow.MODAL_STEPS.STEP_WAREHOUSE_ITEMS,PF.OrderFlow.MODAL_STEPS.STEP_SYNC_PRODUCTS,PF.OrderFlow.MODAL_STEPS.STEP_SYNC_VARIANTS]},PF.ProductPush.getOrderFlowStepsWithoutHeaderSteps=function(){return[PF.OrderFlow.MODAL_STEPS.STEP_SYNC_PRODUCTS,PF.OrderFlow.MODAL_STEPS.STEP_WAREHOUSE_ITEMS,PF.OrderFlow.MODAL_STEPS.STEP_PUSH_WH_DETAILS]},PF.ProductPush.STEP_PRODUCT_CHOOSE=1,PF.ProductPush.STEP_PRODUCT_DESIGN=2,PF.ProductPush.STEP_PRODUCT_MOCKUPS=3,PF.ProductPush.STEP_PRODUCT_DESCRIPTION=4,PF.ProductPush.STEP_PRODUCT_PRICING=5,PF.ProductPush.STEP_PRODUCT_STOCK=6},"j/Tf":function(e,t){!function(){"use strict";PF.ProductPush.ProductMockup=Class({_isReady:!1,_par:null,_nodeMockup:null,_nodeMirror:null,_nodeMirrorCheckbox:null,_mockup:null,__construct:function(e){this._par=e,this.node=tag("div","text-center",[this._nodeMockup=tag("div"),this._nodeCheckbox=tag("div")]),this._subscribeTemplateEvents(),this._render()},_subscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnActiveLayerChanged(this._onActiveLayerSelectedExternally).addOnLayerConfigurationChanged(this.renderMirrorCheckbox).addOnTemplatePositionsChangedListener(this._onPositionsChangedExternally)},_unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onActiveLayerSelectedExternally).unsubscribe(this.renderMirrorCheckbox).unsubscribe(this._onPositionsChangedExternally)},_unsubscribeTemplateEventsIfNeeded:function(){return!(!this._isReady||PF.Utils.isInDocument(this.node))&&(this._unsubscribeTemplateEvents(),!0)},_onRequestLayerRemoval:function(e){var t=this._par.templates.getByKey(this._par.templateKey);this._par.templates.removeLayer(t,e)},_render:function(){this._renderMockupArea(),this.renderMirrorCheckbox()},_renderMockupArea:function(){mkE.clearNode(this._nodeMockup);var e=new PF.Components.GeneratorMockup.Par;e.isResizable=!0,e.maxHeight=this._par.mockupMaxHeight,e.maxWidth=this._par.mockupMaxWidth,e.onReady=this._onReady,e.onLayerRemoved=this._onRequestLayerRemoval,e.showImageQualityWarning=!0,e.product=this._par.product,e.templates=this._par.templates,e.template=this._getCurrentTemplate(),e.isOrderFlow=this._shouldShowMockupControls(this._par.activeLayer),e.disableLayerManipulations=this._par.disableLayerManipulations,e.hideZoomButton=this._par.hideZoomButton,e.disableOutOfBoundsErrorMessages=this._par.disableOutOfBoundsErrorMessages,e.isCustomizingMode=this._par.isCustomizingMode,e.designFillColor=this._par.designFillColor,e.generatorVariant=this._par.generatorVariant,this._mockup=new PF.Components.GeneratorMockup(e),this._mockup.append(this._nodeMockup),this._mockup.render()},_onReady:function(){this._isReady||(this._isReady=!0,this._par.templates&&this.getMockup().showActiveLayer(this._par.templates.getActiveLayer()),this._par.onReady())},_getCurrentTemplate:function(){return this._par.templates.getByKey(this._par.templateKey)},_hasMirroredLayer:function(){return this._par.templates.getByKey(this._par.templateKey).getMirroredLayers().length>0},_hasUnmirroredLayers:function(){return this._par.templates.getByKey(this._par.templateKey).hasUnmirroredLayers()},renderMirrorCheckbox:function(e){if(mkE.clearNode(this._nodeCheckbox),this._canMirrorImage()){var t=this._hasMirroredLayer(),i=this._hasUnmirroredLayers();tag("label",!0===e?"pf-d-none":"pf-d-block",[this._nodeMirrorCheckbox=tag("input",{type:"checkbox",className:"pf-mr-4",prop:{onchange:this._onMirrorLayerChange,checked:t,indeterminate:t&&i}}),tag("span","",dclang("generator","action (to duplicate something)","Duplicate image on both sides"))]).append(this._nodeCheckbox)}},_canMirrorImage:function(){var e=this._par.templates&&this._par.templates.getActiveLayer();return(!e||!e.patternType)&&(!!this._par.allowSpecificProductMirroring&&([PF.Items.ProductItem.TYPE_MUG].indexOf(this._par.product.type)>-1&&this._par.generatorVariant.role===PF.Items.GeneratorVariantItem.ROLE_TEMPLATE))},_onMirrorLayerChange:function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Toggle mirror image",eventLabel:this.isMirroredChecked()?"Checked":"Un-checked"}),this.isMirroredChecked()?this._par.templates.addMirroredLayersForTemplates(!0):this._par.templates.removeMirroredLayersFromTemplates()},isMirroredChecked:function(){var e;return this._canMirrorImage()&&(null===(e=this._nodeMirrorCheckbox)||void 0===e?void 0:e.checked)},getMockup:function(){return this._mockup},updateControlsVisibility:function(e){this._mockup.setControlsVisibility(this._shouldShowMockupControls(e))},_onPositionsChangedExternally:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()&&this._par.templates&&this._mockup&&!this._mockup.isEventOrigin(i)&&"mirror"!==i)for(var r in e)if(e[r].getKey()===this._par.templateKey){this._mockup.updateLayersPositions(e[r],t,i),this._mockup.showActiveLayer(t),this.renderMirrorCheckbox();break}},_onActiveLayerSelectedExternally:function(e,t){this._unsubscribeTemplateEventsIfNeeded()||this._par.templates&&e&&this._par.templates.getTemplateByLayer(e).getKey()===this._par.templateKey&&(t instanceof PF.ProductPush.LayerPicker&&this._mockup.showActiveLayer(e),this._mockup.setControlsVisibility(this._shouldShowMockupControls(e)),this.renderMirrorCheckbox())},_shouldShowMockupControls:function(e){return!!e&&(-1!==[PF.Items.ProductItem.TYPE_CUT_SEW,PF.Items.ProductItem.TYPE_POSTER,PF.Items.ProductItem.TYPE_FRAMED_POSTER,PF.Items.ProductItem.TYPE_CANVAS,PF.Items.ProductItem.TYPE_PHONE_CASE,PF.Items.ProductItem.TYPE_JEWELRY,PF.Items.ProductItem.TYPE_SUBLIMATION].indexOf(this._par.product.type)&&(e&&e instanceof PF.Components.GeneratorMockup.ImageLayer||e instanceof PF.Components.GeneratorMockup.ClipartLayer))}},mkE.Base)}()},j3JC:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return k}));var r=i("x0He"),n=i("SBaP");i("L2JU");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return i}function g(e,t,i){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,i);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=i}return i}var m=function(e){function t(e){var i;return s(this,t),i=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?c(e):t}(this,d(t).call(this)),b.add(c(i)),v.add(c(i)),y.add(c(i)),_.set(c(i),{writable:!0,value:void 0}),P.set(c(i),{writable:!0,value:void 0}),f.set(c(i),{writable:!0,value:!1}),i.node=tag("div","product-push-pricing-mke"),g(c(i),_,e),p(c(i),y,C).call(c(i)),i}var i,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),i=t,(r=[{key:"isValid",value:function(){return!h(this,f)}}])&&l(i.prototype,r),n&&l(i,n),t}(n.a),_=new WeakMap,P=new WeakMap,f=new WeakMap,y=new WeakSet,v=new WeakSet,b=new WeakSet,C=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new r.b).components={"product-push-pricing":function(){return Promise.all([i.e(1),i.e(23),i.e(406)]).then(i.bind(null,"qPWM"))}},t.template="\n            <product-push-pricing\n                @pricesChanged=\"emitEvent('pricesChanged', $event)\"\n                @hasErrors=\"emitEvent('hasErrors', $event)\"\n            />\n        ",t.emitEvent=function(e,t){switch(e){case"hasErrors":p(n,b,I).call(n,t);break;case"pricesChanged":p(n,v,T).call(n)}},t.plugins={store:h(this,_).vuexStore},g(this,P,new r.a(t)),h(this,P).append(this.node);case 7:case"end":return e.stop()}}),e,this)})),function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function s(e){o(a,r,n,s,l,"next",e)}function l(e){o(a,r,n,s,l,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),T=function(){h(this,_).onUpdate({isValid:this.isValid()})},I=function(e){g(this,f,e.hasErrors),p(this,v,T).call(this)},k=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.vuexStore=t.vuexStore||void 0,this.onUpdate=t.onUpdate}},"jY/V":function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.Row=Class({_rowItems:[],_selected:!0,_defaultOverlayItem:6,_par:null,__construct:function(e){this._par=e,this._render()},_render:function(){this.node=tag("div","generator-picker pf-mb-12",[this._renderHeader(),this._itemsNode=tag("div","generator-picker__wrapper",[this._rowItems=this._par.items.map(this._getRowItems.bind(this))]),this._showLessLink=tag("div",{className:"generator-picker__show-less pf-d-none",onclick:this._onShowOtherItems},lang("Show less"))]),this._rowItems.map(this._setRowItemStatus.bind(this)),this._setItemState()},_setItemState:function(){this._selected=this._hasSelectedItems(),this._selected||mkE.addClassName(this._itemsNode,"pf-d-none")},_setRowItemStatus:function(e,t){return t>this._defaultOverlayItem-1&&this._par.items.length>this._defaultOverlayItem&&e.toggleVisibility(!0),this._par.activeItem&&e.getSectionName()===this._par.activeItem.getSectionName()&&(e.setActive(),t>this._defaultOverlayItem-1&&this.setItemAsGroupActive(e),this._setActiveItem(e)),e},_getRowItems:function(e,t){var i=t===this._defaultOverlayItem-1&&this._par.items.length>this._defaultOverlayItem,r=new PF.MockupGenerator.GeneratorPicker.Par;return r.rowTitle=this._title,r.designData=this._par.designData,r.itemTitle.text=e.title,r.itemTitle.isVisible=!i,r.isRadio=!0,r.content=this._getImage(e),r.item=e,r.onChangedCallback=this._onRowItemChanged,r.overlay={itemCount:this._par.items.length-this._defaultOverlayItem,callback:this._onShowOtherItems,isVisible:i},r.setActiveItemCallback=this._setActiveItem,r.isMockupUpdate=this._par.isMockupUpdate,this._par.isMockupUpdate&&!i||(r.onNodeClickCallback=this._setActive.bind(this,e)),new PF.MockupGenerator.GeneratorPicker.RowItem(r)},_setActiveItem:function(e){this._par.activeItemCallback(e)},_setActive:function(e){for(var t in this._rowItems){var i=this._rowItems[t];i.isActive()&&i.getGeneratorVariantId()!==e.generatorVariantId?(i.removeActive(),i._par.overlay.isVisible&&i.setAsGroupActive(!1)):i.getGeneratorVariantId()===e.generatorVariantId&&(i.setActive(),this._par.activeItem=i)}this._par.onItemClick(this._par.activeItem)},_renderHeader:function(){var e=new PF.Forms.CheckboxPar;return e.onchange=this._onRowToggle,e.label=this._par.groupName,e.isChecked=this._hasSelectedItems(),tag("div","generator-picker__header",[this.checkbox=new PF.Forms.Checkbox(e)])},_onRowToggle:function(){this.checkbox.isChecked()?(this._selected=!0,mkE.removeClassName(this._itemsNode,"pf-d-none")):(this._selected=!1,mkE.addClassName(this._itemsNode,"pf-d-none")),this._par.onRowChanged()},getVariantIds:function(){return this._selected?this._par.items.map((function(e){return e.generatorVariantId})):[]},_hasSelectedItems:function(){var e=!1;for(var t in this._par.items)if(this._par.designData.generatorVariantsIdsToSave.indexOf(this._par.items[t].generatorVariantId)>-1){e=!0;break}return e},_filterPickerItems:function(e,t){return 0!==t||(!e.isActive()&&e._par.overlay.isVisible&&this._rowItems[this._defaultOverlayItem-1].setAsGroupActive(!1),e.removeGroupItemOverlay(),!1)},_mapPickerItems:function(e){e.toggleVisibility(),this.setItemAsGroupActive(e)},_onShowOtherItems:function(){var e=this;this._rowItems.filter((function(t,i){return i>=e._defaultOverlayItem-1})).filter(this._filterPickerItems.bind(this)).map(this._mapPickerItems.bind(this)),mkE.hasClassName(this._showLessLink,"pf-d-none")?mkE.removeClassName(this._showLessLink,"pf-d-none"):mkE.addClassName(this._showLessLink,"pf-d-none")},setItemAsGroupActive:function(e){var t=this._defaultOverlayItem-1;e.isActive()&&this._rowItems[t]._par.overlay.isVisible&&(this._rowItems[t].setAsGroupActive(!0),e.setGroupItem(this._rowItems[t]))},containsDefaultVariant:function(){for(var e in this._par.items)if(this._par.designData.defaultGeneratorVariantId===this._par.items[e].generatorVariantId)return!0;return!1},_getImage:function(e){var t=PF.Utils.isTouch()?100:120;return this._par.designData.getMockupPreview(e,t,t)}},mkE.Base)}()},jYDD:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return m}));var r=i("VbEi"),n=i("LvDl"),a=i.n(n);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.prices=t.prices&&Object.values(t.prices).length?a.a.mapValues(t.prices,(function(e){return PF.Items.GeneratorPriceItem.fromArray(e)})):{},this.initPrices=t.initPrices&&Object.values(t.initPrices).length?a.a.mapValues(t.initPrices,(function(e){return PF.Items.GeneratorPriceItem.fromArray(e)})):{},this.store=t.store?PF.Items.StoreItem.fromArray(t.store):void 0,this.isCustomProduct=t.isCustomProduct||!1,this.showDigitizationNote=t.showDigitizationNote||!1,this.nonCustomizablePlacementsCount=t.nonCustomizablePlacementsCount||0,this.customizablePlacementsCount=t.customizablePlacementsCount||0,this.mainCatalogCategoryId=t.mainCatalogCategoryId,this.hasErrors=t.hasErrors||!1,this.isUpdateFlow=t.isUpdateFlow||!1,this.sortOrder=t.sortOrder||[],this.isInitialized=t.isInitialized||!1}var t,i,n;return t=e,(i=[{key:"loadAttributesFromDesignData",value:function(e){this.prices=Object(r.i)(e),this.initPrices=Object(r.i)(e,!0),this.isCustomProduct=e.isCustomProduct(),this.store=e.store,this.nonCustomizablePlacementsCount=e.getNonCustomizablePlacementsCount(),this.customizablePlacementsCount=e.getCustomizablePlacementsCount(),this.mainCatalogCategoryId=e.product?e.product.mainCatalogCategoryId:null,this.showDigitizationNote=!this.isUpdateFlow&&this.isDigitizationNeeded(e),this.sortOrder=a.a.map(this.prices,"priceKey")}},{key:"isDigitizationNeeded",value:function(e){if(!e.isEmbroidery())return!1;if(e.hasTextLayers())return!0;var t=new PF.Repositories.LibraryRepository,i=e.filesIdsByPlacement,r=a.a.keys(i);return a.a.forEach(r,(function(r){a.a.forEach(i[r],(function(i){var n=t.getCachedFile(i);if(r===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT){var a=e.is3DEmbroidery()&&!n.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_3D),o=e.isPartial3DEmbroidery()&&!n.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_BOTH),s=!n.isSample&&e.isFlatEmbroidery()&&!n.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_FLAT);if(a||o||s)return!0}return!n.isSample&&!n.digitizedItems.existsItemWithPuffType(PF.Items.OrderLineItemFile.DIGITIZATION_FLAT)||!n.isDigitized||void 0}))})),!1}}])&&h(t.prototype,i),n&&h(t,n),e}(),g=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u(this,t),(e=s(this,l(t).call(this,i))).lockedPrices=i.lockedPrices&&Object.values(i.lockedPrices).length?a.a.mapValues(i.lockedPrices,(function(e){return PF.Items.GeneratorPriceItem.fromArray(e)})):{},e}return d(t,e),t}(p),m=function(e){function t(){return u(this,t),s(this,l(t).apply(this,arguments))}return d(t,e),t}(p)},jorx:function(e,t){!function(){"use strict";PF.ProductPush.LiveMockups=Class({_timeStarted:0,_timeEnded:0,__construct:function(e,t){this._designData=e,this.node=mkE({tag:"div",className:"live-mockups",els:[this._nodeStatus=mkE({tag:"div"}),this._nodeMain=mkE({tag:"div",className:"live-mockups__main"}),this._nodeThumbs=mkE({tag:"div",className:"live-mockups__thumbs"})]}),t?this._onProgress(t,!0):this._generate()},_generate:function(){this._onProgress(lang("Waiting for magic to happen")),this._timeStarted=(new Date).getTime(),(new PF.Repositories.GeneratorRepository).generateMockups(this._designData,{onProgress:this._onProgress,onCompleted:this._onGenerated,onFailed:this._onFailed,onStarted:this._onStarted},!0)},_onStarted:function(){this._onProgress(PF.ProductPush.LiveMockups.PROCESSING_FILES_STATE)},_onFailed:function(){this._nodeStatus.textContent=lang("Generating failed. Please")+" ",mkE({tag:"a",text:clang("action","try again"),className:"pf-link",onclick:this._generate}).append(this._nodeStatus),this._nodeStatus.appendChild(document.createTextNode("!"))},_onProgress:function(e,t){this._nodeStatus.textContent=PF.ProductPush.LiveMockups.getStatusMessage(e),t||mkE({tag:"div",className:"margin-top-10 text-center",els:[{tag:"img",src:"/static/images/layout/spinner-white.gif"}]}).append(this._nodeStatus)},_onGenerated:function(e){this._nodeStatus.textContent="",this._timeEnded=(new Date).getTime(),console.log("Generation took "+(this._timeEnded-this._timeStarted)/1e3+" seconds");var t=!0;for(var i in e){var r=e[i];t&&(this._showMain(r.downloadUrl),t=!1),e.length>1&&mkE({tag:"div",className:"live-mockups__thumb",onclick:$.proxy(this._showMain,this,r.downloadUrl),els:[{tag:"img",src:r.downloadUrl}]}).append(this._nodeThumbs)}},_showMain:function(e){mkE.clearNode(this._nodeMain),mkE({tag:"img",src:e}).append(this._nodeMain)}},mkE.Base),PF.ProductPush.LiveMockups.getStatusMessage=function(e){switch(e){case PF.ProductPush.LiveMockups.GENERATING_MOCKUPS_STATE:return dlang("generator","Generating mockups");case PF.ProductPush.LiveMockups.GENERATING_PRINTFILES_STATE:return dlang("generator","Generating printfiles");case PF.ProductPush.LiveMockups.PROCESSING_FILES_STATE:return lang("Processing files");default:return e}},PF.ProductPush.LiveMockups.getShortStatusMessage=function(e){switch(e){case PF.ProductPush.LiveMockups.GENERATING_MOCKUPS_STATE:case PF.ProductPush.LiveMockups.GENERATING_PRINTFILES_STATE:return dlang("generator","Generating");case PF.ProductPush.LiveMockups.PROCESSING_FILES_STATE:return lang("Processing");default:return e}},PF.ProductPush.LiveMockups.GENERATING_MOCKUPS_STATE="generating_mockups",PF.ProductPush.LiveMockups.GENERATING_PRINTFILES_STATE="generating_printfiles",PF.ProductPush.LiveMockups.PROCESSING_FILES_STATE="processing_files"}()},jstg:function(e,t){!function(){"use strict";PF.ProductPush.MockupPicker.Row.Par=Class({__NAME:"PF.ProductPush.MockupPicker.Row.Par",items:null,groupName:null,onRowChanged:null,onItemClick:null,designData:null,activeItemCallback:null,activeItem:null,isMockupUpdate:null})}()},kPvU:function(e,t){!function(){"use strict";PF.ProductPush.PlacementFiles=Class({__NAME:"PF.ProductPush.PlacementFiles",_filesByPlacement:{},addFile:function(e,t){var i=this.getFiles(e);i.push(t),this._filesByPlacement[e.id]=i},removeFile:function(e,t){var i=this.getFiles(e);for(var r in i)if(i[r].fileId==t.fileId)return i.splice(r,1),void(this._filesByPlacement[e.id]=i)},getFiles:function(e){return this._filesByPlacement[e.id]||[]},getFileIdsByPlacement:function(){var e={};for(var t in this._filesByPlacement){e[t]=e[t]||[];var i=this.getFiles({id:t});for(var r in i)e[t].push(i[r].fileId)}return e},hasFiles:function(e){return console.error("Should switch to template usage in hasFiles()"),this.getFiles(e).length>0}})}()},ka4h:function(e,t){!function(){"use strict";PF.ProductPush.CanCustomizeCheckbox=Class({_par:null,_checkbox:null,_titleNode:null,_labelNode:null,_infoButton:null,_slider:null,_sliderComponent:null,__construct:function(e){var t;this._par=e,this._checkbox=tag("input",{type:"checkbox",className:"product-push-customizer-options__checkbox",prop:{checked:this._par.isChecked,onchange:this._changeCheckboxState}}),t=this._par.layerType===PF.Components.GeneratorMockup.TextLayer.TYPE||this._par.layerType===PF.Components.GeneratorMockup.TextboxLayer.TYPE?dlang("dashboard","Allow text personalization"):dlang("dashboard","Allow image personalization"),this._titleNode=tag("h6",{className:"product-push-customizer-options__title "+(this._par.layerType===PF.Components.GeneratorMockup.TextLayer.TYPE||this._par.layerType===PF.Components.GeneratorMockup.TextboxLayer.TYPE?"product-push-customizer-options__title--text-layer":""),prop:{onclick:this._changeCheckboxState}},[t]),this._labelNode=tag("span",{className:"margin-left-10 product-push-customizer-options__label",prop:{onclick:this._changeCheckboxState}},[dlang("dashboard","Let your customers create personalized versions of your design in real-time on your store")]),this.node=tag("div",null,[tag("div","product-push-customizer-options",[this._titleNode,tag("div","product-push-customizer-options__checkbox-wrapper",[this._checkbox,this._labelNode])])]),this._renderSlider(),this._initTooltip()},_changeCheckboxState:function(){this._par.isChecked=!this._par.isChecked,this._checkbox.checked=this._par.isChecked,this._checkbox.setAttribute("checked",this._par.isChecked?"checked":""),this._renderSlider(),this._par.onChange&&this._par.onChange(this._par.isChecked)},_initTooltip:function(){setTimeout((function(){$(".text-picker__can-customize-tooltip").tooltip()}),10)},setSliderValue:function(e){this._sliderComponent&&this._sliderComponent.setValue(e)},_renderSlider:function(){this._par.showSlider&&(this._par.isChecked?this._addSlider():this._removeSlider())},_addSlider:function(){var e=new PF.Components.Slider.Par;e.onSlide=this._par.onSliderChange,e.max=99,e.onSlideEnded=function(){},this._infoButton=tag("a",{className:"margin-left-5"},[tag("img",{src:"/static/images/layout/icons/info.png",alt:lang("Info"),data:{toggle:"tooltip",html:!0},className:"text-picker__can-customize-tooltip",title:dlang("dashboard","Set an area size that's wide enough for longer words")})]),this._slider=tag("div","row",[tag("div","col-xs-12 margin-top-20",[tag("strong",null,[dlang("dashboard","Customizable text area"),this._infoButton])]),tag("div","col-xs-12 margin-top-10 text-picker__can-customize-slider",[this._sliderComponent=new PF.Components.Slider(e)])]),this._slider.append(this.node)},_removeSlider:function(){this._slider&&(mkE.removeNode(this._slider),this._sliderComponent=null,this._slider=null)}},mkE.Base)}()},ke60:function(e,t){!function(){"use strict";PF.ProductPush.QualityItem=Class({__NAME:"PF.ProductPush.QualityItem",_dpi:null,_requiredDpi:null,__construct:function(e,t){this._dpi=e,this._requiredDpi=t},getPercent:function(){var e=Math.round(this._dpi/this._requiredDpi*50);return e>200&&(e=200),e},isBad:function(){return this.getPercent()<50},isMedium:function(){return this.getPercent()>=50&&this.getPercent()<=80},getStatus:function(){return this.isBad()?dlang("generator","Your file is not large enough to meet the minimum requirements!"):this.isMedium()?dlang("generator","We strongly suggest a larger file for better results"):""}})}()},"mN+k":function(e,t){!function(){"use strict";PF.ProductPush.VariantArea.Item.Par=Class({generatorVariant:null,product:null,templates:null,template:null,disableLayerManipulations:null,onRemove:null,onSelect:null,getDesignFillColor:null})}()},mTkf:function(e,t,i){"use strict";i.d(t,"d",(function(){return d})),i.d(t,"f",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"e",(function(){return h})),i.d(t,"g",(function(){return p})),i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return m})),i.d(t,"h",(function(){return _}));var r=i("CXOy"),n=i("LvDl"),a=i.n(n),o=i("Cc5H"),s=i("oCYn");function l(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e){switch(e){case r.h.CREATED_DATE_ASC:return{type:r.c.CREATED_DATE,dir:r.b.ASC};case r.h.CREATED_DATE_DESC:return{type:r.c.CREATED_DATE,dir:r.b.DESC};case r.h.UPDATED_DATE_ASC:return{type:r.c.UPDATED_DATE,dir:r.b.ASC};case r.h.UPDATED_DATE_DESC:return{type:r.c.UPDATED_DATE,dir:r.b.DESC};case r.h.TITLE_ASC:return{type:r.c.TITLE,dir:r.b.ASC};case r.h.TITLE_DESC:return{type:r.c.TITLE,dir:r.b.DESC}}return null}function c(e,t){if(t===r.b.ASC)switch(e){case r.c.CREATED_DATE:return r.h.CREATED_DATE_ASC;case r.c.UPDATED_DATE:return r.h.UPDATED_DATE_ASC;case r.c.TITLE:return r.h.TITLE_ASC}else if(t===r.b.DESC)switch(e){case r.c.CREATED_DATE:return r.h.CREATED_DATE_DESC;case r.c.UPDATED_DATE:return r.h.UPDATED_DATE_DESC;case r.c.TITLE:return r.h.TITLE_DESC}return null}function u(e,t){if(!t)return e;if(t.sortBy&&(Object.values(r.c).includes(t.sortBy)||(t.sortBy=r.c.CREATED_DATE)),t.sortDir&&(Object.values(r.b).includes(t.sortDir)||(t.sortDir=r.b.DESC)),t.page){var i=parseInt(t.page+"");(!i||i<0)&&(i=1),t.page=i}return new r.d(a.a.merge({},e||{},t))}function h(e,t){return new Promise((function(i,r){var n=new PF.Components.SvgThumb.Par;n.template=e.getTemplate(t).shift(),n.async=!0,e.placementOptions&&(n.placementOptions=e.placementOptions.getOptionsForPlacement(t)),n.onSvgProcessedCallback=function(e){i(e)};try{new PF.Components.SvgThumb(n)}catch(e){r(e)}}))}function p(e){return!e.getters[o.h](r.f.FLAG_KEYS.IS_LOADING)&&(e.commit(o.s,{key:r.f.FLAG_KEYS.IS_LOADING,value:!0}),!0)}function g(e,t){t&&t.responseFlags&&Object.keys(t.responseFlags).forEach((function(i){e.commit(o.s,{key:i,value:t.responseFlags[i]})}))}function m(e,t){if(t){e.commit(o.n,{items:t.items});var i=(t.items||[]).map((function(e){return e.id})),n=new r.e({itemIds:l(i),page:t.page,totalPages:t.pages,totalItems:t.total,filter:t.usedFilter,itemsPerPage:t.itemsPerPage});t.responseFlags&&g(e,t),e.commit(o.t,{metadata:n}),e.commit(o.s,{key:r.f.FLAG_KEYS.IS_LOADING,shouldUnset:!0})}else e.commit(o.s,{key:r.f.FLAG_KEYS.IS_LOADING,shouldUnset:!0})}function _(e,t){var i,n;if((null===(i=e.currentItemsResponseMetadata)||void 0===i?void 0:i.itemIds)&&(null===(n=e.filter)||void 0===n?void 0:n.sortBy)&&e.itemRepository&&t){var a=e.currentItemsResponseMetadata.itemIds;if(-1===a.indexOf(t.id)){var o=a.map((function(t){return e.itemRepository[t]})).filter((function(e){return!!e}));if(a.length!==o.length)throw new Error("ItemRepository and current itemIds mismatch!");o.push(t);var l=e.filter;switch(l.sortBy){case r.c.CREATED_DATE:case r.c.UPDATED_DATE:var d=l.sortBy===r.c.CREATED_DATE?"createdAt":"updatedAt";o.sort((function(e,t){return e[d]||t[d]?e[d]&&t[d]?e[d].isSame(t[d])?0:l.sortDir===r.b.ASC?e[d].isBefore(t[d])?-1:1:e[d].isBefore(t[d])?1:-1:e[d]?l.sortDir===r.b.ASC?-1:1:l.sortDir===r.b.ASC?1:-1:0}));break;case r.c.TITLE:o.sort((function(e,t){if(!e.title&&!t.title)return 0;if(!e.title||!t.title)return e.title?l.sortDir===r.b.ASC?-1:1:l.sortDir===r.b.ASC?1:-1;var i=e.title.localeCompare(t.title);return 0===i?0:l.sortDir===r.b.ASC?i<0?-1:1:i<0?1:-1}))}var c=e.currentItemsResponseMetadata.itemsPerPage,u=o.slice(0,c).map((function(e){return e.id}));s.a.set(e.currentItemsResponseMetadata,"itemIds",u)}}}},md6N:function(e,t){!function(){"use strict";PF.ProductPush.VariantArea.Par=Class({generatorVariants:[],activeGeneratorVariant:null,templates:null,onGeneratorVariantSelect:null,onGeneratorVariantRemove:null,product:null,disableLayerManipulations:!1,getDesignFillColor:null})}()},mizT:function(e,t){!function(){"use strict";PF.ProductPush.InlineProductPicker.Par=Class({product:null,isProductPickable:!0,isSync:!1,onProductPickedCallback:function(){console.error("No 'onProductPickedCallback' provided")}})}()},mrzt:function(e,t){!function(){"use strict";PF.ProductPush.InlineProductPicker=Class({_par:null,__construct:function(e){if(this._par=e,this.node=mkE({tag:"div",className:"inline-product-picker clearfix pf-mb-16"}),this._par.isProductPickable){var t=new PF.Modal.Par;t.nodeClass="inline-product-picker",t.modalDialogClass="modal-lg inline-product-picker__modal",t.useScrollableModal=!0,this._modal=new PF.Modal(t),this._initSearchBox()}this._render()},_render:function(){mkE.clearNode(this.node),mkE({tag:"div",els:[{tag:"h6",className:"inline-product-picker__title pf-p-0 pf-mt-0 margin-bottom-5",text:this._par.product.getFullTitle()},PF.Utils.Discount.createLaunchPriceDiscountAnnouncement(this._par.product.priceRange,!0,"pf-mb-16 pf-mt-8"),this._getReviewNode(),{tag:"div",className:"pf-mt-32",els:[{tag:"a",els:[{tag:"span",className:"pf-ui-caption",text:lang("Product info, pricing & guidelines"),onclick:this._popupForMockupGen.bind(this,"info")},{tag:"i",className:"pf-link pf-link-block pf-d-inline-block pf-ml-8 pf-i pf-i-open-in-new",onclick:this._popupForMockupGen.bind(this,"info")}]}]},this._par.isProductPickable&&{tag:"div",els:[{tag:"a",text:lang("Change product"),className:"btn btn-default pf-mt-16",onclick:this._onChangeProduct}]}]}).append(this.node)},_popupForMockupGen:function(e,t){var i=this._par.product;$(t.target).closest("a").css("pointer-events","none");var r=new PF.ProductInfo.Modal({product:i,activeTab:e,showReviews:!0,useScrollableModal:!0}).getModal();$(r._node).on("hidden.bs.modal",(function(){$(t.target).closest("a").css("pointer-events","all")}))},_initSearchBox:function(){var e={};e.type=PF.Components.AutoComplete.SEARCH_TYPE_PRODUCTS_GENERATOR,e.onSelected=this._onItemPicked,e.onEnterPressed=this._onItemPicked,e.placeholder=lang("Search products"),e.showAllResults=this._onShowAllResultsClicked,this._searchBox=new PF.Components.AutoComplete(e)},_onShowAllResultsClicked:function(e){var t=this._getShowAllResultsBreadcrumbs(e),i=mkE({tag:"div",els:[t]}),r=new PF.ProductPicker.Par;r.isForGenerator=!0,r.categoryId=0,r.search=e,r.isSync=this._par.isSync,r.callback=this._onProductPicked.bind(this),new PF.ProductPicker(r).append(i),this._modal.setContent(i),this._modal.setHeaderContent(this.getModalHeader(lang("Choose a product")))},_getShowAllResultsBreadcrumbs:function(e){var t=new PF.Components.BreadCrumbs;return t.add({title:lang("All categories"),onclick:this._setCategoryPickerContent.bind(this,0)}),t.add({title:lang('Search results for "{searchValue}"').replace("{searchValue}",tag("span",{text:e}).innerHTML)}),t},_onChangeProduct:function(){this._setCategoryPickerContent(),this._modal.show()},_onCategoryPicked:function(e){var t=this._getCategoryBreadcrumbs(e),i=mkE({tag:"div",els:[t]}),r=new PF.ProductPicker.Par;r.isForGenerator=!0,r.categoryId=e,r.callback=this._onProductPicked.bind(this),r.isSync=this._par.isSync,new PF.ProductPicker(r).append(i),this._modal.setContent(i),this._modal.setHeaderContent(this.getModalHeader(lang("Choose a product")))},_onItemPicked:function(e){this._onProductPicked(PF.Items.ProductItem.fromArray(e))},_onProductPicked:function(e){this._modal&&this._modal.remove(),this._par.onProductPickedCallback&&this._par.onProductPickedCallback(e)},_getCategoryBreadcrumbs:function(e){var t=new PF.Components.BreadCrumbs,i=(new PF.Repositories.CategoryRepository).getPath(e);for(var r in t.add({title:lang("All categories"),onclick:this._setCategoryPickerContent.bind(this,0)}),i)t.add({title:i[r].name,onclick:this._setCategoryPickerContent.bind(this,i[r].categoryId)});return t},_setCategoryPickerContent:function(e){if(PF.ProductsCatalog&&PF.ProductsCatalog.hasAccess){var t=new PF.ProductsCatalog.Initializer.Par;t.onProductChoose=this._onProductPicked.bind(this),t.isMockupGenerator=!0,t.isClean=!0,this._modal.setContent(PF.ProductsCatalog.Initializer.getInstance(t))}else{var i=new PF.CategoryPicker.Par;i.callback=this._onCategoryPicked.bind(this),i.pickForGenerator=!0,void 0!==e&&(i.categoryId=e);var r=new PF.CategoryPicker(i);this._modal.setContent(r)}this._modal.setHeaderContent(this.getModalHeader(lang("Choose a category")))},_getReviewNode:function(){if(!this._par.product.reviewRating||!this._par.product.reviewRating.reviewCount)return!1;for(var e=[],t=1;t<=5;t++){var i=this._par.product.reviewRating.rating,r="";parseInt(i)!==i&&Math.round(i)===t?r="-half":t>i&&(r="-empty"),e.push({tag:"span",className:"icon-star"+r+" star-rating__star"})}var n=this._par.product.reviewRating.reviewCount;return mkE({tag:"a",className:"pf-link pf-ui-caption pf-mt-4",onclick:this._popupForMockupGen.bind(this,"reviews"),data:{toggle:"tooltip",placement:"bottom"},els:[{tag:"div",className:"star-rating__stars star-rating__stars--inline",els:e},nlang("%d Review","%d Reviews",n)]})},getModalHeader:function(e){return mkE({tag:"div",els:[{tag:"button",type:"button",className:"close",prop:{onclick:this._removeModal},els:[{tag:"span",text:"",attr:{"aria-hidden":"true"}},{tag:"span",className:"sr-only",text:lang("Close")}]},mkE({tag:"h4",els:[e||{tag:"span",prop:{innerHTML:"&nbsp;"}}],className:"pf-m-0 pull-left"}),{tag:"div",className:"search-box",els:[this._searchBox]},{tag:"div",className:"clearfix"}]})},_removeModal:function(){this._modal&&this._modal.remove()}},mkE.Base)}()},muKr:function(e,t){!function(){"use strict";PF.ProductPush.OrientationPicker=Class({_current:"",_available:[],__construct:function(e,t,i,r){this._onOrientationChangedCallback=i,this._available=t.slice(),this._current=r,this.node=mkE({tag:"div",els:[{tag:"hr"},{tag:"h6",text:dlang("generator","Select orientation:")},this._buttons=mkE({tag:"div"})]}),this._render()},_render:function(){for(var e in mkE.clearNode(this._buttons),this._available){var t=this._available[e],i=PF.VariantPicker.getOrientationMap()[t];mkE({tag:"label",text:i,className:"regular",style:"display: block",els:[{tag:"input",type:"radio",className:"margin-right-10",value:e,checked:t==this._current,onclick:this._onOrientationPicked.bind(this,t)}]}).append(this._buttons)}},_onOrientationPicked:function(e){this._current=e,this._render(),this._onOrientationChangedCallback(e)},isValuePicked:function(){return!!this._current},getValueCount:function(){return this._available.length},getValue:function(){return this._current},setValue:function(e){this._current=e||"",this._render()}},PF.VariantPicker.BasePicker),PF.VariantPicker.ORIENTATION_ANY="any",PF.VariantPicker.ORIENTATION_VERTICAL="vertical",PF.VariantPicker.ORIENTATION_HORIZONTAL="horizontal",PF.VariantPicker.getOrientationMap=function(){var e={};return e[PF.VariantPicker.ORIENTATION_ANY]=dclang("generator","product orientation","Any"),e[PF.VariantPicker.ORIENTATION_VERTICAL]=dclang("generator","product orientation","Vertical"),e[PF.VariantPicker.ORIENTATION_HORIZONTAL]=dclang("generator","product orientation","Horizontal"),e}}()},n6mh:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Layer=Class({__construct:function(){this.uniqueId=++PF.Components.GeneratorMockup.Layer._instanceCounter},position:null,uniqueId:0,customizeKey:0,isCustomizable:!1,originalPosition:null,overrideImage:null,overrideImagePulse:null,parentLayerUniqueId:null,patternType:null,patternSpacing:null,flipX:null,flipY:null,generatorOptions:null,isOutOfBounds:function(){return this.position.isOutOfBounds()},isPartiallyOutOfBounds:function(){return this.position.isPartiallyOutOfBounds()},getDefaultColor:function(e){switch(!0){case e.isBlackMug():return"#ffffff";case e.isJewelry():return"#7a7979";default:return"#000000"}},getType:function(){},isSimple:function(){return!(this.position.rotation||this.patternType||this.flipX||this.flipY)},isTextLayer:function(){return!1},isClipartLayer:function(){return!1},isImageLayer:function(){return!1},isTextLayerPartiallyOutOfBounds:function(){return this.isTextLayer()&&this.isPartiallyOutOfBounds()},isChanged:function(e){return!this.isConfigurationSame(e)||this.position.isDifferent(e.position)},wasMirrored:function(){return void 0===this.parentLayerUniqueId},toArray:function(){},getDPI:function(){},isVector:function(){},getOriginalClone:function(e){},getSourceWidth:function(){},getSourceHeight:function(){},getSourceDpi:function(){},getDefaultSize:function(e){var t=this.hasNaturalSize()?this.getSourceDpi():e,i=parseFloat((this.getSourceWidth()/t).toFixed(4)),r=parseFloat((this.getSourceHeight()/t).toFixed(4)),n=r<.75?.75/r:1,a=i<.75?.75/i:1,o=Math.max(a,n);return{width:i*o,height:r*o}},isConfigurationSame:function(e){},hasNaturalSize:function(){return!1},getInitialScale:function(e){return 1}},PF.Items.Item),PF.Components.GeneratorMockup.Layer._instanceCounter=0}()},nvph:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.Preview.Par=Class({__NAME:"PF.Components.GeneratorMockup.Preview.Par",maxWidth:null,maxHeight:null,generatorVariant:null,template:null,isPrintfile:null,designFillColor:null})}()},"oE+F":function(e,t){!function(){"use strict";PF.ProductPush.SimilarPushState=Class({sourceSyncProductId:null,targetProduct:null,flowType:null,__construct:function(){this.flowType=PF.ProductPush.SimilarPushState.FLOW_BASE},isValid:function(){return!!(this.sourceSyncProductId&&this.targetProduct&&this.flowType)},toRPCData:function(){return this.isValid()?{sourceSyncProductId:this.sourceSyncProductId,targetProductId:this.targetProduct.productId,flowType:this.flowType}:null}}),PF.ProductPush.SimilarPushState.FLOW_BASE="FLOW_BASE",PF.ProductPush.SimilarPushState.FLOW_DUPLICATE="FLOW_DUPLICATE"}()},oaIx:function(e,t){!function(){"use strict";PF.ProductPush.AdvancedTemplatePicker=Class({_current:"",_availableTypes:[],_showWarningPopup:!1,_isPopupBusy:!1,__construct:function(e,t,i,r){this._onTemplateTypeChangedCallback=t,this._getCurrentTemplateLoaded=i,this._availableTypes=e.slice(),this._current=r,this.node=tag("div","",[tag("h6","",dlang("generator","Select print file template type")),this._buttons=tag("div")]),this._render()},_render:function(){for(var e in mkE.clearNode(this._buttons),this._availableTypes){var t=this._availableTypes[e],i=this._getTemplateTypeText(t);tag("label","regular pf-d-block",[tag("input",{type:"radio",className:"margin-right-10",value:e,checked:t==this._current,onclick:this._onTemplateTypePicked.bind(this,t)}),i]).append(this._buttons)}},_onTemplateTypePicked:function(e){if(this._current!==e)return this._getCurrentTemplateLoaded&&this._getCurrentTemplateLoaded()===e?(this._current=e,void this._render()):void(this._showWarningPopup?this._isPopupBusy||(this._isPopupBusy=!0,setTimeout(function(){this._isPopupBusy=!1}.bind(this),1e3),new PF.ProductPush.AdvancedTemplatePicker.Popup(this._onTemplateTypePickedRe.bind(this,e),this._render())):this._onTemplateTypePickedRe(e))},_getTemplateTypeText:function(e){var t={};return t[PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_SIMPLE]=dclang("generator","template type","Simple"),t[PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_ADVANCED]=dclang("generator","template type","Advanced"),t[e]?t[e]:""},_onTemplateTypePickedRe:function(e){this._current=e,this._render(),this._onTemplateTypeChangedCallback(e)},isValuePicked:function(){return!!this._current},getValue:function(){return this._current},setValue:function(e){this._current=e||"",this._render()},toggleTemplatePickerPopup:function(e){this._showWarningPopup=e}},PF.VariantPicker.BasePicker)}()},osBa:function(e,t){!function(){"use strict";PF.ProductPush.DesignerHelpers={},PF.ProductPush.DesignerHelpers.isSomethingDesigned=function(e){return e&&e._templates&&e._templates.hasLayers()},PF.ProductPush.DesignerHelpers.areDesignsDifferent=function(e,t){if(!e&&!t)return!1;if(!e||!t)return!0;var i=e._userTemplates||{},r=t._userTemplates||{};if(Object.keys(i).length!==Object.keys(r).length)return!0;var n=!1;return Object.keys(i).forEach((function(e){if(!n)if(r.hasOwnProperty(e)){var t=i[e]||{},a=r[e]||{};Object.keys(t).length===Object.keys(a).length?Object.keys(t).forEach((function(e){if(!n)if(a.hasOwnProperty(e)){var i=t[e],r=a[e];PF.ProductPush.DesignerHelpers.areGeneratorTemplatesDifferent(i,r)&&(n=!0)}else n=!0})):n=!0}else n=!0})),n},PF.ProductPush.DesignerHelpers.areGeneratorTemplatesDifferent=function(e,t){if(!e&&!t)return!1;if(!e||!t)return!0;var i=!1;if(["fillMode","height","placementId","technique","templateId","width"].forEach((function(r){i||e[r]!==t[r]&&(i=!0)})),i)return!0;var r=e.layers||[],n=t.layers||[];if(r.length!==n.length)return!0;for(var a=0;a<r.length;a++){var o=r[a],s=n[a];if(PF.ProductPush.DesignerHelpers.areLayersDifferent(o,s))return!0}},PF.ProductPush.DesignerHelpers.areLayersDifferent=function(e,t){if(!e&&!t)return!1;if(!e||!t)return!0;if(e.getType()!==t.getType())return!0;if(e.position?!t.position:!!t.position)return!0;if(e.position.isDifferent(t.position))return!0;var i=e.toArray(),r=t.toArray();if(Object.keys(i).length!==Object.keys(r).length)return!0;var n=!1,a=["position","uniqueId","overrideImagePulse","overrideImage"];return Object.keys(i).forEach((function(e){n||-1!==a.indexOf(e)||i[e]!==r[e]&&(n=!0)})),n}}()},pWIn:function(e,t){!function(){"use strict";PF.Components.GeneratorMockup.TextLayer=Class({text:"",size:0,font:null,color:"",alignment:"",lineHeight:1,letterSpacing:0,engravingStyle:null,isCustomizable:!1,resizeToPercent:null,hasMultipleLines:!1,embroideryType:"",_getNewLayer:function(){return new PF.Components.GeneratorMockup.TextLayer},getOriginalClone:function(e){var t=this._getNewLayer();return e||(t.uniqueId=this.uniqueId),t.text=this.text,t.size=this.size,t.font=this.font,t.color=this.color,t.alignment=this.alignment,t.lineHeight=this.lineHeight,t.letterSpacing=this.letterSpacing,t.engravingStyle=this.engravingStyle,t.customizeKey=this.customizeKey,t.generatorOptions=this.generatorOptions,t.isCustomizable=this.isCustomizable,t.resizeToPercent=this.resizeToPercent,t.hasMultipleLines=this.hasMultipleLines,t.overrideImage=this.overrideImage,t.overrideImagePulse=this.overrideImagePulse,t.position=this.position.getFromOriginalRatio(),t.originalPosition=this.originalPosition,t.parentLayerUniqueId=this.parentLayerUniqueId,t.embroideryType=this.embroideryType,t.patternType=this.patternType,t.patternSpacing=this.patternSpacing,t.flipX=this.flipX,t.flipY=this.flipY,t},getDPI:function(){return 600},isVector:function(){return!0},toArray:function(){return{type:PF.Components.GeneratorMockup.TextLayer.TYPE,text:this.text,size:this.size,font:this.font.fontKey,fontName:this.font.name,fontPath:this.font["path-js"],color:this.color,alignment:this.alignment,lineHeight:this.lineHeight,letterSpacing:this.letterSpacing,engravingStyle:this.engravingStyle,resizeToPercent:this.resizeToPercent,hasMultipleLines:this.hasMultipleLines?1:0,position:this.position?this.position.toArray():{},embroideryType:this.embroideryType,isCustomizable:this.isCustomizable?1:0,customizeKey:this.customizeKey,uniqueId:this.uniqueId,parentLayerUniqueId:this.parentLayerUniqueId,overrideImage:this.overrideImage,overrideImagePulse:this.overrideImagePulse,patternType:this.patternType,patternSpacing:this.patternSpacing,flipX:this.flipX,flipY:this.flipY}},isTextLayer:function(){return!0},getType:function(){return PF.Components.GeneratorMockup.TextLayer.TYPE},isAlignedLeft:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT},isAlignedRight:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT},isAlignedCenter:function(){return this.alignment===PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER},getFontName:function(){return this.font?this.font.name:""},isSimple:function(){return!1},copyValues:function(e){this.text=e.text,this.size=e.size,this.font=e.font,this.color=e.color,this.alignment=e.alignment,this.lineHeight=e.lineHeight,this.letterSpacing=e.letterSpacing,this.engravingStyle=e.engravingStyle,this.customizeKey=e.customizeKey,this.resizeToPercent=e.resizeToPercent,this.isCustomizable=e.isCustomizable,this.generatorOptions=e.generatorOptions,this.hasMultipleLines=e.hasMultipleLines,this.overrideImage=e.overrideImage,this.overrideImagePulse=e.overrideImagePulse},isConfigurationSame:function(e){return this.text===e.text&&Math.abs(this.size-e.size)<.001&&this.font.fontKey===e.font.fontKey&&Math.abs(this.lineHeight-e.lineHeight)<.001&&Math.abs(this.letterSpacing-e.letterSpacing)<.001&&this.color===e.color&&this.alignment===e.alignment},isWidthHeightRatioSame:function(e){return this.text===e.text&&this.getFontName()===e.getFontName()&&this.alignment===e.alignment&&Math.abs(this.lineHeight-e.lineHeight)<.001&&Math.abs(this.letterSpacing-e.letterSpacing)<.001},isValid:function(){return(new PF.Components.GeneratorMockup.Validator).setActiveLayer(this).setText(this.text).isTextValid()},getUpdateDelay:function(){return this.isCustomizable?10:200},setWidthInPercent:function(e){this.resizeToPercent=e}},PF.Components.GeneratorMockup.Layer),PF.Components.GeneratorMockup.TextLayer.fromArray=function(e){var t=new PF.Components.GeneratorMockup.TextLayer;return t.text=e.text,t.font=PF.TEXT2SVG.FONTS[e.font],t.color=e.color,t.alignment=e.alignment,t.letterSpacing=parseFloat(e.letterSpacing),t.lineHeight=parseFloat(e.lineHeight),t.size=parseFloat(e.size),t.engravingStyle=e.engravingStyle,t},PF.Components.GeneratorMockup.TextLayer.ALIGN_LEFT="left",PF.Components.GeneratorMockup.TextLayer.ALIGN_RIGHT="right",PF.Components.GeneratorMockup.TextLayer.ALIGN_CENTER="center",PF.TEXT2SVG.FONTS={},PF.TEXT2SVG.FONTS_JS_URLS={},PF.TEXT2SVG.LOADED_JS_FONTS={},PF.Components.GeneratorMockup.TextLayer.TYPE="text"}()},pkOh:function(e,t){!function(){"use strict";PF.ProductPush.ColorPicker=Class({__NAME:"PF.ProductPush.ColorPicker",_params:null,callback:null,colors:[],unavailableColors:[],selectedColors:[],node:null,nodeCheckboxes:null,nodeCheckboxCheckAll:null,nodeError:null,__construct:function(e){this._params=e,this.callback=e.onChangedCallback,this.colors=PF.Utils.Colors.sortColorsByLuminosity(e.values).reverse(),this.selectedColors=e.selectedValues,this.node=tag("div","generator-color-picker");var t="";if(this.colors.length>1&&this._params.selectedLimit>1){var i=tag("input",{type:"checkbox",prop:{checked:this.colors.length===this.selectedColors.length}});i.onchange=this._onToggleAll.bind(this,i),t=tag("label",{className:"margin-bottom-5",style:{fontWeight:"normal"}},[i,tag("span","margin-left-10",dlang("generator","Select all colors"))]),this.nodeCheckboxCheckAll=i}this.nodeCheckboxes=tag("div"),tag("div","margin-bottom-30",[tag("h6","",(e.pickerTitle?e.pickerTitle:dlang("generator","Choose color"))+":"),t,this.nodeCheckboxes,this.nodeError=tag("div","alert alert-danger text-center hidden padding-10",[dlang("generator","Please select at least one color!")])]).append(this.node),this._render()},_render:function(){mkE.clearNode(this.nodeCheckboxes);var e,t={};for(e in this.colors)t[this.colors[e].color]=this.colors[e].colorCode2?[this.colors[e].colorCode,this.colors[e].colorCode2]:[this.colors[e].colorCode];var i=[];for(e in this.selectedColors){var r=this.selectedColors[e];i.push(r.color)}var n=new PF.Components.ColorPicker.Par;n.colors=t,n.disabledRegionColors=this._regionDisabledColors,n.unavailableColors=this._unavailableColors,n.discontinuedColors=this._discontinuedColors,n.selectedColors=i,n.showHuge=!0,n.shouldSortColors=!1,n.maxCount=this._params.selectedLimit,n.canDeselectLast=this._params.canDeselectLast,n.onChange=this._onColorsChanged.bind(this,!0),this._picker=new PF.Components.ColorPicker(n).append(this.nodeCheckboxes)},_onColorsChanged:function(e,t){for(var i in this.selectedColors=[],t)for(var r in this.colors)this.colors[r].color===t[i]&&this.selectedColors.push(this.colors[r]);this.nodeCheckboxCheckAll&&(this.nodeCheckboxCheckAll.checked=this.selectedColors.length===this.colors.length),this.updateErrorStatus(),this.callback(this.selectedColors,e)},_onToggleAll:function(e){this.selectedColors=[],e.checked&&(this.selectedColors=this.colors.slice(),ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Check all colors"})),this._render(),this.callback(this.selectedColors)},validateSelectedColors:function(e,t,i,r,n){if(t||(t=this.getSelectedColorNames()),t&&this.setSelectedRegionDisabledValues(i,r,"color",e),!this._params.isPopoverEnabled)return!0;var a="",o="",s=t.length?[].concat(t).shift():"",l=!0;if(this._isColorDiscontinued(s))a=this._params.POPOVER.DISCONTINUED.TITLE,o=this._params.POPOVER.DISCONTINUED.DESC,l=!1;else if(this._isColorRegionDisabled(s)){var d,c;if(this._params&&this._params.getSelectedSizes){var u=this._params.getSelectedSizes();1===u.length&&(d=u[0],c="size")}a=this._params.POPOVER.REGION.TITLE.replace("{region}",this.getAvailableAttributeRegion(s,"color",d,c)),o=this._params.POPOVER.REGION.DESC,l=!1}else this._isColorOutOfStock(s)&&(a=this._params.POPOVER.UNAVAILABLE.TITLE,o=this._params.POPOVER.UNAVAILABLE.DESC);return a&&o&&s&&this._picker.showPopover(s,a,o,n),l},getMatchingVariants:function(){if(!this.activeRegion)return[];var e=new PF.Repositories.Products;return this.getRegionVariants(this.activeRegion).map(e.getCachedVariantById.bind(e))},getValueCount:function(){return this.colors.length},isValuePicked:function(){return this.selectedColors.length>0},hasAtLeastOneValue:function(){return!!this.getValueCount()},setDisabledRegionColors:function(e){return this._regionDisabledColors=e,this},setUnavailableColors:function(e){return this._unavailableColors=e,this},setDiscontinuedColors:function(e){return this._discontinuedColors=e,this},_isColorDiscontinued:function(e){return this._discontinuedColors.indexOf(e)>-1},_isColorOutOfStock:function(e){return this._unavailableColors.indexOf(e)>-1},_isColorRegionDisabled:function(e){return this._regionDisabledColors.indexOf(e)>-1},setColors:function(e){return this.selectedColors=e,this},getSelectedColorNames:function(){var e=[];for(var t in this.selectedColors)-1===e.indexOf(this.selectedColors[t].color)&&e.push(this.selectedColors[t].color);return e},getColorCodes:function(e){for(var t in this.colors)if(this.colors[t].color===e){var i=[this.colors[t].colorCode];return this.colors[t].colorCode2&&i.push(this.colors[t].colorCode2),i}},selectAtLeastOneColorAndRender:function(){return this.selectedColors.length||(this.selectedColors=this._params.selectedValues.length?this._params.selectedValues.slice():[this.colors.slice().shift()]),this._render(),this},render:function(){return this._render(),this}},PF.VariantPicker.BasePicker)}()},qud1:function(e,t){!function(){"use strict";PF.ProductPush.ClipartPicker=Class({__NAME:"PF.ProductPush.ClipartPicker",_state:{groups:[],group:null,groupNeeded:null},_nodeBreadcrumbs:null,_nodeGroups:null,_nodeItems:null,_nodeRecent:null,_nodeRecentTitle:null,_par:null,_areGroupsRendered:null,_isFileDropAreaEnabled:null,__construct:function(e){this._par=e,this.node=tag("div","clipart-picker",[tag("a",{className:"pf-link-block pf-mb-24",onclick:this._par.onBackCallback},[tag("i","pf-i pf-i-chevron-left pf-i-24 pf-text-muted"),tag("span","pf-pl-4",lang("Back to design tools"))]),this._nodeRecentTitle=tag("h5","pf-h5 pf-mb-16 pf-d-none",dlang("generator","Recently used")),this._nodeRecent=tag("div","row-flex pf-mb-12 pf-d-none"),this._nodeBreadcrumbs=tag("div","pf-mb-8"),this._nodeGroups=tag("div","row row-flex"),this._nodeItems=tag("div","row-flex")])},renderGroups:function(){this._areGroupsRendered?this._render():this._getAllCliparts(this._render.bind(this))},_render:function(){return this._renderBreadcrumbs(),this._state.group?(mkE.addClassName(this._nodeGroups,"hidden"),mkE.removeClassName(this._nodeItems,"hidden")):(mkE.removeClassName(this._nodeGroups,"hidden"),mkE.addClassName(this._nodeItems,"hidden")),this._renderRecent(),this},_renderBreadcrumbs:function(){mkE.clearNode(this._nodeBreadcrumbs);var e=new PF.Components.BreadCrumbs;mkE.removeClassName(e.node,"hide-only"),this._state.group?(e.add({title:dlang("generator","Clipart collections"),onclick:this._goHome}),e.add({title:this._state.group.name})):e.add({title:dlang("generator","Clipart collections")}),e.append(this._nodeBreadcrumbs)},_setGroups:function(e){mkE.clearNode(this._nodeGroups),mkE.clearNode(this._nodeItems),this._state.groups=e;for(var t=0,i=this._state.groups.length;t<i;t++)this._addGroup(this._state.groups[t]);this._state.groupNeeded&&(this._setActiveGroupById(this._state.groupNeeded),this._render()),this._areGroupsRendered=!0,this._renderRecent()},_addGroup:function(e){tag("div","col-4 col-xs-3 col-sm-3 col-md-4 col-xl-3 pf-mb-8",[tag("div",{className:"clipart-picker__group pf-p-4 pf-p-xs-8",onclick:this._onGroupClick.bind(this,e)},[tag("div","clipart-picker__labels",[e.extra.new?tag("span","pf-badge pf-badge-small pf-badge--primary",lang("New")):"",e.extra.hidden?tag("span","pf-badge pf-badge-small pf-badge--primary",dlang("generator","hidden")):""]),tag("div","clipart-picker__ratio",[tag("div","clipart-picker__ratio__inner",[this._getSpinner(e)])]),tag("p","text-center pf-my-0",[tag("span","",[e.name])])])]).append(this._nodeGroups)},_addItems:function(e){mkE.clearNode(this._nodeItems);for(var t=0,i=e.items.length;t<i;t++)this._renderItem(e.items[t]).append(this._nodeItems);return this},_renderRecent:function(){mkE.clearNode(this._nodeRecent);var e=(new PF.Repositories.ClipartRepository).getRecent(this._par.selectedPlacementTechnique);!this._state.group&&this._areGroupsRendered&&e.length>0?(mkE.removeClassName(this._nodeRecent,"pf-d-none"),mkE.removeClassName(this._nodeRecentTitle,"pf-d-none")):(mkE.addClassName(this._nodeRecent,"pf-d-none"),mkE.addClassName(this._nodeRecentTitle,"pf-d-none"));for(var t=0,i=e.length;t<i;t++)this._renderItem(e[t]).append(this._nodeRecent);return this},_renderItem:function(e){return tag("div",{className:"col-2 pf-px-4 clipart-picker__col",data:{groupId:e.groupId}},[tag("div",{className:"clipart-picker__item pf-p-4 pf-mb-12",onclick:this._onItemClick.bind(this,e)},[tag("div","clipart-picker__labels",[e.extra.new?tag("span","pf-badge pf-badge-small pf-badge--primary",lang("new")):"",e.extra.hidden?tag("span","pf-badge pf-badge-small pf-badge--primary",dlang("generator","hidden")):""]),tag("div","clipart-picker__ratio",[tag("div","clipart-picker__ratio__inner",[this._getSpinnerAndLoadDimensions(e,!0)])])])])},_onGroupClick:function(e,t){this._state.group=e,this._state.groupNeeded=null,this._addItems(e)._showItems()._render()},_showItems:function(){for(var e=0,t=this._nodeItems.childNodes.length;e<t;e++)String(this._state.group.id)===this._nodeItems.childNodes[e].getAttribute("data-groupid")?mkE.removeClassName(this._nodeItems.childNodes[e],"hidden"):mkE.addClassName(this._nodeItems.childNodes[e],"hidden");return this},_onItemClick:function(e,t){(new PF.Repositories.ClipartRepository).addRecent(e.id,this._par.selectedPlacementTechnique),this._par.onAddFileCallback(e),this._goHome()},_goHome:function(){this._state.group=null,this._state.groupNeeded=null,this.renderGroups()},_setActiveGroupById:function(e){for(var t=0,i=this._state.groups.length;t<i;t++)if(this._state.groups[t].id===e){this._state.group=this._state.groups[t],this._state.groupNeeded=null;break}this._state.group||(this._state.groupNeeded=e)},_getAllCliparts:function(e){(new PF.Repositories.ClipartRepository).getAllActive(this._par.selectedPlacementTechnique,function(t){this._setGroups(t),e&&e()}.bind(this))},_getSpinnerAndLoadDimensions:function(e,t){return this._getSpinner(e,t,(function(t,i){e.width=t,e.height=i}))},_getSpinner:function(e,t,i){var r=e.image.urlThumb,n=tag("img",{className:"img-responsive",src:t?"":PF.ASSETS_URL+"images/layout/spinner-white.gif",style:{opacity:.3}}),a=new Image;return a.onload=function(){n.src=r,n.style.opacity=1,i&&i(a.width,a.height)},a.src=r,e instanceof PF.Items.GeneratorClipartItem&&(n.ondragstart=this._clipartDragStart.bind(this,e),n.ondragend=this._clipartDragEnd.bind(this)),n},_clipartDragStart:function(e,t){this._par.fileDropZone.enableDomElementDropZone(),t.dataTransfer.setData("domelement",JSON.stringify(e))},_clipartDragEnd:function(e){this._par.fileDropZone.disableDomElementDropZone()}},mkE.Base)}()},sXCq:function(e,t){!function(){"use strict";PF.ProductPush.TextPicker.Par=Class({templates:null,onLayerCreated:function(e){console.error("No callback present for - onLayerCreated",e)},onLayerRemoved:function(e){console.error("No callback present for - onLayerRemoved",e)},onLayerConfigurationChanged:function(e){console.error("No callback present for - onLayerConfigurationChanged",e)},product:null,placementSelector:null,allowCustomizableLayers:null,technique:null,onBackCallback:null,isAdvancedTemplate:null,isAllOver:null,threadColorSelectionLimit:null,embroideryTypePrices:null,getSelectedEmbroideryColors:null})}()},tFrD:function(e,t){!function(){"use strict";PF.ProductPush.TemplateChangeListeners=Class({__NAME:"PF.ProductPush.TemplateCallbacks",_onAdded:[],_onRemoved:[],_onTemplatePositionsChanged:[],_onTemplateResized:[],_onLayerRotated:[],_onOrderChanged:[],_onAddedOrRemoved:[],_onActiveLayerChanged:[],_onLayerConfigurationChanged:[],_onLayerCustomizableStateChanged:[],_onDesignFillColorChanged:[],_onLayerColorsChanged:[],_onZoomChanged:[],_onPreviewChanged:[],_allListeners:["_onAdded","_onRemoved","_onTemplatePositionsChanged","_onTemplateResized","_onLayerRotated","_onOrderChanged","_onAddedOrRemoved","_onActiveLayerChanged","_onLayerConfigurationChanged","_onDesignFillColorChanged","_onLayerColorsChanged","_onZoomChanged","_onPreviewChanged"],__construct:function(){window.dumpListeners=this._dumpListeners},_dumpListeners:function(){for(var e in this._allListeners)if(this._allListeners.hasOwnProperty(e)){var t=this._allListeners[e],i=this[t].length;if(i){console.log(""+t,i);for(var r=0;r<i;r++){var n=this[t][r];console.log(" %c"+n.name.substring(6)+"("+n.__args+")","color:dimgray")}}else console.log(""+t,i),console.log(" %c(empty)","color:dimgray")}},addOnLayerAddedListener:function(e){return this._onAdded.push(e),this},addOnLayerAddedOrRemovedListener:function(e){return this._onAddedOrRemoved.push(e),this},addOnLayerRemovedListener:function(e){return this._onRemoved.push(e),this},addOnTemplatePositionsChangedListener:function(e){return this._onTemplatePositionsChanged.push(e),this},addOnTemplateResizedListener:function(e){return this._onTemplateResized.push(e),this},addOnLayerRotatedListener:function(e){return this._onLayerRotated.push(e),this},addOnLayerOrderChangedListener:function(e){return this._onOrderChanged.push(e),this},addOnActiveLayerChanged:function(e){return this._onActiveLayerChanged.push(e),this},addOnLayerConfigurationChanged:function(e){return this._onLayerConfigurationChanged.push(e),this},addOnDesignFillColorChanged:function(e){return this._onDesignFillColorChanged.push(e),this},addOnLayerCustomizableStateChanged:function(e){return this._onLayerCustomizableStateChanged.push(e),this},addOnLayerColorsChanged:function(e){return this._onLayerColorsChanged.push(e),this},addOnZoomChanged:function(e){return this._onZoomChanged.push(e),this},addonPreviewChanged:function(e){return this._onPreviewChanged.push(e),this},notifyPreviewChanged:function(e,t,i){this._notify(this._onPreviewChanged,arguments)},notifyLayerRemoved:function(e,t){this._notify(this._onRemoved,arguments),this._notify(this._onAddedOrRemoved,arguments)},notifyLayersAdded:function(e){this._notify(this._onAdded,arguments),this._notify(this._onAddedOrRemoved,arguments)},notifyLayerOrderChanged:function(){this._notify(this._onOrderChanged,arguments)},notifyTemplatePositionsChanged:function(e,t,i){this._notify(this._onTemplatePositionsChanged,arguments)},notifyTemplateResized:function(e,t,i){this._notify(this._onTemplateResized,arguments)},notifyLayerRotated:function(e,t){this._notify(this._onLayerRotated,arguments)},notifyActiveLayerChanged:function(e,t){this._notify(this._onActiveLayerChanged,arguments)},notifyLayerConfigurationChanged:function(e,t){this._notify(this._onLayerConfigurationChanged,arguments)},notifyDesignFillColorChanged:function(){this._notify(this._onDesignFillColorChanged,arguments)},notifyLayerCustomizableStateChanged:function(e){this._notify(this._onLayerCustomizableStateChanged,[e])},notifyLayerColorsChanged:function(e,t,i){this._notify(this._onLayerColorsChanged,[e,t,i])},notifyZoomChanged:function(e){this._notify(this._onZoomChanged,[e])},_notify:function(e,t){for(var i=0,r=(e=e.slice()).length;i<r;i++)e[i].apply(null,t)},unsubscribe:function(e){for(var t=0,i=this._allListeners.length;t<i;t++){var r=this._allListeners[t];this[r]=this[r].filter((function(t){return t!==e}))}return this}})}()},tK7T:function(e,t,i){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s}));var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.store=t.store?PF.Items.StoreItem.fromArray(t.store):null,this.loadedData=t.loadedData?new s(t.loadedData):null,this.isCurrentlyLoadingData=t.isCurrentlyLoadingData||!1}return a(e,[{key:"areResultsCalculated",get:function(){return!!this.loadedData}},{key:"areSimilarProductsLoaded",get:function(){return!(!this.loadedData||!this.loadedData.isLoaded)}}]),e}(),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.sourceSyncProduct=t.sourceSyncProduct?PF.Items.SyncProductItem.fromArray(t.sourceSyncProduct):null,this.targetProducts=t.targetProducts?t.targetProducts.map((function(e){return e instanceof PF.Items.ProductItem?e:PF.Items.ProductItem.fromArray(e)})):null,this.printfileUrl=t.printfileUrl}return a(e,[{key:"isLoaded",get:function(){return!!(this.sourceSyncProduct&&this.targetProducts&&this.targetProducts.length)}}]),e}()},tWQt:function(e,t){function i(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}!function(){"use strict";PF.ProductPush.Pricing.Validator=Class({__NAME:"PF.ProductPush.Pricing.Validator",_designData:null,_loadedFlags:{},__construct:function(e,t){this._designData=e,this._loadedFlags=t},getErrors:function(){var e=[];if(this._isCategoryValid()||e.push(lang("Please pick one or more product collections.")),this._isPriceDiffTooLarge()){var t=this._designData.store.hasDifferentRetailCurrency()?""+PF.ProductPush.Pricing.Validator.WISH_RETAIL_DIFFERENCE_THRESHOLD*this._designData.store.retailCurrencyRate:"$"+PF.ProductPush.Pricing.Validator.WISH_RETAIL_DIFFERENCE_THRESHOLD;e.push(lang("Lowest and highest price cannot differ by more than {amount}").replace("{amount}",t))}return e},_isCategoryValid:function(){if(this._loadedFlags.hasOwnProperty("PushCategories")&&!this._loadedFlags.PushCategories)return!0;var e=(new PF.Repositories.StoreRepository).getCachedStore(this._designData.storeId);if(this._getIntegrationsWithCategoryRequired().indexOf(e.type)>-1&&!(this._designData.categoryIds||[]).length)return!1;return!0},_isPriceDiffTooLarge:function(){if((new PF.Repositories.StoreRepository).getCachedStore(this._designData.storeId).type!==PF.Items.StoreItem.TYPE_WISH||_.isEmpty(this._designData.prices))return!1;var e=this._designData.store.hasDifferentRetailCurrency()?PF.ProductPush.Pricing.Validator.WISH_RETAIL_DIFFERENCE_THRESHOLD*this._designData.store.retailCurrencyRate:PF.ProductPush.Pricing.Validator.WISH_RETAIL_DIFFERENCE_THRESHOLD,t=this._designData.prices.map((function(e){return e.retailPrice})),r=Math.min.apply(Math,i(t));return Math.max.apply(Math,i(t))-r>e},_getIntegrationsWithCategoryRequired:function(){return[PF.Items.StoreItem.TYPE_BIGCOMMERCE]}}),PF.ProductPush.Pricing.Validator.WISH_RETAIL_DIFFERENCE_THRESHOLD=20}()},tx4t:function(e,t,i){"use strict";i.r(t);var r=i("4Vs6");PF.ProductPush.Designer=Class({_KEY_SELECTED_COLORS:"productPushSelectedColors",_KEY_SELECTED_SIZES:"productPushSelectedSizes",_generatorParams:null,_templates:null,generatorVariants:null,_selectedColors:[],_selectedRegionAttributes:{},_selectedSizes:[],_initialSizes:[],allColors:null,discontinuedColors:{},allSizes:null,allAvailableSizes:null,previewMockupVariant:null,_variantArea:null,designData:null,_par:null,_layerPicker:null,_textPicker:null,_nodeTextPicker:null,_layerPickerChooser:null,_clipartPicker:null,_regionPicker:null,_colorPicker:null,_designFillColorPicker:null,_designFillColorApplyCheckbox:null,_sizePicker:null,_techniquePicker:null,_productOptionsPicker:null,_resizeTimeout:null,_renderTimeouts:{},_placementSelector:null,storeId:null,_replaceableParentNode:null,_zoomInLoading:!1,_mockup:null,_mockupMainMaxWidth:0,_mockupMainMaxHeight:0,allVariants:{},_pickerTabContents:{},_designerTabContents:{},_shouldRegeneratePreview:!0,_shouldRegenerate3D:!0,_orientation:"",_templateType:null,observer:null,excludedPlacements:{},_technique:"",allLabelTypesAvailable:!1,_nodeFooter:null,_dynamicStickyFooter:null,_nodeEmbroideryVideoTutorial:null,_nodeDTGVideoTutorial:null,_nodeTextDigitizationPriceDecrease:null,_nodeHatSideBackDigitizationPriceDecrease:null,_nodeMainMockupArea:null,_nodeMainMockupAreaImage:null,_placementOptions:null,_placementOptionsRawStorage:null,_embroideryHelper:null,__construct:function(e){this._par=e,this._product=e.product,this._technique=this._getInitTechnique(),this._par.store&&this._par.store.storeId&&(this.storeId=this._par.store.storeId),this._par.isProductPushMode?(this._mockupMainMaxWidth=this._par.pushMockupMainMaxWidth,this._mockupMainMaxHeight=this._par.pushMockupMainMaxHeight):(this._mockupMainMaxWidth=this._par.mockupMainMaxWidth,this._mockupMainMaxHeight=this._par.mockupMainMaxHeight),this.designData=new PF.ProductPush.DesignData;var t=new PF.ProductPush.Templates.Par;t.validateAddingLayer=this.validateAddingLayer.bind(this),t.getProduct=this.getProduct.bind(this),t.getSelectedMockupVariant=this._getSelectedVariant.bind(this),t.getOrientation=this.getOrientation.bind(this),t.getDesignMeta=this._getDesignMeta.bind(this),this._templates=new PF.ProductPush.Templates(t);var i=new PF.Repositories.Products;this.allVariants=i.variantItemCache?Object.values(i.variantItemCache):{},this._par.observer?this.observer=this._par.observer:this.observer=new PF.ProductPush.Designer.Observer,this._orientation=this._par.forceOrientation,this.previewMockupVariant=this._par.previewMockupVariant,this._subscribeTemplateEvents();var r=this._par.shouldShowPrice?" pf-mb-48 ":"";this.node=tag("div",{className:"product-push "+r+(PF.Utils.isTouch()?" is-touch":""),id:"js--product-push-designer"}),this._initTabContents(),this._updateExcludedPlacements(),this.generatorRepository=new PF.Repositories.GeneratorRepository;var n=new PF.ProductPush.EmbroideryHelper.Par;n.shouldAllowFileColorChanger=this.shouldAllowFileColorChanger.bind(this),n.getSelectedPlacementId=this.getSelectedPlacementId.bind(this),n.getSelectedPlacementTechnique=this.getSelectedPlacementTechnique.bind(this),n.designerNode=this.node,n.getNodeMainMockupArea=this.getNodeMainMockupAreaNode.bind(this),n.scheduleEmbroideryPreviewUpdate=this._scheduleEmbroideryPreviewUpdate.bind(this),n.templates=this._templates,n.editImageLayer=this._editImageLayer.bind(this),n.onLayerColorsChanged=this._onLayerColorsChanged.bind(this),n.getAvailablePlacements=this.getAvailablePlacements.bind(this),n.pickerConfig=this._par.pickerConfig,n.product=this._product,n.isAllOverProduct=this.isAllOverProduct.bind(this),n.onAllImagesProcessed=this.onAllImagesProcessed.bind(this),n.getProductOptionsPicker=this.getProductOptionsPicker.bind(this),n.isCustomizingMode=this._par.isCustomizingMode,this._embroideryHelper=new PF.ProductPush.EmbroideryHelper(n),this.render(),this._par.autoLoad&&this._loadProduct(this._par.designerState,!0),this._par.isMockupGeneratorMode&&this._nodeFooter&&(this._dynamicStickyFooter=new PF.MockupGenerator.Designer.DynamicStickyFooter(this._nodeFooter,!0)),window.dump=this._dump},_getInitTechnique:function(e){var t=this._getTechniqueFromStorage()||this._product.availableTechniques.slice().shift()||this._product.type;if(this._product.isJewelry()&&t!==PF.Items.ProductItem.TECHNIQUE_ENGRAVING&&(t=PF.Items.ProductItem.TECHNIQUE_ENGRAVING),e)return t;var i=this._par.productTemplateEditorState;return i&&(this._isProductTemplateEditor()&&i.isNewTemplateEditor()||(t=null)),t},_dump:function(){var e=function(e){if(!e)return{};var t={id:e.uniqueId,parent:e.parentLayerUniqueId,type:"",data:"",position:"",flipX:e.flipX,flipY:e.flipY};e.isTextLayer()?(t.type="text",t.data='"'+e.text.replace(/\n/," ")+'", '+Number(e.size).toFixed(1)+", "+e.color+", "+e.alignment+", "+e.getFontName()):e.isClipartLayer()?(t.type="clipart",t.data=e.clipartItem.id+", "+e.clipartItem.name+", "+e.fillColor):e.temporaryFileItem?(t.type="temporaryFileItem",t.data=e.temporaryFileItem.fileId+", "+e.temporaryFileItem.filename+", "+e.temporaryFileItem.filesize+", "+e.temporaryFileItem.urlLarge):e.fileItem&&(t.type="fileItem",t.data=e.fileItem.fileId+", "+e.fileItem.filename+", "+e.fileItem.filesize+", "+e.fileItem.urlLarge);var i=e.position;return t.position=Number(i.width).toFixed(2)+"x"+Number(i.height).toFixed(2)+", x"+Number(i.left).toFixed(2)+"y"+Number(i.top).toFixed(2)+", r"+Number(i.rotation).toFixed(2),t},t=this._templates.getActiveLayer();for(var i in this._templates._userTemplates){var r=Object.keys(this._templates._userTemplates[i]).length;if(r>0)for(var n in console.log(""+i,r),this._templates._userTemplates[i])if(Object.keys(this._templates._userTemplates[i][n]).length>0){var a=this._templates._userTemplates[i][n],o=a.layers.length;if(console.log(" "+a.getKey(),"("+a.width+"x"+a.height+")",o),o>0)for(var s=0;s<o;s++){var l=e(a.layers[s]),d=t&&t.uniqueId===a.layers[s].uniqueId?"font-weight:bold;":"";console.log("  %c"+l.id+" "+l.type+" "+(l.parent?"("+l.parent+") ":"")+l.position+" flipX:"+l.flipX+" flipY:"+l.flipY,d),console.log("   %c"+l.data,"color:dimgray;"+d)}else console.log("  %c(empty)","color:dimgray")}else console.log(" %c(empty)","color:dimgray");else console.log("%c(empty)","color:dimgray")}console.log("Active Layer:",t.toArray(!0,!0)),console.log("lastSelectedColor:",this.lastSelectedColor,"lastSelectedSize:",this.lastSelectedSize,"_shouldAllowCustomizablePush:",this._shouldAllowCustomizablePush())},_unsubscribeTemplateEvents:function(){this._templates&&this._templates.getChangeListener().unsubscribe(this._onLayerAdded).unsubscribe(this._onLayerAddedOrRemoved).unsubscribe(this._onLayerRemoved).unsubscribe(this._onLayerOrderChanged).unsubscribe(this._onTemplatePositionsChanged).unsubscribe(this._onActiveLayerChanged).unsubscribe(this._onTemplateResized).unsubscribe(this._checkOutOfBoundsLayers).unsubscribe(this._onPreviewChanged).unsubscribe(this.requireMockupRegenerationAndShowDesigner).unsubscribe(this.requireMockupRegeneration)},_subscribeTemplateEvents:function(){this._templates&&(this._templates.getChangeListener().addOnLayerAddedListener(this._onLayerAdded).addOnLayerAddedOrRemovedListener(this._onLayerAddedOrRemoved).addOnLayerRemovedListener(this._onLayerRemoved).addOnLayerOrderChangedListener(this._onLayerOrderChanged).addOnTemplatePositionsChangedListener(this._onTemplatePositionsChanged).addOnActiveLayerChanged(this._onActiveLayerChanged).addOnTemplateResizedListener(this._onTemplateResized).addOnLayerColorsChanged(this._onLayerColorsChanged).addOnZoomChanged(this._onZoomChanged).addOnLayerCustomizableStateChanged(this._checkOutOfBoundsLayers).addonPreviewChanged(this._onPreviewChanged),this._isDesignerTabsVisible()&&this._templates.getChangeListener().addOnLayerAddedOrRemovedListener(this.requireMockupRegenerationAndShowDesigner).addOnTemplatePositionsChangedListener(this.requireMockupRegenerationAndShowDesigner).addOnLayerOrderChangedListener(this.requireMockupRegeneration).addOnLayerConfigurationChanged(this.requireMockupRegenerationAndShowDesigner).addOnLayerColorsChanged(this.requireMockupRegenerationAndShowDesigner).addOnDesignFillColorChanged(this.requireMockupRegenerationAndShowDesigner))},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this._unsubscribeTemplateEvents(),!0)},registerReplaceableParent:function(e){e&&(this._replaceableParentNode=e)},_showLoader:function(e,t){this._par.onLoaderToggle?this._par.onLoaderToggle(e,t,!0):PF.LoadingOverlay.show(e,t)},_hideLoader:function(e){this._par.onLoaderToggle?this._par.onLoaderToggle(e,null,!1):PF.LoadingOverlay.hide(e)},_getTechniqueFromStorage:function(){return PF.Utils.TechniqueMemory(this._product.productId).getTechniqueFromMemory()},_getSelectedVariant:function(){return this.previewMockupVariant},_loadProduct:function(e,t,i){var r=this._par.generatorParameters;if(this._par.productTemplateEditorState&&(i?r=null:this._par.generatorParameters=null),r)return this._productLoaded(t,i,r),!1;this._showLoader(this.node),this.observer.emitDesignerDisabled();var n={storeId:this._par.store.storeId,isMockupGeneratorMode:this._par.isMockupGeneratorMode,isProductPushMode:this._par.isProductPushMode,isOrderFlowMode:this._par.isOrderFlowMode,productId:this._product.productId||this._par.productId,designerState:e,excludedPlacements:this.excludedPlacements,callback:function(e){this._par.onProductLoaded&&this._par.onProductLoaded(e),this._par.isProductPreloaded?setTimeout(function(){this._productLoaded(t,i,e)}.bind(this),200):this._productLoaded(t,i,e)}.bind(this),technique:this._technique,forceTechnique:i,forceOrientation:this._orientation,generatorDesignKey:this._par.generatorDesignKey,useGeneratedDesignRpcUrl:this._par.useGeneratedDesignRpcUrl,generatorVariant:this.previewMockupVariant,forceTemplateType:this._templateType,productOptions:this._par.pickerConfig.productOptionsValues,similarProductPushState:this._par.similarProductPushState,productTemplateEditorState:this._par.productTemplateEditorState,currency:this._product.priceRange&&this._product.priceRange.currency};this._par.useGeneratedDesignRpcUrl?this.generatorRepository.loadProduct(n):this.generatorRepository.loadGeneratorProduct(n)},_reloadEverything:function(){var e=new PF.ProductPush.DesignerState;this._par.designerState&&(e.generatorDesignId=this._par.designerState.generatorDesignId),this._par.designerState=e,e.addFromTemplates(this._templates),this._savePlacementOptionsLocaly(),this._templates.setActiveLayer(null),this._loadProduct(e,!0)},_productLoaded:function(e,t,i){if(this._hideLoader(this.node),PF.Components.GeneratorMockup.resetGrid(),this._generatorParams=i,this._par.isCustomizerEnabled=this._generatorParams.isCustomizerEnabled,this._conflictCalculator&&this._conflictCalculator.setConflictingTypes(this._generatorParams.conflictingTypes),this._placementOptions=this._generatorParams.placementOptions,this._productOptionsPicker&&this._productOptionsPicker.setPickerGeneratorPlacements(i.availablePlacements),this._templates.setRequiredDpi(i.requiredDPI),this.variantLimit=parseInt(i.variantLimit,10)||null,this.allColors=PF.Utils.Colors.sortColorsByLuminosity(i.colors).reverse(),this.allSizes=i.sizes,this.regionData=i.regions,this._selectedRegionAttributes={},this._orientation||(this._orientation=i.orientation),(this._par.isProductPushMode||this._par.isMockupGeneratorMode&&this._canRenderColorPicker()&&this._canRenderSizePicker(!0))&&(this.discontinuedColors=this._getDiscontinuedColorsPerSize(i.variantMapping),this.allColors=this._getAvailableColors(i.variantMapping)),!this._selectedColors.length)if(i.preselectedData&&i.preselectedData.colors){var r=i.preselectedData.colors.slice();(this._par.isOrderFlowMode||this._par.isChangePrintfileMode)&&(r=r.slice(0,1)),this._selectedColors=r}else this._selectedColors=this._getDefaultSelectedColors();if(this._isProductTemplateEditor()&&!this._selectedSizes.length&&(this._par.product.canHaveColorPicker()?this._selectedSizes=this.allSizes.slice():this._selectedSizes=i.preselectedData&&i.preselectedData.templateSelectedSizes?i.preselectedData.templateSelectedSizes.slice():[]),!this._selectedSizes.length&&this._par.isProductPushMode&&(this._selectedSizes=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_SIZE)),(!this._par.isOrderFlowMode&&!this._par.isChangePrintfileMode||this._isCreatingProductFromTemplate())&&!this._selectedSizes.length)if(i.preselectedData&&i.preselectedData.sizes){var n=i.preselectedData.sizes.slice();(this._par.isOrderFlowMode||this._par.isChangePrintfileMode)&&(n=n.slice(0,1)),this._selectedSizes=n}else this._isCreatingProductFromTemplate()?this._isProductTemplateDetailsEditor()&&this._canRenderSizePicker()?this._selectedSizes=[]:this._selectedSizes=this._getDefaultSelectedSizes().slice(0,1):this._selectedSizes=this._getDefaultSelectedSizes();if(this._initialSizes=this._selectedSizes,i.preselectedData){var a=this._technique;if(i.preselectedData.technique?this._technique=i.preselectedData.technique:this._technique||(this._technique=this._getInitTechnique(!0)),this._isProductTemplateDetailsEditor()||a===this._technique||(PF.Utils.TechniqueMemory(this._product.productId).rememberLastUsedTechnique(this._technique),this.shouldAllowTextboxLayer()?this._renderTextboxPicker():this._renderTextPicker()),this._par.pickerConfig&&i.preselectedData.optionData&&(this._par.pickerConfig.setOptionsValues(i.preselectedData.optionData),this._productOptionsPicker)){var o=new PF.Components.ProductOptions(this._createProductOptionsPickerPar());this._productOptionsPicker.setProductOptions(o),this._productOptionsPicker.render()}}if(this._par.isChangePrintfileMode&&this._processVariantData(),this.designData=i.designData,this.designData.store=this._par.store,this.designData.product=this._par.product,this._isProductTemplateEditor()){var s=this._par.productTemplateEditorState.sourceProductTemplate;i.preselectedData.templateSelectedSizes?this.designData.templateSelectedSizes=i.preselectedData.templateSelectedSizes.slice():this.designData.templateSelectedSizes=s?(s.sizes||[]).slice():this._product.canHaveColorPicker()?[]:this._selectedSizes.slice()}this._placementOptions&&(this.designData.rawPlacementOptions=this._placementOptions.getData()),this._templates.silentlyRemoveAllTemplates(),this._templates.silentlyCopyLayers(i.calculatedPositions),t&&(this._templates.silentlyRemoveAllLayers(),this._productOptionsPicker=null,this._renderProductOptions()),e&&this._par.designerState&&this._templates.silentlySetDesignerState(this._par.designerState),this._selectedVariantCount=0,this._allSelectedVariantCount=0,PF.Components.GeneratorMockup.isZoomedIn=!1,this._setHideEmptyPlacements(i.calculatedPositions),this._placementSelector&&this._placementSelector.setPlacements(this._generatorParams.availablePlacements),this._isProductTemplateDetailsEditor()||(this._renderLayerPicker(),this._renderOrientationPicker(),this._renderClipartPicker(),this._renderLayerPickerChooser(),this._renderEmbroideryImagePicker(),this._renderPatternPicker()),this._renderPickerTabs(),this._onProductLoadedShowDesignTab&&(this.showDesignTab(),this._onProductLoadedShowDesignTab=!1),this._par.isChangePrintfileMode||(this._regionPicker||this._renderRegionPicker(),this._isProductTemplateDetailsEditor()||this._renderTechniquePicker(),this._renderColorPicker(),this._renderSizePicker()),this._isProductTemplateDetailsEditor()||this._renderInlineProductPicker(),this.shouldAllowFileColorChanger()||this._embroideryHelper.customizingDesignWithNewEmbroideryColorPicker()?this._templates.hasLayers()?this._embroideryHelper.canSwitchToNewEmbrColorPicker()?this._embroideryHelper.switchToNewEmbrColorPicker():this._embroideryHelper.colorizeEmbroideryLayers():this.updateView():(this.updateView(),i.availablePlacements.filter((function(e){return e.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY})).forEach(function(e){this._updateEmbroideryColorsForPlacement(e.id)}.bind(this)),this._tryApplyingEmbroideryColorization());var l=this._templates.getUsedFonts();e&&this._shouldPreloadFonts()&&this._preloadFontsAndSetActiveLayer(l,this._onFontsPreloaded.bind(this,l)),this._is3dViewAvailable(this._product.productId)&&e&&(this._show3dViewWarningAlert=!0),0===l.length&&this._removeCustomizerDataFromAllLayers(),this._par.onReady&&this._par.onReady(),setTimeout(function(){this.observer.emitDesignerReady(),this._par.disableDesignerLeaveWarning||this._isProductTemplateEditor()||new PF.Popup.DesignerLeaveWarning(this._templates,this._par.isModalDesigner)}.bind(this),1)},displayTemplateSizeChangeWarningIfNeeded:function(){var e=this;if(this._par.product.productId===PF.Items.ProductItem.ID_GILDAN_18500&&this._par.designerState&&(this._par.existingVariants||this._par.orderLineItem)&&(!this._par.existingVariants||this._par.designerState.generatorDesignId)){var t=this._templates.getUserTemplate(this.getSelectedPlacementId(),this._getSelectedVariant().templateId);if(t){var i=[];if(this._par.existingVariants){var r=this._par.existingVariants.filter((function(t){return t.designId===e._par.designerState.generatorDesignId}));if(!(r&&r.length&&r[0].orderLineItem&&r[0].orderLineItem.design&&r[0].orderLineItem.design.templates))return;i=r[0].orderLineItem.design.templates}else if(this._par.orderLineItem){if(!this._par.orderLineItem.design||!this._par.orderLineItem.design.templates)return;i=this._par.orderLineItem.design.templates}var n=i.find((function(i){return i.placementId===e.getSelectedPlacementId()&&(i.width===t.width&&i.height===t.height||i.height===t.width&&i.width===t.height)}));if(n||(n=i.find((function(t){return t.placementId===e.getSelectedPlacementId()}))),n&&(n.width!==t.width&&n.width!==t.height||n.height!==t.height&&n.height!==t.width)){var a=Math.round(100*t.width)/100,o=Math.round(100*t.height)/100,s=[tag("div","pf-h4",dlang("generator",'We changed our recommended print file size to {width}"x{height}"').replace("{width}",a).replace("{height}",o)),tag("div","",dlang("generator",'You can adjust your design to the new size and save the changes. If you dont want to make any changes, close the editor and well scale your current print file to {width}"x{height}"the placement only appears misaligned in the editor; your product will be printed as normal.').replace("{width}",a).replace("{height}",o))];new PF.Components.Alert(s,"warning",!1,!0,!0,null).prepend(this._nodeMainMockupArea)}}}},_onFontsPreloaded:function(e,t){t||(t=this._onFontsPreloadedFinal),this.shouldAllowTextboxLayer()||t&&t();var i=e.filter((function(e){return!PF.CANVAS.LOADED_TTF_FONTS.hasOwnProperty(e.fontKey)})),r=0;i.length>0?i.forEach((function(e){PF.CANVAS.loadRequiredFont(e.fontKey,e["path-ttf"],(function(){++r===i.length&&t&&t()}))}),this):t&&t()},_onFontsPreloadedFinal:function(){this._setDefaultActiveLayer(!0),this._colorizeClipartLayers(),this._removeCustomizerDataFromAllLayers()},_processVariantData:function(){var e=new PF.Repositories.Products,t=e.getCachedVariantsByProductId(this._product.productId);t.length?setTimeout(function(){this._setChangePrintFileAttributes(t)}.bind(this),1):e.getVariants(this._par.product.productId,function(e,t){this._setChangePrintFileAttributes(t)}.bind(this))},_shouldPreloadFonts:function(){return!(!this._par.designerState&&!this._par.productTemplateEditorState)&&(this._par.isOrderFlowMode||this._par.isChangePrintfileMode||this._par.similarProductPushState||this._par.productTemplateEditorState)},_preloadFontsAndSetActiveLayer:function(e,t){var i=e.filter((function(e){return!PF.ProductPush.TextPicker.hasFontLoaded(e.fontKey)})),r=0;i.length>0?i.forEach((function(e){PF.TEXT2SVG.loadRequiredFont(e,function(){++r===i.length&&t&&t()}.bind(this))}),this):t&&t()},_setDefaultActiveLayer:function(e){var t=this._getSelectedVariant(),i=t?t.templateId:null,r=this._templates.getActiveLayer()||this._templates.getFirstLayer(this.getSelectedPlacementId(),i);if(r){var n=this._templates.getTemplateByLayer(r);e?this._templates.silentlySetActiveLayer(r):this._templates.setActiveLayer(r,null),n&&n.placementId&&this._placementSelector.setSelectedPlacementById(n.placementId),r instanceof PF.Components.GeneratorMockup.ClipartLayer&&this._onClipartColorChanged(r)}this.updateView()},_setChangePrintFileAttributes:function(e){var t,i,r=[];for(t in this._selectedColors=[],this._selectedSizes=[],e)for(i in this._par.existingVariants)e[t].variantId===this._par.existingVariants[i].variantId&&(-1===this._selectedSizes.indexOf(e[t].size)&&this._selectedSizes.push(e[t].size),-1===r.indexOf(e[t].color)&&r.push(e[t].color));for(t in this.allColors)for(i in r)this.allColors[t].color===r[i]&&this._selectedColors.push(this.allColors[t]);var n=this.getSelectedGeneratorVariants();this.generatorVariants=n.generatorVariants,this._selectedVariantCount=n.variantCount;var a=this._par.defaultPlacementId?this.getGeneratorVariantByPlacementId(this._par.defaultPlacementId,!0):this.generatorVariants[0];this.setPreviewMockupVariant(a),this._templates.setActiveLayerFromTemplate(a.placementId,a.templateId),this.setActivePlacement(a.placementId),this._renderMockupMainArea()},_getAvailableColors:function(e){var t=[];for(var i in e){var r=e[i];!r.discontinued&&t.indexOf(r.color)&&t.push(r.color)}var n=this.allColors;for(var a in n){var o=n[a];-1===t.indexOf(o.color)&&delete n[a]}return n},_getDefaultPickerValue:function(e,t){var i="",r=this._par.pickerConfig;switch(e){case PF.VariantPicker.PickersConfig.TYPE_COLOR:var n=r.colorConfig.defaultValue||"";for(var a in this.allColors){var o=this.allColors[a];if(n===o.color){i=o;break}}break;case PF.VariantPicker.PickersConfig.TYPE_SIZE:i=r.sizeConfig.defaultValue||"",this.allSizes.indexOf(i)<0&&(i="");break;case PF.VariantPicker.PickersConfig.TYPE_PRODUCT_OPTIONS:var s=r.productOptionsValues?r.productOptionsValues:this._productOptionsPicker?this._productOptionsPicker.getValues():{};return t?s[t]:s}return i?[i]:[]},_initTabContents:function(){this._pickerTabContents[PF.ProductPush.Designer.TAB_PRODUCT]=tag("div"),this._pickerTabContents[PF.ProductPush.Designer.TAB_DESIGN]=tag("div"),this.shouldAllowTextboxLayer()?this._pickerTabContents[PF.ProductPush.Designer.TAB_TEXTBOX]=tag("div"):this._pickerTabContents[PF.ProductPush.Designer.TAB_TEXT]=tag("div"),this._pickerTabContents[PF.ProductPush.Designer.TAB_IMAGE]=tag("div"),this._pickerTabContents[PF.ProductPush.Designer.TAB_CLIPART]=tag("div"),this._designerTabContents[PF.ProductPush.Designer.TAB_DESIGNER]=tag("div"),this._designerTabContents[PF.ProductPush.Designer.TAB_PREVIEW]=tag("div"),this._designerTabContents[PF.ProductPush.Designer.TAB_3D]=tag("div")},_isProductTemplateEditor:function(){return this._par.productTemplateEditorState&&this._par.productTemplateEditorState.isTemplateEditFlow()},_isCreatingProductFromTemplate:function(){return this._par.productTemplateEditorState&&this._par.productTemplateEditorState.isProductCreateFlow()},_isProductTemplateDetailsEditor:function(){return this._isCreatingProductFromTemplate()&&this._par.productTemplateEditorState.useSimpleDesigner},render:function(){this._isProductTemplateDetailsEditor()?this._renderDetailsEditor():this._renderFull()},_renderDetailsEditor:function(){if(this._isProductTemplateDetailsEditor()){this._par.arePickersVisible=!0,this._nodeProductOptions=tag("div"),this._renderProductOptions(),this._placementSelector=new PF.ProductPush.PlacementSelector((function(){}),this._getPlacementPrices()),this._nodeRegionPicker=tag("div"),this._renderRegionPicker(),this._nodeColorPicker=tag("div"),this._renderColorPicker(),this._nodeAvailability=tag("div"),this._renderAvailability(),this._nodeUsedColors=tag("div"),this._renderUsedColors(),this._nodeSizePicker=tag("div"),this._renderSizePicker(),this._nodeVariantWarning=tag("div","product-push__variant-warning"),this._renderVariantWarning(),this._nodeDiscontinuedWarning=tag("div","product-push__discontinued-warning"),this._renderDiscontinuedWarning(),this._nodeExistingVariantsWarning=tag("div","product-push__existing-warning"),this._renderExistingVariantsWarning(),this._nodePickerTabs=tag("div","pf-mb-24"),this._nodePickerTabContents=tag("div","pf-mb-48"),this._renderPickerTabContents();var e=[this._nodeRegionPicker,this._nodeAvailability,this._nodeColorPicker,this._nodeSizePicker,this._nodeVariantWarning,this._nodeDiscontinuedWarning,this._nodeExistingVariantsWarning,this._nodeUsedColors];tag("div","row pf-mb-0",[tag("div","col-md-12 pf-mt-8",[this._nodePickerTabContents])]).append(this.node),this._buildPickerTabContent(PF.ProductPush.Designer.TAB_PRODUCT,e),this._par.isFooterVisible&&(this._nodeFooter=mkE({tag:"div",className:"footer-block navigation__sticky-buttons "+(this._par.isMockupGeneratorMode?"":"navigation__sticky-buttons--popup"),els:[this._nodeFooterContainer=mkE({tag:"div",className:this._par.isMockupGeneratorMode?"container":"container-fluid"})]}),this._par.onFooterRender?this._par.onFooterRender(this._nodeFooter):this._nodeFooter.append(this.node),this._renderFooter())}},_renderFull:function(){if(!this._isProductTemplateDetailsEditor()){mkE.clearNode(this.node),this._placementSelector=new PF.ProductPush.PlacementSelector(this._onPlacementSelectorChanged,this._getPlacementPrices()),this._product.isAdvancedInsideLabelAllowed()&&(this._labelSwitcher=new PF.ProductPush.LabelSwitcher),this._conflictCalculator=new PF.ProductPush.ConflictCalculator(this._placementSelector,this._templates),this._nodeProductOptions=tag("div"),this._renderProductOptions(),this._nodeInlineProductPicker=tag("div"),this.shouldAllowTextboxLayer()?(this._nodeTextboxPicker=tag("div"),this._renderTextboxPicker()):(this._nodeTextPicker=tag("div"),this._renderTextPicker()),this._nodeEmbroideryImagePicker=tag("div"),this._nodePatternPicker=tag("div","pf-mt-12"),this._nodeLayerPicker=tag("div","pf-mb-24"),this._nodeDesignFillColorPicker=tag("div","pf-mb-24 pf-px-8 product-push__design-fill-color-picker"),this._nodeClipartPicker=tag("div","pf-mb-24"),this._nodeOrientationPicker=tag("div","pf-mb-24"),this._nodeRegionPicker=tag("div"),this._renderRegionPicker(),this._nodeTechniquePicker=tag("div"),this._renderTechniquePicker(),this._nodeColorPicker=tag("div"),this._renderColorPicker(),this._nodeAvailability=tag("div"),this._renderAvailability(),this._nodeLayerPickerChooser=tag("div"),this._nodeUsedColors=tag("div"),this._renderUsedColors(),this._nodeSizePicker=tag("div"),this._renderSizePicker(),this._nodeAdvancedTemplatePicker=tag("div","pf-px-8 pf-mt-24"),this._nodeVariantWarning=tag("div","product-push__variant-warning"),this._renderVariantWarning(),this._nodeDiscontinuedWarning=tag("div","product-push__discontinued-warning"),this._renderDiscontinuedWarning(),this._nodeExistingVariantsWarning=tag("div","product-push__existing-warning"),this._renderExistingVariantsWarning(),this._nodePickerTabs=tag("div","pf-mb-24"),this._renderPickerTabs(),this._nodePickerTabContents=tag("div","pf-mb-48"),this._renderPickerTabContents(),this._nodeDesignerTabContents=tag("div"),this._renderDesignerTabContents(),this._nodeDesignerTabs=tag("div"),this._activeDesignerTabId=PF.ProductPush.Designer.TAB_DESIGNER,this._showDesignerTab(this._activeDesignerTabId),this._par.isOrderFlowMode||this._par.isCustomizingMode?this._nodeMockupArea=tag("div","row",[this._placementSelector,!!this._product.isAdvancedInsideLabelAllowed()&&this._labelSwitcher,this._nodeMainMockupArea=tag("div","main-mockup-area"),this._nodeMockupVariantArea=tag("div","hidden")]):this._nodeMockupArea=tag("div","",[this._placementSelector,!!this._product.isAdvancedInsideLabelAllowed()&&this._labelSwitcher,this._nodeMainMockupArea=tag("div",{className:"main-mockup-area "+(this._isEmpty()?"main-mockup-area--empty-mockup":""),style:{position:"relative"}}),tag("div","pf-mb-8"),this._nodeMockupVariantArea=tag("div")]),tag("div","row pf-mb-0",[this._par.arePickersVisible?tag("div","col-md-4 pf-mt-8",[this._nodePickerTabs,this._nodePickerTabContents]):"",tag("div",this._par.arePickersVisible?"col-md-8":"col-md-12",[this._nodeDesignerTabs,this._nodeDesignerTabContents])]).append(this.node);var e=[this._nodeInlineProductPicker,this._nodeOrientationPicker,this._nodeRegionPicker,this._nodeAvailability,this._nodeTechniquePicker,this._nodeColorPicker,this._nodeSizePicker,this._nodeProductOptions,this._nodeVariantWarning,this._nodeDiscontinuedWarning,this._nodeExistingVariantsWarning,this._nodeLayerPickerChooser,this._nodeUsedColors],t=[this._nodeLayerPicker,this._nodeDesignFillColorPicker],i=[tag("a",{className:"pf-link-block",onclick:this.showDesignTab.bind(this)},[tag("i","pf-i pf-i-chevron-left pf-i-24 pf-text-muted"),tag("span","pf-pl-4",lang("Back to design tools"))]),tag("hr","pf-my-12"),this._nodeEmbroideryImagePicker,this._nodePatternPicker];this._buildPickerTabContent(PF.ProductPush.Designer.TAB_PRODUCT,e),this._buildPickerTabContent(PF.ProductPush.Designer.TAB_DESIGN,t),this.shouldAllowTextboxLayer()?this._buildPickerTabContent(PF.ProductPush.Designer.TAB_TEXTBOX,[this._nodeTextboxPicker]):this._buildPickerTabContent(PF.ProductPush.Designer.TAB_TEXT,[this._nodeTextPicker]),this._buildPickerTabContent(PF.ProductPush.Designer.TAB_IMAGE,i),this._buildPickerTabContent(PF.ProductPush.Designer.TAB_CLIPART,[this._nodeClipartPicker]),this._buildDesignerTabContent(PF.ProductPush.Designer.TAB_DESIGNER,[this._nodeMockupArea]),this._buildDesignerTabContent(PF.ProductPush.Designer.TAB_PREVIEW,[this._nodePreviewArea=tag("div")]),this._buildDesignerTabContent(PF.ProductPush.Designer.TAB_3D,[this._node3DArea=tag("div")]);var r=this._par.productTemplateEditorState;(this._par.isProductPushMode||!this._par.isOrderFlowMode||r)&&this._par.isFooterVisible&&(this._nodeFooter=mkE({tag:"div",className:"footer-block navigation__sticky-buttons "+(this._par.isMockupGeneratorMode?"":"navigation__sticky-buttons--popup"),els:[this._nodeFooterContainer=mkE({tag:"div",className:this._par.isMockupGeneratorMode?"container":"container-fluid"})]}),(this._par.isMockupGeneratorMode||r)&&(this._par.onFooterRender?this._par.onFooterRender(this._nodeFooter):this._nodeFooter.append(this.node)),this._renderFooter()),window.onresize=function(){if(!this._zoomInLoading&&PF.Utils.isInDocument(this._nodeMainMockupArea)&&this._mockup&&this._mockup.getMockup()&&this._mockup.getMockup().node){var e=this._mockup.getMockup(),t=e.node.parentNode,i=e.node,r=this._par.isProductPushMode?this._par.pushMockupMainMaxWidth:this._par.mockupMainMaxWidth,n=t.clientWidth!==t.scrollWidth,a=i.clientWidth!==r&&t.clientWidth>i.clientWidth+100;(n||a)&&this._onResize(300)}}.bind(this)}},getNodeMainMockupAreaNode:function(){return this._nodeMainMockupArea||null},append:function(e){return this.node.append(e),this._onResize(300),this},_buildPickerTabContent:function(e,t){for(var i in t)t[i].append(this._pickerTabContents[e])},_buildDesignerTabContent:function(e,t){for(var i in t)t[i].append(this._designerTabContents[e])},_getPlacementPrices:function(){return this._par.isOrderFlowMode?this._par.pickerConfig.placementPrices:null},_getDiscontinuedColorsPerSize:function(e){var t,i={},r={};for(var n in e){var a=e[n];(t=a.size)in i||(i[t]=[]),i[t].push(a.color),a.discontinued&&(t in r||(r[t]=[]),r[t].push(a.color))}for(var o in this.allColors){var s=this.allColors[o].color;for(t in i)-1===i[t].indexOf(s)&&(t in r||(r[t]=[]),r[t].push(s))}return r},_renderInlineProductPicker:function(){if(this._par.arePickersVisible){mkE.clearNode(this._nodeInlineProductPicker);var e=PF.ProductPush.InlineProductPicker.Par;e.product=this._product,e.onProductPickedCallback=this._onProductPickedFromPicker,e.isProductPickable=!this._par.isProductPushMode&&!this._par.isOrderFlowMode&&!this._par.productTemplateEditorState,e.isSync=this._par.isProductPushMode,new PF.ProductPush.InlineProductPicker(e).append(this._nodeInlineProductPicker)}},_renderPickerTabs:function(){if(this._par.arePickersVisible){mkE.clearNode(this._nodePickerTabs);var e=new PF.Components.Tabs("primary top-icons tabs-justify");this._pickerTabs=e,e.add({caption:dlang("generator","Product"),icon:tag("i","pf-i pf-i-tshirt-crew-outline pf-i-24"),customId:PF.ProductPush.Designer.TAB_PRODUCT,onclick:this.showProductTab.bind(this)}),this._isProductTemplateDetailsEditor()||e.add({caption:dlang("generator","Design"),icon:tag("i","pf-i pf-i-palette-outline pf-i-24"),customId:PF.ProductPush.Designer.TAB_DESIGN,onclick:this.showDesignTab.bind(this)}),e.append(this._nodePickerTabs),this.showProductTab()}},_renderDesignerTabs:function(){if(!this._isProductTemplateDetailsEditor()&&this._nodeDesignerTabs){mkE.clearNode(this._nodeDesignerTabs);var e=!this._templates.hasLayers()&&!this._hasPlacementWithDesignFillColor();if(this._isDesignerTabsVisible()&&!e&&(this._selectedSizes.length||this._selectedColors.length)&&0!==this.getSelectedGeneratorVariants(!1).generatorVariants.length){var t=new PF.Components.Tabs("secondary");t.add({caption:this._getTemplateTabName(),isActive:this._activeDesignerTabId===PF.ProductPush.Designer.TAB_DESIGNER,customId:PF.ProductPush.Designer.TAB_DESIGNER,onclick:this._onDesignerTabPicked.bind(this,PF.ProductPush.Designer.TAB_DESIGNER)}),this._is3dViewAvailable(this._product.productId)&&this.hasDesignForPlacement(PF.Items.OrderLineItemFile.TYPE_DEFAULT)&&t.add({caption:tag("div","",[dlang("generator","3D view"),tag("span","pf-badge pf-badge-small pf-badge-new pf-badge--primary pf-badge-new pf-ml-4",clang("Badge","New"))]),isActive:this._activeDesignerTabId===PF.ProductPush.Designer.TAB_3D,customId:PF.ProductPush.Designer.TAB_3D,onclick:function(){this._onDesignerTabPicked(PF.ProductPush.Designer.TAB_3D),this._manage3dViewPlacementCheck()}.bind(this)}),this._isMockupViewAvailable()&&t.add({caption:dlang("generator","Mockup view"),isActive:this._activeDesignerTabId===PF.ProductPush.Designer.TAB_PREVIEW,customId:PF.ProductPush.Designer.TAB_PREVIEW,onclick:function(){this._onDesignerTabPicked(PF.ProductPush.Designer.TAB_PREVIEW);var e=this._getSelectedMappings();this.generatorRepository.getGeneratorVariants(e,function(e){this._generatorParams.generatorVariants=Object.assign(this._generatorParams.generatorVariants,e),this._showMockupPreview()}.bind(this))}.bind(this)}),tag("div","pf-mb-12 text-center",[t]).append(this._nodeDesignerTabs)}}},_is3dViewAvailable:function(e){var t,i=null===(t=this._getSelectedVariant())||void 0===t?void 0:t.templateId;return PF.ProductPush.Live3dView.getMapObject(e,i)},_isMockupViewAvailable:function(){var e=this.getAvailablePlacements().map((function(e){return e.id})).filter(function(e){return this.hasDesignForPlacement(e)}.bind(this));return Object.values(this._generatorParams.generatorVariants).filter((function(t){return e.indexOf(t.placementId)>-1&&t.role!==PF.Items.GeneratorVariantItem.ROLE_TEMPLATE&&t.role!==PF.Items.GeneratorVariantItem.ROLE_ADVANCED_TEMPLATE})).length>0},_isDesignerTabsVisible:function(){return!this._par.isCustomizingMode&&(this._product.isMug()||this._product.isSublimation()||this._product.isCutSew()||this._product.isCanvas()||this._product.isPoster()||this._product.isFramedPoster()||this._product.isSticker()||this._technique===PF.Items.ProductItem.TECHNIQUE_ENGRAVING)},_onDesignerTabPicked:function(e){this._activeDesignerTabId!==e?(this._onBeforeSwitchToTab(e),this._activeDesignerTabId=e,this._renderDesignerTabs(),this._showDesignerTab(e)):this._renderDesignerTabs()},_onBeforeSwitchToTab:function(e){this._activeDesignerTabId===PF.ProductPush.Designer.TAB_DESIGNER&&this._is3dViewAvailable(this._product.productId)&&(this._mockupAreaSize=this._calculateMockupMainAreaSize()),this._live3dView&&this._activeDesignerTabId===PF.ProductPush.Designer.TAB_3D&&e!==PF.ProductPush.Designer.TAB_3D&&this._live3dView.stopAnimate()},_renderPickerTabContents:function(){for(var e in this._pickerTabContents)this._pickerTabContents[e].append(this._nodePickerTabContents)},_renderDesignerTabContents:function(){for(var e in this._designerTabContents)this._designerTabContents[e].append(this._nodeDesignerTabContents)},_showPickerTab:function(e){if(!this._isPickerTabDisabled(e)&&this._par.arePickersVisible){for(var t in this._pickerTabContents)t===e?mkE.removeClassName(this._pickerTabContents[t],"hidden"):mkE.addClassName(this._pickerTabContents[t],"hidden");var i=e===PF.ProductPush.Designer.TAB_PRODUCT?e:PF.ProductPush.Designer.TAB_DESIGN;this._pickerTabs.markTabAsSelectedById(i),i===PF.ProductPush.Designer.TAB_PRODUCT?this._isProductTemplateDetailsEditor()||(this._templates.setActiveLayer(null,null,!0),this._renderLayerPickerChooser()):(this._templates.hasLayersForPlacement(this.getSelectedPlacementId())&&!this._templates.getActiveLayer()&&this._templates.setActiveLayerFromTemplate(this.previewMockupVariant.placementId,this.previewMockupVariant.templateId),this._renderLayerPicker()),e===PF.ProductPush.Designer.TAB_CLIPART&&this._clipartPicker.renderGroups(),e===PF.ProductPush.Designer.TAB_IMAGE&&this._patternPicker&&this._patternPicker.resubscribeToEvents(),this._mockup&&this._mockup.renderMirrorCheckbox(e===PF.ProductPush.Designer.TAB_IMAGE),this._renderTextDigitizationPriceDecreaseNode(e),this._renderHatSideBackDigitizationPriceDecreaseNode(e),this._renderEmbroideryVideoTutorial(e),this._renderDTGVideoTutorial(e),PF.Utils.isTouch()&&$(".tooltip").tooltip("hide"),PF.Events.emit(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE)}},_showDesignerTab:function(e){for(var t in this._designerTabContents)t===e?mkE.removeClassName(this._designerTabContents[t],"hidden"):mkE.addClassName(this._designerTabContents[t],"hidden");PF.Events.emit(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE)},_showMockupPreview:function(){if(this._shouldRegeneratePreview){mkE.clearNode(this._nodePreviewArea);var e=this.getDesignData(),t=null;e.generatorVariants.length?this._par.isCustomizingMode||this._productOptionsPicker&&this._productOptionsPicker.hasValidOptions()?this.isFileLimitExceeded()&&(t=this.getFileLimitExceededText()):t=e.product.isEmbroidery()?dlang("generator","Please select thread colors!"):dlang("generator","Please select product options!"):t=dlang("generator","Please select size, color and at least one file!"),null===t&&(this._shouldRegeneratePreview=!1),new PF.ProductPush.LiveMockups(e,t).append(this._nodePreviewArea),t&&(this._productOptionsPicker.updateErrorStatus(),this.showProductTab()),PF.Events.emit(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE)}},_manage3dViewPlacementCheck:function(){if(this.getSelectedPlacementId()!==PF.Items.OrderLineItemFile.TYPE_DEFAULT){PF.LoadingOverlay.show(this._node3DArea);var e=this._placementSelector._placements.filter((function(e){return e.id===PF.Items.OrderLineItemFile.TYPE_DEFAULT}));if(e=e[0])return this._placementSelector.deselectPlacement(),this._updateActivePlacement(e),this._onPlacementSelectorChanged(e.id),void(this._needToShow3dTab=!0)}this._show3DPreview()},_show3DPreview:function(e){var t=this;if(this._shouldRegenerate3D){mkE.clearNode(this._node3DArea),this._shouldRegenerate3D=!1;var i=new PF.ProductPush.Live3dView.Par;i.mockup=this._mockup,i.loadingNode=this._node3DArea,i.productId=this._product.productId,i.getSelectedVariant=this._getSelectedVariant.bind(this),i.width=this._mockupAreaSize.maxWidth,i.height=this._mockupAreaSize.maxHeight,i.getLoaded3dObj=function(){return t._loaded3dObj},i.on3dObjectLoaded=function(e){return t._loaded3dObj=e},i.showWarningAlert=this._show3dViewWarningAlert,i.onWarningAlertClose=function(){this._show3dViewWarningAlert=!1}.bind(this),e||PF.LoadingOverlay.show(this._node3DArea),this._live3dView=new PF.ProductPush.Live3dView(i),this._live3dView.append(this._node3DArea)}else this._live3dView&&this._live3dView.startAnimate&&this._live3dView.startAnimate()},requireMockupRegeneration:function(){this._shouldRegeneratePreview=!0,this._shouldRegenerate3D=!0},requireMockupRegenerationAndShowDesigner:function(e){var t=Array.prototype.slice.call(arguments).some((function(e){return e&&e.skipMockupRegeneration}));t||this.requireMockupRegeneration(),this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY&&this._activeDesignerTabId!==PF.ProductPush.Designer.TAB_DESIGNER||this._onDesignerTabPicked(PF.ProductPush.Designer.TAB_DESIGNER),e||this._renderFooter()},setMockupControlsVisibility:function(e){this._mockup&&this._mockup.updateControlsVisibility(e)},showProductTab:function(){this._showPickerTab(PF.ProductPush.Designer.TAB_PRODUCT)},showDesignTab:function(){this._getSelectedVariant()&&this._showPickerTab(PF.ProductPush.Designer.TAB_DESIGN)},setLayerPickerError:function(e){this._layerPicker.showError(),this._layerPicker.nodeError.textContent=e},_onProductPickedFromPicker:function(e){if(!this._templates.hasLayers()||confirm(lang("Changes that you made may not be saved. Are you sure?"))){PF.Popup.DesignerLeaveWarning.disable=!0,this._showLoader(this.node);try{location.assign(e.getMockupGeneratorUrl())}catch(t){location.href=e.getMockupGeneratorUrl()}}},_renderTextPicker:function(){if(mkE.clearNode(this._nodeTextPicker),this._par.arePickersVisible){var e=new PF.ProductPush.TextPicker.Par;e.templates=this._templates,e.onLayerCreated=this._onTextLayerCreated,e.onLayerRemoved=this._onTextLayerRemoved,e.onLayerConfigurationChanged=this._onTextLayerChanged,e.placementSelector=this._placementSelector,e.product=this._product,e.allowCustomizableLayers=this._shouldAllowCustomizablePush,e.technique=this._technique,e.onBackCallback=this.showDesignTab.bind(this),e.isAdvancedTemplate=this._isAdvancedTemplateLoaded.bind(this),e.isAllOver=this.isAllOverProduct.bind(this),this.shouldAllowFileColorChanger()&&(e.getSelectedEmbroideryColors=this._embroideryHelper.getSelectedPaletteColors.bind(this._embroideryHelper),e.threadColorSelectionLimit=PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS,e.embroideryTypePrices=this._getEmbroideryPricesData()),this._textPicker&&this._textPicker.unsubscribeTemplateEvents(),this._textPicker=new PF.ProductPush.TextPicker(e),this._textPicker.append(this._nodeTextPicker),this._toggleTextPickerAvailability()}},_renderTextboxPicker:function(){if(mkE.clearNode(this._nodeTextboxPicker),this._par.arePickersVisible){var e=new PF.ProductPush.TextboxPicker.Par;e.templates=this._templates,e.onLayerCreated=this._onTextLayerCreated,e.onLayerRemoved=this._onTextLayerRemoved,e.onLayerConfigurationChanged=this._onTextLayerChanged,e.placementSelector=this._placementSelector,e.product=this._product,e.allowCustomizableLayers=this._shouldAllowCustomizablePush,e.technique=this._technique,e.onBackCallback=this.showDesignTab.bind(this),e.isAdvancedTemplate=this._isAdvancedTemplateLoaded.bind(this),e.isAllOver=this.isAllOverProduct.bind(this),this.shouldAllowFileColorChanger()&&(e.getSelectedEmbroideryColors=this._embroideryHelper.getSelectedPaletteColors.bind(this._embroideryHelper),e.threadColorSelectionLimit=PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS,e.embroideryTypePrices=this._getEmbroideryPricesData()),this._textboxPicker&&this._textboxPicker.unsubscribeTemplateEvents(),this._textboxPicker=new PF.ProductPush.TextboxPicker(e),this._textboxPicker.append(this._nodeTextboxPicker),this._toggleTextboxPickerAvailability()}},_renderEmbroideryImagePicker:function(){if(mkE.clearNode(this._nodeEmbroideryImagePicker),this._par.arePickersVisible&&this.shouldAllowFileColorChanger()){var e=this.getSelectedPlacementId(),t=this.getSelectedPlacementTechnique(),i=new PF.ProductPush.EmbroideryImagePicker.Par;i.templateChangeListener=this._templates.getChangeListener(),i.fileColorMapperPalette=this._embroideryHelper.getFileColorChangerColors(e,t),i.onLayerRemoved=this.showDesignTab.bind(this),i.threadColorSelectionLimit=PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS,i.embroideryTypePrices=this._getEmbroideryPricesData(),i.getSelectedEmbroideryColors=this._embroideryHelper.getSelectedPaletteColors.bind(this._embroideryHelper),i.onEmbroideryTypeChangedCallback=this.onEmbroideryTypeChanged.bind(this),i.shouldShowExtraPriceForEmbroideryType=this.shouldShowExtraPriceForEmbroideryType.bind(this),this._embroideryImagePicker&&this._embroideryImagePicker.unsubscribeTemplateEvents(),this._embroideryImagePicker=new PF.ProductPush.EmbroideryImagePicker(i),this._embroideryImagePicker.append(this._nodeEmbroideryImagePicker),this._recalcEmbroideryPriceOptionsValue()}},_renderPatternPicker:function(){if(this._par.arePickersVisible&&this._shouldEnablePatternPicker())if(this._patternPicker)this._patternPicker.resubscribeToEvents();else{mkE.clearNode(this._nodePatternPicker);var e=new PF.ProductPush.PatternPicker.Par;e.templates=this._templates,e.onLayerRemoved=this.showDesignTab.bind(this),this._patternPicker=new PF.ProductPush.PatternPicker(e),this._patternPicker.append(this._nodePatternPicker)}else mkE.clearNode(this._nodePatternPicker)},_getEmbroideryPricesData:function(){return{currency:this._product.priceRange.currency,prices:this._productOptionsPicker.getPrices()[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE]}},_manageEmbroiderySelectedColorsOnLayersAdded:function(e){for(var t in e){var i=e[t];for(var r in i.layers)this._embroideryHelper.updateSelectedEmbroideryPaletteColors(i.layers[r])}},onEmbroideryTypeChanged:function(e){var t=this._templates.getActiveLayer();t&&e&&(t.embroideryType=e,this.firstLayerWith3dEmbroidery||e!==PF.Items.OrderLineItemFile.DIGITIZATION_3D&&e!==PF.Items.OrderLineItemFile.DIGITIZATION_3D?this.firstLayerWith3dEmbroidery&&this.firstLayerWith3dEmbroidery.uniqueId===t.uniqueId&&e===PF.Items.OrderLineItemFile.DIGITIZATION_FLAT&&(this.firstLayerWith3dEmbroidery=this._getFirstEmbroideryLayerWith3dType()):this.firstLayerWith3dEmbroidery=t,this._recalcEmbroideryPriceOptionsValue())},_recalcFirstLayerWith3dEmbroidery:function(){if(this.firstLayerWith3dEmbroidery){var e,t=this._getTemplate(this.getSelectedPlacementId());if(t)for(var i in t.layers)if(t.layers[i].uniqueId===this.firstLayerWith3dEmbroidery.uniqueId){e=t.layers[i];break}e||(this.firstLayerWith3dEmbroidery=this._getFirstEmbroideryLayerWith3dType())}else this.firstLayerWith3dEmbroidery=this._getFirstEmbroideryLayerWith3dType()},shouldShowExtraPriceForEmbroideryType:function(e){return!this.firstLayerWith3dEmbroidery||!e||this.firstLayerWith3dEmbroidery.uniqueId===e.uniqueId},_recalcEmbroideryPriceOptionsValue:function(){var e=this._getFirstEmbroideryLayerWith3dType(),t=this._productOptionsPicker.getValues()[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE],i=e?e.embroideryType:PF.Items.OrderLineItemFile.DIGITIZATION_FLAT;t!==i&&this._productOptionsPicker.setValue(PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE,i)},_getFirstEmbroideryLayerWith3dType:function(){var e,t=this._getTemplate(this.getSelectedPlacementId());if(t)for(var i in t.layers)if(t.layers[i].embroideryType===PF.Items.OrderLineItemFile.DIGITIZATION_3D||t.layers[i].embroideryType===PF.Items.OrderLineItemFile.DIGITIZATION_BOTH){e=t.layers[i];break}return e},renderTextPickerForProductCustomizer:function(){var e=new PF.ProductPush.TextPicker.Par;e.product=this._product,e.technique=this._technique,e.allowCustomizableLayers=function(){return!1},e.placementSelector=this._placementSelector,e.isAdvancedTemplate=this._isAdvancedTemplateLoaded.bind(this),e.isAllOver=this.isAllOverProduct.bind(this),this._textPicker=new PF.ProductPush.TextPicker(e)},_onTextLayerChanged:function(e){if(e.isTextLayer()){var t=e instanceof PF.Components.GeneratorMockup.TextboxLayer?this._textboxPicker:this._textPicker;PF.Utils.Delayer.delay("_templates.updateTextLayer",this._templates.updateTextLayer.bind(this,e,t),e.getUpdateDelay()),this._scheduleEmbroideryPreviewUpdate(this.getSelectedPlacementId(),e),this._mockup&&(this._mockup.getMockup().displayOutOfBoundsIndicator(),this._mockup.getMockup().displayCustomizableTextLayerError()),this._layerPicker&&this._layerPicker.updateLayer(e),this.setMockupControlsVisibility(),this._renderFooter()}},_onLayerDuplicate:function(e){this._activeDesignerTabId!==PF.ProductPush.Designer.TAB_PREVIEW&&this._activeDesignerTabId!==PF.ProductPush.Designer.TAB_3D||(this.requireMockupRegenerationAndShowDesigner(),this.resizeMockupArea()),this._templates.duplicateLayerToPlacementTemplates(e),this.setMockupControlsVisibility(),this._validateTextLayerCount(),this._renderMockupMainArea()},_onTextLayerCreated:function(e,t,i){this._activeDesignerTabId!==PF.ProductPush.Designer.TAB_PREVIEW&&this._activeDesignerTabId!==PF.ProductPush.Designer.TAB_3D||(this.requireMockupRegenerationAndShowDesigner(),this.resizeMockupArea()),this._templates.addLayerToPlacementTemplates(this.getSelectedPlacementId(),e,t,!1,i),this._templates.silentlySetActiveLayer(e),this.setMockupControlsVisibility(),this._validateTextLayerCount(),this._renderMockupVariantArea()},_onTextLayerRemoved:function(e){this._templates.removeLayer(this._templates.getTemplateByLayer(e),e),this._templates.setActiveLayer(null),this._validateTextLayerCount()},_onActiveLayerChanged:function(e){e&&(this.showDesignTab(),"function"==typeof this._par.onActiveLayerChanged&&this._par.onActiveLayerChanged(e)),this._mockup&&e&&(this._mockup.getMockup().displayOutOfBoundsIndicator(),this._mockup.getMockup().displayCustomizableTextLayerError(),this._mockup.getMockup().setActiveLayer(e,!0,this))},_validateTextLayerCount:function(){var e=this._templates.getLayerCountByType(PF.Components.GeneratorMockup.TextLayer,this._placementSelector.getSelectedPlacementId());e+=this._templates.getLayerCountByType(PF.Components.GeneratorMockup.TextboxLayer,this._placementSelector.getSelectedPlacementId());var t=PF.Components.GeneratorMockup.Validator.getLayerLimit(this.getSelectedPlacementTechnique()),i=!t||t>e,r=dlang("dashboard","Max limit is {number} text layers. Please delete a layer if you want to add another one.").replace("{number}",t);this._layerPickerChooser&&(this._layerPickerChooser.setTypeEnabled(PF.ProductPush.LayerPicker.TYPE_TEXT,i,r),this._layerPickerChooser.setTypeEnabled(PF.ProductPush.LayerPicker.TYPE_TEXTBOX,i,r)),this._textPicker&&this._textPicker.enabled(i).render(),this._textboxPicker&&this._textboxPicker.setEnabled(i).render()},_renderWarningNode:function(e,t,i,r){mkE.clearNode(e),tag("div","pf-mt-24 pf-mb-12",[tag("div","pf-mb-12",[tag("b",null,t)]),tag("div",r+"-box-warning",i)]).append(e)},_renderUnavailableVariantBlock:function(e,t,i){return tag("div","pf-pt-8 variation-warning-block",[t?tag("span",{className:"pf-d-inline-block",style:{minWidth:"20%"}},[tag("b",null,t)]):"",tag("span",{className:"swatches swatches--medium",style:{verticalAlign:"middle"}},[new PF.Components.ColorPicker(i)])]).append(e)},_renderExistingVariantsWarning:function(){if(this._par.existingVariants&&0!==this._par.existingVariants.length&&!this._par.isChangePrintfileMode){var e=dlang("generator","Variants that won't be updated"),t=dlang("generator","These variants are already in your store and won't be updated");this._renderWarningNode(this._nodeExistingVariantsWarning,e,t,"blue");var i=new PF.Components.ColorPicker.Par;i.showInline=!0,i.onChange=function(){},i.isColorClickable=!1;var r=this._getExistingProductVariantData();this._nodeExistingVariationBlock=tag("div");var n=!1;for(var a in r){for(var o in i.colors={},r[a]){var s=r[a][o];s.color&&s.colorCode&&(i.colors[s.color]=[s.colorCode],s.colorCode2&&i.colors[s.color].push(s.colorCode2),n||(n=!0))}"null"===a&&(a=""),this._renderUnavailableVariantBlock(this._nodeExistingVariationBlock,a,i)}var l=!(!Object.keys(r).length||!Object.keys(r).filter((function(e){return"null"!==e})).length);this._renderVariationWarningHeader(this._nodeExistingVariationBlock,l,n),this._nodeExistingVariationBlock.append(this._nodeExistingVariantsWarning)}},_renderUsedColors:function(){if(this._par.isChangePrintfileMode){var e,t=[],i=[];for(var r in this._par.existingVariants)t.push((new PF.Repositories.Products).getCachedVariantById(this._par.existingVariants[r].variantId));for(e in t)i.push({color:t[e].color,colorCode:t[e].colorCode,colorCode2:t[e].colorCode2});if(!(i.length<=1&&null==i[0].colorCode)){var n=new PF.Components.ColorPicker.Par;for(var a in n.showInline=!0,n.colors={},n.isColorClickable=!1,i){var o=i[a];o.color&&o.colorCode&&(n.colors[o.color]=[o.colorCode],o.colorCode2&&n.colors[o.color].push(o.colorCode2))}$.isEmptyObject(n.colors)||(mkE({tag:"div",els:[{tag:"h6",text:dlang("generator","Selected color(s):")},{tag:"span",className:"swatches swatches--huge",style:{verticalAlign:"middle"},els:[new PF.Components.ColorPicker(n)]}]}).append(this._nodeUsedColors),tag("hr").prepend(this._nodeUsedColors))}}},_renderDiscontinuedWarning:function(){if(this._colorPicker){mkE.clearNode(this._nodeDiscontinuedWarning);var e=this._colorPicker.getSelectedColorNames(),t=this._getDiscontinuedColorSelected(e);if(0!==Object.keys(t).length){var i=dlang("generator","Discontinued variants"),r=this._par.isProductPushMode?dlang("generator","These variants are discontinued and won't be pushed into your store"):dlang("generator","These variants are discontinued and won't be generated");this._renderWarningNode(this._nodeDiscontinuedWarning,i,r,"orange");var n=new PF.Components.ColorPicker.Par;n.showInline=!0,n.onChange=function(){},n.isColorClickable=!1,this._nodeDiscontinuedVariationBlock=tag("div");var a=!1;for(var o in t)if(-1!==this._selectedSizes.indexOf(o)){for(var s in n.colors={},t[o]){var l=t[o][s];n.colors[l]=this._colorPicker.getColorCodes(l),a||(a=!0)}var d=this._sizePicker?o:"";this._renderUnavailableVariantBlock(this._nodeDiscontinuedVariationBlock,d,n)}var c=!!this._sizePicker;this._renderVariationWarningHeader(this._nodeDiscontinuedVariationBlock,c,a),this._nodeDiscontinuedVariationBlock.append(this._nodeDiscontinuedWarning,t)}}},_renderVariationWarningHeader:function(e,t,i){tag("div","text-muted",[t?tag("span",{className:"pf-d-inline-block",style:{minWidth:"20%"}},dlang("generator","Size")):"",i?tag("span",null,dlang("generator","Colors")):""]).prepend(e)},_getDiscontinuedColorSelected:function(e){var t={};for(var i in this.discontinuedColors)if(-1!==this._selectedSizes.indexOf(i)){var r=this.discontinuedColors[i];t[i]=e.filter((function(e){return-1!==r.indexOf(e)})),0===t[i].length&&delete t[i]}return t},_updateExcludedPlacements:function(){var e=this._par.isOrderFlowMode,t=this._par.isProductPushMode&&this._product.isAdvancedInsideLabelAllowed(),i=this._par.productTemplateEditorState;e||t||i||(this.excludedPlacements[PF.Items.ProductItem.TYPE_T_SHIRT]=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE])},_renderFooter:function(){if(this._par.isFooterVisible){var e=!1;mkE.clearNode(this._nodeFooterContainer);var t=tag("div","order-3 grow-md-0 order-md-1 shrink-0 basis-100 basis-md-auto pf-d-flex");this._par.onBack&&(tag("a",{style:{pointerEvents:"auto"},onclick:this._onBack.bind(this),className:"pf-d-md-none pf-btn pf-btn-secondary pf-btn-square pf-mr-12"},[tag("i","pf-i pf-i-chevron-left pf-i-24")]).append(t),tag("a",{id:"js--back",className:"pf-d-none pf-d-md-inline-block pf-btn pf-btn-secondary pf-mr-12",style:{pointerEvents:"auto"},onclick:this._onBack.bind(this)},clang("action","Back")).append(t)),this._footerButtonContinue=tag("a",{className:"pf-btn pf-btn-primary grow-2 grow-md-0"+(this._footerButtonContinue&&mkE.hasClassName(this._footerButtonContinue,"disabled loading")?" disabled loading":""),style:{pointerEvents:"auto"},onclick:function(){mkE.hasClassName(this._footerButtonContinue,"disabled loading")||(mkE.addClassName(this._footerButtonContinue,"disabled loading"),this._showLoader(this.node),tag("i","pf-i pf-i-loading pf-i-spin pf-i-24 pf-ml-4").append(this._footerButtonContinue),this.onFinish(this._onFinishCallback))}.bind(this)},this._par.ctaText).append(t);var i=null;this._par.isProductPushMode||this._isProductTemplateEditor()||(i=tag("a",{className:"pf-btn pf-btn-secondary pf-ml-12",style:{pointerEvents:"auto"},onclick:this.onFinish.bind(this,this._initOrderPreview)},clang("action","Order")).append(t));var r=this._isVariantLimitExceeded(),n=this._getEbayStockQuantityExceededError(),a=!this.hasNeededQuality(),o=this._isOnlyLabelOrHangTagUploaded(),s=this._isInvalidEtsyVariantCombination(),l=this.hasCustomizableTextLayerError(),d=this.hasCustomizableTextLayerArcError(),c=this.hasEmbroideryPositionError(),u=this.hasEmbroideryTextSizeError(),h=this.hasEmbroideryTextOverlapError(),p=this.hasTextSizeError(),g=this.hasClipartSizeError(),m=this.hasLayersOverlapError(),_=this.hasLayersPositionError(),P=!this.areEmbroideryThreadColorsValid(),f=this.hasEmbroideryNotesError(),y=[],v=[];if(this._isProductTemplateDetailsEditor()||(this._productOptionsPicker.hasValidOptions()?this._productOptionsPicker.updateErrorStatus():this._productOptionsPicker.hasOption(PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE)?e=!0:y.push(dlang("generator","Please check if all required options are selected."))),this._sizePicker&&this._sizePicker.updateErrorStatus(),n){var b=dlang("dashboard","The amount of selected variants ({0}) exceeds the available quantity ({1}) for your eBay store.");b=b.format(n.used,n.limit),v.push(b),v.push({tag:"br"})}r&&(v.push(dlang("generator","Stores variant limit per product exceeded!")),v.push({tag:"br"})),a&&(v.push(PF.VariantPicker.Footer.PRINTFILE_TOO_SMALL),v.push({tag:"br"})),!this._isProductTemplateDetailsEditor()&&this.isFileLimitExceeded()&&(v.push(this.getFileLimitExceededText()),v.push({tag:"br"})),s&&(v.push(dlang("generator","Discontinued colors/sizes cant be pushed to your Etsy store. Please unselect them.")),v.push({tag:"a",className:"margin-left-5",target:"_blank",href:langUrl("/faq/integrations/etsy/288-can-t-publish-products-on-etsy"),text:clang("button that leads to FAQ","Help")}),v.push({tag:"br"})),this._layerPicker&&mkE.addClassName(this._layerPicker.nodeError,"hidden"),o&&y.push(lang("Please add a design!")),(l||d)&&v.push(dlang("generator","Personalization tool doesn't support text arcs or multiple lines")),u?v.push(PF.VariantPicker.Footer.EMBROIDERY_TEXT_TOO_SMALL):h?v.push(PF.VariantPicker.Footer.EMBROIDERY_LAYERS_OVERLAPPING):c?v.push(PF.VariantPicker.Footer.EMBROIDERY_OUT_OF_BOUNDS):p?v.push(PF.VariantPicker.Footer.LAYER_TEXT_TOO_SMALL):g?v.push(PF.VariantPicker.Footer.LAYER_CLIPART_TOO_SMALL):m?v.push(PF.VariantPicker.Footer.LAYERS_OVERLAPPING):_?v.push(PF.VariantPicker.Footer.LAYER_OUT_OF_BOUNDS):P?v.push(PF.VariantPicker.Footer.EMBROIDERY_THREAD_COLOR_LIMIT.replace("{limit}",PF.ProductPush.EmbroideryHelper.EMBROIDERY_MAX_SELECTED_THREAD_COLORS)):f&&!this._par.isMockupGeneratorMode&&v.push(PF.VariantPicker.Footer.EMBROIDERY_NOTES_MISSING),this.areTextLayersValid()||v.push(PF.VariantPicker.Footer.TEXT_TOO_LONG);var C=tag("div","grow-1 order-1 order-md-2 basis-50 basis-md-auto");v.length&&tag("div","pf-text-red pf-bold pf-pb-8 pf-pb-md-0 pf-px-8 pf-pr-md-8 text-center text-md-left",v).append(C);var T=!0;(y.length||v.length||e||0===this._selectedVariantCount)&&(mkE.addClassName(this._footerButtonContinue,"disabled"),i&&(mkE.addClassName(i,"disabled"),i.onclick=this._reCheckAndUpdateErrorStatus.bind(this,o)),this._footerButtonContinue.onclick=this._reCheckAndUpdateErrorStatus.bind(this,o),T=!1);var I=tag("div","grow-1 pf-pb-8 pf-pb-md-0 text-right order-2 order-md-3 shrink-0 basis-50 basis-md-auto");this._par.shouldShowPrice&&tag("div",null,[tag("div","variant-picker-footer__price variant-picker-footer__price--smaller",[this._product.getDisplayPriceString()]),tag("p","pf-ui-caption pf-mt-2 pf-mb-0 pf-text-muted",[lang("Excl. taxes and other charges")])]).append(I),tag("div","designer-footer text-left pf-d-flex pf-align-items-center pf-flex-wrap pf-flex-md-nowrap",[t,C,I]).append(this._nodeFooterContainer),"function"==typeof this._par.updateStickyButtonHeight&&this._par.updateStickyButtonHeight(!!v.length),this._par.isMockupGeneratorMode&&this._dynamicStickyFooter&&this._dynamicStickyFooter.updateFooterStickyState(),this._par.onCanContinueChange&&this._par.onCanContinueChange(T)}},_reCheckAndUpdateErrorStatus:function(e){return this._layerPicker&&!this._layerPicker.updateErrorStatus()?(this.showDesignTab(),this._layerPicker.showError(),void this._layerPicker.scrollToNodeError()):this._layerPicker&&!this._layerPicker.checkProductOptionsStatus()?(this.showDesignTab(),void this._layerPicker.getProductOptionsPicker().scrollToNodeError()):this._productOptionsPicker&&!this._productOptionsPicker.updateErrorStatus()?(this.showProductTab(),void this._productOptionsPicker.scrollToNodeError()):this._sizePicker&&!this._sizePicker.updateErrorStatus()?(this.showProductTab(),void this._sizePicker.scrollToNodeError()):void(e&&this._generatorParams&&this.gotoFirstPlacementAndDisplayNoRealDesignMsg())},gotoFirstPlacementAndDisplayNoRealDesignMsg:function(){var e=this.getAvailablePlacements().slice().shift();e&&this.setActivePlacement(e.id),setTimeout(function(){this.showDesignTab(),this._layerPicker.showError(),this._layerPicker.scrollToNodeError()}.bind(this),0)},trackTransparencyWarningContinueClick:function(){var e=this;this._product&&(this._product.isDtgShirt()||this._product.isDtgTote())&&this._templates.getPlacementIdsHavingFiles(PF.Components.GeneratorMockup.ImageLayer).forEach((function(t){e._templates.getLayersByType(PF.Components.GeneratorMockup.ImageLayer,t).forEach((function(e){e&&e.hasTransparencyIssues&&e.hasTransparencyIssues()&&PF.MockupGenerator.Tracking.trackTransparencyWarningContinue(e.fileItem?e.fileItem.fileId:null)}))}))},_initOrderPreview:function(){this.trackTransparencyWarningContinueClick();var e=new PF.MockupGenerator.BundleOrderPreview.Par;e.onChildComponentProductOptionsChanged=this._onChildComponentProductOptionsChanged.bind(this,!1);var t=new PF.ProductPush.DesignData;mkE.O2O(t,this.getDesignData()),e.designData=t,e.designData.generatorVariants=this.getSelectedGeneratorVariants(!1).generatorVariants,e.generatorParams=this._generatorParams,new PF.MockupGenerator.BundleOrderPreview(e)},_isOnlyLabelOrHangTagUploaded:function(){var e=this._templates.getPlacementIdsHavingFiles().concat(this.designData.getPlacementIdsWithDesign());e=e.filter((function(e,t,i){return i.indexOf(e)===t}));var t=[PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE,PF.Items.OrderLineItemFile.TYPE_LABEL_OUTSIDE,PF.Items.OrderLineItemFile.TYPE_HANG_TAG];for(var i in e)if(e.hasOwnProperty(i)&&-1===t.indexOf(e[i]))return!1;return!0},_hasPlacementWithDesignFillColor:function(){return!!this._placementOptions&&this._placementOptions.hasPlacementWithFillColor()},_getEbayStockQuantityExceededError:function(){if(!this._par.store.canManageStock()||this._par.isOrderFlowMode)return!1;if(!this._par.store.hasEnabledLimits())return!1;var e=(this._par.store.newProductLimits||{}).quantity||0,t=(this._par.existingVariants||[]).length,i=this._allSelectedVariantCount-t;return i>e&&{limit:e,used:i}},_isInvalidEtsyVariantCombination:function(){if(!this._colorPicker)return!1;if(this._par.store.type!==PF.Items.StoreItem.TYPE_ETSY)return!1;var e=this._colorPicker.getSelectedColorNames(),t=this._getDiscontinuedColorSelected(e);return Object.keys(t).length>0},_isVariantLimitExceeded:function(){var e=this._par.existingVariants&&!this._par.isChangePrintfileMode?this._par.existingVariants.length:0;return!!(this.variantLimit&&this._allSelectedVariantCount+e>this.variantLimit)},_colorizeClipartLayers:function(){this._templates.getLayersByType(PF.Components.GeneratorMockup.ClipartLayer,this._placementSelector.getSelectedPlacementId()).forEach(this._onClipartColorChanged)},_onClipartColorChanged:function(e){this._layerPicker&&this._layerPicker.updateLayer(e),this._templates.updateClipartLayer(e,this._layerPicker),this.setMockupControlsVisibility(),this.updateView(),this._clipartPicker&&this._clipartPicker.renderGroups(),PF.Events.emit(PF.Events.DESIGN_UPDATE)},_onPlacementItemAdded:function(e,t){this._updateActivePlacement(e);var i=null;if(t instanceof PF.Items.FileItem){if(i=PF.Components.GeneratorMockup.ImageLayer.fromFileItem(t),this._isProductReloadRequired(e.id,i))return void this._reloadProductAfterPlacementFileAdded(e,t)}else{if(!(t instanceof PF.Items.GeneratorClipartItem))return void console.error("Invalid item type:",t);i=PF.Components.GeneratorMockup.ClipartLayer.fromClipartItem(t)}if(this._isProductReloadRequired(e.id,i))this._reloadProductAfterPlacementFileAdded(e,t);else if(this.shouldAllowFileColorChanger()){this._showLoader(this.node);var r=this._embroideryHelper.getEmbrTypeFromDigitizedItem(t);r&&(i.embroideryType=r),this._embroideryHelper.quantizeLayer(e,i)}else{this._templates.addLayerToPlacementTemplates(e.id,i,!1);var n=this.getGeneratorVariantByPlacementId(e.id);this._templates.silentlySetActiveLayer(null),this._templates.setActiveLayerFromTemplate(n.placementId,n.templateId),this._afterLayerAddedAndLoaded()}},_onLayerColorsChanged:function(e,t,i,r,n){if(t instanceof PF.Components.GeneratorMockup.ImageLayer){var a=this._templates.getFreshLayer(t);a.overrideColors=t.overrideColors,this._embroideryHelper.recolorizeImageLayer(a,e,i,r,n)}t.isTextLayer()&&(this._embroideryHelper.updateSelectedEmbroideryPaletteColors(t),t instanceof PF.Components.GeneratorMockup.TextLayer?this._textPicker.render():t instanceof PF.Components.GeneratorMockup.TextboxLayer&&this._product.isEmbroidery()&&this._textboxPicker.render()),PF.Events.emit(PF.Events.DESIGN_UPDATE)},_onZoomChanged:function(e){var t=this._templates.getUserTemplate(this.getSelectedPlacementId(),this._getSelectedVariant().templateId);e?(t.layers.forEach(function(e){e.overrideImagePulse&&(e.overrideImagePulse=null,this._templates.getChangeListener().notifyTemplatePositionsChanged([t],e))}.bind(this)),this._embroideryHelper.lastZoomedInEmbroideryTemplate=t):t.layers.forEach(function(e){this._scheduleEmbroideryPreviewUpdate(this.getSelectedPlacementId(),e)}.bind(this))},_onPreviewChanged:function(e,t,i){var r=this;if(!this._unsubscribeTemplateEventsIfNeeded()&&PF.Components.GeneratorMockup.Preview.getPreviewString(t.getKey())!==e){var n=this._templates.getTemplatesByPlacement(t.placementId),a=0,o=0,s=this.getSelectedGeneratorVariants(!1,!0).generatorVariants;for(var l in n)if(t.isRelated(n[l]))PF.Components.GeneratorMockup.Preview.setPreviewString(n[l].getKey(),e);else for(var d in s){var c=s[d];if(c.templateId===n[l].templateId){var u={fillColor:this._placementOptions.getPlacementFillColor(n[l].placementId)};a+=1,PF.Components.GeneratorMockup.Preview.setPreviewStringFromTemplate(n[l],c.mockupPosition,u,(function(){(o+=1)>=a&&r._variantArea&&r._variantArea.renderMockupPreviewStrings()}))}}this._variantArea&&a<1&&this._variantArea.renderMockupPreviewStrings()}},_updateActivePlacement:function(e){this._placementSelector.setSelectedPlacement(e),this._par.placementDependentOptions&&this._productOptionsPicker.setSelectedPlacementId(e.id)},_isProductReloadRequired:function(e,t){if(this._generatorParams.availableOrientations&&this._generatorParams.availableOrientations.length)return!0;if(!(t instanceof PF.Components.GeneratorMockup.ImageLayer))return!1;if(this._hasTemplateTypeChanged()&&this._isAdvancedTemplateAvailable())return!0;if(this._savePlacementOptionsLocaly(),this._generatorParams.layerMatchesAdvancedTemplate(e,t))return!0;var i=this.getGeneratorVariantByPlacementId(e,!1);return i&&i.role===PF.Items.GeneratorVariantItem.ROLE_ADVANCED_TEMPLATE},_savePlacementOptionsLocaly:function(){this._placementOptions&&(this._placementOptionsRawStorage=this._placementOptions.getData())},_reloadProductAfterPlacementFileAdded:function(e,t){var i=new PF.ProductPush.DesignerState;t instanceof PF.Items.FileItem?i.addPlacementFileLayer(e.id,t):t instanceof PF.Items.GeneratorClipartItem&&i.addPlacementClipartLayer(e.id,t);var r=this._orientation;!r&&this._generatorParams.availableOrientations.length>1&&this._templates.hasLayers()&&(r=this._templates.getOrientation()),this._savePlacementOptionsLocaly(),this.generatorRepository.loadGeneratorProduct({storeId:this._par.store.storeId,isMockupGeneratorMode:this._par.isMockupGeneratorMode,isProductPushMode:this._par.isProductPushMode,productId:this._product.productId,designerState:i,excludedPlacements:this.excludedPlacements,callback:this._onNewFileAddedAndLoaded.bind(this,e),technique:this._technique,forceOrientation:r,forceTemplateType:this._templateType,forceRequest:!0})},_afterLayerAddedAndLoaded:function(){this._onFilesChanged(),this._renderMockupVariantArea(),this._renderMockupMainArea()},_onNewFileAddedAndLoaded:function(e,t){this._generatorParams=t,this._placementOptions=this._generatorParams.placementOptions,this._templates.copyLayersFromTemplates(t.calculatedPositions);var i=this.getGeneratorVariantByPlacementId();i&&(this._templates.silentlySetActiveLayer(null),this._templates.setActiveLayerFromTemplate(i.placementId,i.templateId,this)),this._afterLayerAddedAndLoaded()},_onFilesChanged:function(){this._productOptionsPicker&&(this._productOptionsPicker.setFileTypesWithFiles(this._templates.getPlacementIdsHavingFiles()).setPlacementIdsWithFiles(this._templates.getPlacementIdsHavingFiles(PF.Components.GeneratorMockup.ImageLayer)),this._renderProductOptions(),this._renderFooter(),this._par.onPickerChanged&&this._par.onPickerChanged(),this._placementOptionsRawStorage&&this._loadDesignFillColor())},_onResize:function(e){this.previewMockupVariant&&this.node.clientWidth&&(mkE.addClassName(this._nodeMainMockupArea,"loading"),clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(this._renderMockupMainArea,e||300))},resizeMockupArea:function(){this._onResize(10)},_onLayerRemoved:function(e,t){this._par.onFileRemoved&&e.length&&this._par.onFileRemoved(t.fileItem.fileId,e[0].placementId),this._onFilesChanged(),this.shouldAllowFileColorChanger()&&(this._embroideryHelper.manageEmbroiderySelectedColorsOnLayerRemove(t),this._recalcFirstLayerWith3dEmbroidery(),this._recalcEmbroideryPriceOptionsValue()),this._templates.removeFeatureDesignCopied(this.getSelectedPlacementId())},_onLayerAdded:function(e){e.length<1||(this._tryApplyingEmbroideryColorization(),this._mockup&&this._mockup.isMirroredChecked()&&this._templates.addMirroredLayersForTemplates(),this.shouldAllowFileColorChanger()&&(this._manageEmbroiderySelectedColorsOnLayersAdded(e),this._recalcEmbroideryPriceOptionsValue()))},validateAddingLayer:function(e,t){if(t||(t=1),this._layerPicker&&e instanceof PF.Components.GeneratorMockup.ImageLayer){var i=this._templates.getTemplateByLayer(e);return this._templates.getLayerCountByType(PF.Components.GeneratorMockup.ImageLayer,this._placementSelector.getSelectedPlacementId(),i)+t<=this._layerPicker.fileCountLimit}if(this._layerPicker&&e.isTextLayer()){var r=PF.Components.GeneratorMockup.Validator.getLayerLimit(this.getSelectedPlacementTechnique());if(r)return this._templates.getLayerCountByType(PF.Components.GeneratorMockup.TextLayer,this._placementSelector.getSelectedPlacementId())+this._templates.getLayerCountByType(PF.Components.GeneratorMockup.TextboxLayer,this._placementSelector.getSelectedPlacementId())+t<=r}return!0},_renderLayerPicker:function(){if(this._par.arePickersVisible){mkE.clearNode(this._nodeLayerPicker);var e=this._generatorParams.availablePlacements;if(e&&!(e.length<1)){var t=this.getSelectedPlacementId()||e.slice().shift().id,i=this._product.isEmbroidery()?"EMBROIDERY":this._product.fileTagGroup,r=new PF.ProductPush.LayerPicker.Par;r.placements=e,r.activePlacementId=t,r.templates=this._templates,r.onPicked=this._onPlacementItemAdded,r.onColorChanged=this._onClipartColorChanged,r.product=this._product,r.conflictCalculator=this._conflictCalculator,r.fileCountLimit=this._getFileCountLimit(),r.allowCustomizableLayers=this._shouldAllowCustomizablePush(),r.storeId=this._par.store.storeId,r.includeSamples=this._par.pickerConfig.isSampleOrder,r.searchTag=this._par.pickerConfig.getFileTag(t,i),r.onItemEdit=this._onLayerEdit,r.onCustomizableChanged=this._onTextLayerChanged,r.onDuplicate=this._onLayerDuplicate,r.layerPickerChooser=this._layerPickerChooser,this._isAdvancedTemplateAvailable()&&(r.nodeTemplateTypePicker=this._nodeAdvancedTemplatePicker),r.isAdvancedTemplate=this._isAdvancedTemplateLoaded.bind(this),r.isAllOver=this.isAllOverProduct.bind(this),r.hasAtLeastOneDesignFillColor=this.hasAtLeastOneDesignFillColor.bind(this),r.validateAddingLayer=this.validateAddingLayer.bind(this),r.getSelectedMockupVariant=this._getSelectedVariant.bind(this),this._product.type!==PF.Items.ProductItem.TYPE_CUT_SEW&&(r.productOptions=this._getProductOptions(),r.productOptionsValues=this.getProductOptionsValues(),r.onProductOptionsChanged=this._onChildComponentProductOptionsChanged.bind(this,!0),r.productOptionsPlacements=this._generatorParams.availablePlacements.slice()),r.showPatternPicker=this._shouldEnablePatternPicker(),this._layerPicker=new PF.ProductPush.LayerPicker(r).append(this._nodeLayerPicker)}}},_onLayerEdit:function(e,t,i){e=e.isTextLayer()?this._templates.getLayerById(e.uniqueId):e,t.isTextLayer()?this.shouldAllowTextboxLayer()?(e instanceof PF.Components.GeneratorMockup.TextLayer?(i&&i.stopPropagation(),e=this._convertTextLayerToTextboxLayer(e)):this._templates.silentlySetActiveLayer(e),this._textboxPicker.editTextboxLayer(e),this._showPickerTab(PF.ProductPush.Designer.TAB_TEXTBOX)):(this._textPicker.editTextLayer(e),this._templates.silentlySetActiveLayer(e),this._showPickerTab(PF.ProductPush.Designer.TAB_TEXT)):(t.isImageLayer()||t.isClipartLayer())&&this._editImageLayer(e)},_convertTextLayerToTextboxLayer:function(e){var t=this._templates.getTemplateByLayer(e),i=this._layerPicker.getLayerIndexInPicker(t.placementId,e.uniqueId,!0),r=new PF.Components.GeneratorMockup.TextboxLayer.fromTextLayer(e);return this._templates.addLayerToPlacementTemplates(this.getSelectedPlacementId(),r,!0,!0),this._templates.silentlySetActiveLayer(r),this._templates.removeLayer(t,e,!1,!0),this._templates.reorderLayer(r,i),this._isTextLayerConverted=!0,r},getProductOptionsValues:function(e,t){var i=this._validateEmbroideryTypeForText(this._productOptionsPicker.getValues());return!e&&$.isEmptyObject(i)&&(i=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_PRODUCT_OPTIONS)),t&&mkE.O2O(i,this._getTextUsedColors()),i},_validateEmbroideryTypeForText:function(e){var t=PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE;return this._placementSelector.getSelectedPlacementId()!==PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT?e:(this._isEmbroideryWithText()&&e.hasOwnProperty(t)&&"flat"!==e[t]&&(e[t]="flat"),e)},_getTextUsedColors:function(){var e={},t=this._templates.getPlacementIdsHavingFiles();for(var i in t){var r=t[i];e[PF.Items.ProductOptionItem.getTextThreadName(r)]=this._templates.getUsedColors(r)}return e},_renderClipartPicker:function(){if(this._par.arePickersVisible){mkE.clearNode(this._nodeClipartPicker);var e=new PF.ProductPush.ClipartPicker.Par;e.onAddFileCallback=this._onPlacementItemAdded.bind(this,this._placementSelector.getSelectedPlacement()),e.onBackCallback=this.showDesignTab,e.selectedPlacementTechnique=this._getActiveTechnique(),this._dropZoneArea&&(e.fileDropZone=this._dropZoneArea,this._dropZoneArea.setActivePlacement(this._placementSelector.getSelectedPlacement())),this._clipartPicker=new PF.ProductPush.ClipartPicker(e),this._clipartPicker.append(this._nodeClipartPicker)}},_renderOrientationPicker:function(){this._par.arePickersVisible&&this._generatorParams.availableOrientations.length&&(mkE.clearNode(this._nodeOrientationPicker),this._orientationPicker=new PF.ProductPush.OrientationPicker(this._generatorParams.generatorVariants,this._generatorParams.availableOrientations,this._onOrientationChanged,this._orientation),this._orientationPicker.append(this._nodeOrientationPicker))},getOrientation:function(){return this._orientation||null},_onOrientationChanged:function(){this._orientation=this._orientationPicker.getValue(),this.requireMockupRegenerationAndShowDesigner(),this._reloadEverything()},_createProductOptionsPickerPar:function(){var e=new PF.Components.ProductOptions.Par;return e.optionItems=this._getProductOptions(),e.values=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_PRODUCT_OPTIONS),e.onChange=this.onProductOptionChanged,e},_renderProductOptions:function(){if(this._par.arePickersVisible||this._par.isCustomizingMode){if(mkE.clearNode(this._nodeProductOptions),!this._productOptionsPicker){var e=this._createProductOptionsPickerPar();this._productOptionsPicker=new PF.VariantPicker.OptionPicker(e)}this.shouldAllowTextboxLayer()?this._toggleTextboxPickerAvailability():this._toggleTextPickerAvailability(),this._shouldProductOptionsBeHidden()||(this._productOptionsPicker.hasVisibleOptions()&&tag("hr").append(this._nodeProductOptions),this._productOptionsPicker.append(this._nodeProductOptions))}},_shouldProductOptionsBeHidden:function(){return this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY||this._product.type!==PF.Items.ProductItem.TYPE_CUT_SEW&&(!this._productOptionsPicker.hasVisibleOptions()||this._par.isOrderFlowMode&&!this._templates.getPlacementIdsHavingFiles().length)},_renderColorPicker:function(){var e=this;if(this._par.arePickersVisible&&(mkE.clearNode(this._nodeColorPicker),this._canRenderColorPicker())){this._selectedColors.length||(this._selectedColors=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_COLOR));var t=new PF.ProductPush.Pickers.Params;t.values=this.allColors.slice(),t.selectedValues=this._selectedColors.slice(),t.selectedLimit=this._getMaxColorsLimit(),t.pickerTitle=this._product.getColorPickerTitle(this._getMaxColorsLimit()),t.onChangedCallback=this._onColorsChanged,t.isPopoverEnabled=this._par.pickerConfig.colorConfig.isPopoverEnabled,t.canDeselectLast=!this._par.isOrderFlowMode&&!this._par.isChangePrintfileMode,t.getSelectedSizes=function(){return e._selectedSizes},this._colorPicker=new PF.ProductPush.ColorPicker(t).append(this._nodeColorPicker),tag("hr").prepend(this._colorPicker.node)}},_canRenderColorPicker:function(){return this._par.arePickersVisible&&this.allColors&&this.allColors.length&&this.allColors.length>1},_renderDesignFillColorPicker:function(){if((this._par.arePickersVisible||this._par.isCustomizingMode)&&this._nodeDesignFillColorPicker&&this.isAllOverProduct(!0)){mkE.clearNode(this._nodeDesignFillColorPicker),tag("h6","pf-h6 pf-mb-8 pf-d-inline-block",[dlang("generator","Print area background color")]).append(this._nodeDesignFillColorPicker);var e=new PF.Components.ColorDropdown.Par;if(e.colors=this._getDesignFillColorOptions(),e.color=this.getDesignFillColor(this.getSelectedPlacementId()),e.hideRGB=!1,e.onChange=this._onDesignFillColorChanged,e.scrollToDropDown=!0,this._designFillColorPicker=new PF.Components.ColorDropdown(e).append(this._nodeDesignFillColorPicker),this._loadDesignFillColor(),this._checkIfBgColorApplyToAllCheckBoxIsNeeded()){var t=new PF.Forms.CheckboxPar;t.label=dlang("generator","Apply to all placements"),t.wrapperClass="control-options",t.isChecked=this._placementOptions.isSameFillForAllPlacements(),t.onchange=this._onDesignFillColorApplyCheckboxChanged,this._designFillColorApplyCheckbox=new PF.Forms.Checkbox(t).append(this._nodeDesignFillColorPicker),this._manageCheckboxShowHide()}}},_checkIfBgColorApplyToAllCheckBoxIsNeeded:function(){if(this._generatorParams.availablePlacements.length<2)return!1;var e=this.getAvailablePlacements(),t=0;for(var i in e){var r=e[i];if(-1===PF.Items.OrderLineItemFile.DESIGN_FILL_COLOR_EXCEPTION_PLACEMENTS.indexOf(r.id)&&t++,t>1)return!0}},_manageCheckboxShowHide:function(){this._designFillColorApplyCheckbox&&(PF.Items.OrderLineItemFile.DESIGN_FILL_COLOR_EXCEPTION_PLACEMENTS.indexOf(this.getSelectedPlacementId())>-1?(this._designFillColorApplyCheckbox.setChecked(!1),this._designFillColorApplyCheckbox.hide()):(this._designFillColorApplyCheckbox.setChecked(this._placementOptions.isSameFillForAllPlacements()),this._designFillColorApplyCheckbox.show()))},_getDesignFillColorOptions:function(){var e=PF.Components.ColorDropdown.getNoneColor();return Object.assign(e,this._getColors()),e},hasDesignFillColor:function(e){return e=void 0!==e?e:this.getSelectedPlacementId(),!!this.getDesignFillColor(e)},hasAtLeastOneDesignFillColor:function(){return!!this._placementOptions&&this._placementOptions.hasPlacementWithFillColor()},_loadDesignFillColor:function(){if(this.isAllOverProduct(!0)){this._placementOptionsRawStorage&&(this._placementOptions=PF.Items.PlacementOptions.fromArray(this._placementOptionsRawStorage),this._placementOptionsRawStorage=null);var e=this.getDesignFillColor(this.getSelectedPlacementId());this._designFillColorPicker.setColor(e,!0)}},getDesignFillColor:function(e){var t=null;return this._placementOptions&&(t=this._placementOptions.getPlacementFillColor(e)),t||null},_getColors:function(){if(this.isAllOverProduct())return PF.Components.ColorDropdown.allOverColors();var e=PF.Components.ColorDropdown.defaultColors();return this._par.product.isWhiteDtgTote()&&delete e.White,this._par.product.isBlackMug()&&delete e.Black,e},isAllOverProduct:function(e){var t=this._par.product.isMug()||this._par.product.isPhoneCase()||this._par.product.isPoster()||this._par.product.isCanvas()||this._par.product.isFramedPoster();return e?this._templates.isCoverMode()||t:this._templates.isCoverMode()&&!t},_onDesignFillColorChanged:function(e){this._designFillColorApplyCheckbox&&this._designFillColorApplyCheckbox.isChecked()?this._placementOptions.setAllPlacementFillColor(e):this._placementOptions.setPlacementFillColor(this.getSelectedPlacementId(),e),this.designData.rawPlacementOptions=this._placementOptions.getData(),this._mockup&&this._mockup.getMockup().setMockupDesignFillColor(e),this.requireMockupRegeneration(),this.updateView(),this.observer.emitDesignFillColorChanged(this._placementOptions.hasPlacementWithFillColor()),this._templates.getChangeListener().notifyDesignFillColorChanged()},_onDesignFillColorApplyCheckboxChanged:function(e){if(e.target.checked){var t=this.getDesignFillColor(this.getSelectedPlacementId());this._placementOptions.setAllPlacementFillColor(t),this._onDesignFillColorChanged(t)}},_getMaxColorsLimit:function(){return this._par.pickerConfig.colorConfig.maxValues?this._par.pickerConfig.colorConfig.maxValues:this._isVariantLimitExceeded()?this._selectedColors.length:this.allColors.length},_onColorsChanged:function(e,t){var i=this;if(this._popoverCloseTimeoutColor&&clearTimeout(this._popoverCloseTimeoutColor),this.observer.emitBeforeColorsChanged(e)){var r=[];for(var n in e)e[n].color?r.push(e[n].color):e[n].colors;var a=this._regionPicker?this._regionPicker.getMatchingVariants():null,o=this._par.product.productId,s=this.regionData;if(!this.lastSelectedColor&&this._selectedColors.length&&(this.lastSelectedColor=this._selectedColors[0].color),this._colorPicker.validateSelectedColors(s,r,a,this.allVariants.filter((function(e){return o===e.productId})),(function(){i._popoverCloseTimeoutColor=setTimeout((function(){i._colorPicker.setColors(i.allColors.filter((function(e){return PF.Utils.String.isEqual(e.color,i.lastSelectedColor)}))).render()}),500)}))){this.requireMockupRegenerationAndShowDesigner();var l=this.lastSelectedColor;if((t=t||!1)||e.length!==this.allColors.length)if(this.lastSelectedColor=null,e.length>this._selectedColors.length){for(var n in e)if(!this.isColorSelected(e[n].color)){this.lastSelectedColor=e[n].color;break}}else e.length>0&&e.length<this._selectedColors.length&&this.isColorSelected(l,e)&&(this.lastSelectedColor=l);this._selectedColors=e,0===this._selectedColors.length&&(this._selectedColors.push([].concat(this.allColors).shift()),this._colorPicker.setColors(this._selectedColors).render(),this._colorPicker.updateErrorStatus()),!this.lastSelectedColor&&e[0]&&(this.lastSelectedColor=e[0].color),(this._par.isMockupGeneratorMode||this._par.isProductPushMode)&&this._renderSizePicker(),this.updateView(),this.observer.emitAfterColorsChanged(e),PF.Events.emit(PF.Events.DESIGN_UPDATE)}}},isColorSelected:function(e,t){for(var i in t=t||this._selectedColors)if(PF.Utils.String.isEqual(t[i].color,e))return!0;return!1},isSizeSelected:function(e,t){for(var i=0,r=(t=t||this._selectedSizes).length;i<r;i++)if(PF.Utils.String.isEqual(t[i],e))return!0;return!1},getGeneratorVariantById:function(e,t){var i=this._getGeneratorVariants(t);if(!i.length)return null;for(var r=0,n=i.length;r<n;r++)if(i[r]&&i[r].generatorVariantId===e)return i[r];if(t)for(r=0,n=(i=this.getSelectedGeneratorVariants(!1,!0).generatorVariants).length;r<n;r++)if(i[r]&&i[r].generatorVariantId===e)return i[r];return PF.DEV&&console.log("Generator variant not found for id: "+e),null},_renderTechniquePicker:function(){if(this._isTechniquePickerAvailable()){mkE.clearNode(this._nodeTechniquePicker);var e=new r.TechniquePickerPar;e.techniques=this._getTechniques(),e.activeValue=this._getActiveTechnique(),e.callback=this._onTechniquePicked,e.isGenerator=!0,e.productId=this._product.productId,this._techniquePicker=(this._getTechniques().length>1?new PF.VariantPicker.TechniquePicker(e):tag("div")).append(this._nodeTechniquePicker),tag("hr").prepend(this._techniquePicker.node),this._techniquePicker.toggleChangeTechniquePopup(this._templates.hasLayers())}},_onTechniquePicked:function(e){this._technique=e;var t=new PF.ProductPush.DesignerState;this._labelSwitcher&&this._labelSwitcher.hide(),this._par.designerState&&(t.generatorDesignId=this._par.designerState.generatorDesignId),this._par.designerState=t,this._templates.setActiveLayer(null),this._templates.silentlyRemoveAllTemplates(),this._placementSelector.deselectPlacement(),this.requireMockupRegenerationAndShowDesigner(!0),PF.Utils.TechniqueMemory(this._product.productId).rememberLastUsedTechnique(e),this.shouldAllowTextboxLayer()?this._renderTextboxPicker():this._renderTextPicker(),this.observer.emitMainTechniqueChanged(e),this._loadProduct(t,!0,!0)},onAllImagesProcessed:function(){this._isProductTemplateDetailsEditor()||this._renderTechniquePicker(),this.updateView()},_getTechniques:function(){return this._generatorParams.availableTechniques?this._generatorParams.availableTechniques.map((function(e){return{type:e,label:PF.Items.ProductItem.LABELS[e]}})):[]},_getActiveTechnique:function(){if(this._technique)return this._technique;var e=this._templates.getTechnique(),t=e||this._product.type;return PF.Utils.TechniqueMemory(this._product.productId).rememberLastUsedTechnique(),t},_isTechniquePickerAvailable:function(){return this._generatorParams&&this._generatorParams.availableTechniques&&this._generatorParams.availableTechniques.length>1},_renderRegionPicker:function(){!this._par.arePickersVisible||this._par.isMockupGeneratorMode||this._isProductTemplateEditor()||(mkE.clearNode(this._nodeRegionPicker),this.regionData&&(this._regionPicker=new PF.ProductPush.RegionPicker(this.regionData,this._par.pickerConfig.activeRegion,this._onRegionChanged).append(this._nodeRegionPicker),this._isProductTemplateDetailsEditor()||tag("hr").prepend(this._regionPicker.node)))},_onRegionChanged:function(e,t){if(this.observer.emitRegionChanged(e)){this._setAllowedRegionColorsAndSizes(e);var i,r,n=this.allSizes,a=this.allColors,o=this._selectedColors.map((function(e){return e.color})).filter((function(e){return!a.map((function(e){return e.color})).some((function(t){return e==t}))})),s=this._selectedSizes.filter((function(e){return!n.some((function(t){return e==t}))}));if(this._selectedRegionAttributes[e]){for(i in this._selectedRegionAttributes[e].sizes)-1===this._selectedSizes.indexOf(this._selectedRegionAttributes[e].sizes[i])&&this._selectedSizes.push(this._selectedRegionAttributes[e].sizes[i]);for(i in a)for(r in this._selectedRegionAttributes[e].colors)a[i].color==this._selectedRegionAttributes[e].colors[r]&&this._selectedColors.push(a[i])}if(o)for(i in t!=e&&(this._selectedRegionAttributes[t]={colors:o}),this._selectedColors)for(r in o)this._selectedColors[i].color==o[r]&&this._selectedColors.splice(i,1);if(s)for(i in t!=e&&$.extend(this._selectedRegionAttributes[t],{sizes:s}),s){var l=this._selectedSizes.indexOf(s[i]);l>-1&&this._selectedSizes.splice(l,1)}0!==o.length&&0===this._selectedColors.length&&this._selectedColors.push(a[0]);var d=!1;for(i in this._selectedColors)PF.Utils.String.isEqual(this._selectedColors[i].color,this.lastSelectedColor)&&(d=!0);!d&&this._selectedColors.length>0&&(this.lastSelectedColor=this._selectedColors[0].color);var c=!1;for(i in this._selectedSizes)PF.Utils.String.isEqual(this._selectedSizes[i],this.lastSelectedSize)&&(c=!0);!c&&this._selectedSizes.length>0&&(this.lastSelectedSize=this._selectedSizes[0]),this._renderColorPicker(),this._renderDesignFillColorPicker(),this._renderSizePicker(),this.updateView()}},_setAllowedRegionColorsAndSizes:function(e){var t,i,r=this.regionData.variantsByRegion[e],n=this._generatorParams.variantMapping,a=[];for(t in n)for(i in r)n[t].variantId==r[i]&&a.push(n[t]);var o=[],s=[];for(t in a)o.push(a[t].size),s.push(a[t].color);var l=o.filter((function(e,t){return o.indexOf(e)==t})),d=s.filter((function(e,t){return s.indexOf(e)==t})),c=[],u=this._generatorParams.colors;for(t in d)for(i in u)d[t]==u[i].color&&c.push(u[i]);return this.allColors=c,this.allSizes=l,!0},_shouldRenderSizePicker:function(){return!(!this._par.arePickersVisible||this._isProductTemplateEditor()&&this._product.canHaveColorPicker())},_canRenderSizePicker:function(e){if(!(e||this._generatorParams&&this._shouldRenderSizePicker()))return!1;if(this._recalcAvailableSizes(),!e&&(!this.allAvailableSizes||this.allAvailableSizes.length<1||!this._getAvailableSizesCount()))return!1;if(!e&&1===this._getAvailableSizesCount()&&!this._par.pickerConfig.sizeConfig.maxValues)return!1;var t=[PF.Items.ProductItem.TYPE_T_SHIRT,PF.Items.ProductItem.TYPE_CUT_SEW,PF.Items.ProductItem.TYPE_SUBLIMATION,PF.Items.ProductItem.TYPE_SHOES,PF.Items.ProductItem.TYPE_JEWELRY,PF.Items.ProductItem.TYPE_EMBROIDERY];return!(this._par.isMockupGeneratorMode&&-1!==t.indexOf(this._product.type)&&!this._product.isPillow()&&!this._product.isLaptopSleeve())},_renderSizePicker:function(){if(this._canRenderSizePicker()){mkE.clearNode(this._nodeSizePicker),1===this.allAvailableSizes.length&&(this._selectedSizes.length||(this._selectedSizes=this.allAvailableSizes.slice()));var e=this._par.existingVariants&&this._par.store.isEtsy(),t=this.designData.product.isDtgShirt();e&&t&&this._setExistingVariantSizes(),this._selectedSizes.length||(this._selectedSizes=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_SIZE));var i=new PF.ProductPush.Pickers.Params;i.values=this.allAvailableSizes,i.allValues=this.allSizes,i.selectedValues=this._selectedSizes,i.selectedLimit=this._getMaxSizeLimit(),i.onChangedCallback=this._onSizesChanged,i.designData=this.designData,i.isPopoverEnabled=this._par.pickerConfig.sizeConfig.isPopoverEnabled,i.productId=this._product.productId,i.isSizeGuideVisible=this._par.isOrderFlowMode||this._par.isChangePrintfileMode,this._sizePicker=new PF.ProductPush.SizePicker(i).append(this._nodeSizePicker),e&&t&&this._disableSizePicker(),tag("hr").prepend(this._sizePicker.node)}},_isAddVariantsFlow:function(){return!(!this._par.existingVariants||!this._par.existingVariants.length)},_renderAdvancedTemplatePicker:function(){if(this._par.arePickersVisible&&this._isAdvancedTemplateAvailable()&&this._nodeAdvancedTemplatePicker){var e=[PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_SIMPLE,PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_ADVANCED];this._templateType=this.getTemplateTypeLoaded(),mkE.clearNode(this._nodeAdvancedTemplatePicker),this._advancedTemplatePicker=new PF.ProductPush.AdvancedTemplatePicker(e,this._onTemplateTypeChanged.bind(this),this.getTemplateTypeLoaded.bind(this),this._templateType),this._advancedTemplatePicker.toggleTemplatePickerPopup(this._templates.hasLayers()),this._advancedTemplatePicker.append(this._nodeAdvancedTemplatePicker)}},_onTemplateTypeChanged:function(){this._templateType=this._advancedTemplatePicker.getValue(),this._templates.silentlyRemoveAllLayers(),this._onProductLoadedShowDesignTab=!0,this._advancedTemplatePicker.toggleTemplatePickerPopup(this._templates.hasLayers()),this._reloadEverything()},_isAdvancedTemplateAvailable:function(){return!(!this._generatorParams||!this._generatorParams.variantMapping)&&this._getSelectedMappings().some(function(e){if(e.advancedTemplateSize){var t=Object.keys(e.advancedTemplateSize);for(var i in t)if(t[i]!==PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE&&t[i]===this.getSelectedPlacementId())return!0}}.bind(this))},_hasTemplateTypeChanged:function(){return this._templateType!==this.getTemplateTypeLoaded()},_getAvailableSizesCount:function(){return this.allAvailableSizes.length},_recalcAvailableSizes:function(){var e=this;return this.allAvailableSizes=this._getSelectedMappings(!0).map((function(e){return e.size})).filter((function(t,i,r){return t&&r.indexOf(t)===i&&e.allSizes.indexOf(t)>-1})).sort(PF.Utils.Product.sizeSortingCallback),(this._par.isMockupGeneratorMode||this._par.isProductPushMode)&&this._recalcSelectedSizes(),this.allAvailableSizes},_recalcSelectedSizes:function(){this._sizePicker&&this._sizePicker.isSelectAllChecked()?this._selectedSizes=this.allAvailableSizes.slice():this._selectedSizes=this._selectedSizes.filter(function(e){return this.allAvailableSizes.indexOf(e)>-1}.bind(this)),this._selectedSizes.length||(this._selectedSizes=this.allAvailableSizes.slice())},_getMaxSizeLimit:function(){return this._par.pickerConfig.sizeConfig.maxValues||this.allAvailableSizes.length},_setExistingVariantSizes:function(){var e=this._par.existingVariants.map((function(e){return(new PF.Repositories.Products).getCachedVariantById(e.variantId).size}));e=e.filter((function(t,i){return e.indexOf(t)===i})),this._selectedSizes=e},_disableSizePicker:function(){var e=tag("span",{className:"glyphicon glyphicon-info-sign size-picker-tooltip",attr:{title:dlang("generator","New color variants will be added in the existing size range.")}}).append(this._sizePicker.sizeNodeTitle);$(e).tooltip(),mkE.addClassName(this._sizePicker.sizeCheckboxSelector,"disabled")},_onSizesChanged:function(e){var t=this;if(this._popoverCloseTimeoutSize&&clearTimeout(this._popoverCloseTimeoutSize),this.observer.emitSizesChanged(e)){var i=this._regionPicker?this._regionPicker.getMatchingVariants():null,r=this._par.product.productId,n=this.regionData;if(!this.lastSelectedSize&&this._selectedSizes.length&&(this.lastSelectedSize=this._selectedSizes[0]),this._sizePicker.validateSelectedSize(n,e.join(" "),i,this.allVariants.filter((function(e){return r===e.productId})),(function(){t._popoverCloseTimeoutSize=setTimeout((function(){t._sizePicker.setSizes(t.allSizes.filter((function(e){return PF.Utils.String.isEqual(e,t.lastSelectedSize)}))).render()}),500)}))){if(this.requireMockupRegenerationAndShowDesigner(),this.lastSelectedSize=null,e.length>this._selectedSizes.length)for(var a in e)if(!this.isSizeSelected(e[a])){this.lastSelectedSize=e[a];break}this._par.store.isWix()&&this._isAddVariantsFlow()&&(this.designData.shouldShowWixMockupWarning=e!==this._initialSizes),this._selectedSizes=e,0===this._selectedSizes.length&&(this._selectedSizes.push([].concat(this.allAvailableSizes).shift()),this._sizePicker.setSizes(this._selectedSizes).render()),!this.lastSelectedSize&&e[0]&&(this.lastSelectedSize=e[0]),this.designData&&this._isProductTemplateEditor()&&this._shouldRenderSizePicker()&&(this.designData.templateSelectedSizes=this._selectedSizes.slice()),0===e.length&&this._renderDiscontinuedWarning(),this.updateView(),this.observer.emitAfterSizesChanged(e),PF.Events.emit(PF.Events.DESIGN_UPDATE)}}},_renderAvailability:function(){var e=this._par.isMockupGeneratorMode||this._par.isChangePrintfileMode||this._par.isCustomizingMode;if(this._product.shouldShowAvailabilityTab()&&!e){var t=this._product.getProductPageUrl()+"#availability";PF.Utils.isInDocument(this.node)||PF.Events.off("showProductAvailability",null),PF.Events.on("showProductAvailability",(function(){window.open(t,"_blank").focus()}),this)}},_renderLayerPickerChooser:function(){mkE.clearNode(this._nodeLayerPickerChooser);var e={id:this.shouldAllowTextboxLayer()?PF.ProductPush.LayerPicker.TYPE_TEXTBOX:PF.ProductPush.LayerPicker.TYPE_TEXT,icon:"format-font",title:lang("Add text"),description:dlang("generator","Create a text-based design"),onclick:function(){this._showPickerTab(this.shouldAllowTextboxLayer()?PF.ProductPush.Designer.TAB_TEXTBOX:PF.ProductPush.Designer.TAB_TEXT),this._templates.setActiveLayer(null),this.shouldAllowTextboxLayer()?this._textboxPicker.resetText(!0):this._textPicker.resetText()}.bind(this),disabled:this._isTextPickerDisabled(),tooltip:""};tag("div","pf-mb-24",[tag("hr"),this._layerPickerChooser=new PF.ProductPush.LayerPicker.Chooser([{id:PF.ProductPush.LayerPicker.TYPE_FILE,icon:"upload",title:lang("Upload file"),description:dlang("generator","Use your own design"),onclick:function(){this.showDesignTab(),PF.ProductPush.LayerPicker.checkForWarnings(this._product,!1,this.getLayerPicker().requestFilePicking.bind(this,this._placementSelector.getSelectedPlacement()))}.bind(this),disabled:this.isFilePickerDisabled(),tooltip:""},e,{id:PF.ProductPush.LayerPicker.TYPE_CLIPART,icon:"emoticon-happy-outline",title:lang("Add clipart"),description:dlang("generator","Use our clipart"),onclick:this._showPickerTab.bind(this,PF.ProductPush.Designer.TAB_CLIPART),disabled:this._isClipartPickerDisabled(),tooltip:""}])]).append(this._nodeLayerPickerChooser);var t=this._conflictCalculator.getConflictingPlacementTitles(this.getSelectedPlacementId());this._templates.hasLayersForPlacement(this.getSelectedPlacementId())||0!==t.length?mkE.addClassName(this._nodeLayerPickerChooser,"hidden"):mkE.removeClassName(this._nodeLayerPickerChooser,"hidden"),this._layerPickerChooser.setTitleHidden(!1)},_isPickerTabDisabled:function(e){return[PF.ProductPush.Designer.TAB_TEXT,PF.ProductPush.Designer.TAB_CLIPART].indexOf(e)>-1&&this._isTextPickerDisabled()},isFilePickerDisabled:function(){return this._technique===PF.Items.ProductItem.TECHNIQUE_ENGRAVING},_isTextPickerDisabled:function(){return!1},_isClipartPickerDisabled:function(){var e=this._placementSelector.getSelectedPlacement();return e&&e.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY},_isEmbroideryWithText:function(){return this.getSelectedPlacementTechnique()===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY&&this._templates.hasTextLayers(this._placementSelector.getSelectedPlacementId())},onProductOptionChanged:function(e){if(this.observer.emitProductOptionsChanged()){var t,i=e.getOption();if(this.shouldAllowFileColorChanger()||(i.isEmbroideryType()||i.isEmbroideryFrontColors()||i.isEmbroideryFront3dColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT:i.isEmbroideryLeftColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_LEFT:i.isEmbroideryRightColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_RIGHT:i.isEmbroideryBackColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_BACK:i.isEmbroideryLeftChestColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_CHEST_LEFT:i.isEmbroideryCenterChestColors()?t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_CHEST_CENTER:i.isEmbroideryApparelColors()&&(t=PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_APPAREL_FRONT)),t&&(this.shouldAllowFileColorChanger()||this._updateEmbroideryColorsForPlacement(t),t!==this.getSelectedPlacementId()&&this.setActivePlacement(t)),this._renderFooter(),this._par.arePickersVisible){var r=this._productOptionsPicker.getValues();r.hasOwnProperty(e.getName())||(r[e.getName()]=e.getValue()),this._layerPicker.setProductOptionsValues(r).renderOptions(PF.Items.GeneratorPlacement.fromArray({id:this.getSelectedPlacementId()}))}this.requireMockupRegenerationAndShowDesigner(),this._par.onPickerChanged&&this._par.onPickerChanged()}},_onChildComponentProductOptionsChanged:function(e,t){if(this._isEmbroideryWithText()&&!this.shouldAllowFileColorChanger()&&mkE.O2O(t,this._getTextUsedColors()),this._productOptionsPicker){var i=this._productOptionsPicker.getValues();mkE.O2O(i,t),t=i;var r=new PF.Components.ProductOptions.Par;r.optionItems=this._getProductOptions(),r.values=t,r.onChange=this.onProductOptionChanged;var n=new PF.Components.ProductOptions(r);n.setPlacementIdsWithLayers(this._templates.getPlacementIdsHavingFiles()).setPlacementIdsWithFiles(this._templates.getPlacementIdsHavingFiles(PF.Components.GeneratorMockup.ImageLayer)).renderOptions(),this._productOptionsPicker.setProductOptions(n).render()}console.log("[W] Final option values calculated",t),this.designData.productOptions=t,e&&(this._updateEmbroideryColorsForPlacement(this.getSelectedPlacementId()),t.hasOwnProperty(PF.Items.ProductOptionItem.NAME_NOTES)&&this.observer.emitEmbroideryNotesValueChanged());var a=e?500:0;setTimeout(function(){this.observer.emitProductOptionsChanged(t)}.bind(this),a),this.requireMockupRegenerationAndShowDesigner(),this.shouldAllowTextboxLayer()?this._toggleTextboxPickerAvailability(t[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE]):this._toggleTextPickerAvailability(t[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE]),this._par.onPickerChanged&&this._par.onPickerChanged()},_tryApplyingEmbroideryColorization:function(){this.shouldAllowFileColorChanger()||this._productOptionsPicker&&(this._productOptionsPicker.setFileTypesWithFiles(this._templates.getPlacementIdsHavingFiles()).setPlacementIdsWithFiles(this._templates.getPlacementIdsHavingFiles(PF.Components.GeneratorMockup.ImageLayer)),this._updateEmbroideryColorsForPlacement(this.getSelectedPlacementId()))},_editImageLayer:function(e){this._embroideryImagePicker&&(this._recalcFirstLayerWith3dEmbroidery(),this._recalcEmbroideryPriceOptionsValue(),this._embroideryImagePicker.editImageLayer(e,this.getSelectedPlacementId())),this._templates.silentlySetActiveLayer(e),this._showPickerTab(PF.ProductPush.Designer.TAB_IMAGE)},_updateEmbroideryColorsForPlacement:function(e){var t=this._getAvailablePlacementByPlacementId(e);if(t&&t.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY){for(var i=function(){this._mockup&&!this._par.isCustomizingMode||this.updateView();for(var e=this._getTemplate(t.id),i=0,r=e.layers.length;i<r;i++)this._scheduleEmbroideryPreviewUpdate(t.id,e.layers[i],!1)}.bind(this),r=this._getEmbroideryColorsForPlacement(t.id),n=this._templates.getUniqueFilesForPlacement(t.id),a=0,o=n.length;a<o;a++)this._updateEmbroideryColorsForPlacementAndFile(t,n[a],r,i);i()}},_getEmbroideryColorsForPlacement:function(e){if(!this._productOptionsPicker&&!this._par.isCustomizingMode)return[];if(-1===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FILES.indexOf(e))return[];var t=this._par.isCustomizingMode?this._par.pickerConfig.productOptionsValues||{}:this._productOptionsPicker.getValues(),i=this._validateEmbroideryTypeForText(t),r=[];if(PF.Items.OrderLineItemFile.PLACEMENT_COLOR_MAP[e]===PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE){var n=i[PF.Items.OrderLineItemFile.PLACEMENT_COLOR_MAP[e]];"3d"!==n&&(r=r.concat(i[PF.Items.ProductOptionItem.NAME_THREAD_COLORS]||[])),"flat"!==n&&(r=r.concat(i[PF.Items.ProductOptionItem.NAME_THREAD_COLORS_3D]||[]))}else r=i[PF.Items.OrderLineItemFile.PLACEMENT_COLOR_MAP[e]]||[];return r},_updateEmbroideryColorsForPlacementAndFile:function(e,t,i,r){var n=function(i){this._templates.overrideLayerImages(e.id,t.fileId,i),e.id===this.getSelectedPlacementId()&&r&&r()}.bind(this);i.length<1?n(null):new PF.Utils.ColorMapper(t.urlPreview,i,n)},_toggleTextPickerAvailability:function(e){if(this._layerPickerChooser&&!this._par.isCustomizingMode){var t=this._isTextPickerAvailable(e),i=dlang("dashboard","Text is only available in flat embroidery and can't be combined with 3D puff elements. Please choose flat embroidery to add text.");this._layerPickerChooser.setTypeEnabled(PF.ProductPush.LayerPicker.TYPE_TEXT,t,i)}},_toggleTextboxPickerAvailability:function(e){if(this._layerPickerChooser&&!this._par.isCustomizingMode){var t=this._isTextPickerAvailable(e),i=dlang("dashboard","Text is only available in flat embroidery and can't be combined with 3D puff elements. Please choose flat embroidery to add text.");this._layerPickerChooser.setTypeEnabled(PF.ProductPush.LayerPicker.TYPE_TEXTBOX,t,i)}},_isTextPickerAvailable:function(e){var t=this._placementSelector.getSelectedPlacementId();e||(e=t===PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FRONT?this.getProductOptionsValues(!0)[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE]:"flat");var i=this._templates.hasLayersForPlacement(t,PF.Components.GeneratorMockup.ImageLayer);return"flat"===e||!e||!i||this.shouldAllowFileColorChanger()},_scheduleEmbroideryPreviewUpdate:function(e,t,i,r){if(this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY&&this._generatorParams.isEmbroideryPreviewEnabled){var n=this._getAvailablePlacementByPlacementId(e);if(!n||n.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY){var a=e+t.uniqueId;this._renderTimeouts[a]&&clearTimeout(this._renderTimeouts[a]);var o=i?0:3e3;this._renderTimeouts[a]=setTimeout(this._renderEmbroideryImagePreview.bind(this,e,t,a,r),o)}}},_renderEmbroideryImagePreview:function(e,t,i,r){if(this._templates.getTemplateByLayer(t)){var n=[],a={};if((t=this._templates.getFreshLayer(t)).isImageLayer()?(n=this._getEmbroideryColorsForPlacement(e),a=t.overrideColors?t.overrideColors:{}):t.isTextLayer()&&t.color?n=[t.color]:t.isClipartLayer()&&t.fillColor&&(n=[t.fillColor]),0!==n.length||0!==Object.keys(a).length)if(!this.shouldAllowFileColorChanger()&&t.position.width*t.position.height>PF.ProductPush.EmbroideryHelper.MAX_EMBROIDERY_PREVIEW_AREA)t.overrideImagePulse&&(t.overrideImagePulse=null,this.updateView());else{var o=this._renderTimeouts[i],s=this._embroideryPreviewGenerated.bind(this,e,t,o,i,r);this.generatorRepository.generateEmbroideryPreview(t,n,s)}}},_embroideryPreviewGenerated:function(e,t,i,r,n,a){if(this._renderTimeouts[r]===i){var o=new Image;o.onload=function(){var i=this._templates.getFreshLayer(t);i&&(i.overrideImagePulse=o.src,t.isImageLayer()?this._templates.updateImageLayer(i,this._templates,!0):t.isTextLayer()?this._templates.updateTextLayer(i,this._templates,!0,!0):e===this.getSelectedPlacementId()&&this.updateView(),n&&"function"==typeof n&&n())}.bind(this),o.src=a.image}else console.log("Skipping preview since another task was active")},_renderVariantWarning:function(){if(!this._par.isOrderFlowMode){mkE.clearNode(this._nodeVariantWarning);var e=null;this._isVariantLimitExceeded()&&(e=this._renderExceededVariantLimitWarning()),this._getEbayStockQuantityExceededError()&&(e=this._renderEbayStockQuantityWarning()),e&&e.append(this._nodeVariantWarning)}},_renderEbayStockQuantityWarning:function(){var e=this._getEbayStockQuantityExceededError();if(!e)return null;var t=tag("div","alert alert-danger");return t.innerHTML="<b>"+dlang("dashboard","You've exceeded the total quantity of variants eBay allows you to add this month.")+"</b> "+dlang("dashboard","You're attempting to add {0} variants, but your remaining available eBay item quantity this month is {1} new items (variants).").format("<b>"+e.used+"</b>","<b>"+e.limit+"</b>")+"<br/>"+dclang("dashboard","eBay product push","Try un-checking some colors or sizes."),t},_renderExceededVariantLimitWarning:function(){if(!this._isVariantLimitExceeded())return null;var e=!!this._par.existingVariants&&this._par.existingVariants.length>0,t="<b>"+dlang("generator","You've exceeded your store's variant limit per product.")+"</b> ";return t+=e?(1===this._par.existingVariants.length?1===this.variantLimit?dlang("generator","You selected {0} including existing {1} variant, but the limit is {2} variant."):dlang("generator","You selected {0} additionally to existing {1} variants, but the limit is {2} variants."):1===this.variantLimit?dlang("generator","You selected {0} including existing {1} variants, but the limit is {2} variant."):dlang("generator","You selected {0} additionally to existing {1} variants, but the limit is {2} variants.")).format("<b>"+this._allSelectedVariantCount+"</b>","<b>"+this._par.existingVariants.length+"</b>",this.variantLimit+"</b>"):dnlang("generator","You selected {0}, but the limit is {1} variant.","You selected {0}, but the limit is {1} variants.",this.variantLimit).format("<b>"+this._allSelectedVariantCount+"</b>","<b>"+this.variantLimit+"</b>"),tag("div","alert alert-danger",[tag("span",{innerHTML:t}),tag("br"),dlang("generator","Try un-checking some colors or sizes, or create a new product if necessary.")])},_disableAddDesignTabIfNeeded:function(){if(this._pickerTabs){var e=this._pickerTabs.getTabById(PF.ProductPush.Designer.TAB_DESIGN);e&&this._par.isProductPushMode&&(this._getSelectedVariant()?e.isDisabled&&(e.isDisabled=!1,e.tooltipTitle="",this._pickerTabs.render(),this._dropZoneArea&&this._dropZoneArea.enable()):(e.isDisabled=!0,e.tooltipTitle=dlang("generator","To start designing, please select a new variant thats not already synced to your store."),this._pickerTabs.render(),this._dropZoneArea&&this._dropZoneArea.disable()))}},updateView:function(){this._renderDesignFillColorPicker();var e=this.getSelectedGeneratorVariants();this.generatorVariants=e.generatorVariants,this._selectedVariantCount=e.variantCount,this._allSelectedVariantCount=e.allVariantCount,this.setPreviewMockupVariant(null);var t=this._isProductTemplateDetailsEditor()?null:this.getGeneratorVariantByPlacementId(!1,!0);if(t){this.setPreviewMockupVariant(t),this._placementSelector.setSelectedPlacementById(this.previewMockupVariant.placementId),this._par.placementDependentOptions&&this._productOptionsPicker.setSelectedPlacementId(this.previewMockupVariant.placementId),this._renderClipartPicker();var i=this._pickerTabs&&this._pickerTabs.getActiveTab();i&&i.customId===PF.ProductPush.Designer.TAB_PRODUCT?this._renderLayerPickerChooser():this._renderLayerPicker(),this.shouldAllowTextboxLayer()?this._toggleTextboxPickerAvailability():this._toggleTextPickerAvailability(),this._validateTextLayerCount()}if(this._renderFooter(),this._renderDiscontinuedWarning(),this._renderVariantWarning(),this._renderDesignerTabs(),this._renderAdvancedTemplatePicker(),!this._isProductTemplateDetailsEditor()&&this._isEmpty())return this.renderEmptyMockup(),void(this._par.isChangePrintfileMode&&this._isEmbroideryWithText()&&this._renderProductOptions());this._isProductTemplateDetailsEditor()||(this._renderOrientationPicker(),this._renderProductOptions(),this._renderMockupVariantArea(),this._renderMockupMainArea())},updatePlacementPrices:function(e){this._placementSelector.setPriceDataAndRender(e)},getGeneratorVariantByPlacementId:function(e,t){e=e||this.getSelectedPlacementId();var i=this.lastSelectedColor,r=this.lastSelectedSize,n=this.getSelectedGeneratorVariants(!1,!0).generatorVariants;if(t)return n.sort((function(t,n){var a=0,o=0;return a+=2*Number(t.placementId===e),a+=Number(PF.Utils.String.isEqual(t.color,i)),a+=Number(PF.Utils.String.isEqual(t.size,r)),o+=2*Number(n.placementId===e),o+=Number(PF.Utils.String.isEqual(n.color,i)),a>(o+=Number(PF.Utils.String.isEqual(n.size,r)))?-1:a===o?0:1}))[0];for(var a in n){var o=n[a],s=!i||!o.color||PF.Utils.String.isEqual(i,o.color),l=!r||!o.size||PF.Utils.String.isEqual(r,o.size),d=!e||e===o.placementId;if(s&&l&&d)return o}return null},_canGeneratePreview:function(){return this.generatorVariants&&0!==this.generatorVariants.length},_renderMockupVariantArea:function(){if(!this._par.isFooterVisible)return!1;var e=this.hasDesignForPlacement(this.getSelectedPlacementId()),t=this._getGeneratorVariants(!e),i=this.getSelectedPlacementId(),r=t.filter((function(e){return e.placementId===i}));if(r.length<1)this._variantArea&&(this._variantArea.remove(),this._variantArea=null,mkE.clearNode(this._nodeMockupVariantArea));else if(this._variantArea)this._variantArea.setGeneratorVariants(r,this.previewMockupVariant),e||this._variantArea.renderMockupPreviewStrings();else{mkE.clearNode(this._nodeMockupVariantArea);var n=new PF.ProductPush.VariantArea.Par;n.generatorVariants=r,n.activeGeneratorVariant=this.previewMockupVariant,n.onGeneratorVariantRemove=this._onGeneratorVariantRemove,n.onGeneratorVariantSelect=this._onGeneratorVariantSelect,n.templates=this._templates,n.disableLayerManipulations=this._par.disableLayerManipulations,n.getDesignFillColor=this.getDesignFillColor.bind(this),n.product=this._product,n.designData=this.designData,this._variantArea=new PF.ProductPush.VariantArea(n),this._variantArea.append(this._nodeMockupVariantArea)}},_getGeneratorVariants:function(e){return this._canGeneratePreview()&&!e?this.generatorVariants:this.getSelectedGeneratorVariants(!0,!0).generatorVariants},_onGeneratorVariantRemove:function(e){var t=[],i=[],r=this.getSelectedPlacementId(),n=this._getGeneratorVariants();for(var a in n){var o=n[a];o.generatorVariantId!==e&&o.placementId===r&&(o.size&&t.indexOf(o.size)<0&&t.push(o.size),o.color&&i.indexOf(o.color)<0&&i.push(o.color))}if((i=this.allColors.filter((function(e){return i.indexOf(e.color)>-1}))).length&&i.length!=this._selectedColors.length)return this._onColorsChanged(i),void this._colorPicker.setColors(i).render();t.length&&t.length!=this._selectedSizes.length&&(this._onSizesChanged(t),this._sizePicker.setSizes(t).render())},_getFirstInsideLabelGeneratorVariantId:function(e){var t=this._generatorParams.generatorVariants,i=null,r=null;for(var n in e||(e=this._par.isOrderFlowMode&&this._selectedColors.length>0?this._selectedColors[0].color:this.lastSelectedColor),t){var a=t[n];if(a.isInsideLabel()&&((!a.color||!e||PF.Utils.String.isEqual(a.color,e))&&(a.templateType===PF.Components.InsideLabelTemplate.LABEL_CUSTOM?r=a.generatorVariantId:a.templateType===PF.Components.InsideLabelTemplate.LABEL_NATIVE&&(i=a.generatorVariantId)),i&&r))break}return{native:i,custom:r}},_onGeneratorVariantSelect:function(e){this._onPlacementSelectorChanged(e,!0)},_onPlacementSelectorChanged:function(e,t){var i,r=!0;if(e instanceof PF.Items.GeneratorPlacement?(i=this.getGeneratorVariantByPlacementId(e.id))||(i=this.getGeneratorVariantByPlacementId(e.id,!0)):Number(e)?(i=this.getGeneratorVariantById(e,!0),r=!1):i="string"==typeof e?this.getGeneratorVariantByPlacementId(e):this.getGeneratorVariantByPlacementId(),i&&(this.setPreviewMockupVariant(i),this._templates.setActiveLayerFromTemplate(i.placementId,i.templateId),this.lastSelectedColor=i.color,this.lastSelectedSize=i.size),r){var n=this._pickerTabs&&this._pickerTabs.getActiveTab();n&&n.customId&&(this._renderLayerPickerChooser(),this._showPickerTab(n.customId))}if(this._embroideryHelper.recalcGlobalSelectedEmbroiderySelectedColors(),this._embroideryHelper.reScheduleEmbroideryPreviewForTemplate(),t||PF.Components.GeneratorMockup.resetZoom(),this._renderFooter(),this._loadDesignFillColor(),this._manageCheckboxShowHide(),this._renderClipartPicker(),this._canRenderNativeInsideLabelSelection())this._renderInsideLabel();else{if(this._isEmpty())return this.shouldAllowTextboxLayer()?this._renderTextboxPicker():this._renderTextPicker(),this.renderEmptyMockup(i),this._hideInsideLabelSwitcher(),void PF.Events.emit(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE);this._renderMockupVariantArea(),this._renderMockupMainArea(),this._hideInsideLabelSwitcher()}this.shouldAllowTextboxLayer()?this._toggleTextboxPickerAvailability():this._toggleTextPickerAvailability(),this._validateTextLayerCount(),PF.Events.emit(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE)},_hideInsideLabelSwitcher:function(){this._product.isAdvancedInsideLabelAllowed()&&this._labelSwitcher.hide()},_renderInsideLabel:function(){if(!this._isTemplatePreselected()&&this._isPlacementInsideLabel()&&!this.designData.labelTemplateType&&this._product.isDtgShirt()&&this._product.hasAdvancedInsideLabel&&!this._isProductTemplateEditor()){var e=new PF.Components.InsideLabelTemplate.Par;e.nativeTemplateSelected=this._setSelectedInsideLabelTemplate.bind(this,PF.Components.InsideLabelTemplate.LABEL_NATIVE),e.customTemplateSelected=this._setSelectedInsideLabelTemplate.bind(this,PF.Components.InsideLabelTemplate.LABEL_CUSTOM),this.nodeInsideLabelTemplatePicker=new PF.Components.InsideLabelTemplate(e),mkE.clearNode(this._nodeMainMockupArea),this.nodeInsideLabelTemplatePicker.append(this._nodeMainMockupArea),this._renderLayerPicker(),this._renderClipartPicker(),this.shouldAllowTextboxLayer()?this._renderTextboxPicker():this._renderTextPicker(),this._renderEmbroideryImagePicker(),this._renderPatternPicker()}var t=this._product.hasAdvancedInsideLabel&&this._isProductTemplateEditor();if(t&&(this.designData.labelTemplateType=PF.Components.InsideLabelTemplate.LABEL_NATIVE),this._isTemplatePreselected()){this._product.hasAdvancedInsideLabel||(this.designData.labelTemplateType=PF.Components.InsideLabelTemplate.LABEL_CUSTOM),this._product.hasAdvancedInsideLabel&&this._labelSwitcher.setActiveSwitch.bind(this,this.designData.labelTemplateType),this._setSelectedInsideLabelTemplate(this.designData.labelTemplateType);var i=this._getFirstInsideLabelGeneratorVariantId(),r=this._generatorParams.generatorVariants[i[this.designData.labelTemplateType]];t&&this._labelSwitcher.hide(),this._templates.setActiveLayerFromTemplate(r.placementId,r.templateId),this.setPreviewMockupVariant(r),this._renderLayerPicker(),this._renderClipartPicker(),this.shouldAllowTextboxLayer()?this._renderTextboxPicker():this._renderTextPicker(),this._renderEmbroideryImagePicker(),this._renderPatternPicker()}},_isTemplatePreselected:function(){if(!this._product.isDtgShirt())return!1;if(this.getSelectedPlacementId()!==PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE)return!1;if(this.designData.labelTemplateType)return!0;var e=this.getSelectedGeneratorVariants().generatorVariants;if(e)for(var t in e)if(e[t].isInsideLabel()&&e[t].templateType)return this.designData.labelTemplateType=e[t].templateType,!0;return!1},_setSelectedInsideLabelTemplate:function(e){this._updateMockupPlacements();var t=this._getFirstInsideLabelGeneratorVariantId();this._product.hasAdvancedInsideLabel&&this._labelSwitcher.show(e,this._setSelectedInsideLabelTemplate.bind(this)),this.designData.labelTemplateType=e;var i=this._generatorParams.generatorVariants[t[e]];this.setPreviewMockupVariant(i),this._isEmpty()?this.renderEmptyMockup(i):i&&(this._templates.setActiveLayerFromTemplate(i.placementId,i.templateId),this.updateView()),this._dropZoneArea&&this._isPlacementInsideLabel()&&this._dropZoneArea.setInsideLabelType(e),e===PF.Components.InsideLabelTemplate.LABEL_NATIVE&&this._labelSwitcher.getLabelPopover(this._applyPopoverInfoNode)},_applyPopoverInfoNode:function(e){e&&e.append(this._nodeMainMockupArea)},_updateMockupPlacements:function(){this.observer.emitPlacementLayersChanged(this.designData)&&(this.hasDesignForPlacement(this.getSelectedPlacementId())?mkE.addClassName(this._nodeLayerPickerChooser,"hidden"):(this.renderEmptyMockup(),mkE.removeClassName(this._nodeLayerPickerChooser,"hidden")),this._renderFooter(),this._par.placementDependentOptions&&this._productOptionsPicker.setSelectedPlacementId(this.getSelectedPlacementId()),this._dropZoneArea&&(this._nodeMainMockupArea.dataset.placement=this.getSelectedPlacementId()),this._techniquePicker&&this._techniquePicker.toggleChangeTechniquePopup(this._templates.hasLayers()),this._advancedTemplatePicker&&this._advancedTemplatePicker.toggleTemplatePickerPopup(this._templates.hasLayers()),this._isPlacementInsideLabel()&&this._product.isDtgShirt()&&this.designData.labelTemplateType===PF.Components.InsideLabelTemplate.LABEL_NATIVE&&this._labelSwitcher&&this._labelSwitcher.getLabelPopover(this._applyPopoverInfoNode))},_renderMockupMainArea:function(){if(this.previewMockupVariant){this._showLoader(this._nodeMainMockupArea,{minHeight:200});var e=this._calculateMockupMainAreaSize(),t=new PF.ProductPush.ProductMockup.Par;t.templates=this._templates,t.generatorVariant=this.previewMockupVariant,t.onReady=this._onMainMockupAreaReady,t.mockupMaxWidth=e.maxWidth,t.mockupMaxHeight=e.maxHeight,t.disableLayerManipulations=this._par.disableLayerManipulations,t.disableOutOfBoundsErrorMessages=this._par.disableOutOfBoundsErrorMessages,t.activeLayer=this._templates.getActiveLayer(),t.isCustomizingMode=this._par.isCustomizingMode,t.designFillColor=this.getDesignFillColor(this.getSelectedPlacementId());var i=this.getUserTemplateByGeneratorVariant(this.previewMockupVariant);i&&(t.templateKey=i.getKey()),t.product=this._product,t.hideZoomButton=this._par.hideZoomButton,this._mockup=new PF.ProductPush.ProductMockup(t)}},_onMainMockupAreaReady:function(){if(this.observer.emitMainMockupReady()&&this._mockup){if(mkE.clearNode(this._nodeMainMockupArea),mkE.removeClassName(this._nodeMainMockupArea,"main-mockup-area--empty-mockup"),this._isAdvancedTemplateLoaded()?(this._addAdvancedTemplateWarning(),this._par.isOrderFlowMode||this._layerPicker.clearGuidelineIfo()):this._removeAdvancedTemplateWarning(),this._isTextLayerConverted&&(this._getWarningNode(dlang("generator","Please double-check text before clicking Continue")).append(this._nodeMainMockupArea),this._isTextLayerConverted=!1),this._needToShow3dTab&&(this._show3DPreview(!0),this._needToShow3dTab=!1),this._mockup.append(this._nodeMainMockupArea),this._par.similarProductPushState&&this._product.isCutSew()){var e=tag("div","text-center",dlang("generator","Please double-check your design alignment in the print area before you continue"));new PF.Components.Alert([e],"warning",!1,!1,!0,null).prepend(this._nodeMainMockupArea)}this.displayTemplateSizeChangeWarningIfNeeded(),mkE.removeClassName(this._nodeMainMockupArea,"loading"),this._hideLoader(this._nodeMainMockupArea),PF.Utils.isTouch()||this._par.withGlobalDropZone&&(this.storeId?this._initDropZone(this.storeId,!1):(new PF.Repositories.StoreRepository).getFirstId(this._initDropZone)),this._disableAddDesignTabIfNeeded()}},_isAdvancedTemplateLoaded:function(){return this.previewMockupVariant&&this.previewMockupVariant.role===PF.Items.GeneratorVariantItem.ROLE_ADVANCED_TEMPLATE&&(!this.designData.labelTemplateType||this.designData.labelTemplateType!==PF.Components.InsideLabelTemplate.LABEL_NATIVE)},_onLayerAddedOrRemoved:function(){this.updateView(),this._updateMockupPlacements(),PF.Events.emit(PF.Events.DESIGN_UPDATE)},_onLayerOrderChanged:function(){this._renderMockupMainArea(),this._renderMockupVariantArea(),PF.Events.emit(PF.Events.DESIGN_UPDATE)},_calculateMockupMainAreaSize:function(){var e=1,t=this._mockupMainMaxWidth,i=this._mockupMainMaxHeight,r=this._nodeMainMockupArea;return r.clientWidth&&t>r.clientWidth&&(e=t/r.clientWidth),{maxWidth:t/e,maxHeight:i/e}},_getProductWarning:function(){var e;if(this._product.productId!==PF.Items.ProductItem.ID_T_SHIRT_BB453&&this._product.productId!==PF.Items.ProductItem.ID_T_SHIRT_TC245||this.getSelectedPlacementId()!==(PF.Items.OrderLineItemFile.TYPE_FRONT||PF.Items.OrderLineItemFile.TYPE_BACK))if(-1!==PF.Items.ProductItem.YOGA_PRODUCTS.indexOf(this._product.productId)&&this._isPlacementInsideLabel())e=dlang("generator","Please note - back waist print file is copied on the inside of the waistband, so the inside label will appear on top of your design");else{if(this.getSelectedPlacementId()!==PF.Items.OrderLineItemFile.TYPE_BACK||this._product.productId!==PF.Items.ProductItem.ID_ANVIL_71600)return"";e=dlang("generator","Because of the stitching at the top, we recommend placing graphics lower so they dont print over the seams")}else e=dlang("generator","Placement is approximate and graphics larger than 12x13 will be scaled to clear the garment seams");return this._getWarningNode(e)},_getWarningNode:function(e){return tag("div","generator-mockup__warning-message alert alert-warning alert-dismissible text-center",[tag("button",{className:"close",attr:{"aria-label":lang("Close")},data:{dismiss:"alert"}},""),tag("span","",e)])},setPreviewMockupVariant:function(e){var t;this._loaded3dObj&&(null===(t=this.previewMockupVariant)||void 0===t?void 0:t.templateId)!==(null==e?void 0:e.templateId)&&(this._loaded3dObj=null,this._shouldRegenerate3D=!0,this._show3dViewWarningAlert=!0),this.previewMockupVariant=e},setProductOptions:function(e){this._productOptionsPicker||(this._productOptionsPicker=new PF.VariantPicker.OptionPicker(new PF.Components.ProductOptions.Par)),this._productOptionsPicker.setProductOptions(e)},_onTemplatePositionsChanged:function(e,t){this._needToReRenderVariantArea(e,t)&&this._renderMockupVariantArea(),this._renderFooter(),this.observer.emitPlacementPositionsChanged(),this._displayQualityIndicators(),this._par.onPositionsChanged&&this._par.onPositionsChanged(),PF.Events.emit(PF.Events.DESIGN_UPDATE)},_needToReRenderVariantArea:function(e,t){if(!this._templates||!t)return!1;var i=this._templates.getActiveTemplate(this.getSelectedPlacementId());if(i){var r=i.getLayerIndex(t);if(r>-1)return e.some((function(e){return e.layers[r].uniqueId!==t.uniqueId}))}return!1},_onTemplateResized:function(e,t){if(this._renderFooter(),this._displayQualityIndicators(),this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY)for(var i in e)if(e[i].technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY){this._scheduleEmbroideryPreviewUpdate(e[i].placementId,t);break}PF.Events.emit(PF.Events.DESIGN_UPDATE)},_displayQualityIndicators:function(){this._mockup&&(this._mockup.getMockup().displayOutOfBoundsIndicator(),this._mockup.getMockup().displayQualityIndicators(),this._mockup.getMockup().displayCustomizableTextLayerError())},getUserTemplateByGeneratorVariant:function(e){return this._templates.getUserTemplate(e.placementId,e.templateId)},getSelectedGeneratorVariants:function(e,t){var i={generatorVariants:[],variantCount:0,allVariantCount:0},r={},n=this._getSelectedMappings();for(var a in n){var o=n[a];if(!this._isVariantDiscontinued(o.size,o.color)&&(!this._par.existingVariants||!this._isVariantExistingForProduct(o.size,o.color)||this._par.isChangePrintfileMode)){var s=!1,l=!1;for(var d in this._generatorParams.availablePlacements){var c=this._generatorParams.availablePlacements[d];if(this._templates.hasTemplates(c.id)&&(s||(s=!0,i.allVariantCount+=1),t||this.hasDesignForPlacement(c.id))){var u=null,h=o.mockupIds[c.id],p=o.templateIds[c.id];if(c.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE&&this.designData.product.isAdvancedInsideLabelAllowed()){var g=PF.Components.InsideLabelTemplate.LABEL_CUSTOM;if(this.designData.hasLabelNative()){var m=h||p,_=this._generatorParams.generatorVariants[m].color,P=this._getFirstInsideLabelGeneratorVariantId(_);h=P[g=PF.Components.InsideLabelTemplate.LABEL_NATIVE],p=P[g]}this._isPlacementInsideLabel()&&this.hasLayersForPlacement(this.getSelectedPlacementId())&&!this.designData.labelTemplateType&&(this.designData.labelTemplateType=g,this._labelSwitcher.show(g,this._setSelectedInsideLabelTemplate.bind(this)))}if(u=e?h||p:p||h,this._isZoomedTemplate(o,c)&&(u=p),l||(l=!0,i.variantCount++),!r[u]){var f=this._generatorParams.generatorVariants[u];r[u]=1,i.generatorVariants.push(f)}}}}}return i},_isZoomedTemplate:function(e,t){return this._isZoomedTemplateShown()&&void 0!==e.templateIds[t.id]},_isZoomedTemplateShown:function(){if(this._product&&this._product.availableTechniques)return this._product.availableTechniques.indexOf(PF.Items.ProductItem.TYPE_T_SHIRT)>-1||this._product.availableTechniques.indexOf(PF.Items.ProductItem.TYPE_EMBROIDERY)>-1},_getSelectedMappings:function(e){var t=[];for(var i in this._generatorParams.variantMapping){var r=this._generatorParams.variantMapping[i];r.color&&!this.isColorSelected(r.color)||(e||!r.size||this.isSizeSelected(r.size,this._getFakeSelectedSizes()))&&t.push(r)}return t},_getFakeSelectedSizes:function(){return this._par.isOrderFlowMode&&!this._selectedSizes.length?this.allSizes:null},_isVariantDiscontinued:function(e,t){return e in this.discontinuedColors&&-1!==this.discontinuedColors[e].indexOf(t)},_isVariantExistingForProduct:function(e,t){var i=this._getExistingProductVariantData(),r=!1;for(var n in i[e])i[e][n].color==t&&(r=!0);return e in i&&r},_getExistingProductVariantData:function(){var e=[];for(var t in this._par.existingVariants)e.push((new PF.Repositories.Products).getCachedVariantById(this._par.existingVariants[t].variantId));var i,r={};for(i in e)r[e[i].size]=[];for(i in e)r[e[i].size].push({color:e[i].color,colorCode:e[i].colorCode,colorCode2:e[i].colorCode2});return r},onFinish:function(e){var t=this.getMissingUploadPrintFiles();t.length?new PF.Components.MissingPrintfilesPopup(t,e):e()},_onFinishCallback:function(){this.trackTransparencyWarningContinueClick();var e=this.getDesignData(),t=this._getSelectedMappings();this.generatorRepository.getGeneratorVariants(t,function(t){this._generatorParams.generatorVariants=Object.assign(this._generatorParams.generatorVariants,t),mkE.removeClassName(this._footerButtonContinue,"loading"),mkE.removeClassName(this._footerButtonContinue,"disabled"),this._hideLoader(this.node),2===this._footerButtonContinue.childNodes.length&&this._footerButtonContinue.removeChild(this._footerButtonContinue.childNodes[1]),this._par.productTemplateEditorState?this._par.onProductDesigned(e):(this._par.onProductDesigned(e,this.getSelectedGeneratorVariants(!1).generatorVariants),this._forgetColorsAndSizes(),this._par.isOrderFlowMode||this._rememberColorsAndSizes())}.bind(this))},_onBack:function(){this._par.onBack()},getSizes:function(){return this._selectedSizes},getColors:function(){return this._selectedColors},getRegion:function(){return this._regionPicker?this._regionPicker.activeRegion:PF.VariantPicker.RegionPicker.REGION_USA},getSizePicker:function(){return this._sizePicker},getColorPicker:function(){return this._colorPicker},getLayerPicker:function(){return this._layerPicker},getProductOptionsPicker:function(){return this._productOptionsPicker},getSelectedRegionVariants:function(){return this._regionPicker?this._regionPicker.getMatchingVariants():[]},getValuesToRemember:function(){return{size:this.getSizes().slice().shift(),color:this.getColors().map((function(e){return e.color})).slice().shift(),region:this.getRegion(),options:this.getProductOptionsValues()}},getAvailablePlacements:function(){return this._generatorParams.availablePlacements},isPlacementSimple:function(e){return!this.hasDesignFillColor(e)&&this._templates.isPlacementSimple(e)},getTechnique:function(){return this._technique||this._product.type},getDesignData:function(){var e,t;if(this.designData.colors=this.getSelectedColorNameArray(),this.designData.hexColors=this.getSelectedColorHexArray(),this.designData.sizes=this._selectedSizes,this.designData.productId=this._product.productId,this.designData.productTemplateId=this._isCreatingProductFromTemplate()&&this._par.productTemplateEditorState.sourceProductTemplate?this._par.productTemplateEditorState.sourceProductTemplate.id:null,this._productOptionsPicker){var i=!this.shouldAllowFileColorChanger();this.designData.productOptions=this.getProductOptionsValues(!0,i)}this.designData.storeId=this._par.store.storeId,this.designData.templates={},this.designData.generatorVariants=[],this.designData.forceOrientation=this._orientation||"",this.designData.forceTemplateType=this._templateType,this.designData.useSizeConversion=this._product.useSizeConversion,this.designData.store=this._par.store.storeId?(new PF.Repositories.StoreRepository).getCachedStore(this._par.store.storeId):this._par.store,this.designData.technique=this.getTechnique();var r={};for(e in this.generatorVariants){t=this.generatorVariants[e];var n=this.getUserTemplateByGeneratorVariant(t);for(var a in this.designData.templates[n.getKey()]=n,n.layers){var o=n.layers[a];o instanceof PF.Components.GeneratorMockup.ImageLayer&&(r[t.placementId]=r[t.placementId]||[],r[t.placementId].indexOf(o.fileItem.fileId)<0&&r[t.placementId].push(o.fileItem.fileId))}}this.designData.filesIdsByPlacement=r;var s=this.designData.defaultGeneratorVariantId,l=null,d=this.getSelectedGeneratorVariants(!0).generatorVariants;for(e in d)s==(t=d[e]).generatorVariantId&&(l=t.generatorVariantId),this.designData.generatorVariants.push(t);if(!l){var c=this.getSelectedGeneratorVariants(!1).generatorVariants[0];c&&c.generatorVariantId&&(this.designData.generatorVariants.push(c),l=c.generatorVariantId)}this.designData.defaultGeneratorVariantId=l;var u=new PF.ProductPush.VariantFilter(this.designData,this._generatorParams);return this.designData.generatorVariantsIdsToSave=u.getMockupVariantIds(),this.designData.sizeGuideUnits=[PF.ProductPush.MockupPicker.SizeGuide.SIZE_UNIT_IMPERIAL],this.designData.rawPlacementOptions=this._placementOptions.getData(),this.designData},_getProductOptions:function(){var e=[PF.Items.ProductOptionItem.NAME_EMBROIDERY_FONT,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_LEFT,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_RIGHT,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_BACK,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_CHEST_LEFT,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_CHEST_CENTER,PF.Items.ProductOptionItem.NAME_TEXT_THREAD_COLORS_APPAREL];return this.getTechnique()!==PF.Items.ProductItem.TYPE_EMBROIDERY&&e.push(PF.Items.ProductOptionItem.NAME_NOTES),this._product.getOptionItems(e).map(function(e){return this._manageOptionItemVisibleProperty(e),e.isEmbroideryType()&&this._isEmbroideryWithText()&&(e.disabledValues=[PF.Items.OrderLineItemFile.DIGITIZATION_3D,PF.Items.OrderLineItemFile.DIGITIZATION_BOTH],e.disabledValuesLabelText=dlang("dashboard","Text can't be combined with 3D puff elements.")),e}.bind(this))},_manageOptionItemVisibleProperty:function(e){var t=[PF.Items.ProductOptionItem.NAME_NOTES,PF.Items.ProductOptionItem.OPTION_INSIDE_POCKET],i=[PF.Items.ProductOptionItem.NAME_EMBROIDERY_TYPE,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_3D,PF.Items.ProductOptionItem.NAME_THREAD_COLORS,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_LEFT,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_RIGHT,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_BACK,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_CHEST_LEFT,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_CHEST_CENTER,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_APPAREL];(this._par.isMockupGeneratorMode&&t.indexOf(e.name)>-1||this.shouldAllowFileColorChanger()&&i.indexOf(e.name)>-1)&&(e.visible=!1)},getSelectedColorNameArray:function(){var e=[];for(var t in this._selectedColors)e.push(this._selectedColors[t].color);return e},getSelectedColorHexArray:function(){return this._selectedColors.map((function(e){return e.colorCode}))},_getGeneratorVariantFromVariantMapping:function(e,t){var i,r;for(var n in e.mockupIds)if(i=this._generatorParams.generatorVariants[e.mockupIds[n]],n===t){r=this._generatorParams.generatorVariants[e.mockupIds[n]];break}for(var a in e.templateIds)if(i=this._generatorParams.generatorVariants[e.templateIds[a]],a===t)return this._isZoomedTemplateShown()?this._generatorParams.generatorVariants[e.templateIds[a]]:r||this._generatorParams.generatorVariants[e.templateIds[a]];return r||i},_isEmpty:function(){return!(this._templateType||this._canGeneratePreview()&&this._templates.hasLayersForPlacement(this.getSelectedPlacementId()))},renderEmptyMockup:function(e){if(PF.Components.GeneratorMockup.Preview.clearPreviewStrings(),!this._canRenderNativeInsideLabelSelection()||this._isTemplatePreselected()){var t=e||this._getFirstEmptyMockupVariant(),i=this.getSelectedPlacementId();if(!t)for(var r in this._generatorParams.variantMapping){if(t)break;var n=this._generatorParams.variantMapping[r];t=this._getGeneratorVariantFromVariantMapping(n,i)}if(mkE.clearNode(this._nodeMainMockupArea),mkE.removeClassName(this._nodeMainMockupArea,"loading"),mkE.removeClassName(this._nodeMainMockupArea,"main-mockup-area--empty-mockup"),this._removeAdvancedTemplateWarning(),this._renderMockupVariantArea(),this._shouldInitDropZone()&&this._par.withGlobalDropZone&&(this.storeId?this._initDropZone(this.storeId,!0):(new PF.Repositories.StoreRepository).getFirstId(function(e){this._initDropZone(e,!0),this.storeId=e}.bind(this))),this._disableAddDesignTabIfNeeded(),this.hasDesignFillColor()&&(this._renderMockupMainArea(),this._onMainMockupAreaReady()),t){var a=this._getProductWarning();a&&a.append(this._nodeMainMockupArea),this.hasDesignFillColor()||(mkE.addClassName(this._nodeMainMockupArea,"main-mockup-area--empty-mockup"),this._renderEmptyMockupImage(t))}}else this._renderInsideLabel()},_addAdvancedTemplateWarning:function(){this.nodeAdvancedTemplateWarning||(this.nodeAdvancedTemplateWarning=this._getWarningNode(dlang("generator","You are now in advanced mode")),mkE.addClassName(this.nodeAdvancedTemplateWarning,"generator-mockup__warning-message"),this.nodeAdvancedTemplateWarning.append(this._nodeMainMockupArea))},_removeAdvancedTemplateWarning:function(){this.nodeAdvancedTemplateWarning&&(mkE.removeNode(this.nodeAdvancedTemplateWarning),this.nodeAdvancedTemplateWarning=null)},_shouldInitDropZone:function(){var e,t=null===(e=this._conflictCalculator)||void 0===e?void 0:e.getConflictingPlacementTitles(this.getSelectedPlacementId()),i=!this._templates.hasLayersForPlacement(this.getSelectedPlacementId())&&0!==(null==t?void 0:t.length),r=!PF.Utils.isTouch()&&this._technique===PF.Items.ProductItem.TECHNIQUE_ENGRAVING;return!(i||r)},_renderEmptyMockupImage:function(e,t){var i={image:e.backgroundImageUrl||"",shadow:e.backgroundShadowUrl||"",base:e.generatorImageUrl||""};(i.image||i.shadow||i.base)&&PF.CANVAS.backgroundFromCache(i,{width:Math.ceil(this._nodeMainMockupArea.clientWidth),height:Math.ceil(this._nodeMainMockupArea.clientWidth)},function(r){if(r){if("data:,"===r)return console.warn("Image data returned from cloudfront:",r,i),void(t||this._renderEmptyMockupImage(e,!0));this._nodeMainMockupAreaImage&&mkE.removeNode(this._nodeMainMockupAreaImage),this.hasLayersForPlacement(this.getSelectedPlacementId())||(this._nodeMainMockupAreaImage=tag("img",{className:"img-responsive pf-mx-auto pf-my-0",src:r,style:{backgroundColor:e.backgroundColor||"",boxShadow:"inset 0 0 0 2px white"}}),this._nodeMainMockupAreaImage.complete||this._nodeMainMockupAreaImage.addEventListener("load",PF.Events.emit.bind(null,PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE)),this._nodeMainMockupAreaImage.append(this._nodeMainMockupArea)),this._dropZoneArea&&this._dropZoneArea.setGeneratorVariant(e,!0)}else console.warn("Couldnt backgroundFromCache (_renderEmptyMockupImage)",i)}.bind(this))},_getVariantIdIntersection:function(e,t){if(!e||!t)return[];var i=[];return e.forEach((function(e){t.forEach((function(t){e.variantId===t.variantId&&i.push(t.variantId)}))})),i},_getFirstEmptyMockupVariant:function(){var e=this.lastSelectedColor,t=this._getVariantIdIntersection(this._par.existingVariants,this._generatorParams.variantMapping);for(var i in this._generatorParams.variantMapping){var r=this._generatorParams.variantMapping[i],n=!1;if(-1==t.indexOf(r.variantId)&&(!e||PF.Utils.String.isEqual(r.color,e))&&(0!==this._selectedSizes.length&&this._selectedSizes[0]||(n=!0),(!r.color||this.isColorSelected(r.color))&&(!r.size||this.isSizeSelected(r.size)||n)))for(var a in this._generatorParams.availablePlacements){var o=this._generatorParams.availablePlacements[a];if(this.getSelectedPlacementId()===o.id){if(o.id===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE){var s=this._getFirstInsideLabelGeneratorVariantId();return this._product.hasAdvancedInsideLabel&&this._generatorParams.allLabelTypesAvailable||(this.designData.labelTemplateType=PF.Components.InsideLabelTemplate.LABEL_CUSTOM),this._generatorParams.generatorVariants[s[this.designData.labelTemplateType]]}if(this._isZoomedTemplate(r,o))return this._generatorParams.generatorVariants[r.templateIds[o.id]];var l=r.mockupIds[o.id];if(l)return this._generatorParams.generatorVariants[l];if(l=r.templateIds[o.id])return this._generatorParams.generatorVariants[l]}}}return null},hasNeededQuality:function(){if(!this._templates.getRequiredDpi()||this._product.isEmbroidery())return!0;for(var e in this.generatorVariants){var t=this.getUserTemplateByGeneratorVariant(this.generatorVariants[e]);if(t.layers.length>0&&t.getLowestDPI()<this._templates.getRequiredDpi())return!1}return!0},isFileLimitExceeded:function(){for(var e in this.generatorVariants){var t=this.getUserTemplateByGeneratorVariant(this.generatorVariants[e]);if(0!==t.layers.length){var i=0;for(var r in t.layers)t.layers[r]instanceof PF.Components.GeneratorMockup.ImageLayer&&i++;if(i>this._getMaxFileLayerCount())return!0}}return!1},getFileLimitExceededText:function(){return dlang("dashboard","The max limit is {number} design layers. Please delete a layer if you want to continue.").replace("{number}",this._getMaxFileLayerCount())},hasCustomizableTextLayerError:function(){for(var e in this.generatorVariants)if(this.getUserTemplateByGeneratorVariant(this.generatorVariants[e]).hasCustomizableLayersWithMultiLineText())return!0;return!1},hasCustomizableTextLayerArcError:function(){for(var e in this.generatorVariants)if(this.getUserTemplateByGeneratorVariant(this.generatorVariants[e]).hasCustomizableLayersWithArcText())return!0;return!1},isDesignValid:function(){switch(this._technique){case PF.Items.ProductItem.TYPE_EMBROIDERY:return!(this.hasEmbroideryPositionError()||this.hasEmbroideryTextSizeError()||this.hasEmbroideryTextOverlapError());case PF.Items.ProductItem.TECHNIQUE_ENGRAVING:return!(this.hasLayersOverlapError()||this.hasTextSizeError()||this.hasClipartSizeError())}return!0},hasEmbroideryPositionError:function(){return this._getEmbroideryErrors(PF.VariantPicker.Footer.EMBROIDERY_OUT_OF_BOUNDS)},hasEmbroideryTextSizeError:function(){return this._getEmbroideryErrors(PF.VariantPicker.Footer.EMBROIDERY_TEXT_TOO_SMALL)},hasEmbroideryTextOverlapError:function(){return this._getEmbroideryErrors(PF.VariantPicker.Footer.EMBROIDERY_LAYERS_OVERLAPPING)},hasTextSizeError:function(){return this._getTechniqueDependentErrors(PF.VariantPicker.Footer.LAYER_TEXT_TOO_SMALL)},hasClipartSizeError:function(){return this._getTechniqueDependentErrors(PF.VariantPicker.Footer.LAYER_CLIPART_TOO_SMALL)},hasLayersOverlapError:function(){return this._getTechniqueDependentErrors(PF.VariantPicker.Footer.LAYERS_OVERLAPPING)},hasLayersPositionError:function(){return this._getTechniqueDependentErrors(PF.VariantPicker.Footer.LAYER_OUT_OF_BOUNDS)},_getEmbroideryErrors:function(e){var t=new PF.Components.GeneratorMockup.Validator(this._product),i={};if(i[PF.VariantPicker.Footer.EMBROIDERY_LAYERS_OVERLAPPING]=!1,i[PF.VariantPicker.Footer.EMBROIDERY_OUT_OF_BOUNDS]=!1,i[PF.VariantPicker.Footer.EMBROIDERY_TEXT_TOO_SMALL]=!1,this._technique!==PF.Items.ProductItem.TYPE_EMBROIDERY)return!1;for(var r in this.generatorVariants){var n=this.getUserTemplateByGeneratorVariant(this.generatorVariants[r]);if(n.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY)for(var a in n.areLayersOverlapping(PF.Components.GeneratorMockup.TextLayer,PF.Components.GeneratorMockup.TextboxLayer)&&(i[PF.VariantPicker.Footer.EMBROIDERY_LAYERS_OVERLAPPING]=!0),n.layers){var o=n.layers[a];o.isTextLayerPartiallyOutOfBounds()&&(i[PF.VariantPicker.Footer.EMBROIDERY_OUT_OF_BOUNDS]=!0),t.setActiveLayer(o).isTextSizeValid()||(i[PF.VariantPicker.Footer.EMBROIDERY_TEXT_TOO_SMALL]=!0)}}return!!i.hasOwnProperty(e)&&i[e]},_getTechniqueDependentErrors:function(e){if(void 0===PF.ProductPush.Designer.TECHNIQUE_DEPENDENT_VALIDATION[this._technique]||-1===PF.ProductPush.Designer.TECHNIQUE_DEPENDENT_VALIDATION[this._technique].indexOf(e))return!1;var t=new PF.Components.GeneratorMockup.Validator(this._product),i={};for(var r in this.generatorVariants){var n=this.getUserTemplateByGeneratorVariant(this.generatorVariants[r]);for(var a in n.areLayersOverlapping()&&(i[PF.VariantPicker.Footer.LAYERS_OVERLAPPING]=!0),n.layers){var o=n.layers[a];o.isPartiallyOutOfBounds()&&(i[PF.VariantPicker.Footer.LAYER_OUT_OF_BOUNDS]=!0),t.setActiveLayer(o).isTextSizeValid()||(i[PF.VariantPicker.Footer.LAYER_TEXT_TOO_SMALL]=!0),t.setActiveLayer(o).isClipartSizeValid()||(i[PF.VariantPicker.Footer.LAYER_CLIPART_TOO_SMALL]=!0)}}return!!i.hasOwnProperty(e)&&i[e]},areTextLayersValid:function(){return!this.generatorVariants||!this.generatorVariants.length||!this.generatorVariants.some((function(e){var t=this.getUserTemplateByGeneratorVariant(e);return!!t&&!t.areTextLayersValid()}),this)},areEmbroideryThreadColorsValid:function(){return!this._embroideryHelper.hasEmbroideryThreadColorsError()},hasEmbroideryNotesError:function(){if(!this.shouldAllowFileColorChanger()||!this._generatorParams)return!1;var e=this._templates.getTemplates();if(this._embroideryHelper.hasLayerWithPartial3dType(e)){var t=this._productOptionsPicker.getValues();if(!t||!t[PF.Items.ProductOptionItem.NAME_NOTES])return!0}return!1},_rememberColorsAndSizes:function(){try{sessionStorage.setItem(this._getSessionStorageKey(this._KEY_SELECTED_COLORS),JSON.stringify(this.getSelectedColorNameArray())),sessionStorage.setItem(this._getSessionStorageKey(this._KEY_SELECTED_SIZES),JSON.stringify(this._selectedSizes))}catch(e){console.error("Could not remember Colors and size")}},_forgetColorsAndSizes:function(){sessionStorage.removeItem(this._getSessionStorageKey(this._KEY_SELECTED_COLORS)),sessionStorage.removeItem(this._getSessionStorageKey(this._KEY_SELECTED_SIZES))},_getDefaultSelectedColors:function(){var e=sessionStorage.getItem(this._getSessionStorageKey(this._KEY_SELECTED_COLORS)),t=e&&JSON.parse(e)||[],i=[];for(var r in this.allColors){var n=this.allColors[r];t.indexOf(n.color)>-1&&i.push(n)}var a=this._getDefaultPickerValue(PF.VariantPicker.PickersConfig.TYPE_COLOR);return a.length>0?a:i.length>0?i:this.allColors.slice(0,1)},_getDefaultSelectedSizes:function(){var e=sessionStorage.getItem(this._getSessionStorageKey(this._KEY_SELECTED_SIZES)),t=e&&JSON.parse(e)||[],i=[];for(var r in t)this.allSizes.indexOf(t[r])>-1&&i.push(t[r]);return i.length?i:this.allSizes},_getSessionStorageKey:function(e){return this._getStorageKeyPrefix()+this._product.productId+e},_getStorageKeyPrefix:function(){var e="";return this._par.isOrderFlowMode&&(e="orderFlow_"),e},getGeneratorParams:function(){if(!this._generatorParams)throw"Cannot access generator params";return this._generatorParams},getPlacementFilePosition:function(e,t){var i=new PF.Items.GeneratorPlacement;if(i.id=e,!this.hasLayersForPlacement(i.id))return null;var r=this._getTemplate(e);for(var n in r.layers){var a=r.layers[n];if(!(a.isTextLayer()||a instanceof PF.Components.GeneratorMockup.ClipartLayer||a.fileItem.fileId!==t))return a.position}return null},_getTemplate:function(e){var t=this.getGeneratorVariantByPlacementId(e);return t?this.getUserTemplateByGeneratorVariant(t):new PF.Items.GeneratorTemplateItem},setActivePlacement:function(e){this._placementSelector.setSelectedPlacementById(e,!0)},getMissingUploadPrintFiles:function(){var e=[];if(this._par.product.type!==PF.Items.ProductItem.TYPE_CUT_SEW)return e;for(var t in this._generatorParams.availablePlacements){var i=this._generatorParams.availablePlacements[t];-1!=PF.ProductPush.Templates.MISSING_PRINTFILES_WARNING.indexOf(i.id)&&(this.hasDesignForPlacement(i.id)||e.push(i.title))}return e},_initDropZone:function(e,t){var i=new PF.ProductPush.DropZoneArea.Par;i.targetNode=this.node,i.callback=this._onDropZoneFileUploaded.bind(this),i.onClick=this._onDropzoneClick.bind(this),i.storeId=e,this.storeId=e,i.product=this._par.product,i.isModalDesigner=this._par.isModalDesigner,i.activePlacement=this._placementSelector.getSelectedPlacement(),i.getMaxFileLayerCount=this._getMaxFileLayerCount.bind(this),i.validateAddingLayer=this.validateAddingLayer.bind(this),i.nodeDomElementDropArea=this._nodeMainMockupArea,i.onDropDomElement=this._onDropDomElement.bind(this),i.enableTransparencyValidation=!0,i.generatorVariant=this.previewMockupVariant,this._dropZoneArea?(this._dropZoneArea.setActivePlacement(i.activePlacement),this._dropZoneArea.setGeneratorVariant(i.generatorVariant,!0),this._dropZoneArea.append(this._nodeMainMockupArea),this._isCurrentPlacementConflicting()||this._dropZoneArea.enable(),t&&!this._isCurrentPlacementConflicting()?mkE.removeClassName(this._dropZoneArea.node,"pf-d-none"):mkE.addClassName(this._dropZoneArea.node,"pf-d-none")):(this._dropZoneArea=new PF.ProductPush.DropZoneArea(i),this._dropZoneArea.append(this._nodeMainMockupArea),this._clipartPicker._par.fileDropZone=this._dropZoneArea)},_onDropzoneClick:function(){this._getSelectedVariant()&&this._layerPicker.requestFilePicking(this._placementSelector.getSelectedPlacement())},_getMaxFileLayerCount:function(){return this._layerPicker?this._layerPicker.fileCountLimit:this._getFileCountLimit()},_onDropZoneFileUploaded:function(e){this._isCurrentPlacementConflicting()?this._hideLoader(this.node):this._onPlacementItemAdded(this._placementSelector.getSelectedPlacement(),e)},_isCurrentPlacementConflicting:function(){if(!this._generatorParams.conflictingTypes)return!1;for(var e in this._generatorParams.conflictingTypes){var t=this._generatorParams.conflictingTypes[e];if(this.hasLayersForPlacement(t.placementId))for(var i in t.conflictsWith)if(t.conflictsWith[i].id===this.getSelectedPlacementId())return!0}return!1},_getFileCountLimit:function(){return PF.Components.GeneratorMockup.Validator.getLayerLimit(this.getSelectedPlacementTechnique())||5},getTemplateTypeLoaded:function(){return this.hasDesignForPlacement(this.getSelectedPlacementId())?this._isAdvancedTemplateLoaded()?PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_ADVANCED:PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_SIMPLE:this._canGeneratePreview()?PF.Repositories.GeneratorRepository.GeneratorParameters.TEMPLATE_TYPE_SIMPLE:this._templateType||null},_onDropDomElement:function(e,t){var i=e.dataTransfer.getData("domelement");if(i){var r=JSON.parse(i),n=new PF.Items.GeneratorClipartItem.fromArray(r);this._onPlacementItemAdded(t,n)}},getSelectedPlacementId:function(){return this._placementSelector.getSelectedPlacementId()},getSelectedPlacementTechnique:function(){var e=this._placementSelector&&this._placementSelector.getSelectedPlacement();return e?e.technique:null},hasLayersForPlacement:function(e){return this._templates.hasLayersForPlacement(e)},hasDesignForPlacement:function(e){return this.hasLayersForPlacement(e)||this.hasDesignFillColor(e)},_getTemplateTabName:function(){return this._product.isApparelEmbroidery()||this._product.isEmbroideryApron()?PF.ProductPush.Designer.TAB_ZOOMED_IN_TITLE:this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY&&this._product.isDtgShirt()?PF.ProductPush.Designer.TAB_ZOOMED_IN_TITLE:PF.ProductPush.Designer.TAB_TEMPLATE_TITLE},addClickListenerToTemplateLayers:function(e){console.log("addClickListenerToTemplateLayers",this._templates.getTemplates())},setActiveLayerByCustomizeKey:function(e){var t=this._templates.getLayerByCustomizeKey(e),i=this._templates.getTemplateByLayer(t);this.getSelectedPlacementId()!==i.placementId&&this.setActivePlacement(i.placementId),this._templates.setActiveLayer(t,"productCustomizer",!0)},getLayerByCustomizeKey:function(e){return this._templates.getLayerByCustomizeKey(e)},updateTextLayerByCustomizeKey:function(e,t,i){var r=this._templates.getLayerByCustomizeKey(e);r.text=t,r.color=i,this._templates.updateTextLayer(r,"productCustomizer")},updateTextboxLayerByCustomizeKey:function(e,t,i,r,n){var a=this._templates.getLayerByCustomizeKey(e);a.text=t,a.color=i,r&&(a.strokeColor=r),n&&(a.shadowColor=n),this._templates.updateTextLayer(a,"productCustomizer")},updateFileLayerByCustomizeKey:function(e,t,i){this._templates.updateFileLayerByCustomizeKey(e,t,this._par.product,i)},_setHideEmptyPlacements:function(e){if(this._par.hideEmptyPlacements){var t={};e.forEach((function(e){t[e.placementId]=e.layers.length})),this._generatorParams.availablePlacements.forEach(function(e){t[e.id]>0||(e.hide=!0)}.bind(this))}},_shouldAllowCustomizablePush:function(e){return!0===this._par.isCustomizerEnabled&&!0===this._par.isCustomizerEnabledJS&&(e||!this._par.isChangePrintfileMode)&&(e||!this._par.existingVariants||0===this._par.existingVariants.length)},shouldAllowFileColorChanger:function(){return(this._product.isEmbroidery()||this._technique===PF.Items.ProductItem.TYPE_EMBROIDERY)&&PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()},shouldAllowTextboxLayer:function(){return PF.Utils.BetaAccess().hasTextboxLayer()},_shouldEnablePatternPicker:function(){return!this._product.isEmbroidery()&&!this._product.isSticker()&&!this._product.isJewelry()&&this._technique!==PF.Items.ProductItem.TECHNIQUE_EMBROIDERY&&this._technique!==PF.Items.ProductItem.TECHNIQUE_ENGRAVING&&this.isAllOverProduct(!0)&&PF.Utils.BetaAccess().hasPatternPicker()},_checkOutOfBoundsLayers:function(){this._mockup.getMockup()&&(this._mockup.getMockup().displayOutOfBoundsIndicator(),this._mockup.getMockup().displayCustomizableTextLayerError())},setSizeAndColor:function(e,t){this.lastSelectedSize=e,this.lastSelectedColor=t,this._selectedSizes=null===e?[]:[e];var i=!1;for(var r in this._generatorParams.colors){var n=this._generatorParams.colors[r];if(PF.Utils.String.isEqual(n.color,t)){this._selectedColors=[n],i=!0;break}}i||1!==this._generatorParams.colors.length||(console.log("Color",t,"was not found within generator colors. We picked the only available color instead."),this._selectedColors=this._generatorParams.colors.slice(0)),this.updateView(),this._par.onPositionsChanged&&this._par.onPositionsChanged()},_removeCustomizerDataFromAllLayers:function(){this._shouldAllowCustomizablePush(!0)||this._templates.removeCustomizerDataFromAllLayers()},_canRenderNativeInsideLabelSelection:function(){return this._isPlacementInsideLabel()&&this._product.isDtgShirt()&&this._product.hasAdvancedInsideLabel&&this._generatorParams.allLabelTypesAvailable},refreshClipartColors:function(){this._templates.refreshClipartColors(function(e){e instanceof PF.Components.GeneratorMockup.ClipartLayer&&this._onClipartColorChanged(e)}.bind(this))},_isPlacementInsideLabel:function(){return this.getSelectedPlacementId()===PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE},getDynamicStickyFooter:function(){return this._dynamicStickyFooter},_renderEmbroideryVideoTutorial:function(e){if(this._nodeEmbroideryVideoTutorial&&(mkE.removeNode(this._nodeEmbroideryVideoTutorial.node),this._nodeEmbroideryVideoTutorial=null),this._product&&this._product.isEmbroidery()){var t=this._pickerTabContents[e],i=t.hasChildNodes(),r=[PF.ProductPush.Designer.TAB_PRODUCT,PF.ProductPush.Designer.TAB_DESIGN].indexOf(e)>-1;i&&r&&(this._nodeEmbroideryVideoTutorial=new PF.TimedPopup.EmbroideryVideoTutorial(!1),this._nodeEmbroideryVideoTutorial.append(t))}},_renderDTGVideoTutorial:function(e){if(this._nodeDTGVideoTutorial&&(mkE.removeNode(this._nodeDTGVideoTutorial.node),this._nodeDTGVideoTutorial=null),!this._product||!this._product.isEmbroidery()){var t=this._pickerTabContents[e],i=t.hasChildNodes(),r=[PF.ProductPush.Designer.TAB_PRODUCT,PF.ProductPush.Designer.TAB_DESIGN].indexOf(e)>-1;i&&r&&(this._nodeDTGVideoTutorial=new PF.TimedPopup.DTGVideoTutorial(!1),this._nodeDTGVideoTutorial.append(t))}},_renderTextDigitizationPriceDecreaseNode:function(e){if(this._nodeTextDigitizationPriceDecrease&&(mkE.removeNode(this._nodeTextDigitizationPriceDecrease.node),this._nodeTextDigitizationPriceDecrease=null),this._product&&this._product.isEmbroidery()&&!this._product.hasEmbroideryHatSideAndBackPlacements()){var t=this._pickerTabContents[e],i=t.hasChildNodes(),r=[PF.ProductPush.Designer.TAB_PRODUCT,PF.ProductPush.Designer.TAB_DESIGN].indexOf(e)>-1;i&&r&&(this._nodeTextDigitizationPriceDecrease=new PF.TimedPopup.TextDigitizationPriceDecrease(!0,!0),this._nodeTextDigitizationPriceDecrease.append(t))}},_renderHatSideBackDigitizationPriceDecreaseNode:function(e){if(this._nodeHatSideBackDigitizationPriceDecrease&&(mkE.removeNode(this._nodeHatSideBackDigitizationPriceDecrease.node),this._nodeHatSideBackDigitizationPriceDecrease=null),this._product&&this._product.hasEmbroideryHatSideAndBackPlacements()){var t=this._pickerTabContents[e],i=[PF.ProductPush.Designer.TAB_PRODUCT,PF.ProductPush.Designer.TAB_DESIGN].indexOf(e)>-1;t.hasChildNodes()&&i&&(this._nodeHatSideBackDigitizationPriceDecrease=new PF.TimedPopup.HatSideBackDigitizationPriceDecrease(!0,!0),this._nodeHatSideBackDigitizationPriceDecrease.append(t))}},_getAvailablePlacementByPlacementId:function(e){var t=this.getAvailablePlacements().filter((function(t){return t.id===e})).pop();return t||null},getProduct:function(){return this._product},_getDesignMeta:function(){return this.designData.designMeta}},mkE.Base),PF.ProductPush.Designer.TAB_PRODUCT="product",PF.ProductPush.Designer.TAB_DESIGN="design",PF.ProductPush.Designer.TAB_TEXT="text",PF.ProductPush.Designer.TAB_TEXTBOX="textbox",PF.ProductPush.Designer.TAB_IMAGE="image",PF.ProductPush.Designer.TAB_CLIPART="clipart",PF.ProductPush.Designer.TAB_DESIGNER="designer",PF.ProductPush.Designer.TAB_PREVIEW="preview",PF.ProductPush.Designer.TAB_3D="3d",PF.ProductPush.Designer.TAB_TEMPLATE_TITLE=dlang("generator","File view"),PF.ProductPush.Designer.TAB_ZOOMED_IN_TITLE=dlang("generator","Zoomed-in view"),PF.ProductPush.Designer.TECHNIQUE_DEPENDENT_VALIDATION={},PF.ProductPush.Designer.TECHNIQUE_DEPENDENT_VALIDATION[PF.Items.ProductItem.TECHNIQUE_ENGRAVING]=[PF.VariantPicker.Footer.LAYERS_OVERLAPPING,PF.VariantPicker.Footer.LAYER_TEXT_TOO_SMALL,PF.VariantPicker.Footer.LAYER_CLIPART_TOO_SMALL]},uGFp:function(e,t){!function(){"use strict";PF.ProductPush.DesignData=function(){this.templateSelectedSizes=[]},PF.ProductPush.DesignData.prototype=new PF.Items.Item,PF.ProductPush.DesignData.prototype.toArrayKeys=["storeId","productId","productTemplateId","customProductId","productOptions","filesIdsByPlacement","colors","sizes","templateSelectedSizes","defaultGeneratorVariantId","templates","title","titleDe","description","descriptionDe","multiLanguageDetails","prices","quantities","isVisible","isTransparent","withSizeGuide","sizeGuideUnits","useSizeConversion","categoryIds","integrationMarketplaceCategoryIds","tags","genderCategory","generatorVariantsIdsToSave","multipleMockups","forceOrientation","forceTemplateType","generatorDesignId","arePrintfilesHidden","templateKeysToSave","orderId","shippingProfileId","selectedShippingCost","labelTemplateType","translationLanguage","rawPlacementOptions","taxRuleId","additionalGeneratorVariantIds","isFreeShippingEnabled","designMeta"],PF.ProductPush.DesignData.prototype.storeId=null,PF.ProductPush.DesignData.prototype.productId=null,PF.ProductPush.DesignData.prototype.productTemplateId=null,PF.ProductPush.DesignData.prototype.customProductId=null,PF.ProductPush.DesignData.prototype.productOptions=null,PF.ProductPush.DesignData.prototype.colors=null,PF.ProductPush.DesignData.prototype.sizes=null,PF.ProductPush.DesignData.prototype.templateSelectedSizes=null,PF.ProductPush.DesignData.prototype.defaultGeneratorVariantId=null,PF.ProductPush.DesignData.prototype.templates=null,PF.ProductPush.DesignData.prototype.title="",PF.ProductPush.DesignData.prototype.description="",PF.ProductPush.DesignData.prototype.multiLanguageDetails=null,PF.ProductPush.DesignData.prototype.prices=null,PF.ProductPush.DesignData.prototype.initPrices=null,PF.ProductPush.DesignData.prototype.quantities=null,PF.ProductPush.DesignData.prototype.filesIdsByPlacement=null,PF.ProductPush.DesignData.prototype.isVisible=null,PF.ProductPush.DesignData.prototype.withSizeGuide=!0,PF.ProductPush.DesignData.prototype.sizeGuideUnits=[],PF.ProductPush.DesignData.prototype.useSizeConversion=null,PF.ProductPush.DesignData.prototype.generatorVariants=null,PF.ProductPush.DesignData.prototype.isTransparent=null,PF.ProductPush.DesignData.prototype.categoryIds=null,PF.ProductPush.DesignData.prototype.taxRuleId=null,PF.ProductPush.DesignData.prototype.integrationMarketplaceCategoryIds=null,PF.ProductPush.DesignData.prototype.tags=null,PF.ProductPush.DesignData.prototype.genderCategory=null,PF.ProductPush.DesignData.prototype.generatorVariantsIdsToSave=null,PF.ProductPush.DesignData.prototype.templateKeysToSave=null,PF.ProductPush.DesignData.prototype.multipleMockups=!1,PF.ProductPush.DesignData.prototype.store=null,PF.ProductPush.DesignData.prototype.product=null,PF.ProductPush.DesignData.prototype.forceOrientation=null,PF.ProductPush.DesignData.prototype.forceTemplateType=null,PF.ProductPush.DesignData.prototype.generatorDesignId=null,PF.ProductPush.DesignData.prototype.orderId=null,PF.ProductPush.DesignData.prototype.arePrintfilesHidden=!1,PF.ProductPush.DesignData.prototype.shippingProfileId=null,PF.ProductPush.DesignData.prototype.selectedShippingCost=null,PF.ProductPush.DesignData.prototype.labelTemplateType=null,PF.ProductPush.DesignData.prototype.productTranslations=null,PF.ProductPush.DesignData.prototype.translationLanguage=null,PF.ProductPush.DesignData.prototype.rawPlacementOptions=null,PF.ProductPush.DesignData.prototype.additionalGeneratorVariantIds=null,PF.ProductPush.DesignData.prototype.designMeta=null,PF.ProductPush.DesignData.prototype.hexColors=null,PF.ProductPush.DesignData.prototype.technique=null,PF.ProductPush.DesignData.prototype.isFreeShippingEnabled=!1,PF.ProductPush.DesignData.prototype.shouldShowWixMockupWarning=!1,PF.ProductPush.DesignData.prototype.getGeneratorVariant=function(e){for(var t in this.generatorVariants)if(this.generatorVariants[t].generatorVariantId==e)return this.generatorVariants[t];PF.DEV&&console.log("Generator variant not found: "+e)},PF.ProductPush.DesignData.prototype.getTemplate=function(e,t){for(var i in this.templates)if(this.templates[i].templateId==t&&this.templates[i].placementId==e)return this.templates[i];PF.DEV&&console.log("Generator template not found: "+t)},PF.ProductPush.DesignData.prototype.getMockupPreview=function(e,t,i){if(e instanceof PF.Items.GeneratorVariantItem||e instanceof PF.Items.GeneratorTemplateItem){var r=e instanceof PF.Items.GeneratorVariantItem?e:this.getGeneratorVariant(this.defaultGeneratorVariantId)||this.generatorVariants[0],n=e instanceof PF.Items.GeneratorTemplateItem?e:this.getTemplate(e.placementId,e.templateId),a=new PF.Components.GeneratorMockup.Preview.Par;return a.designFillColor=PF.Items.PlacementOptions.fromArray(this.rawPlacementOptions).getPlacementFillColor(e.placementId),a.generatorVariant=r,a.maxWidth=t,a.maxHeight=i,a.template=n,a.isPrintfile=e instanceof PF.Items.GeneratorTemplateItem,new PF.Components.GeneratorMockup.Preview(a)}return tag("img",{className:"generator-picker__printfile",src:PF.ASSETS_URL+"images/layout/printfile.svg"})},PF.ProductPush.DesignData.prototype.isEmbroidery=function(){for(var e in this.generatorVariants)if(PF.Items.OrderLineItemFile.TYPE_EMBROIDERY_FILES.indexOf(this.generatorVariants[e].placementId)>-1)return!0;return!1},PF.ProductPush.DesignData.prototype.getPlacementIdsWithDesign=function(){var e=[];for(var t in this.templates){var i=this.templates[t];i.layers.length>0&&-1===e.indexOf(i.placementId)&&e.push(i.placementId)}return e=e.concat(this.getPlacementIdsWithDesignFillColorSet()).filter((function(e,t,i){return i.indexOf(e)===t}))},PF.ProductPush.DesignData.prototype.hasPlacementDesignFillColorSet=function(e){if(!this.rawPlacementOptions)return!1;var t=this.rawPlacementOptions.find((function(t){return t.placement===e}));return!(!t||!t.options.designFillColor)&&t.options.designFillColor},PF.ProductPush.DesignData.prototype.getPlacementIdsWithDesignFillColorSet=function(){if(!this.rawPlacementOptions)return[];var e=[];for(var t in this.rawPlacementOptions){var i=this.rawPlacementOptions[t].placement;this.hasPlacementDesignFillColorSet(i)&&-1===e.indexOf(i)&&e.push(i)}return e},PF.ProductPush.DesignData.prototype._hasPlacementDesignFillColorSet=function(e){if(!this.rawPlacementOptions)return!1;var t=this.rawPlacementOptions.find((function(t){return t.placement===e}));return!(!t||!t.options.designFillColor)&&t.options.designFillColor!==PF.Components.ColorDropdown.COLOR_VALUE_NONE},PF.ProductPush.DesignData.prototype.hasTextLayers=function(){for(var e in this.templates){if(this.templates[e].layers.filter((function(e){return e.isTextLayer()})).length>0)return!0}return!1},PF.ProductPush.DesignData.prototype.hasCustomizableLayers=function(){return this.getCustomizablePlacementsCount()>0},PF.ProductPush.DesignData.prototype.getNonCustomizablePlacementsCount=function(){return Object.keys(this.templates).length-this.getCustomizablePlacementsCount()},PF.ProductPush.DesignData.prototype.getCustomizablePlacementsCount=function(){var e=0;for(var t in this.templates){var i=this.templates[t];PF.Items.GeneratorTemplateItem.getCustomizableLayersCount(i)>0&&e++}return e},PF.ProductPush.DesignData.prototype.hasClipartLayers=function(){for(var e in this.templates){if(this.templates[e].layers.filter((function(e){return e instanceof PF.Components.GeneratorMockup.ClipartLayer})).length>0)return!0}return!1},PF.ProductPush.DesignData.prototype.isCustomProduct=function(){return this.productId===PF.Items.ProductItem.ID_CUSTOM_PRODUCT},PF.ProductPush.DesignData.prototype.setPrices=function(e){e&&e.length||(this.prices=this.initPrices=null),this.prices&&this.prices.length||(this.initPrices=e.map((function(e){return PF.Items.GeneratorPriceItem.fromArray(e)}))),this.prices=e},PF.ProductPush.DesignData.prototype.optionGroup=null,PF.ProductPush.DesignData.prototype.isFlatEmbroidery=function(){return!(!this.productOptions||this.productOptions.embroidery_type!==PF.Items.OrderLineItemFile.DIGITIZATION_FLAT)},PF.ProductPush.DesignData.prototype.is3DEmbroidery=function(){return!(!this.productOptions||this.productOptions.embroidery_type!==PF.Items.OrderLineItemFile.DIGITIZATION_3D)},PF.ProductPush.DesignData.prototype.isPartial3DEmbroidery=function(){return!(!this.productOptions||this.productOptions.embroidery_type!==PF.Items.OrderLineItemFile.DIGITIZATION_BOTH)},PF.ProductPush.DesignData.prototype.hasLabelNative=function(){return!(!this.labelTemplateType||this.labelTemplateType!==PF.Components.InsideLabelTemplate.LABEL_NATIVE)},PF.ProductPush.DesignData.prototype.canHaveColorPicker=function(){return!this.product||this.product.canHaveColorPicker()},PF.ProductPush.DesignData.META_COPY_DESIGN="copy_design"}()},ukqv:function(e,t){!function(){"use strict";PF.ProductPush.StockManagement.Table=Class({_rows:[],__construct:function(e){if(this._prices=e.prices,this._store=e.store,this._quantities=e.quantities,this._oldQuantities=e.oldQuantities,this._currency=this._store.currency,this._onUpdateCallback=e.onUpdate,this._isCustomProduct=e.isCustomProduct,this._isUpdateFlow=e.isUpdateFlow,!this._store.canManageStock())throw new Error(dlang("dashboard","Store doesn't support stock management."));this.node=tag("div","stock-management-table",[]),this._render()},_render:function(){mkE.clearNode(this.node);var e=tag("table","table stock-list",[this._createTableHeader(),this._tableBodyNode=this._createTableBody()]);this._setTableRows(),tag("div","table-responsive",[e]).append(this.node)},_createTableBody:function(){return tag("tbody",null,null)},_createTableHeader:function(){var e=this._isCustomProduct,t=this._isUpdateFlow,i=e?dclang("dashboard","Custom product name","Name"):dlang("dashboard","Variant"),r=[tag("th",null,i),tag("th","text-center",dlang("dashboard","Retail price"))];return t?(r.push(tag("th","text-center",dclang("dashboard","Variant qty","Current Quantity"))),r.push(tag("th","text-center",dclang("dashboard","Variant qty","Additional Quantity")))):r.push(tag("th","text-center",dclang("dashboard","Variant qty","Quantity"))),tag("thead",null,[tag("tr",null,r)])},_setTableRows:function(){mkE.clearNode(this._tableBodyNode),this._rows=[],this._prices.forEach(function(e){var t=new PF.ProductPush.StockManagement.Row({price:e,currency:this._currency,onchange:this._onRowChange.bind(this),quantity:this._getQuantityFromPreloadedData(e.priceKey),oldQuantity:this._getOldQuantity(e.priceKey),isUpdateFlow:this._isUpdateFlow});this._rows.push(t),t.append(this._tableBodyNode)}.bind(this))},getError:function(){var e=this.getFirstRowError();return e?dclang("dashboard","Variant qties","One or more of your set quantities are invalid.")+" "+e:null},_onRowChange:function(){clearTimeout(this._onChangeEventTimeoutId),this._onChangeEventTimeoutId=setTimeout(function(){this._onUpdateCallback()}.bind(this),50)},isValid:function(){return!(!this._rows||!this._rows.length)&&!this._rows.some((function(e){return!e.isValid()}))},getFirstRowError:function(){if(!this._rows||!this._rows.length)return null;if(this.isValid())return null;var e=this._rows.find((function(e){return!!e.getError()}));return e?e.getError():null},_getQuantityFromPreloadedData:function(e){return this._quantities?this._quantities.find((function(t){return t.variantIdentifier===e})):null},_getOldQuantity:function(e){return this._oldQuantities?this._oldQuantities.find((function(t){return t.variantIdentifier===e})):null},getQuantities:function(){if(!this._rows||!this._rows.length)return null;var e=[];return this._rows.forEach((function(t){var i=new PF.Items.GeneratorQuantityItem;i.variantIdentifier=t.getKey(),i.quantity=t.getValue(),e.push(i)})),e}},mkE.Base)}()},"v88+":function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryTypePicker=Class({_current:"",_available:[],__construct:function(e){this._par=e,this._available=this._par.embroideryTypesAvailable.slice(),this._current=this._par.embroideryType,this.node=tag("div","",[tag("h6","",[dlang("generator","Embroidery type"),this._getTooltipNode()]),this._buttons=tag("div")]),this._par.nodeFooter&&tag("div","pf-mt-8",[this._par.nodeFooter]).append(this.node),this._render()},_render:function(){if(mkE.clearNode(this._buttons),this._par.renderRadioInput&&this._current!==PF.Items.OrderLineItemFile.DIGITIZATION_BOTH)for(var e in this._available){var t=this._available[e],i=this.getEmbroideryTypeMap(this._par.embroideryTypePrices,this._par.showExtraPrice)[t];tag("label",{text:i,className:"regular pf-d-block"},[tag("input",{type:"radio",className:"margin-right-10",value:e,checked:t==this._current,onclick:this._onEmbroideryTypePicked.bind(this,t)})]).append(this._buttons)}else tag("div","",this.getEmbroideryTypeMap(this._par.embroideryTypePrices,this._par.showExtraPrice)[this._current]).append(this._buttons)},_onEmbroideryTypePicked:function(e){this._current=e,this._render(),this._par.onEmbroideryTypeChangedCallback&&this._par.onEmbroideryTypeChangedCallback(e)},isValuePicked:function(){return!!this._current},getValueCount:function(){return this._available.length},_getTooltipNode:function(){if(!this._par.labelTooltipText)return tag();var e=tag("span",{className:"icon-info pf-text-gray option-label-sign",attr:{title:this._par.labelTooltipText}});return $(e).tooltip({html:!0,delay:{hide:450},container:"body"}),e},getValue:function(){return this._current},setValue:function(e){this._current=e||"",this._render()},getEmbroideryTypeMap:function(e){var t={};if(e){var i=e&&e.prices?e.prices:{},r=e&&e.currency?e.currency:"";t[PF.Items.OrderLineItemFile.DIGITIZATION_FLAT]=dlang("generator","Flat Embroidery"),t[PF.Items.OrderLineItemFile.DIGITIZATION_3D]=dlang("generator","3D Puff {price}").replace("{price}",this._par.showExtraPrice?"(+"+prettyMoney(i[PF.Items.OrderLineItemFile.DIGITIZATION_3D],r)+")":""),t[PF.Items.OrderLineItemFile.DIGITIZATION_BOTH]=dlang("generator","Partial 3D Puff {price}").replace("{price}",this._par.showExtraPrice?"(+"+prettyMoney(i[PF.Items.OrderLineItemFile.DIGITIZATION_BOTH],r)+")":"")}else t[PF.Items.OrderLineItemFile.DIGITIZATION_FLAT]=dlang("generator","Flat Embroidery"),t[PF.Items.OrderLineItemFile.DIGITIZATION_3D]=dlang("generator","3D Puff {price}").replace("{price}",""),t[PF.Items.OrderLineItemFile.DIGITIZATION_BOTH]=dlang("generator","Partial 3D Puff {price}").replace("{price}","");return t}},PF.VariantPicker.BasePicker),PF.ProductPush.EmbroideryTypePicker.getDefaultEmbroideryType=function(){return PF.Items.OrderLineItemFile.DIGITIZATION_FLAT}}()},vfGd:function(e,t){!function(){"use strict";PF.ProductPush.SyncedProductPicker.Par=Class({sourceStoreId:null,targetStoreId:null,type:PF.ProductPush.SyncedProductCounts.TYPE_ALL,searchKeyword:"",onProductCountUpdatedCallback:null,addedFailedProductIds:null})}()},wQfs:function(e,t){!function(){"use strict";PF.ProductPush.LayerPicker.Chooser=Class({__NAME:"PF.ProductPush.LayerPicker.Chooser",_types:null,_nodeTitle:null,_nodeTypes:null,_nodeWarning:null,_isMinified:null,_isTitleHidden:null,__construct:function(e){this._types=e,this.node=tag("div","",[this._nodeTitle=tag("h6","pf-h6 pf-my-12",dlang("generator","Next steps:")),this._nodeTypes=tag("div"),this._nodeWarning=tag("div")]),this._render()},_render:function(){this._isTitleHidden?mkE.addClassName(this._nodeTitle,"pf-d-none"):mkE.removeClassName(this._nodeTitle,"pf-d-none"),mkE.clearNode(this._nodeTypes),tag("div","row row-flex row-flex--center no-gutters",this._types.map(function(e){return this._getTypeNode(e)}.bind(this))).append(this._nodeTypes),setTimeout(function(){$(this.node).find('[data-toggle="tooltip"]').tooltip()}.bind(this),100)},_getTypeNode:function(e){return tag("div","col-4 pf-px-8",[tag("div",{className:"layer-picker__type "+(e.disabled?"disabled":"")+" pf-p-8 text-center pf-border",onclick:e.disabled?null:e.onclick,attr:{"data-title":e.disabled?e.tooltip:"","data-toggle":e.disabled?"tooltip":"","data-placement":"top","data-html":!0}},[tag("i","pf-i pf-i-"+e.icon+" pf-i-24 pf-text-gray"),tag("h6","pf-h6 pf-my-4",e.title),tag("p","pf-m-0 pf-text-muted pf-ui-caption "+(this._isMinified?"pf-d-none":""),e.description)])])},setMinified:function(e){this._isMinified=e,this._render()},setTitleHidden:function(e){this._isTitleHidden=e,this._render()},showWarning:function(e){mkE.clearNode(this._nodeWarning),tag("div",{className:"alert alert-warning",innerHTML:e}).append(this._nodeWarning)},setTypeEnabled:function(e,t,i){for(var r=0,n=this._types.length;r<n;r++){var a=this._types[r];if(e===a.id){if(a.disabled&&t&&a.tooltip!==i)break;a.disabled=!t,a.tooltip=i,this._render();break}}}},mkE.Base)}()},wllI:function(e,t){!function(){"use strict";PF.ProductPush.EmbroideryTypePicker.Par=Class({embroideryTypesAvailable:null,embroideryType:null,onEmbroideryTypeChangedCallback:null,labelTooltipText:"",renderRadioInput:null,embroideryTypePrices:null,showExtraPrice:null,nodeFooter:null})}()},wy2R:function(e,t){e.exports=moment},x0He:function(e,t,i){"use strict";i.d(t,"a",(function(){return C})),i.d(t,"b",(function(){return R}));var r=i("oCYn"),n=i("LvDl"),a=i.n(n),o=i("SBaP"),s=i("bA+e");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,i){return t&&p(e.prototype,t),i&&p(e,i),e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value}function f(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return i}function y(e,t,i){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,i);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=i}return i}function v(e,t,i,r){if(e!==t)throw new TypeError("Private static access of wrong provenance");if(i.set)i.set.call(e,r);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=r}return r}function b(e,t,i){if(e!==t)throw new TypeError("Private static access of wrong provenance");return i.get?i.get.call(e):i.value}var C=function(e){function t(e){var i;return c(this,t),i=function(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?h(e):t}(this,u(t).call(this)),D.add(h(i)),L.add(h(i)),F.add(h(i)),T.set(h(i),{writable:!0,value:void 0}),I.set(h(i),{writable:!0,value:void 0}),k.set(h(i),{writable:!0,value:void 0}),E.set(h(i),{writable:!0,value:void 0}),S.set(h(i),{writable:!0,value:void 0}),y(h(i),I,e||{}),f(h(i),F,x).call(h(i)),y(h(i),E,t.getNewUniqueID()),i.node=tag("div",{className:"mke-vue-wrapper",id:i._identifier}),function(e,t,i){if(e!==t)throw new TypeError("Private static access of wrong provenance");return i}(t,t,w).call(t),y(h(i),k,f(h(i),L,N).call(h(i))),f(h(i),D,M).call(h(i)),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),g(t,null,[{key:"getNewUniqueID",value:function(){var e;return"MkeVueWrapper"+(v(t,t,O,1+(e=+b(t,t,O))),e)}}]),g(t,[{key:"updateData",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=P(this,k);if(!r)throw new Error("Attempting to call updateData on a destroyed instance! ".concat(P(this,E)));a.a.forIn(P(this,S),(function(n,a){!e.hasOwnProperty(a)&&i&&r.$delete(P(t,S),a),e.hasOwnProperty(a)&&r.$set(P(t,S),a,e[a])}))}},{key:"setDataProp",value:function(e,t){var i=P(this,k);if(!i)throw new Error("Attempting to call setDataProp on a destroyed instance! ".concat(P(this,E)));i.$set(P(this,S),e,t)}},{key:"destroy",value:function(){var e=P(this,k);e&&(e.$destroy(),y(this,k,null),delete t.activeComponentMap[P(this,E)],mkE.clearNode(this.node))}}]),t}(o.a),T=new WeakMap,I=new WeakMap,k=new WeakMap,E=new WeakMap,S=new WeakMap,F=new WeakSet,L=new WeakSet,D=new WeakSet,w=function(){b(C,C,A)||(Object(s.b)(r.a,s.a.DYNAMIC_INSTANCE),v(C,C,A,!0))},A={writable:!0,value:void 0},O={writable:!0,value:0};_(C,"activeComponentMap",{});var x=function(){a.a.forIn(P(this,I).components||{},(function(e){if(!(e instanceof Function))throw new Error("MkeVueWrapper components must be defined like so: {'component': () => import('./xyz')}")})),a.a.forIn(P(this,I).plugins||{},(function(e,t){if(!e)throw new Error("MkeVueWrapper plugin '".concat(t,"' is null/undefined!"))}))},N=function(){var e=this;y(this,S,P(this,I).initialData?a.a.clone(P(this,I).initialData):{});var t=P(this,I).emitEvent,i=new r.a(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(i,!0).forEach((function(t){_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({template:P(this,I).template||"<div>Empty MkeVueWrapper instance! Please contact support!</div>",components:a.a.clone(P(this,I).components||{}),data:function(){return P(e,S)},methods:{emitEvent:function(e,i){t&&t(e,i)}},created:function(){P(e,I).onCreated&&P(e,I).onCreated()},mounted:function(){P(e,I).onMounted&&P(e,I).onMounted()}},P(this,I).plugins));return C.activeComponentMap[P(this,E)]=i,i},M=function(){mkE.clearNode(this.node);var e=tag("div","mke-vue-wrapper__inner");e.append(this.node),P(this,k).$mount(e)},R=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this.components=t.components||{},this.plugins=t.plugins||{},this.template=t.template||"",this.initialData=t.initialData||{},this.emitEvent=t.emitEvent,this.onCreated=t.onCreated,this.onMounted=t.onMounted}},yGJc:function(e,t){!function(){"use strict";PF.ProductPush.Pricing=function(e,t,i,r){this.onPricesSetCallback=t,this.designData=e,this.addingVariantsToExistingProduct=i,this.isTableValid=!0,this._par=r,this.node=mkE({tag:"div",className:"product-push-pricing"}),this.wrapper=tag("div","",[this.node]),this.loadedFlags={},this.render()},PF.ProductPush.Pricing.prototype=new mkE.Base,PF.ProductPush.Pricing.prototype.toggleContinueState=function(e){e?mkE.removeClassName(this.nodeSubmitToStore,"disabled"):mkE.addClassName(this.nodeSubmitToStore,"disabled")},PF.ProductPush.Pricing.prototype.render=function(){mkE.clearNode(this.node);var e=this.designData.store;if(e.canSetVisibility()&&!this.addingVariantsToExistingProduct&&this.getNodeVisibilitySelector().append(this.node),e.canGetPushCategories()&&!this.addingVariantsToExistingProduct){this.loadedFlags.PushCategories=!1;var t=lang("Product {category}").replace("{category}",this.getCategoryName(!0));t=t.charAt(0).toUpperCase()+t.slice(1),mkE({tag:"div",className:"pf-mb-16",els:[{tag:"label",text:t},{tag:"span",className:"product-push-pricing__select-note",text:e.canPushMultipleCategories()?dclang("dashboard","Pick a category","Pick one or more"):dclang("dashboard","Pick a category","Pick one")},this.nodeCategoryPicker=mkE({tag:"div"})]}).append(this.node),this.loadCategoryList()}e.hasCustomTaxRules()&&!this.addingVariantsToExistingProduct&&(this.taxRulePicker=new PF.ProductPush.TaxRulePicker(this.designData.storeId),this.taxRulePicker.append(this.node)),this._shouldLoadShippingCost()&&(this.loadedFlags.SelectedShippingCost=!1,tag("div","pf-mb-16",[tag("label",null,dlang("dashboard","Shipping cost")),tag("span","product-push-pricing__select-note",this.designData.store instanceof PF.Items.StoreItems.EbayStoreItem?dlang("dashboard","Shipping cost for all variants."):dlang("dashboard","Shipping cost for all variants. You can change it later on.")),this.nodeShippingCost=tag("div")]).append(this.node),this.loadSelectedShippingCost()),this.designData.store.shouldAllowFreeShippingPush()&&tag("div","pf-mb-16",[tag("label",null,dlang("dashboard","Display with free shipping on your storefront")),tag("div","pf-ui-caption pf-mb-16",[tag("div",{innerHTML:this.designData.store.isShopify()?dlang("dashboard",'Check the box below and we\'ll hide your product\'s shipping cost on your storefront so you can offer free shipping. Since <b>you\'ll have to cover the <a href="https://www.printful.com/shipping" target="_blank">shipping costs</a></b>, add them to your product retail price now!'):dlang("dashboard","Check the box below and we'll hide your product's shipping cost on your storefront so you can offer free shipping. Since <b>you'll have to cover the shipping costs</b>, add them to your product retail price now! Use our rates above for your customer's location or calculate the average to cover worldwide shipments.")})]),tag("label","inline-radio",[tag("input",{type:"checkbox",prop:{checked:!!this.designData.isFreeShippingEnabled},onclick:function(){this.designData.isFreeShippingEnabled=!this.designData.isFreeShippingEnabled}.bind(this)}),tag("span",{className:"pf-pl-8",innerHTML:dlang("dashboard","Display my product with free shipping")})])]).append(this.node),this._canPushShippingProfile()&&(this.loadedFlags.ShippingProfile=!1,tag("div","pf-mb-16",[tag("label",null,[dlang("dashboard","Shipping profile")]),tag("span","product-push-pricing__select-note",[dlang("dashboard","Pick one of the following shipping profiles/policies for your product")]),this.nodeShippingProfilePicker=tag("div")]).append(this.node),this.loadShippingProfileList()),this.nodeErrors=tag("div","pf-text-red pf-bold");var i=this.designData.store.canManageStock()?dclang("dashboard","Product push - edit stock quantities","Edit quantities"):this.designData.store.isNative()?dlang("dashboard","Save product"):dlang("dashboard","Submit to store");this._nodeFooter=tag("div","footer-block navigation__sticky-buttons navigation__sticky-buttons--popup",[tag("div","container-fluid",[tag("a",{className:"pf-btn pf-btn-secondary pf-mr-12",onclick:this._par.onBack},[dlang("products","Back")]),this.nodeSubmitToStore=tag("a",{className:"pf-btn pf-btn-primary disabled",onclick:this.onSubmitClick.bind(this)},[i]),this.nodeErrors])]),this.collectAndValidate()},PF.ProductPush.Pricing.prototype.append=function(e){return this.wrapper.append(e),PF.Utils.textareaAutoHeight(this.inputDescription),this},PF.ProductPush.Pricing.prototype.isCategoryRequired=function(){var e=this.designData.store.getFlagData(PF.Items.StoreItem.Flags.CAN_CHOOSE_PUSH_CATEGORIES);return e&&e.isCategoryRequired},PF.ProductPush.Pricing.prototype.gatherData=function(){this.designData.isVisible=!0,void 0!==this.inputIsVisible&&(this.designData.isVisible=this.inputIsVisible.checked),this.designData.categoryIds=$(this.inputCategories).val(),this.designData.shippingProfileId=$(this.inputShippingProfiles).val(),this.designData.store.hasCustomTaxRules()&&!this.addingVariantsToExistingProduct&&this.taxRulePicker&&(this.designData.taxRuleId=this.taxRulePicker.getValue())},PF.ProductPush.Pricing.prototype.validate=function(e){var t=new PF.ProductPush.Pricing.Validator(this.designData,this.loadedFlags).getErrors();return t.length>0?(void 0!==e&&(e.errors=t),!1):(!this.loadedFlags.hasOwnProperty("ShippingProfile")||!0===this.loadedFlags.ShippingProfile)&&(!(this.loadedFlags.hasOwnProperty("PushCategories")&&this.isCategoryRequired()&&!this.designData.categoryIds)&&((!this.loadedFlags.hasOwnProperty("SelectedShippingCost")||!0===this.loadedFlags.SelectedShippingCost)&&!!this.isTableValid))},PF.ProductPush.Pricing.prototype._updateContinueButtonState=function(e){if(!this.nodeSubmitToStore)return!1;(void 0!==e?e:this.validate())?mkE.removeClassName(this.nodeSubmitToStore,"disabled"):mkE.addClassName(this.nodeSubmitToStore,"disabled")},PF.ProductPush.Pricing.prototype.collectAndValidate=function(){this.gatherData();var e={},t=this.validate(e),i=e.errors&&e.errors.length>0?e.errors:[];return this.renderErrors(i),this._updateContinueButtonState(t),this._par.hasOwnProperty("onValidate")&&this._par.onValidate(),t},PF.ProductPush.Pricing.prototype._showWixMockupWarning=function(){var e=new PF.Modal.Par;e.modalDialogClass="modal-md",e.title=lang("Are you sure?"),this.wixConfirmationModal=new PF.Modal(e);var t=tag("div",null,[tag("p",null,[lang("Resulting action will update mockups for existing variants with same colors in you Wix store")])]);this.wixConfirmationModal.setContent(t);var i=tag("div",{clasname:"row text-left"},[this.actions=tag("div","pf-ml-4",[tag("a",{className:"pf-btn pf-btn-secondary pf-mr-12",text:lang("Cancel"),onclick:this._onWixConfirmationCancel.bind(this)}),tag("a",{className:"pf-btn pf-btn-primary",text:lang("Continue"),onclick:this._onWixConfirmationConfirm.bind(this)})]),tag("div","clearfix")]);this.wixConfirmationModal.setFooterContent(i),this.wixConfirmationModal.show()},PF.ProductPush.Pricing.prototype._onWixConfirmationConfirm=function(){this._submit(),this.wixConfirmationModal.hide()},PF.ProductPush.Pricing.prototype._onWixConfirmationCancel=function(){this.wixConfirmationModal.hide()},PF.ProductPush.Pricing.prototype.onSubmitClick=function(){return!!this.collectAndValidate()&&(this.designData.shouldShowWixMockupWarning?(this._showWixMockupWarning(),!1):void this._submit())},PF.ProductPush.Pricing.prototype._submit=function(){mkE.addClassName(this.nodeSubmitToStore,"disabled"),PF.ProductPush.MockupPicker.Tags.allowTagPush(this.designData.store.type)&&PF.ProductPush.MockupPicker.Tags.setRecentTags(this.designData.tags),PF.LoadingOverlay.show(this.node),this.onPricesSetCallback(this.designData)},PF.ProductPush.Pricing.prototype.renderErrors=function(e){if(this.nodeErrors&&(this.nodeErrors.innerHTML="",!(e.length<1)))for(var t in e)mkE({tag:"div",text:e[t]}).append(this.nodeErrors)},PF.ProductPush.Pricing.prototype.getNodeVisibilitySelector=function(){return mkE({tag:"div",className:"margin-bottom-20",els:[{tag:"label",text:lang("Product visibility")},{tag:"label",className:"inline-radio",els:[this.inputIsVisible=mkE({tag:"input",type:"checkbox",prop:{checked:this.designData.isVisible,onchange:$.proxy(this.gatherData,this)}})," "+lang("Publish product (this product will be visible in your online store)")]}]})},PF.ProductPush.Pricing.prototype.loadCategoryList=function(){mkE.clearNode(this.nodeCategoryPicker),mkE({tag:"div",text:lang("Fetching {category} list").replace("{category}",this.getCategoryName(!1))}).append(this.nodeCategoryPicker);var e={};e=this.designData.store.canPushMultipleCategories()?{"data-placeholder":lang("Choose {category}").replace("{category}",this.getCategoryName(!0)),multiple:"multiple"}:{"data-placeholder":lang("Choose {category}").replace("{category}",this.getCategoryName(!1))},this.inputCategories=mkE({tag:"select",className:"product-push-pricing__collection-select",attr:e,prop:{onchange:$.proxy((function(){ga("send",{hitType:"event",eventCategory:"ProductPush",eventAction:"Category changed"}),this.collectAndValidate()}),this)}}),(new PF.Repositories.StoreRepository).getProductPushCategories(this.designData.storeId,$.proxy(this.categoriesLoaded,this),$.proxy(this.categoriesFailedToLoad,this))},PF.ProductPush.Pricing.prototype.loadSelectedShippingCost=function(){mkE.clearNode(this.nodeShippingCost),tag("div","product-push-pricing__select-note",[dlang("dashboard","Loading")]).append(this.nodeShippingCost),(new PF.Repositories.StoreRepository).getSelectedShippingCost(this.designData,this.shippingCostLoaded.bind(this),this.shippingCostFailedToLoad.bind(this))},PF.ProductPush.Pricing.prototype.loadShippingProfileList=function(){tag("div",null,[lang("Fetching list")]).append(this.nodeShippingProfilePicker),this.inputShippingProfiles=tag("select",{className:"product-push-pricing__collection-select",attr:{"data-placeholder":lang("Choose a shipping profile")},prop:{onchange:function(){this.collectAndValidate()}.bind(this)}}),(new PF.Repositories.StoreRepository).getStoreShippingProfiles(this.designData,this.shippingProfilesLoaded.bind(this),this.shippingProfilesFailedToLoad.bind(this))},PF.ProductPush.Pricing.prototype.shippingCostLoaded=function(e){mkE.clearNode(this.nodeShippingCost),this.designData.selectedShippingCost=e,this.designData.store instanceof PF.Items.StoreItems.EbayStoreItem&&(e.AUCost=null);var t="col-md-4";e.EUCost&&e.AUCost?t="col-md-2":(e.EUCost||e.AUCost)&&(t="col-md-3");var i=!0,r=!0;this.designData.store.type===PF.Items.StoreItem.TYPE_BONANZA&&(i=!1,r=!1),tag("div","shipping-cost pf-mt-0 pf-mt-md-8",[tag("div","row",[tag("div",t+" cost-item pf-mt-8 pf-mt-md-0 pf-ui-body",[tag("span","flag us-cost",""),tag("span","location-prefix pf-ml-8 pf-mr-4",dclang("dashboard","United States: (short)","US:")),tag("span","cost-info",e.USCost.getReadable(i))]),tag("div",t+" cost-item pf-mt-8 pf-mt-md-0 pf-ui-body",[tag("span","flag ca-cost",""),tag("span","location-prefix  pf-ml-8 pf-mr-4",dclang("dashboard","Canada: (short)","CA:")),tag("span","cost-info",e.CACost.getReadable(i))]),e.EUCost?tag("div",t+" cost-item pf-mt-8 pf-mt-md-0 pf-ui-body",[tag("span","flag eu-cost",""),tag("span","location-prefix  pf-ml-8 pf-mr-4",dclang("dashboard","Europe: (short)","EU:")),tag("span","cost-info",e.EUCost.getReadable(i))]):"",e.AUCost?tag("div","col-md-3 cost-item pf-mt-8 pf-mt-md-0 pf-ui-body",[tag("span","flag au-cost",""),tag("span","location-prefix  pf-ml-8 pf-mr-4",dclang("dashboard","Australia: (short)","AU")),r&&tag("span","",[tag("span","location-prefix","/"),tag("span","flag nz-cost pf-px-4 pf-ml-8",""),tag("span","location-prefix  pf-ml-8 pf-mr-4",dclang("dashboard","New Zealand: (short)","NZ")),tag("span","location-prefix",":")]),tag("span","cost-info",e.AUCost.getReadable(i))]):"",tag("div",t+" cost-item pf-mt-8 pf-mt-md-0 pf-ui-body",[tag("span","flag worldwide",""),tag("span","location-prefix  pf-ml-8 pf-mr-4",dclang("dashboard","Worldwide shipping: (short)","Worldwide:")),tag("span","cost-info",e.WWCost.getReadable(i))])])]).append(this.nodeShippingCost),this.loadedFlags.SelectedShippingCost=!0,this._updateContinueButtonState()},PF.ProductPush.Pricing.prototype.shippingCostFailedToLoad=function(){mkE.clearNode(this.nodeShippingCost),tag("p",null,[tag("b",{text:lang("We could not retrieve the shipping cost for this product."),style:{color:"#f0473d"}})]).append(this.nodeShippingCost)},PF.ProductPush.Pricing.prototype.shippingProfilesLoaded=function(e){var t=e.shippingProfiles;for(var i in mkE.clearNode(this.nodeShippingProfilePicker),mkE.clearNode(this.inputShippingProfiles),t){var r=t[i];tag("option",{text:r.title,value:r.id}).append(this.inputShippingProfiles)}tag("div","margin-bottom-20 row",[tag("div","col-lg-8",[this.inputShippingProfiles])]).append(this.nodeShippingProfilePicker),$(this.inputShippingProfiles).chosen({width:"100%"}),this.loadedFlags.ShippingProfile=!0,this._updateContinueButtonState()},PF.ProductPush.Pricing.prototype.shippingProfilesFailedToLoad=function(){mkE.clearNode(this.nodeCategoryPicker),tag("p",null,[tag("b",{text:lang("We could not retrieve the shipping profile list from your store."),style:{color:"#f0473d"}})]).append(this.nodeShippingProfilePicker)},PF.ProductPush.Pricing.prototype.categoriesLoaded=function(e){if(mkE.clearNode(this.nodeCategoryPicker),mkE.clearNode(this.inputCategories),this.loadedFlags.PushCategories=!0,0===e.length)return this.nodeCategoryPicker.textContent=lang("We failed to load your {categories}. Please check your store to make sure theyre added correctly").replace("{categories}",this.getCategoryName(!0)),void this._updateContinueButtonState();for(var t in mkE({tag:"option",text:""}).append(this.inputCategories),e){var i=e[t],r={};this.designData.categoryIds&&this.designData.categoryIds.indexOf(String(i.categoryId))>-1?r.selected="selected":!this.designData.categoryIds&&this.isCategoryRequired()&&"0"===t&&(r.selected="selected"),mkE({tag:"option",text:i.title,value:i.categoryId,prop:r}).append(this.inputCategories)}mkE({tag:"div",className:"margin-bottom-20 row",els:[{tag:"div",className:"col-lg-8",els:[this.inputCategories]}]}).append(this.nodeCategoryPicker),$(this.inputCategories).chosen({width:"100%"}).change(function(){this.collectAndValidate()}.bind(this)),this.collectAndValidate()},PF.ProductPush.Pricing.prototype.categoriesFailedToLoad=function(){mkE.clearNode(this.nodeCategoryPicker),mkE({tag:"p",els:[{tag:"b",text:lang("We could not retrieve the {category} list from your store.").replace("{category}",this.getCategoryName(!1)),style:{color:"#f0473d"}},{tag:"br"},tag("span",null,lang("You can add these products to {categories} manually in your store later or {@@}try again{@@}.").replace("{categories}",this.getCategoryName(!0)).split("{@@}").map(function(e,t){return 1!==t?e:tag("a",{onclick:this.loadCategoryList.bind(this)},e)}.bind(this)))]}).append(this.nodeCategoryPicker),this.loadedFlags.PushCategories=!0,this._updateContinueButtonState()},PF.ProductPush.Pricing.prototype.getCategoryName=function(e){var t=nlang("category","categories",e?2:1);return-1!==[PF.Items.StoreItem.TYPE_SHOPIFY,PF.Items.StoreItem.TYPE_STORENVY].indexOf(this.designData.store.type)&&(t=nlang("collection","collections",e?2:1)),this.designData.store.type==PF.Items.StoreItem.TYPE_ETSY&&(t=nlang("section","sections",e?2:1)),t},PF.ProductPush.Pricing.prototype._canPushShippingProfile=function(){return PF.Items.StoreItem.TYPE_ETSY==this.designData.store.type?null!==this.designData.customProductId:this.designData.store.canChooseShippingProfile()},PF.ProductPush.Pricing.prototype._shouldLoadShippingCost=function(){return null===this.designData.customProductId&&-1!==[PF.Items.StoreItem.TYPE_EBAY,PF.Items.StoreItem.TYPE_BONANZA,PF.Items.StoreItem.TYPE_ETSY].indexOf(this.designData.store.type)}}()},yLpj:function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},yQrk:function(e,t){!function(){"use strict";PF.ProductPush.LayerPicker.Par=Class({__NAME:"PF.ProductPush.LayerPicker.Par",placements:[],templates:null,activePlacementId:"",onPicked:null,product:null,conflictCalculator:null,fileCountLimit:null,productOptionsPlacements:null,productOptions:null,includeSamples:!1,searchTag:"",productOptionsValues:null,onProductOptionsChanged:null,onColorChanged:null,onCustomizableChanged:null,onDuplicate:null,allowCustomizableLayers:!1,layerPickerChooser:null,nodeTemplateTypePicker:null,onItemEdit:null,isAdvancedTemplateLoaded:null,isAllOver:null,hasAtLeastOneDesignFillColor:null,validateAddingLayer:null,getSelectedMockupVariant:null,showPatternPicker:null})}()},zVjX:function(e,t){!function(){"use strict";PF.ProductPush.VariantArea=Class({_variantItems:[],_par:null,_generatorVariants:[],_activeGeneratorVariant:null,_isVariantOverlayVisible:!1,_variantOverlayHandle:null,__construct:function(e){this._par=e,this._subscribeTemplateEvents(),this.node=tag("div","generator-variant-area"),this.setGeneratorVariants(this._par.generatorVariants.slice(),this._par.activeGeneratorVariant)},_render:function(){for(var e in mkE.clearNode(this.node),this._variantItems=[],this._generatorVariants){var t=this._generatorVariants[e],i=this._par.templates.getUserTemplate(t.placementId,t.templateId),r=new PF.ProductPush.VariantArea.Item.Par;r.generatorVariant=t,r.product=this._par.product,r.templates=this._par.templates,r.template=i,r.disableLayerManipulations=this._par.disableLayerManipulations,r.onRemove=this._par.onGeneratorVariantRemove.bind(null,t.generatorVariantId),r.onSelect=this._onGeneratorVariantSelected.bind(this,t.generatorVariantId),r.getDesignFillColor=this._par.getDesignFillColor;var n=new PF.ProductPush.VariantArea.Item(r);this._activeGeneratorVariant&&this._activeGeneratorVariant.generatorVariantId===t.generatorVariantId&&n.setActive(!0),this._variantItems.push(n),n.append(this.node),n.renderMockupPreviewString()}this._variantItems.length>1&&this._hasUnrelatedTemplates()&&tag("div","overlay-notice pf-py-12",[tag("div","overlay-notice__pattern"),tag("div","overlay-notice__text pf-px-16",dlang("generator","Items with the overlay need to be adjusted individually."))]).append(this.node)},_unsubscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().unsubscribe(this._onTemplatesChangedExternallyVariant)},_subscribeTemplateEvents:function(){this._par.templates&&this._par.templates.getChangeListener().addOnLayerAddedOrRemovedListener(this._onTemplatesChangedExternallyVariant).addOnTemplatePositionsChangedListener(this._onTemplatesChangedExternallyVariant)},_unsubscribeTemplateEventsIfNeeded:function(){return!PF.Utils.isInDocument(this.node)&&(this._unsubscribeTemplateEvents(),!0)},_onGeneratorVariantSelected:function(e){if(!this._activeGeneratorVariant||this._activeGeneratorVariant.generatorVariantId!==e){for(var t=0,i=this._variantItems.length;t<i;t++){var r=this._variantItems[t];r.setActive(r.getGeneratorVariantId()===e)}this._par.onGeneratorVariantSelect(e)}},setGeneratorVariants:function(e,t){var i=this._activeGeneratorVariant===t,r=this._generatorVariants.map((function(e){return e.getComparisonKey()})).join("|")===e.map((function(e){return e.getComparisonKey()})).join("|");i&&r||(this._activeGeneratorVariant=t,this._generatorVariants=e,r||this._render())},_onTemplatesChangedExternallyVariant:function(e,t,i){if(!this._unsubscribeTemplateEventsIfNeeded()){for(var r=0,n=this._variantItems.length;r<n;r++)for(var a=this._variantItems[r],o=0,s=e.length;o<s;o++){var l=e[o];l.getKey()===a.getTemplateKey()&&a.updateDpiWarning(l,t,i)}this._showTimedVariantOverlay()}},renderMockupPreviewStrings:function(){for(var e=0,t=this._variantItems.length;e<t;e++){this._variantItems[e].renderMockupPreviewString()}},_showTimedVariantOverlay:function(){var e=this;this._isVariantOverlayVisible&&!this._variantOverlayHandle||(this._showVariantItemsOverlay(),this._variantOverlayHandle&&clearTimeout(this._variantOverlayHandle),this._variantOverlayHandle=setTimeout((function(){e._hideVariantItemsOverlay(),e._variantOverlayHandle=null}),2e3))},_showVariantItemsOverlay:function(){if(this._activeGeneratorVariant&&this._variantItems){this._isVariantOverlayVisible=!0;var e=this._par.templates.getUserTemplate(this._activeGeneratorVariant.placementId,this._activeGeneratorVariant.templateId);for(var t in this._variantItems){var i=this._variantItems[t],r=i.getTemplate();e.isRelated(r)||i.showOverlay()}}},_hideVariantItemsOverlay:function(){for(var e in this._variantItems)this._variantItems[e].hideOverlay();this._isVariantOverlayVisible=!1},_hasUnrelatedTemplates:function(){var e=this._par.templates.getUserTemplate(this._activeGeneratorVariant.placementId,this._activeGeneratorVariant.templateId);for(var t in this._variantItems){var i=this._variantItems[t].getTemplate();if(!e.isRelated(i))return!0}return!1}},mkE.Base)}()},zfrb:function(e,t){!function(){"use strict";PF.ProductPush.TemplateQuality=Class({_templates:null,__construct:function(e){this._templates=e,this._validator=new PF.Components.GeneratorMockup.Validator},getQualityPercent:function(e,t){if(e.isImageLayer()){if(e.isVector())return 100;var i=e.getDPI()/this._templates.getRequiredDpi()*50;return i>200&&(i=200),i}if(e.isTextLayer()){if(!this._validator.setProduct(t).setActiveLayer(e).isTextSizeValid())return 0;var r=this._templates.getTemplateByLayer(e);return t&&t.isEmbroidery()&&r&&r.technique===PF.Items.ProductItem.TECHNIQUE_EMBROIDERY&&this._templates.areTextLayersOverlapping()?1:t&&t.isDtgShirt()&&e.size<=.275?0:100}if(!e)return console.error("Undefined layer found. Assuming it has 100 percent quality!"),100},isQualityBad:function(e){return e>0&&e<50},isQualityMedium:function(e){return e>=50&&e<=80},getQualityKey:function(e,t,i,r,n){if(i&&t&&t.isTextLayer()&&e<100)return 1===e?PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_OVERLAPPING:PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_TOO_SMALL;var a=PF.ProductPush.TemplateQuality.QUALITY_GOOD;return this.hasTransparencyProblems(t,n)&&(a=PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY),i&&!r&&t&&t.isTextLayerPartiallyOutOfBounds()&&(a=PF.ProductPush.TemplateQuality.QUALITY_EMBROIDERY),!i&&this.isQualityMedium(e)&&(a=PF.ProductPush.TemplateQuality.QUALITY_MEDIUM),!i&&this.isQualityBad(e)&&(a=PF.ProductPush.TemplateQuality.QUALITY_BAD),a},getTemplateQualityPercent:function(e,t){var i=this._templates.getUserTemplate(e,t),r=null;for(var n in i.layers){var a=this.getQualityPercent(i.layers[n]);r=null===r?a:Math.min(r,a)}return r},hasTransparencyProblems:function(e,t){return e&&t&&(t.isDtgShirt()||t.isDtgTote())&&e.isImageLayer()&&e.hasTransparencyIssues()}}),PF.ProductPush.TemplateQuality.QUALITY_GOOD="good",PF.ProductPush.TemplateQuality.QUALITY_MEDIUM="medium",PF.ProductPush.TemplateQuality.QUALITY_BAD="bad",PF.ProductPush.TemplateQuality.QUALITY_EMBROIDERY="embroidery",PF.ProductPush.TemplateQuality.QUALITY_TRANSPARENCY="transparencyWarning",PF.ProductPush.TemplateQuality.TEXT_TOO_SMALL="textSmall",PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_TOO_SMALL="embroideryTextSmall",PF.ProductPush.TemplateQuality.EMBROIDERY_TEXT_OVERLAPPING="embroideryTextOverlapping"}()},zsu5:function(e,t){!function(){"use strict";PF.ProductPush.VariantFilter=Class({__NAME:"PF.ProductPush.VariantFilter",__construct:function(e,t){this._designData=e,this._generatorParams=t},getGroupedMockupVariants:function(){var e,t,i=this._getTemplateGeneratorVariantIds(),r={},n=[],a={},o={},s={},l=this._designData.templates;for(t in l){var d=l[t];n.push(d.templateId),d.parentTemplateId&&n.push(d.parentTemplateId)}for(t in this._designData.generatorVariants){var c=this._designData.generatorVariants[t];o[c.size]=!0,a[c.color]=!0,s[c.placementId]=!0}for(t in this._generatorParams.generatorVariants){var u=this._generatorParams.generatorVariants[t];if(!(i.indexOf(u.generatorVariantId)>-1)&&(!(n.indexOf(u.templateId)<0)&&(!u.size||o[u.size])&&(!u.color||a[u.color])&&(!u.placementId||s[u.placementId])&&u.placementId!==PF.Items.OrderLineItemFile.TYPE_LABEL_INSIDE)){e=u.option||this._getReadablePlacement(u.placementId);var h=u.optionGroup||"Default";r[h]=r[h]||[],r[h][e]=r[h][e]||[],r[h][e].push(u)}}return this._sortGroupedMockupVariants(r)},_sortGroupedMockupVariants:function(e){var t=(this._designData.colors||[]).slice(),i=(this._designData.sizes||[]).slice(),r=function(e,t){return function(i,r){var n=t.indexOf(i[e]),a=t.indexOf(r[e]);return n===a?0:n<a?-1:1}},n=this._sortBySequence(e,PF.ProductPush.VariantFilter.OPTION_GROUP_SEQUENCE);for(var a in n){var o=this._sortBySequence(n[a],PF.ProductPush.VariantFilter.OPTION_SEQUENCE);for(var s in o){var l=o[s];l.sort((function(e,n){var a=r("color",t)(e,n),o=0;return a||(o=r("size",i)(e,n)),a+o})),o[s]=l}n[a]=o}return n},_sortBySequence:function(e,t){var i=Object.keys(e);i.sort((function(e,i){return t.indexOf(e)>t.indexOf(i)?1:-1}));var r=[];for(var n in i)r[i[n]]=e[i[n]];return r},getMockupVariantIds:function(){var e=this.getGroupedMockupVariants(),t=[];for(var i in e)for(var r in e[i])for(var n in e[i][r])t.push(e[i][r][n].generatorVariantId);return t},getGroupMockupVariantIds:function(e){var t=this.getGroupedMockupVariants(),i=[];for(var r in t[e])for(var n in t[e][r])i.push(t[e][r][n].generatorVariantId);return i},getDefaultGroupVariantId:function(e){var t=this.getGroupMockupVariantIds(e);if(t.length)return t[0];console.error("Generator variants not found for mockup main group: "+e)},getAdditionalGroupVariantId:function(e,t,i){var r=this.getGroupedMockupVariants(),n=[];for(var a in r[e]){var o=r[e][a];for(var s in o){var l=o[s];t&&i&&l.size===i&&l.color===t?n.push(l.generatorVariantId):t&&l.color===t?n.push(l.generatorVariantId):i&&l.size===i&&n.push(l.generatorVariantId)}}if(n.length>0)return n[0];var d=this.getDefaultGroupVariantId(e);if(d)return d;console.error("Generator variants not found for mockup additional group: "+e)},_getReadablePlacement:function(e){var t=this._generatorParams.availablePlacements;for(var i in t){var r=t[i];if(r.id==e)return r.title}return e},_getTemplateGeneratorVariantIds:function(){var e=this._generatorParams.variantMapping,t=[];for(var i in e){var r=e[i];for(var n in r.templateIds){var a=r.templateIds[n];t.indexOf(a)<0&&t.push(a)}}return t}}),PF.ProductPush.VariantFilter.OPTION_SEQUENCE=PF.ProductPush.VariantFilter.OPTION_SEQUENCE?PF.ProductPush.VariantFilter.OPTION_SEQUENCE:[],PF.ProductPush.VariantFilter.OPTION_GROUP_SEQUENCE=PF.ProductPush.VariantFilter.OPTION_GROUP_SEQUENCE?PF.ProductPush.VariantFilter.OPTION_GROUP_SEQUENCE:[]}()}},[[19,0,3,5]]]);