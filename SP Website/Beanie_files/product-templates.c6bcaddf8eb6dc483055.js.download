(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{"+QmR":function(t,e){!function(){"use strict";PF.ProductTemplates.ReviewStep.Par=Class({productTitle:"",designData:null,generatorParams:null,nextText:"",prevText:"",onSave:null,onBack:null})}()},"+yt1":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n("MSZa"),i={},o="onSuccess";function a(t,e){var n;if(e&&(null==t?void 0:t.id)&&(null==t?void 0:null===(n=t.mainImage)||void 0===n?void 0:n.pusherKey)){var r=t.mainImage.pusherKey,a=t.id;i[a]||(i[a]={callbacks:[],pusherKey:r},PF.Pusher.subscribe(r,o,l)),i[a].callbacks.push(e)}}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&i[t]){var n=i[t];if(e&&n.callbacks){var r=n.callbacks.indexOf(e);r>=0&&n.callbacks.splice(r,1)}else{var a=n.pusherKey;a&&(PF.Pusher.unbind(a,o,l),delete i[t])}}}function c(t){var e=Object.values(t||{})[0];if(!e||!e.urlThumb&&!e.urlLarge)return new r.a;var n=new r.a;return n.status=r.a.STATUSES.STATUS_DONE,n.thumbnailURL=e.urlThumb||e.urlLarge,n.imageURL=e.urlLarge||e.urlThumb,n}function l(t){var e=t.templateId;((i[e]||{}).callbacks||[]).forEach((function(e){e(t)})),s(e)}},37:function(t,e,n){n("mwBX"),n("Udrt"),n("+QmR"),n("6VhK"),n("5KJ7"),n("N4UO"),n("RHAc"),n("YSCK"),t.exports=n("elN9")},"5KJ7":function(t,e,n){"use strict";n.r(e);var r=n("+yt1");PF.ProductTemplates.DetailsEditor=Class({_par:void 0,_editorState:void 0,_orderDesigner:void 0,_pushDesigner:void 0,_editFurtherNode:void 0,_mockupImageNode:void 0,_storedGeneratorParams:void 0,_currentlyShowingLoader:!1,_userCanContinue:!1,__construct:function(t){this._par=t,this.node=tag("div","product-template-details-editor",[this._contentNode=tag("div",{style:{minHeight:"600px"}},"")]),(new PF.Repositories.Products).cacheProduct(this._par.item.productData),this._subscribeToMainMockupChanges(),this._init(),this._render()},_init:function(){var t=new PF.ProductTemplates.EditorState;t.sourceProductTemplate=this._par.item,t.flowType=PF.ProductTemplates.EditorState.FLOW_TYPES.CREATE_PRODUCT,t.useSimpleDesigner=!0,this._editorState=t,this._initializeDesignerComponent()},_initializeDesignerComponent:function(){var t=this._editorState;if(this._pushDesigner=this._orderDesigner=null,this._par.isPushFlow()){var e=new PF.ProductPush.Designer.Par;e.store=this._par.store,e.product=this._par.item.productData,e.onProductDesigned=function(t,e){this._par.pushFlowTypeParams.onProductDesigned(t,e,this._pushDesigner)}.bind(this),e.isProductPushMode=!0,e.productTemplateEditorState=t,e.onBack=this._par.onBack,e.onFooterRender=this._par.onFooterRender,e.onLoaderToggle=function(t,e,n){this._toggleLoadingOverlay(n)}.bind(this),e.onProductLoaded=function(t){this._storedGeneratorParams=PF.Repositories.GeneratorRepository.GeneratorParameters.duplicateFrom(t)}.bind(this),e.onCanContinueChange=this._onDesignerCanContinueChange.bind(this),e.isCustomizerEnabledJS=!0,e.ctaText=dlang("dashboard","Proceed to mockups"),!t.useSimpleDesigner&&this._storedGeneratorParams&&(e.generatorParameters=this._storedGeneratorParams),this._pushDesigner=new PF.ProductPush.Designer(e),this._pushDesigner.registerReplaceableParent(this._contentNode)}else if(this._par.isOrderFlow()){var n=new PF.VariantPicker.Par;n.orderLineItem=this._par.orderFlowTypeParams.lineItem,n.externalId=this._par.orderFlowTypeParams.externalId,n.callback=this._par.orderFlowTypeParams.callback.bind(this),n.callbackWithGeneratingFiles=this._par.orderFlowTypeParams.callbackWithGeneratingFiles.bind(this),n.storeId=this._par.store.storeId,n.currency=this._par.orderFlowTypeParams.currency,n.productId=this._par.item.productData.productId,n.isSampleOrder=this._par.orderFlowTypeParams.isSampleOrder,n.isModalOrder=!0,n.isModalDesigner=!1,n.flow=PF.ProductsCatalog.TYPE_OF,n.skipMemory=this._par.orderFlowTypeParams.skipMemory,n.productTemplateEditorState=t,n.onBack=this._par.onBack,n.stickyButtonNodeUpdate=this._par.onFooterRender,n.enableCustomizableLayers=!!this._par.enableCustomizableLayers,n.onDesignerLoaded=this._onDesignerLoaded.bind(this),n.onLoaderToggle=function(t,e,n){this._toggleLoadingOverlay(n)}.bind(this),n.onProductLoaded=function(t){this._storedGeneratorParams=PF.Repositories.GeneratorRepository.GeneratorParameters.duplicateFrom(t)}.bind(this),n.onCanContinueChange=this._onDesignerCanContinueChange.bind(this),!t.useSimpleDesigner&&this._storedGeneratorParams&&(n.generatorParameters=this._storedGeneratorParams),this._orderDesigner=new PF.VariantPicker(n)}},_onDesignerCanContinueChange:function(t){this._userCanContinue!==t&&(this._userCanContinue=t,this._editFurtherNode&&(mkE.clearNode(this._editFurtherNode),this._createEditFurtherLink().append(this._editFurtherNode)))},_toggleLoadingOverlay:function(t){t?this._initLoadingOverlay():this._hideLoadingOverlay()},_initLoadingOverlay:function(){this._currentlyShowingLoader||(this._par.onInitLoading(),this._currentlyShowingLoader=!0)},_hideLoadingOverlay:function(){this._currentlyShowingLoader&&(this._par.onEndLoading(),this._currentlyShowingLoader=!1)},_render:function(){mkE.clearNode(this._contentNode),this._editorState.useSimpleDesigner?tag("div","product-template-details-editor__container",[tag("div","product-template-details-editor__title pf-mb-24",[tag("h4","pf-h4",[this._par.isPushFlow()?dlang("dashboard","Details for your store"):dlang("dashboard","Template details")])]),tag("div","product-template-details-editor__content row",[tag("div","product-template-details-settings col-12 col-md-6 col-lg-8 pf-mb-24",[this._pushDesigner||this._orderDesigner]),tag("div","product-template-details-printfiles col-12 col-md-6 col-lg-4 pf-d-flex pf-flex-column",[this._createPrintfilesPanel()])])]).append(this._contentNode):tag("div","product-template-details-editor__container-full",[this._pushDesigner||this._orderDesigner]).append(this._contentNode)},_onEditFurther:function(){(this._userCanContinue||$(".edit-further-link").hasClass("force"))&&(this._initLoadingOverlay(),setTimeout(function(){var t=!this._editorState.useSimpleDesigner;this._editorState.useSimpleDesigner=t,t&&(this._storedGeneratorParams=null),this._adjustStoredGenParamsFromDesigner(),this._initializeDesignerComponent(),this._render(),this._pushDesigner&&this._onDesignerLoaded()}.bind(this),1))},_adjustStoredGenParamsFromDesigner:function(){if(this._storedGeneratorParams&&this._editorState.isProductCreateFlow()){var t=this._getPushDesignerUnsafe();if(t){var e=t._selectedSizes.slice().filter((function(t){return!!t})),n=t._selectedColors.slice();e&&e.length>0&&(this._storedGeneratorParams.preselectedData.sizes=e),n&&n.length>0&&(this._storedGeneratorParams.preselectedData.colors=n)}}},_onDesignerLoaded:function(){this._getPushDesignerUnsafe().updateView(),this._hideLoadingOverlay()},_getPushDesignerUnsafe:function(){return this._pushDesigner?this._pushDesigner:this._orderDesigner.getPushDesigner()},_createPrintfilesPanel:function(){var t=this._par.item,e=t.placementNames&&Object.keys(t.placementNames).length>0?Object.keys(t.placementNames).map((function(e){return new PF.Components.PlacementSVGPopoverLink({linkText:t.placementNames[e],generatorDesign:t.design,placement:e,linkClasses:"pf-text-muted pf-pointer"})})):[],n=[];return e.forEach((function(t){n.push(t),n.push(", ")})),n.pop(),tag("div","product-template-details-printfiles__container pf-ui-body",[this._mockupImageNode=tag("div",null,[this._createImage()]),tag("div","product-template-details-printfiles__placements pf-mt-8",[tag("div","pf-h5 pf-mb-4",lang("Print files")),tag("div","pf-ui-body pf-text-muted",n)]),this._editFurtherNode=tag("div","product-template-details-printfiles__edit-link pf-mt-16 pf-mb-64",[this._createEditFurtherLink()])])},_createImage:function(){var t=this._par.item,e="pf-border pf-border-light pf-d-block ";if(t.mainImage.isDone)return tag("div",e,[tag("img",{className:"product-template-details-printfiles__image",src:this._par.item.mainImage.thumbnailURL})]);var n=t.mainImage.isLoading?"product-template-details-printfiles__loader":"product-template-details-printfiles__broken";return tag("div",e+"product-template-details-printfiles__fake-image-wrapper",[tag("img",{className:"product-template-details-printfiles__image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAHCCAYAAAB8GMlFAAAFa0lEQVR42u3VMQEAAAjDMFCO9GGCj0RCn3ZSUwDwVBshAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIAEYIgBEaIQBGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCABGCIARygCAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQJghEYIgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECYIRGCIARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAoARAmCERgiAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQKAEQJghEYIgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECgBECYIQyAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEAGCEABihEQJghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABghABwaQHZ/mG5cVp0BgAAAABJRU5ErkJggg=="}),tag("div","product-template-details-printfiles__fake-image-background "+n)])},_createEditFurtherLink:function(){var t=this._userCanContinue,e={className:"edit-further-link pf-link-block pf-cursor-pointer pf-d-flex pf-mr-12"+(t?"":" pf-text-muted"),onclick:this._onEditFurther.bind(this)},n="";return t||(n=tag("span",{className:"glyphicon glyphicon-info-sign"}),$(n).tooltip({title:dlang("dashboard","Please select at least one color and size!"),placement:"top",trigger:"hover"})),tag("a",e,[tag("i",{className:"pf-i pf-i-pencil pf-text-gray pf-mr-4",style:{fontSize:"1.4em"}}),tag("span",null,[dlang("dashboard","Edit print files")+" ",n])])},_subscribeToMainMockupChanges:function(){var t=this,e=this._par.item;Object(r.b)(e,(function(n){var i=n.files;e.mainImage=Object(r.a)(i),t._mockupImageNode&&(mkE.clearNode(t._mockupImageNode),t._createImage().append(t._mockupImageNode))}))}},mkE.Base)},"6VhK":function(t,e,n){"use strict";n.r(e);var r=n("HSPo"),i=n("LvDl"),o=n.n(i);PF.ProductTemplates.InitializeEditor=Class({_productDesigner:null,_reviewScreen:null,_warningModal:null,_editorState:null,_par:null,__construct:function(t){this._par=t;var e=new PF.ProductTemplates.EditorState;t&&t.existingTemplate&&(e.sourceProductTemplate=t.existingTemplate),this._editorState=e,this._initialRender()},_getCurrentDesignData:function(){var t=null,e=null;return this._reviewScreen&&(t=this._reviewScreen.getCurrentDesignData(),e=this._reviewScreen.getCurrentGeneratorParams()),this._productDesigner&&(t=this._productDesigner.getDesignData(),e=this._productDesigner.getGeneratorParams()),t&&e?(this._adjustGeneratorVariantIdsToSave(t,e),t):(console.error("Can't resolve designData and generatorParams!"),null)},_initialRender:function(){var t=this,e=new PF.Modal.Par;e.nodeClass="pf-modal order-flow",e.modalDialogClass="modal-lg",e.useScrollableModal=!0,e.closeOnClick=!1,e.title=this._isEditFlow()?dlang("dashboard","Edit product template"):dlang("dashboard","Create a product template"),e.hasSteps=!0,e.onCloseInit=function(){return t._showCloseWarningModal(),!1},this.modal=new PF.Modal(e);var n={additionalClasses:"pf-py-0 pf-border-0",additionalWrapClasses:"pf-steps--small pf-steps--oneside pf-steps--clickable pf-justify-content-center pf-justify-content-md-end"};this._isEditFlow()?(this._currentStep=PF.ProductTemplates.STEP_PRODUCT_DESIGN,this._steps=new PF.Components.Steps([lang("Design"),lang("Review")],this._onStepClick,[],n)):(this._currentStep=PF.ProductTemplates.STEP_PRODUCT_CHOOSE,this._steps=new PF.Components.Steps([lang("Product"),lang("Design"),lang("Review")],this._onStepClick,[],n)),this.modal.setSteps(this._steps),this._initModalContents()},_initModalContents:function(){var t=this._editorState.sourceProductTemplate?this._editorState.sourceProductTemplate.productData:null,e=this._isEditFlow()?this._buildNewDesigner(t):this._buildNewProductCatalog(),n=tag("div",null,[new PF.Components.BreadCrumbs,e]);this.modal.setContent(n),this._isEditFlow()?(this._productDesigner=e,this.modal.setStickyButtons(e._nodeFooter)):this._productDesigner=null,this.modal.show()},_buildInitialModalContent:function(){var t=new PF.Components.BreadCrumbs;return tag("div","",[t,this._buildNewProductCatalog()])},_buildNewDesigner:function(t){var e=new PF.ProductPush.Designer.Par;e.store=new PF.Items.StoreItem,e.product=t,e.ctaText=lang("Continue"),e.productTemplateEditorState=this._editorState,e.isCustomizerEnabledJS=!1,e.shouldShowPrice=!0,e.updateStickyButtonHeight=function(t){this.modal&&this.modal.updateStickyButtonHeight(t)}.bind(this);var n=null;return e.designerState=new PF.ProductPush.DesignerState,e.orderLineItem=this._par?this._par.existingTemplate:null,e.onProductDesigned=function(t){this._onProductDesigned(t,n.getGeneratorParams())}.bind(this),e.isModalDesigner=!0,e.onBack=this._isEditFlow()?null:this._onBack.bind(this,PF.ProductTemplates.STEP_PRODUCT_CHOOSE),(n=new PF.ProductPush.Designer(e)).observer.onDesignerReady(function(){var t=n.getDesignData();this._isEditFlow()&&!this._editorState.existingTemplateInitState&&n._templates&&(this._editorState.existingTemplateInitState=new PF.ProductTemplates.TemplateDesignerState({templates:n._templates.clone(),sizes:t.templateSelectedSizes.slice(),colors:t.colors.slice(),title:t.title,productOptions:o.a.cloneDeep(t.productOptions||{})}))}.bind(this)),n.registerReplaceableParent(this.modal._nodeBody),n},_buildNewProductCatalog:function(){var t=new PF.ProductsCatalog.Initializer.Par;return t.isProductTemplate=!0,t.isEmbedded=!0,t.onProductChoose=function(t){this._productDesigner=this._buildNewDesigner(t),this._switchToDesignerStep()}.bind(this),PF.ProductsCatalog.Initializer.getInstance(t,!0)},_changeStep:function(t){this._currentStep=t,this._isEditFlow()&&(t-=1),this._steps.setStep(t)},_adjustGeneratorVariantIdsToSave:function(t,e){PF.ProductTemplates.adjustGeneratorVariantIdsToSave(t,e)},_onProductDesigned:function(t,e){t.initTitleSet||(t.title=this._resolveInitTitle(t),t.initTitleSet=!0);var n=new PF.ProductTemplates.ReviewStep.Par;n.productTitle=t.product.customTitle,t.title||(t.title=t.title+" "+dclang("dashboard","{name} template","template")),t.sizes=t.sizes||[],n.designData=t,n.generatorParams=e,n.nextText=dlang("dashboard","Save product template"),n.prevText=dlang("dashboard","Back to design"),n.onSave=this._onSave.bind(this,!1,!0),n.onBack=this._onBack.bind(this,PF.ProductTemplates.STEP_PRODUCT_DESIGN),this._reviewScreen=new PF.ProductTemplates.ReviewStep(n),this.modal.setContent(this._reviewScreen.getContent()),this.modal.setStickyButtons(this._reviewScreen.getFooter()),this._changeStep(PF.ProductTemplates.STEP_PRODUCT_REVIEW)},_onSave:function(t,e){var n=this,i=this._getCurrentDesignData();Object(r.g)({designData:i,existingTemplateId:this._editorState.sourceProductTemplate&&this._editorState.sourceProductTemplate.id?this._editorState.sourceProductTemplate.id:void 0,forceDraft:!!t,forceActive:!!e,saveFlowType:r.a.DEFAULT}).then((function(e){PF.Events.emit(PF.Events.PRODUCT_TEMPLATE_SAVED,{item:e,isNewItem:n._editorState.isNewTemplateEditor()}),n._closeEditor(),new PF.Components.Snackbar({type:PF.Components.Snackbar.TYPE_SUCCESS,content:n._editorState.isNewTemplateEditor()?t?dlang("dashboard","A product template draft created. Finish it any time!"):dlang("dashboard","Product template created!"):dlang("dashboard","Product template updated!"),duration:6e3})})).catch((function(t){console.error(t),n._reviewScreen&&n._reviewScreen.enableSaveNode(),n._warningModal&&n._warningModal.enablePrimaryButton(),new PF.Components.Snackbar({type:PF.Components.Snackbar.TYPE_ERROR,content:dlang("dashboard","Error while saving product template! Please contact support!"),duration:6e3})}))},_onBack:function(t){if(t!==this._currentStep)if(t!==PF.ProductTemplates.STEP_PRODUCT_CHOOSE)t===PF.ProductTemplates.STEP_PRODUCT_DESIGN&&this._switchToDesignerStep();else{var e=!this._editorHasChanges();this._isEditFlow()?this._showCloseWarningModal():e?this._onBackToProductsWarningModalClose(!0):this._showBackToProductsWarning()}},_switchToDesignerStep:function(){var t=this._productDesigner;if(this._reviewScreen){var e=this._reviewScreen.getCurrentDesignData();e.templateSelectedSizes&&(t.designData.templateSelectedSizes=e.templateSelectedSizes)}this._changeStep(PF.ProductTemplates.STEP_PRODUCT_DESIGN),this.modal.setContent(t),this.modal.setStickyButtons(t._nodeFooter),this._reviewScreen=null},_showBackToProductsWarning:function(){var t=new PF.Components.WarningDialog.Par;t.onPrimaryBtnClick=this._onBackToProductsWarningModalClose.bind(this,!0),t.onSecondaryBtnClick=this._onBackToProductsWarningModalClose.bind(this,!1),t.modalTitle=dlang("dashboard","Choose product"),t.contentTitle=dlang("dashboard","Do you want to go back to product selection?"),t.contentText=dlang("dashboard","If you go back, your design won't be saved"),t.primaryBtnText=dlang("dashboard","Yes, go back"),t.secondaryBtnText=dlang("dashboard","Keep designing"),this._warningModal=new PF.Components.WarningDialog(t)},_onBackToProductsWarningModalClose:function(t){this._warningModal&&this._warningModal.closeDialog(),t&&(this._changeStep(PF.ProductTemplates.STEP_PRODUCT_CHOOSE),this.modal.setContent(this._buildInitialModalContent()),this._productDesigner=this._reviewScreen=null)},_closeEditor:function(){this._warningModal&&this._warningModal.closeDialog(),this.modal.remove()},_editorHasChanges:function(){if(this._isEditFlow()&&this._editorState.existingTemplateInitState){var t=this._editorState.existingTemplateInitState;if(this._productDesigner&&t.templates&&PF.ProductPush.DesignerHelpers.areDesignsDifferent(this._productDesigner._templates,t.templates))return!0;var e=this._getCurrentDesignData();if(e){var n=t.sizes||[],r=e.templateSelectedSizes||[];if(n.length!==r.length)return!0;var i=r.filter((function(t){return-1===n.indexOf(t)}));if(i&&i.length)return!0;var a=t.colors||[],s=e.colors||[];if(a.length!==s.length)return!0;var c=s.filter((function(t){return-1===a.indexOf(t)}));if(c&&c.length)return!0;if(e.title!==t.title)return!0;var l=e.productOptions||{},u=t.productOptions;if(!o.a.isEqual(l,u))return!0}return!1}return PF.ProductPush.DesignerHelpers.isSomethingDesigned(this._productDesigner)},_showCloseWarningModal:function(){if(this._editorHasChanges()){var t=new PF.Components.WarningDialog.Par;t.onSecondaryBtnClick=this._closeEditor,t.modalTitle=dlang("dashboard","Close template builder"),this._isEditFlow()?(t.contentTitle=dlang("dashboard","Do you want to save changes?"),t.contentText=dlang("dashboard","If you don't save, your changes will be lost."),t.primaryBtnText=dlang("dashboard","Save changes"),t.onPrimaryBtnClick=this._onSave.bind(this)):(t.contentTitle=dlang("dashboard","Do you want to save your product template as a draft?"),t.contentText=dlang("dashboard","Finish it at any time or discard changes now"),t.primaryBtnText=dlang("dashboard","Save template as draft"),t.onPrimaryBtnClick=this._onSave.bind(this,!0)),t.secondaryBtnText=dlang("dashboard","Don't save"),this._warningModal=new PF.Components.WarningDialog(t)}else this._closeEditor()},_isEditFlow:function(){return!this._editorState.isNewTemplateEditor()},_onStepClick:function(t){var e=t+1;this._isEditFlow()&&(e+=1),e>=this._currentStep||this._onBack(e)},_resolveInitTitle:function(t){if(!this._editorState.isNewTemplateEditor())return t.title;var e=PF.LOCALE,n=t.multiLanguageDetails;if(!e||!n)return t.title;var r=n.find((function(t){return t.language===e&&t.type===PF.Items.ProductDetailTranslation.TYPE_TITLE}));return r&&r.value||t.title}}),PF.ProductTemplates.adjustGeneratorVariantIdsToSave=function(t,e){var n=new PF.ProductPush.VariantFilter(t,e),r=Object.keys(n.getGroupedMockupVariants()).filter((function(t){return!!e.getGeneratorVariant(n.getDefaultGroupVariantId(t))}));if(r.length){var i=n.getGroupMockupVariantIds(r[0]);i&&i.length&&(t.generatorVariantsIdsToSave=i)}},PF.ProductTemplates.STEP_PRODUCT_CHOOSE=1,PF.ProductTemplates.STEP_PRODUCT_DESIGN=2,PF.ProductTemplates.STEP_PRODUCT_REVIEW=3},"8oxB":function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,l=[],u=!1,d=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&h())}function h(){if(!u){var t=s(p);u=!0;for(var e=l.length;e;){for(c=l,l=[];++d<e;)c&&c[d].run();d=-1,e=l.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function f(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new g(t,e)),1!==l.length||u||s(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"9Nv7":function(t,e,n){"use strict";var r=n("LvDl"),i=n.n(r);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return l(t,arguments,d(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,t)})(t)}function l(t,e,n){return(l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&u(i,n.prototype),i}).apply(null,arguments)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=s(this,d(e).call(this,t.statusText))).xhr=t,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,t),n=e,(r=[{key:"getXhr",value:function(){return this.xhr}}])&&a(n.prototype,r),i&&a(n,i),e}(c(Error));e.a=function(t,e,n){n=n||{},e=e||{};var r=t.split("/"),o=null,a=null,s=null;3===r.length?(o=r[0],a=r[1],s=r[2]):2===r.length?(a=r[0],s=r[1]):console.error("RPC call got strange URL: "+t);var c=(o?"/"+o:"")+"/rpc/"+a+"-rpc/"+s;return new Promise((function(r,o){var a=n.simpleRejection||!1,s=n.beforeSend||null,l={url:c,method:"POST",dataType:"json",data:e,success:function(e){e.output&&console&&console.info&&console.info(t+" output:\n"+e.output),r(e.result)},error:function(n){if(a)o(new g(n));else{var r=parseInt(n.status+"");404===r?(PF.ErrorLogger.log("RPC 404 for `"+c+"`"),alert("Whoa, we encountered an unexpected problem.\nPlease, refresh the page and try again!\nIf this persists, please contact us!")):504===r?alert("Whoa, it seems that the communication to server timed-out.\nPlease, refresh the page and try again!\nIf this persists, please contact us!"):429===r?alert(n.responseJSON.message):403===r?location.reload():0!==r?alert("["+r+"]\nSorry, an error occurred.\nReload the page and try again.\nIf this persists, please contact at devsupport@printful.com"):console.error("Unknown error",t,e),o(new g(n))}}};i.a.assign(l,n),$.ajax(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},l,{},n,{beforeSend:function(t){t.setRequestHeader("X-CSRF-Token",window.yii.getCsrfToken()),s&&s(t)}}))}))}},CXOy:function(t,e,n){"use strict";n.d(e,"f",(function(){return p})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return g})),n.d(e,"a",(function(){return f})),n.d(e,"i",(function(){return m})),n.d(e,"h",(function(){return E})),n.d(e,"g",(function(){return A})),n.d(e,"c",(function(){return T})),n.d(e,"b",(function(){return P}));var r,i=n("MSZa"),o=n("mTkf"),a=n("wy2R"),s=n.n(a);function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var p=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.itemRepository=e.itemRepository||{},this.viewType=e.viewType||m.LIST,this.filter=e.filter?new g(e.filter):null,this.currentItemsResponseMetadata=e.currentItemsResponseMetadata?new h(e.currentItemsResponseMetadata):null,this.selectedItemIds=e.selectedItemIds||[],this.flags=e.flags||{}};p.FLAG_KEYS=Object.freeze({IS_LOADING:"IS_LOADING",SHOW_DELETE_MODAL:"SHOW_DELETE_MODAL",JUST_CREATED_FIRST_TEMPLATE:"JUST_CREATED_FIRST_TEMPLATE",HAS_NOT_CREATED_ANY_TEMPLATES:"HAS_NOT_CREATED_ANY_TEMPLATES",HAS_NO_PUSH_STORES:"HAS_NO_PUSH_STORES",HAS_NOT_CLOSED_INTRO:"HAS_NOT_CLOSED_INTRO"});var h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.itemIds=e.itemIds||[],this.page=parseInt(e.page||0),this.itemsPerPage=parseInt(e.itemsPerPage||0),this.totalPages=parseInt(e.totalPages||0),this.totalItems=parseInt(e.totalItems||0),this.filter=e.filter?new g(e.filter):null}return u(t,[{key:"isLastPage",get:function(){return this.page===this.totalPages}}]),t}(),g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.search=e.search||null,this.sortBy=e.sortBy||T.CREATED_DATE,this.sortDir=e.sortDir||P.DESC,this.page=parseInt(e.page||1)}return u(t,[{key:"isDifferentThan",value:function(e){return!(e&&e instanceof t)||Object.keys(this).some(function(t){return this[t]!=e[t]}.bind(this))}},{key:"toQueryParams",value:function(){var t={};return this.search&&this.search.length&&(t.search=this.search),this.sortBy&&this.sortBy.length&&(t.sortBy=this.sortBy),this.sortDir&&this.sortDir.length&&(t.sortDir=this.sortDir),this.page&&(t.page=this.page),t}}]),t}(),f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.id=e.id||null,this.title=e.title||null,this.templateStatus=e.templateStatus||null,this.productStatus=e.productStatus||null,this.productData=e.productData?e.productData instanceof PF.Items.ProductItem?PF.Items.ProductItem.duplicateFrom(e.productData):PF.Items.ProductItem.fromArray(e.productData):null,this.mainImage=e.mainImage?new i.a(e.mainImage):null,this.design=e.design?e.design instanceof PF.Items.GeneratorDesign?PF.Items.GeneratorDesign.duplicateFrom(e.design):PF.Items.GeneratorDesign.fromArray(e.design):null,this.colors=e.colors||{},this.sizes=e.sizes||null,this.technique=e.technique||null,this.placementNames=e.placementNames||{},this.placementSVGs=e.placementSVGs||{},this.createdAt=e.createdAt?e.createdAt instanceof s.a?s.a.utc(e.createdAt.toISOString()):s.a.utc(e.createdAt):null,this.updatedAt=e.updatedAt?e.updatedAt instanceof s.a?s.a.utc(e.updatedAt.toISOString()):s.a.utc(e.updatedAt):null,this.storeData=e.storeData?_.cloneDeep(e.storeData):null}return u(t,[{key:"getPlacementSVG",value:function(t){var e=this;return new Promise((function(n,r){e.design&&t?e.placementSVGs&&e.placementSVGs[t]?n(e.placementSVGs[t]):Object(o.e)(e.design,t).then((function(r){e.placementSVGs||(e.placementSVGs={}),e.placementSVGs[t]=r,n(r)})).catch((function(t){return r(t)})):r(new Error("Design or placement type missing!"))}))}},{key:"shouldShowTechnique",get:function(){var t;return!!(null===(t=this.productData)||void 0===t?void 0:t.hasMultipleTechniques())&&this.technique}},{key:"isDraft",get:function(){return this.templateStatus===t.TEMPLATE_STATUSES.DRAFT}},{key:"isActive",get:function(){return this.templateStatus===t.TEMPLATE_STATUSES.ACTIVE}},{key:"displaySizes",get:function(){return(this.sizes||[]).filter((function(t){return!!t}))}},{key:"displayColors",get:function(){return _.pickBy(this.colors||{},(function(t){return!!t}))}},{key:"techniqueDisplayName",get:function(){return this.technique?PF.Items.ProductItem.LABELS[this.technique]||this.technique:""}}]),t}();f.TEMPLATE_STATUSES=Object.freeze({DRAFT:"draft",ACTIVE:"active",REMOVED:"removed"}),f.PRODUCT_STATUSES=Object.freeze({ACTIVE:"active",INACTIVE:"inactive",DISABLED_IN_PUSH:"disabled_in_push",BROKEN:"broken"});var m=Object.freeze({GRID:"GRID",LIST:"LIST"}),E=Object.freeze({CREATED_DATE_DESC:"CREATED_DATE_DESC",CREATED_DATE_ASC:"CREATED_DATE_ASC",UPDATED_DATE_DESC:"UPDATED_DATE_DESC",UPDATED_DATE_ASC:"UPDATED_DATE_ASC",TITLE_ASC:"TITLE_ASC",TITLE_DESC:"TITLE_DESC"}),A=Object.freeze((c(r={},E.CREATED_DATE_DESC,dclang("dashboard","sort type","Created: newest first")),c(r,E.CREATED_DATE_ASC,dclang("dashboard","sort type","Created: oldest first")),c(r,E.UPDATED_DATE_DESC,dclang("dashboard","sort type","Updated: newest first")),c(r,E.UPDATED_DATE_ASC,dclang("dashboard","sort type","Updated: oldest first")),c(r,E.TITLE_ASC,dclang("dashboard","sort type","Title: A to Z")),c(r,E.TITLE_DESC,dclang("dashboard","sort type","Title: Z to A")),r)),T=Object.freeze({CREATED_DATE:"created",UPDATED_DATE:"updated",TITLE:"title"}),P=Object.freeze({ASC:"asc",DESC:"desc"})},Cc5H:function(t,e,n){"use strict";n.d(e,"s",(function(){return i})),n.d(e,"n",(function(){return o})),n.d(e,"r",(function(){return a})),n.d(e,"t",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"o",(function(){return l})),n.d(e,"w",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"u",(function(){return h})),n.d(e,"d",(function(){return g})),n.d(e,"h",(function(){return f})),n.d(e,"m",(function(){return m})),n.d(e,"i",(function(){return E})),n.d(e,"j",(function(){return _})),n.d(e,"v",(function(){return A})),n.d(e,"q",(function(){return T})),n.d(e,"p",(function(){return P})),n.d(e,"g",(function(){return C})),n.d(e,"f",(function(){return S})),n.d(e,"e",(function(){return v})),n.d(e,"l",(function(){return D})),n.d(e,"k",(function(){return b}));var r="productTemplates/index/",i="m_setFlag",o="m_loadItemsIntoRepo",a="m_removeItemsFromRepo",s="m_setItemsResponseMetadata",c="m_changeViewType",l="m_loadSavedItem",u="m_updateItemFiles",d="m_changeItemCheckedState",p="m_changePageCheckedState",h="m_toggleDeleteModal",g="m_cleanupDeletedItemData",f="g_getFlag",m="g_getPageItems",E="g_getItem",_="g_getItemCheckedState",A="a_updateFilterAndLoad",T="a_loadUsingFilter",P="a_loadSingleItem",C="a_duplicateItem",S="a_deleteItems",v="a_closeIntro";function D(t){return t.productTemplates.index}function b(t){return r+t}},HSPo:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"g",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var r=n("9Nv7"),i=n("CXOy"),o=n("PwNb");function a(t){var e=t.filter,n=t.storeId,i=void 0===n?null:n,o=t.forPushFlow,a=void 0!==o&&o,s=t.forOrderFlow,c=void 0!==s&&s;return new Promise((function(t,n){e?Object(r.a)("product-templates/get-templates",{filter:Object.assign({},e),storeId:i||null,forPushFlow:!!a,forOrderFlow:!!c}).then((function(e){e?(h(e),t(e)):n(new Error("Malformed getTemplatesResponse data!"))})).catch((function(t){return n(t)})):n(new Error("Missing filter parameters!"))}))}function s(t){var e=t.id,n=t.storeId,a=void 0===n?null:n;return new Promise((function(t,n){e?Object(r.a)("product-templates/get-template",{id:e,storeId:a}).then((function(e){e.item?(e.item=new i.a(e.item),t(e)):n(new o.a("Item wasn't found!"))})).catch((function(t){return n(t)})):n(new Error("Missing template id!"))}))}function c(t){return new Promise((function(e,n){t?Object(r.a)("product-templates/duplicate-template",{id:t}).then((function(t){g(t),t.item?e(t.item):n(new Error("Template duplication failed!"))})).catch((function(t){return n(t)})):n(new Error("Missing template id!"))}))}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,i){t&&Array.isArray(t)&&t.length?Object(r.a)("product-templates/delete-templates",{ids:t,filter:e}).then((function(t){t&&t.hasOwnProperty("deletedRows")?(h(t.newResponse),n(t)):i(new Error("Malformed deleteTemplatesResponse data!"))})):i(new Error("Missing deletable template ID array!"))}))}function u(t){return new Promise((function(e,n){if(!t.designData||!t.designData instanceof PF.ProductPush.DesignData)n(new Error("Missing design data for template save!"));else{var i=t.designData.toArray();Object(r.a)("product-templates/save",{designData:i,existingTemplateId:t.existingTemplateId||null,isDraftSave:!!t.forceDraft,isFinalSubmit:!!t.forceActive,saveFlowType:t.saveFlowType||d.DEFAULT}).then((function(t){g(t),t.item?e(t.item):n(new Error("Template save failed!"))})).catch((function(t){return n(t)}))}}))}var d={DEFAULT:"DEFAULT",SYNC_PRODUCT_DRAFT:"SYNC_PRODUCT_DRAFT"};function p(){return Object(r.a)("product-templates/close-intro")}function h(t){t&&(t.items&&(t.items=t.items.map((function(t){return new i.a(t)}))),t.usedFilter&&(t.usedFilter=new i.d(t.usedFilter)))}function g(t){t&&t.item&&(t.item=new i.a(t.item))}},MSZa:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return o}));var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.status=e.status||t.STATUSES.STATUS_BROKEN,this.imageURL=e.imageURL||null,this.thumbnailURL=e.thumbnailURL||null,this.imageSVG=e.imageSVG||null,this.pusherKey=e.pusherKey||null}var e,n,i;return e=t,(n=[{key:"loadResults",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.imageURL,r=void 0===n?null:n,i=e.thumbnailURL,o=void 0===i?null:i,a=e.imageSVG,s=void 0===a?null:a;if(this.pusherKey=null,!r&&!o&&!s)return this.imageURL=this.thumbnailURL=this.imageSVG=null,void(this.status=t.STATUSES.STATUS_BROKEN);r&&(this.imageURL=r),o&&(this.thumbnailURL=o),s&&(this.imageSVG=s),this.status=t.STATUSES.STATUS_DONE}},{key:"isDone",get:function(){return this.status===t.STATUSES.STATUS_DONE}},{key:"isLoading",get:function(){return this.status===t.STATUSES.STATUS_LOADING}},{key:"isBroken",get:function(){return this.status===t.STATUSES.STATUS_BROKEN}}])&&r(e.prototype,n),i&&r(e,i),t}();i(o,"IMAGE_LOADING_URL","/static/images/layout/spinner-transparent.gif"),i(o,"IMAGE_BROKEN_URL","/static/images/retina/invalid-file.svg"),o.STATUSES=Object.freeze({STATUS_BROKEN:"broken",STATUS_LOADING:"loading",STATUS_DONE:"done"})},N4UO:function(t,e){!function(){"use strict";PF.ProductTemplates.DetailsEditor.Par=Class({item:void 0,store:void 0,flowType:void 0,onBack:void 0,onFooterRender:void 0,onInitLoading:void 0,onEndLoading:void 0,orderFlowTypeParams:{},pushFlowTypeParams:{},enableCustomizableLayers:void 0,isOrderFlow:function(){return this.flowType&&this.flowType===PF.ProductTemplates.DetailsEditor.Par.FLOW_TYPES.ORDER_FLOW},isPushFlow:function(){return!this.flowType||this.flowType===PF.ProductTemplates.DetailsEditor.Par.FLOW_TYPES.PUSH_FLOW}}),PF.ProductTemplates.DetailsEditor.Par.FLOW_TYPES=Object.freeze({ORDER_FLOW:"ORDER_FLOW",PUSH_FLOW:"PUSH_FLOW"})}()},PwNb:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){var e="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return a(t,arguments,c(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,t)})(t)}function a(t,e,n){return(a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&s(i,n.prototype),i}).apply(null,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return l}));var l=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,c(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(e,t),e}(o(Error))},RHAc:function(t,e,n){"use strict";n.r(e);var r=n("HSPo");PF.ProductTemplates.StoreFlowInitializer=Class({_par:void 0,_modal:void 0,__construct:function(t){this._par=t,this._isOrderFlow()?this._initOrderFlow():this._isPushFlow()&&this._initPushFlow()},_initOrderFlow:function(){var t=new PF.OrderBegin.Par;t.storeId=this._par.store?this._par.store.storeId:null,t.productTemplateId=this._par.productTemplate.id,t.requireLogin=!0,t.allowStoresWithAvailableProductId=this._par.productTemplate.productData.productId,new PF.OrderBegin(t)},_initPushFlow:function(){this._par.store?new PF.ProductPush(this._par.store,null,(function(){new PF.Components.Snackbar({type:PF.Components.Snackbar.TYPE_SUCCESS,content:dlang("dashboard","Adding new product to store!"),duration:6e3})}),void 0,{existingModal:this._modal||null,initWithProductTemplate:this._par.productTemplate}):this._loadStorePicker()},_loadStorePicker:function(){var t=new PF.Modal.Par;t.modalDialogClass="modal-lg",t.useScrollableModal=!0,t.closeOnClick=!1,this._isPushFlow()&&(t.title=lang("Add product to store")),this._modal=new PF.Modal(t),mkE({tag:"div",className:"clearfix"}).append(this._modal._nodeHeader);var e=new PF.Components.StorePicker.Par;e.type=PF.Repositories.StoreRepository.CACHE_KEY_WITH_ENABLED_PRINTFUL_PUSH,e.callback=function(t,e){var n,i=this;if(this._par.store=e,!e)throw new Error("Store picker returned undefined store!");this._isPushFlow()&&((null===(n=this._par.productTemplate.storeData)||void 0===n?void 0:n.storeId)===e.storeId?this._initPushFlow():(PF.LoadingOverlay.show(this._modal._nodeBody),Object(r.e)({id:this._par.productTemplate.id,storeId:e.storeId}).then((function(t){var e=t.item;if(!e)throw new Error("Product template not found!");i._par.productTemplate=e,i._initPushFlow(),PF.LoadingOverlay.hide(i._modal._nodeBody)}))))}.bind(this),e.withAvailableProductId=this._par.productTemplate.productData.productId;var n=new PF.Components.StorePicker(e);this._modal.setContent(n),this._modal.show()},_isOrderFlow:function(){return this._par.flowType===PF.ProductTemplates.StoreFlowInitializer.Par.FLOW_TYPES.FLOW_ORDER},_isPushFlow:function(){return this._par.flowType===PF.ProductTemplates.StoreFlowInitializer.Par.FLOW_TYPES.FLOW_PUSH}})},URgk:function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n("YBdB"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n("yLpj"))},Udrt:function(t,e){!function(){"use strict";PF.ProductTemplates.ReviewStep=Class({_sizePicker:null,_sizesSectionNode:null,_templateNameNode:null,__construct:function(t){this._par=t,this.node=tag("div","pf-ui-body product-templates-review-step pf-mb-96",[tag("div","row",[tag("div","col-12 col-md-4 text-center",[this._getMainMockup()]),tag("div","col-12 col-md-8",[tag("div","row",[tag("div","col-12",[tag("strong","",dlang("dashboard","Product template title"))]),tag("div","col-12",[this._templateNameNode=tag("input",{type:"text",className:"pf-mt-8 product-templates-review-step__title-input",attr:{value:this._par.designData.title},prop:{onchange:this._onTitleChange.bind(this)}})])]),tag("div","row pf-mt-24",[tag("div","col-12",[tag("strong","",lang("Product"))]),tag("div","col-12",[tag("p","pf-mt-4 pf-mb-0 pf-text-muted",this._par.productTitle)])]),this._productHasColorPicker()?tag("div","row pf-mt-24",[tag("div","col-12",[tag("strong","",lang("Product colors"))]),tag("div","col-12",[tag("div","pf-mt-4 pf-mb-0",[this._renderColorSwatches()])])]):"",this._shouldShowTechnique()?tag("div","row pf-mt-24",[tag("div","col-12",[tag("strong","",lang("Technique"))]),tag("div","col-12",[tag("p","pf-mt-4 pf-mb-0 pf-text-muted",this._getTechnique())])]):"",tag("div","row pf-mt-24",[tag("div","col-12",[tag("strong","",lang("Print files"))]),tag("div","col-12",[tag("p","pf-mt-4 pf-mb-0 pf-text-muted",this._getPlacements())])]),this._sizesSectionNode=tag("div","row pf-mt-24")])])]),this.footer=tag("div","footer-block navigation__sticky-buttons ",[tag("div","container-fluid",[tag("div","row pf-flex-column-reverse pf-flex-md-row",[tag("div","col-12 col-md-6 text-left pf-mt-12 pf-mt-md-0 pf-d-flex pf-align-items-center",[tag("a",{className:"pf-d-inline-block pf-d-md-none pf-btn pf-btn-secondary pf-btn-square pf-mr-12",onclick:this._onBack},[tag("i","pf-i pf-i-chevron-left pf-i-24")]),tag("a",{className:"pf-d-none pf-d-md-inline-block pf-btn pf-btn-secondary pf-mr-12",onclick:this._onBack},this._par.prevText),this.saveNode=tag("a",{className:"pf-btn pf-btn-primary grow-1 grow-md-0",onclick:this._onSave},this._par.nextText)]),tag("div","col-12 col-md-6 text-right",[tag("div","variant-picker-footer__price variant-picker-footer__price--smaller",[this._setPrice(this._par.designData.product)]),tag("p","pf-ui-caption pf-text-muted pf-mt-2 pf-mb-0",[lang("Excl. taxes and other charges")])])])])]),this._createOrDestroySizePicker()},_productHasColorPicker:function(){return this._par.designData.canHaveColorPicker()},_shouldShowTechnique:function(){return this._par.designData.product.hasMultipleTechniques()},getContent:function(){return this.node},getFooter:function(){return this.footer},_renderColorSwatches:function(){var t={},e=this._par.designData.colors.slice();return this._par.designData.hexColors.slice().forEach(function(n){var r=e.shift();t[r]=n}.bind(this)),new PF.Components.SmallColorSwatches({colorMap:t})},_getTechnique:function(){return PF.Items.ProductItem.LABELS[this._par.designData.technique]||this._par.designData.technique},_getPlacements:function(){var t=Object.values(this._par.designData.templates),e=this._par.designData.rawPlacementOptions,n=t.map((function(t){var n=t.placementId,r=t.placementName,i=e.find((function(t){return t.placement===n}));return new PF.Components.PlacementSVGPopoverLink({linkText:r,template:t,placementOptions:i?i.options:null,linkClasses:"pf-text-muted pf-pointer"})})),r=[];return n.forEach((function(t){r.push(t),r.push(", ")})),r.pop(),r},_setPrice:function(t){return t.getDisplayPriceString()},_onTitleChange:function(t){clearTimeout(this._onTitleChangeEventTimeoutId),this._onTitleChangeEventTimeoutId=setTimeout(function(){this._par.designData.title=t.target.value+""}.bind(this),50)},_onSizesChanged:function(){if(this._sizePicker){var t=this._sizePicker.selectedSizes;this._par.designData.templateSelectedSizes=t||[],t&&t.length||this._createOrDestroySizePicker()}},_createOrDestroySizePicker:function(){var t=this._par.designData.templateSelectedSizes||[];if(t&&t.length>0){if(!this._sizePicker){var e=new PF.ProductPush.Pickers.Params;e.values=this._par.designData.product.sizes,e.selectedValues=this._par.designData.templateSelectedSizes,e.onChangedCallback=this._onSizesChanged,e.designData=this._par.designData,e.productId=this._par.designData.productId,e.isSizeNodeTitleVisible=!1;this._sizePicker=new PF.ProductPush.SizePicker(e,{allowNoSelectedSizes:!0})}}else this._sizePicker=null;this._renderSizeSection()},_onSizesToggle:function(){var t=this._par.designData.templateSelectedSizes||[],e=t&&t.length>0;this._par.designData.templateSelectedSizes=e?[]:this._par.designData.product.sizes.slice(0,1),this._createOrDestroySizePicker()},_renderSizeSection:function(){mkE.clearNode(this._sizesSectionNode);var t=this._par.designData.templateSelectedSizes||[];if(this._par.designData.product.sizes.filter((function(t){return!!t})).length>0)if(this._productHasColorPicker()){var e=t&&t.length>0,n=e?lang("Remove"):lang("Add sizes"),r=e?this._sizePicker:"",i=tag("a",{onclick:this._onSizesToggle.bind(this)},n);[tag("div","col-12",[tag("strong","",lang("Sizes")),e?tag("span",null,[" ",i]):""]),tag("div","col-12",[r,e?"":i])].forEach(function(t){t.append(this._sizesSectionNode)}.bind(this))}else[tag("div","col-12",[tag("strong","",lang("Sizes"))]),tag("div","col-12",[tag("span","pf-text-muted",[t.join(", ")])])].forEach(function(t){t.append(this._sizesSectionNode)}.bind(this))},enableSaveNode:function(){this.saveNode&&mkE.removeClassName(this.saveNode,"disabled")},_onSave:function(){this.saveNode&&mkE.addClassName(this.saveNode,"disabled"),this._par.onSave()},_onBack:function(){this._par.onBack()},getCurrentDesignData:function(){return this._par.designData},getCurrentGeneratorParams:function(){return this._par.generatorParams},_getMainMockup:function(){var t=this._par.designData.generatorVariants[0];return this._par.designData.getMockupPreview(t,320,320)}})}()},YBdB:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,c=1,l={},u=!1,d=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){g(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){g(t.data)},r=function(t){o.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(t){var e=d.createElement("script");e.onreadystatechange=function(){g(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(g,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&g(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return l[c]=i,r(c),c++},p.clearImmediate=h}function h(t){delete l[t]}function g(t){if(u)setTimeout(g,0,t);else{var e=l[t];if(e){u=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{h(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n("yLpj"),n("8oxB"))},YSCK:function(t,e){!function(){"use strict";PF.ProductTemplates.StoreFlowInitializer.Par=Class({store:void 0,productTemplate:void 0,flowType:void 0}),PF.ProductTemplates.StoreFlowInitializer.Par.FLOW_TYPES=Object.freeze({FLOW_PUSH:"FLOW_PUSH",FLOW_ORDER:"FLOW_ORDER"})}()},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},elN9:function(t,e){!function(){"use strict";PF.ProductTemplates.TemplateDesignerState=Class({templates:void 0,colors:void 0,sizes:void 0,title:void 0,productOptions:void 0,__construct:function(t){this.templates=t.templates,this.colors=t.colors,this.sizes=t.sizes,this.title=t.title,this.productOptions=t.productOptions}})}()},mTkf:function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"g",(function(){return h})),n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return f})),n.d(e,"h",(function(){return m}));var r=n("CXOy"),i=n("LvDl"),o=n.n(i),a=n("Cc5H"),s=n("oCYn");function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t){switch(t){case r.h.CREATED_DATE_ASC:return{type:r.c.CREATED_DATE,dir:r.b.ASC};case r.h.CREATED_DATE_DESC:return{type:r.c.CREATED_DATE,dir:r.b.DESC};case r.h.UPDATED_DATE_ASC:return{type:r.c.UPDATED_DATE,dir:r.b.ASC};case r.h.UPDATED_DATE_DESC:return{type:r.c.UPDATED_DATE,dir:r.b.DESC};case r.h.TITLE_ASC:return{type:r.c.TITLE,dir:r.b.ASC};case r.h.TITLE_DESC:return{type:r.c.TITLE,dir:r.b.DESC}}return null}function u(t,e){if(e===r.b.ASC)switch(t){case r.c.CREATED_DATE:return r.h.CREATED_DATE_ASC;case r.c.UPDATED_DATE:return r.h.UPDATED_DATE_ASC;case r.c.TITLE:return r.h.TITLE_ASC}else if(e===r.b.DESC)switch(t){case r.c.CREATED_DATE:return r.h.CREATED_DATE_DESC;case r.c.UPDATED_DATE:return r.h.UPDATED_DATE_DESC;case r.c.TITLE:return r.h.TITLE_DESC}return null}function d(t,e){if(!e)return t;if(e.sortBy&&(Object.values(r.c).includes(e.sortBy)||(e.sortBy=r.c.CREATED_DATE)),e.sortDir&&(Object.values(r.b).includes(e.sortDir)||(e.sortDir=r.b.DESC)),e.page){var n=parseInt(e.page+"");(!n||n<0)&&(n=1),e.page=n}return new r.d(o.a.merge({},t||{},e))}function p(t,e){return new Promise((function(n,r){var i=new PF.Components.SvgThumb.Par;i.template=t.getTemplate(e).shift(),i.async=!0,t.placementOptions&&(i.placementOptions=t.placementOptions.getOptionsForPlacement(e)),i.onSvgProcessedCallback=function(t){n(t)};try{new PF.Components.SvgThumb(i)}catch(t){r(t)}}))}function h(t){return!t.getters[a.h](r.f.FLAG_KEYS.IS_LOADING)&&(t.commit(a.s,{key:r.f.FLAG_KEYS.IS_LOADING,value:!0}),!0)}function g(t,e){e&&e.responseFlags&&Object.keys(e.responseFlags).forEach((function(n){t.commit(a.s,{key:n,value:e.responseFlags[n]})}))}function f(t,e){if(e){t.commit(a.n,{items:e.items});var n=(e.items||[]).map((function(t){return t.id})),i=new r.e({itemIds:c(n),page:e.page,totalPages:e.pages,totalItems:e.total,filter:e.usedFilter,itemsPerPage:e.itemsPerPage});e.responseFlags&&g(t,e),t.commit(a.t,{metadata:i}),t.commit(a.s,{key:r.f.FLAG_KEYS.IS_LOADING,shouldUnset:!0})}else t.commit(a.s,{key:r.f.FLAG_KEYS.IS_LOADING,shouldUnset:!0})}function m(t,e){var n,i;if((null===(n=t.currentItemsResponseMetadata)||void 0===n?void 0:n.itemIds)&&(null===(i=t.filter)||void 0===i?void 0:i.sortBy)&&t.itemRepository&&e){var o=t.currentItemsResponseMetadata.itemIds;if(-1===o.indexOf(e.id)){var a=o.map((function(e){return t.itemRepository[e]})).filter((function(t){return!!t}));if(o.length!==a.length)throw new Error("ItemRepository and current itemIds mismatch!");a.push(e);var c=t.filter;switch(c.sortBy){case r.c.CREATED_DATE:case r.c.UPDATED_DATE:var l=c.sortBy===r.c.CREATED_DATE?"createdAt":"updatedAt";a.sort((function(t,e){return t[l]||e[l]?t[l]&&e[l]?t[l].isSame(e[l])?0:c.sortDir===r.b.ASC?t[l].isBefore(e[l])?-1:1:t[l].isBefore(e[l])?1:-1:t[l]?c.sortDir===r.b.ASC?-1:1:c.sortDir===r.b.ASC?1:-1:0}));break;case r.c.TITLE:a.sort((function(t,e){if(!t.title&&!e.title)return 0;if(!t.title||!e.title)return t.title?c.sortDir===r.b.ASC?-1:1:c.sortDir===r.b.ASC?1:-1;var n=t.title.localeCompare(e.title);return 0===n?0:c.sortDir===r.b.ASC?n<0?-1:1:n<0?1:-1}))}var u=t.currentItemsResponseMetadata.itemsPerPage,d=a.slice(0,u).map((function(t){return t.id}));s.a.set(t.currentItemsResponseMetadata,"itemIds",d)}}}},mwBX:function(t,e){!function(){"use strict";PF.ProductTemplates.EditorState=Class({sourceProductTemplate:null,existingTemplateInitState:null,flowType:null,useSimpleDesigner:null,isTemplateEditFlow:function(){return!this.flowType||this.flowType===PF.ProductTemplates.EditorState.FLOW_TYPES.TEMPLATE_EDIT},isProductCreateFlow:function(){return this.flowType&&this.flowType===PF.ProductTemplates.EditorState.FLOW_TYPES.CREATE_PRODUCT},isNewTemplateEditor:function(){return this.isTemplateEditFlow()&&(!this.sourceProductTemplate||!this.sourceProductTemplate.id)},isExistingTemplateEditor:function(){return this.isTemplateEditFlow()&&this.sourceProductTemplate&&this.sourceProductTemplate.id},toRPCData:function(){return{sourceProductTemplateId:this.sourceProductTemplate?this.sourceProductTemplate.id:null,flowType:this.flowType||PF.ProductTemplates.EditorState.FLOW_TYPES.TEMPLATE_EDIT}}}),PF.ProductTemplates.EditorState.FLOW_TYPES=Object.freeze({TEMPLATE_EDIT:"TEMPLATE_EDIT",CREATE_PRODUCT:"CREATE_PRODUCT"})}()},wy2R:function(t,e){t.exports=moment},yLpj:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n}},[[37,0,3,5]]]);