(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{23:function(e,t,i){i("bJ+N"),i("V5fh"),i("VKqq"),i("t5kI"),i("H5D6"),i("2ovl"),i("r6K3"),i("wQ4t"),i("JM6l"),i("bvdp"),i("UlqT"),i("hh1a"),i("BK9/"),i("t2vt"),i("rrge"),i("Lrar"),i("aRUU"),i("pnlN"),i("el0J"),i("hdhN"),i("dFzF"),e.exports=i("7wy1")},"2ovl":function(e,t){!function(){"use strict";PF.MockupGenerator.Memory=Class({placementFiles:{},_templates:{},productId:0,_storageTemplatesKey:"mockupGeneratorTemplates",_storagePlacementFilesKey:"mockupGeneratorPlacementFiles",_storage:window.sessionStorage,__construct:function(e){this._productId=e},loadFromStorage:function(e){var t=this._storage.getItem(this._storageTemplatesKey);if(this._storage.removeItem(this._storageTemplatesKey),t){var i=JSON.parse(t);if(i=i[this._productId]){var n={};for(var r in i){var a=i[r];for(var o in a.layers){var s=a.layers[o];n[s.fileId]=s.fileId}}(new PF.Repositories.LibraryRepository).getByIds(Object.keys(n),this._onFilesLoaded.bind(this,i,e),!1)}}},_onFilesLoaded:function(e,t){for(var i in this._templates={},e)this._templates[i]=PF.Items.GeneratorTemplateItem.fromArray(e[i]);var n=this._getPlacementFiles();this._storage.removeItem(this._storagePlacementFilesKey),t(this._templates,n)},rememberTemplates:function(e){this._templates=e.templates,this._placementFiles=e.filesIdsByPlacement,this._savePlacementFilesToStorage(),this._saveTemplatesToStorage()},_savePlacementFilesToStorage:function(){var e={};if(e[this._productId]=[],this._placementFiles){e[this._productId]=this._placementFiles;try{this._storage.setItem(this._storagePlacementFilesKey,JSON.stringify(e))}catch(e){this._showAlert()}}},_saveTemplatesToStorage:function(){var e=[],t={};if(t[this._productId]=[],!$.isEmptyObject(this._templates)){for(var i in this._templates)e.push(this._templates[i].toArray());t[this._productId]=e;try{this._storage.setItem(this._storageTemplatesKey,JSON.stringify(t))}catch(e){this._showAlert()}}},_getPlacementFiles:function(){var e=new PF.ProductPush.PlacementFiles,t=this._storage.getItem(this._storagePlacementFilesKey),i=(JSON.parse(t)||{})[this._productId];for(var n in i)for(var r in i[n]){var a=new PF.Items.GeneratorPlacement;a.id=n,e.addFile(a,(new PF.Repositories.LibraryRepository).getCachedFile(i[n][r]))}return e},_clearStorage:function(){try{this._storage.setItem(this._storageTemplatesKey,JSON.stringify({})),this._storage.setItem(this._storagePlacementFilesKey,JSON.stringify({}))}catch(e){this._showAlert()}},hasPositions:function(){var e=this._storage.getItem(this._storageTemplatesKey);if(e&&JSON.parse(e)[this._productId])return!0;return!1},_showAlert:function(){alert(dlang("generator","You are in a Private/Incognito Mode. It does not support storing settings locally."))}})}()},"7wy1":function(e,t){!function(){"use strict";PF.MockupGenerator.OrderPreview.Row.Par=Class({title:null,color:null,size:null,generatorVariant:null,designData:null,variants:[],selectedVariant:null,onVariantSelected:null})}()},"BK9/":function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker.Par=Class({rowTitle:"",itemTitle:{text:"",isVisible:!1},content:null,item:null,onChangedCallback:null,overlay:{},designData:{},onNodeClickCallback:null,isRadio:!1,isChecked:!1,setActiveItemCallback:null,activeItems:null,inactiveItems:null,isMockupUpdate:!1})}()},H5D6:function(e,t){!function(){"use strict";PF.MockupGenerator.FileName=Class({_input:null,__construct:function(e,t,i){this._filename=e,this._suffix=t,this._callback=i,this.node=mkE({tag:"div",className:"file-name"}),this._renderEditable()},_getFullFilename:function(){return this._filename?this._filename+"_"+this._suffix:this._suffix},_renderEditable:function(){mkE.clearNode(this.node);var e=mkE({tag:"a",className:"icon-edit edit-icons",style:{color:"#a7a7a7",position:"relative",top:"1px"},onclick:this._renderEditing,title:lang("Edit file name")});$(e).tooltip({html:!0}),mkE({tag:"div",els:[this._getFullFilename()+" ",e]}).append(this.node)},_renderEditing:function(){mkE.clearNode(this.node),this._input=mkE({tag:"input",type:"text",value:this._filename,attr:{maxLength:100},prop:{onkeydown:this._onEditKeyDown,onkeyup:this._onEditKeyUp,onblur:this._approveEditedName},style:{height:"39px",width:"250px",display:"inline-block"}}),mkE({tag:"div",els:[this._input,{tag:"span",text:"_"+this._suffix,style:{display:"inline-block"}}]}).append(this.node),this._input.select()},_onEditKeyUp:function(e){e.stopPropagation(),27==e.keyCode&&(this._input.onblur=null,this._renderEditable())},_onEditKeyDown:function(e){e.stopPropagation(),13==e.keyCode&&(e.preventDefault(),this._input.onblur=null,this._approveEditedName())},_approveEditedName:function(){this._filename=$.trim(this._input.value),this._callback&&this._callback(this._filename),this._renderEditable()},getValue:function(){return this._filename}},mkE.Base)}()},JM6l:function(e,t){!function(){"use strict";PF.MockupGenerator.SaveFilesToLibrary=Class({__construct:function(e,t,i){if(this._productId=t,this._files=e,this._onSavedCallback=i,PF.Customer.isLogged()){var n=new PF.Components.StorePicker.Par;n.callback=this._onStorePicked,this._modal=PF.Components.StorePicker.popup(n,dlang("generator","Choose store to save to…"))}else this._requireUserLogin()},_requireUserLogin:function(){var e=[];for(var t in this._files)e.push(this._files[t].toArray());sessionStorage&&(sessionStorage.setItem(PF.MockupGenerator.SaveFilesToLibrary._keyFileData,JSON.stringify(e)),sessionStorage.setItem(PF.MockupGenerator.SaveFilesToLibrary._keyProductId,JSON.stringify(this._productId)));var i=new Url;i.query.completeSave=1;var n=PF.Components.SignUpPopup.Par;n.returnUrl=i.path+"?"+i.query.toString(),n.signUpContent=[[tag("span",{innerHTML:dlang("generator","Download print file <strong>templates </strong>and <strong>mockups</strong>")})],[tag("span",{innerHTML:dlang("generator","Store <strong>design ideas </strong>in one place")})],[tag("span",{innerHTML:dlang("generator","Get notifications about our <strong>latest products</strong>")})]],n.signInContent=[dlang("generator","Please sign in to save mockups.")],new PF.Components.SignUpPopup(n)},_onStorePicked:function(e){PF.LoadingOverlay.show(this._modal.getContentNode());var t=(new PF.Repositories.Products).getCachedProductById(this._productId);(new PF.Repositories.GeneratorRepository).saveToLibrary(this._files,e,t.type,this._onTaskCreated)},_onTaskCreated:function(e){this._modal.remove(),this._onSavedCallback(e)}}),PF.MockupGenerator.SaveFilesToLibrary.completeSave=function(e){var t=sessionStorage.getItem(PF.MockupGenerator.SaveFilesToLibrary._keyFileData),i=JSON.parse(sessionStorage.getItem(PF.MockupGenerator.SaveFilesToLibrary._keyProductId));if(t){sessionStorage.removeItem(PF.MockupGenerator.SaveFilesToLibrary._keyFileData),sessionStorage.removeItem(PF.MockupGenerator.SaveFilesToLibrary._keyProductId);var n=JSON.parse(t),r=[];for(var a in n)r.push(PF.Items.GeneratorDownloadItem.fromArray(n[a]));new PF.MockupGenerator.SaveFilesToLibrary(r,i,(function(){e&&e(),alert(dlang("generator",'Files were saved to your library! You can access it by going to the main site and then clicking on "Print files" in the menu.'))}))}},PF.MockupGenerator.SaveFilesToLibrary._keyFileData="mockupSave",PF.MockupGenerator.SaveFilesToLibrary._keyProductId="mockupSaveProductId"}()},Lrar:function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker.Row.Par=Class({__NAME:"PF.MockupGenerator.GeneratorPicker.Row.Par",title:"",items:null,onChanged:null,generatorParams:null,designData:null,activeItems:[],inactiveItems:[],isPrintfiles:!1})}()},UlqT:function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker=Class({__NAME:"PF.MockupGenerator.GeneratorPicker",_generatorParams:null,_rows:[],_mainGroupItems:[],_activeItems:[],_inactiveItems:[],__construct:function(e,t,i){this._onChange=i,this._generatorParams=t,this._designData=e,this.node=tag("div","",[tag("div",{className:"whitesmoke pf-pb-40 clearfix",style:{borderBottom:"1px solid #E5E5E5"}},[this._mockupNode=tag("div","container"),this._photificNode=tag("div")]),tag("div","container",[this._groupsOuterNode=tag("div"),this._groupsPrinfileNode=tag("div")])]),this._render()},_render:function(){this._renderMainMockupGroups(),this._renderPhotificInfo(),this._renderMockupGroups(),this._renderTemplateFiles()},_renderTemplateFiles:function(){if(mkE.clearNode(this._groupsPrinfileNode),!this._designData.product.isJewelry()){var e=new PF.MockupGenerator.GeneratorPicker.Row.Par;e.title=this._designData.isEmbroidery()?dclang("generator","type","Embroidery files"):dclang("generator","type","Print Files"),e.items=this._designData.templates,e.onChanged=this._onRowChanged,e.generatorParams=this._generatorParams,e.designData=this._designData,e.activeItems=this._activeItems,e.inactiveItems=this._inactiveItems,e.isPrintfiles=!0;var t=new PF.MockupGenerator.GeneratorPicker.Row(e);this._rows.push(t),t.append(this._groupsPrinfileNode)}},_getGeneratorMockupPreview:function(e,t){return this._designData.getMockupPreview(e,t.maxWidth,t.maxHeight)},_filterMainGroup:function(e){return!!this._generatorParams.getGeneratorVariant(this._variantFilter.getDefaultGroupVariantId(e))},_mapMainGroupItems:function(e,t){var i=new PF.MockupGenerator.GeneratorPicker.Par;return i.itemTitle.text=e,i.itemTitle.isVisible=!0,i.isRadio=!1,i.isChecked=0===t,i.onNodeClickCallback=this._onMockupClick,i.mockupPreview=this._getGeneratorMockupPreview,i.generatorVariant=this._generatorParams.getGeneratorVariant(this._variantFilter.getDefaultGroupVariantId(e)),i.productId=this._designData.productId,new PF.MockupGenerator.GeneratorPicker.MainGroupItem(i)},_renderMainMockupGroups:function(){mkE.clearNode(this._mockupNode),this._variantFilter=new PF.ProductPush.VariantFilter(this._designData,this._generatorParams),this._mainGroups=this._variantFilter.getGroupedMockupVariants(),this._mainGroupItems=Object.keys(this._mainGroups).filter(this._filterMainGroup.bind(this)).map(this._mapMainGroupItems.bind(this)),tag("div","pf-mt-16 generator-picker__main-group",this._mainGroupItems).append(this._mockupNode),window.onresize=this._onResizeMainItems},_renderPhotificInfo:function(){mkE.clearNode(this._photificNode),tag("div","container text-center clearfix",[tag("div",{className:"pf-ui-body text-center pf-text-muted hide-empty",style:{marginTop:"36px",marginBottom:"-4px"},innerHTML:this._generatorParams.getPhotificInfoText(this._designData.productId)})]).append(this._photificNode)},_onResizeMainItems:function(){this._mainGroupItems.map((function(e){e._onResize()}))},_renderMockupGroups:function(){mkE.clearNode(this._groupsOuterNode);var e={};this._mainGroupItems.filter((function(e){return e.isChecked()})).forEach(function(t){var i=this._mainGroups[t.getGroupName()];Object.keys(i).forEach((function(t){e[t]||(e[t]=[]),e[t]=e[t].concat(i[t])}))}.bind(this)),this._rows=Object.keys(e).map(function(t){var i=new PF.MockupGenerator.GeneratorPicker.Row.Par;return i.title=t,i.items=e[t],i.onChanged=this._onRowChanged,i.generatorParams=this._generatorParams,i.designData=this._designData,i.activeItems=this._activeItems,i.inactiveItems=this._inactiveItems,i.isPrintfiles=!1,new PF.MockupGenerator.GeneratorPicker.Row(i)}.bind(this)),tag("div","",this._rows).append(this._groupsOuterNode)},_onMockupClick:function(e){e.setCheckedState(!e.isChecked()),this._designData.defaultGeneratorVariantId=e._par.generatorVariant.generatorVariantId,this._designData.generatorVariantsIdsToSave=new PF.ProductPush.VariantFilter(this._designData,this._generatorParams).getGroupMockupVariantIds(e.getGroupName()),this._renderMockupGroups(),this._renderTemplateFiles(),this._onMainMockupChanged()},_onMainMockupChanged:function(){this._onChange()},_onRowChanged:function(){this._onChange()},getSelectedCount:function(){return this.getSelectedTemplates().length+this.getSelectedVariants().length},getCount:function(){var e=0;return this._rows.forEach((function(t){e+=t.getCount()})),e},getSelectedTemplates:function(){var e=[];for(var t in this._rows)e=e.concat(this._rows[t].getSelectedTemplates());return e},getSelectedVariants:function(){var e=[];for(var t in this._rows)e=e.concat(this._rows[t].getSelectedVariants());return e}},mkE.Base)}()},V5fh:function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value}function s(e,t,i){if(e!==t)throw new TypeError("Private static access of wrong provenance");return i}function c(e,t,i){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return i}i.r(t);var d=function(){function e(t){r(this,e),u.add(this),h.add(this),l.set(this,{writable:!0,value:void 0}),function(e,t,i){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,i);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=i}}(this,l,t),c(this,h,_).call(this),this.modal.show()}var t,i,n;return t=e,(i=[{key:"close",value:function(){this.modal&&this.modal.hide()}}])&&a(t.prototype,i),n&&a(t,n),e}(),l=new WeakMap,h=new WeakSet,u=new WeakSet,p=function(e){return tag("li","",[tag("img",{src:PF.ASSETS_URL+"images/icons/bullet-point-green.svg",style:{width:"17px",height:"15px",position:"absolute",marginTop:"3px"}}),tag("div","",e)])},_=function(){var e=new PF.Modal.Par;e.title=lang("Save as template or download files"),this.modal=new PF.Modal(e),this.modal.setContent(c(this,u,g).call(this))},g=function(){return tag("div","mockup-generator-auth-popup-container",[tag("div","row mockup-generator-auth-popup-container__row",[tag("div","col-sm-6",[tag("div",{className:"mockup-generator-auth-popup-container__box mockup-generator-auth-popup-container__box--thick"},[tag("div","mockup-generator-auth-popup-container__header",[tag("strong",null,lang("Sign up and save template"))]),tag("div","container",[tag("div","row",[tag("div","mockup-generator-auth-popup-container__content pf-py-24",[tag("ul","pf-p-0",[s(d,d,p).call(d,lang("Create products faster")),s(d,d,p).call(d,lang("Push products to 14+ ecommerce platforms")),s(d,d,p).call(d,lang("Edit product templates as needed"))])])]),tag("div","row",[tag("div","col-12 pf-px-16",[tag("a",{className:"btn btn-danger mockup-generator-auth-popup-container__btn",onclick:o(this,l).onSignupCallback},[lang("Sign up and save")])])]),tag("div","row",[tag("div","mockup-generator-auth-popup-container__login pf-py-16",[tag("a",{className:"",onclick:o(this,l).onAuthCallback},dlang("site","I already have an account"))])])])])]),tag("div","col-sm-6",[tag("div","mockup-generator-auth-popup-container__box container",[tag("div","row",[tag("div","mockup-generator-auth-popup-container__header",[lang("Download files")])]),tag("div","text-center mockup-generator-auth-popup-container__content mockup-generator-auth-popup-container__content--download row",[tag("div","pf-px-16",lang("Generate mockups and files for download"))]),tag("div","row",[tag("div","col-12 pf-px-16",[tag("a",{className:"btn btn-default mockup-generator-auth-popup-container__btn pf-mb-16",onclick:o(this,l).onDownloadCallback},[lang("Download files")])])])])])])])},m=function e(){r(this,e),n(this,"onSignupCallback",void 0),n(this,"onAuthCallback",void 0),n(this,"onDownloadCallback",void 0)};PF.MockupGenerator.Designer=Class({__construct:function(e){if(this._product=e,this.node=mkE({tag:"div",className:"margin-bottom-50",els:[this._nodeBackWrapper=mkE({tag:"div",className:"padding-top-30 padding-bottom-10",els:[{tag:"div",className:"container",els:[this._nodeBack=mkE({tag:"a",className:"pf-link",innerHTML:"&larr; "+dclang("generator","Button text to return back to editing a design","Back to edit"),href:"javascript:",onclick:this._showDesigner})]}]}),this._nodeContainer=mkE({tag:"div"})]}),PF.MockupGenerator.Tracking.trackViewDesigner(),(new Url).query.completeSave)PF.MockupGenerator.SaveFilesToLibrary.completeSave(this._showDesigner),PF.MockupGenerator.Tracking.trackCompleteFileSavingAfterLogin();else if(PF.Customer.isLogged()&&(new Url).query.transferFiles){(new PF.Repositories.StoreRepository).getFirstId(this._onStorePickedForFiles.bind(this));var t=new Url;delete t.query.transferFiles,history.replaceState("",document.title,t.toString())}else this._showDesigner()},_showDownload:function(e,t){mkE.clearNode(this._nodeContainer),this._nodeBack.innerHTML="&larr; "+dclang("generator","Button text to return back to editing a design","Back to edit"),this._nodeBack.onclick=this._showDesigner,this._nodeBack.href="javascript:",mkE.removeClassName(this._nodeBack,"hidden"),mkE.addClassName(this._nodeBackWrapper,"whitesmoke"),mkE.removeClassName(this._nodeContainer,"container"),this._nodeDownload=new PF.MockupGenerator.Download(e,t,this._showDesigner,this._templatePreferredGeneratorVariants).append(this._nodeContainer),this._nodeDownload.getDynamicStickyFooter().updateFooterStickyState()},_showDesigner:function(){if(this._nodeDownload&&(this._nodeDownload.getDynamicStickyFooter().detach(),mkE.removeNode(this._nodeDownload)),mkE.clearNode(this._nodeContainer),mkE.addClassName(this._nodeContainer,"container"),mkE.addClassName(this._nodeBack,"hidden"),mkE.removeClassName(this._nodeBackWrapper,"whitesmoke"),this._nodeBack.innerHTML=dlang("generator","&larr; Back to all models"),this._nodeBack.className="pf-link hide-on-zoom-in",this._nodeBack.onclick=null,setTimeout($.proxy((function(){this._nodeBack.href=this._product.getMockupGeneratorModelsUrl()}),this),10),this._designer)this._appendDesignerToNodeContainer();else{var e=new PF.ProductPush.Designer.Par;e.isMockupGeneratorMode=!0,e.store=new PF.Items.StoreItem,e.product=this._product,e.ctaText=PF.Customer.isLogged()?dlang("generator","Generate files"):lang("Continue"),e.onProductDesigned=this._onProductDesigned,e.withGlobalDropZone=!0,this._createDesigner(e)}this._designer&&this._designer.registerReplaceableParent(this._nodeContainer)},_createDesigner:function(e){this._designer=new PF.ProductPush.Designer(e),this._appendDesignerToNodeContainer()},_appendDesignerToNodeContainer:function(){this._designer.append(this._nodeContainer),this._designer.getDynamicStickyFooter()&&this._designer.getDynamicStickyFooter().updateFooterStickyState()},_onProductDesigned:function(e,t){this._templatePreferredGeneratorVariants=t,PF.Customer.isLogged()?this._showDownload(e,this._designer.getGeneratorParams()):this._showAuthModal(e)},_showAuthModal:function(e){var t=new m;t.onDownloadCallback=this._popupDownloadCallback.bind(this,e),t.onSignupCallback=this._popupSignupCallback.bind(this,e),t.onAuthCallback=this._popupAuthCallback.bind(this,e),this.authModal=new d(t)},_popupSignupCallback:function(e){this._rememberDesignData(e,(function(){document.location=langUrl("/auth/register")+"?returnUrl="+encodeURIComponent(langUrl("/dashboard/product-templates/create-from-saved-design-data"))}))},_popupAuthCallback:function(e){this._rememberDesignData(e,(function(){document.location=langUrl("/auth")+"?returnUrl="+encodeURIComponent(langUrl("/dashboard/product-templates/create-from-saved-design-data"))}))},_rememberDesignData:function(e,t){RPC("product-generator/remember-design-data",{designData:e.toArray()},(function(){return t&&t()}))},_popupDownloadCallback:function(e){this.authModal.close(),this._showDownload(e,this._designer.getGeneratorParams())},_onProceedCallback:function(e){this._showDownload(e,this._designer.getGeneratorParams())},_onStorePickedForFiles:function(e){if(e==PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID){var t=new PF.Components.StorePicker.Par;t.forceCreate=!0,t.callback=function(e){(new PF.Repositories.GeneratorRepository).transferAnonymousFilesToStore(e,this._showDesigner.bind(this))}.bind(this),t.closeOnClick=!1,PF.Components.StorePicker.popup(t,dlang("generator","Create new store where to save files..."))}else(new PF.Repositories.GeneratorRepository).transferAnonymousFilesToStore(e,this._showDesigner.bind(this))},append:function(e){return this.node.append(e),this._designer.getDynamicStickyFooter()&&this._designer.getDynamicStickyFooter().updateFooterStickyState(),this}},mkE.Base)},VKqq:function(e,t){!function(){"use strict";PF.MockupGenerator.Download=Class({_designData:null,_isCurrentlyGenerating:!1,_filesGenerated:[],_filesGeneratedByFormat:{png:[],jpg:[]},_hasAlreadyClickedGenerate:!1,_hasAlreadyClickedDownload:!1,_nodeFooter:null,_dynamicStickyFooter:null,__construct:function(e,t,i,n){this._designData=e,this._editDesignCallback=i,this._generatorParams=t,this._templatePreferredGeneratorVariants=n,this._product=(new PF.Repositories.Products).getCachedProductById(this._designData.productId),this._picker=new PF.MockupGenerator.GeneratorPicker(e,t,this._onPickedChange),this._filenameEditor=new PF.MockupGenerator.FileName(this._generateFilename(),"variation",this._onFilenameChanged),this.node=tag("div",null,[tag("div","whitesmoke ",[tag("div","container text-center mockup-generator__head-titles clearfix",[tag("h2","text-center pf-m-0",dlang("generator","Choose mockup style")),tag("h4","subheading regular",this._product.getFullTitle())])]),tag("div","pf-mb-48",[this._picker,tag("div","container",[tag("div","pf-my-16",[tag("strong",null,lang("File name")),this._filenameEditor,tag("div","pf-mt-40",[tag("strong",null,dlang("generator","Mockup format")),this._renderFileTypeSelection()])]),tag("div","pf-mt-64 pf-pt-32 pf-border-top",[tag("b",null,lang("All done here?")),tag("p",{innerHTML:dlang("generator",'<a href="{productUrl}" class="pf-link">Create a new product</a> or <a href="{designUrl}" class="pf-link">create a new design</a> for this product').replace("{productUrl}",langUrl("/generator")).replace("{designUrl}",this._product.getMockupGeneratorUrl())})])])]),this._nodeFooter=tag("div","navigation__sticky-buttons",[tag("div","container",[this._nodeGenerate=tag("a",{className:"pf-btn pf-btn-primary pf-mr-16",text:dlang("generator","Generate files"),onclick:this._generate}),this._nodeDownload=tag("a",{className:"pf-btn pf-btn-primary pf-mr-16 hidden sticky-buttons__download",onclick:this._prepareZipArchive},[this._nodeDownloadInnerText=tag("span","hidden-xs",lang("Download files")),this._nodeDownloadMobileInnertText=tag("span","sticky-buttons__download--mobile",lang("Download"))]),this._nodeSaveToLibrary=tag("a",{className:"pf-btn pf-btn-secondary pf-mr-0 pf-mr-sm-16 hidden",text:dlang("generator","Save to library"),onclick:this._saveToLibrary}),this._nodeOrderPreview=tag("a",{className:"pf-btn pf-btn-secondary",text:clang("To place an order (action)","Order"),onclick:this._initOrderPreview}),tag("span",{className:"pf-d-block pf-text-muted pf-ui-caption pf-mt-12",innerHTML:dlang("generator","By using our Mockup Generator you agree to Printful's {termsLinkBegin}Terms of Service{termsLinkEnd} and {policyLinkBegin}Privacy Policy{policyLinkEnd}.").replace("{termsLinkBegin}",'<a class="pf-link" href="'+langUrl("/policies/terms-of-service")+'" target="_blank">').replace("{termsLinkEnd}","</a>").replace("{policyLinkBegin}",'<a class="pf-link" href="'+langUrl("/policies/privacy")+'" target="_blank">').replace("{policyLinkEnd}","</a>")})])]),this.nodeOverlay=tag("div","mockup-generator__overlay")]),this._dynamicStickyFooter=new PF.MockupGenerator.Designer.DynamicStickyFooter(this._nodeFooter),PF.MockupGenerator.Tracking.trackViewDownloadPage()},_renderFileTypeSelection:function(){var e=new PF.Forms.RadioListPar;return e.name="fileType",e.options=[{value:"jpg",name:tag("div",{innerHTML:dlang("generator","<b>JPG</b> (smaller, your store will load faster)")})},{value:"png",name:tag("div",{innerHTML:dlang("generator","<b>PNG</b> (bulkier, but with a transparent background)")})}],e.value="png",e.prop={checked:"checked",onclick:this._handleFileTypeClick.bind(this)},e.isRequired=!0,this._fileChooser=new PF.Forms.RadioList(e),this._selectedFileType="png",tag("div","border-top-10",[this._fileChooser])},_handleFileTypeClick:function(){this._selectedFileType!==this._fileChooser.getValue()&&(this._filesGeneratedByFormat[this._selectedFileType]=this._filesGenerated,this._filesGenerated=this._filesGeneratedByFormat[this._fileChooser.getValue()],this._selectedFileType=this._fileChooser.getValue(),this._onPickedChange())},_generateFilename:function(){var e=[],t=new PF.Repositories.LibraryRepository;for(var i in this._designData.filesIdsByPlacement){var n=this._designData.filesIdsByPlacement[i];for(var r in n){var a=t.getCachedFile(n[r]).filename;a=a.slice(0,a.lastIndexOf(".")),e.indexOf(a)<0&&e.push(a)}}return e.join("_").substr(0,75)},_initOrderPreview:function(){var e=new PF.MockupGenerator.BundleOrderPreview.Par,t=new PF.ProductPush.DesignData;mkE.O2O(t,this._designData),e.designData=t,e.designData.generatorVariants=this._templatePreferredGeneratorVariants,e.generatorParams=this._generatorParams,e.editDesignCallback=this._editDesignCallback,new PF.MockupGenerator.BundleOrderPreview(e)},_saveToLibrary:function(){this._updateFileNames();var e=this._getGeneratedAndPickedFiles();new PF.MockupGenerator.SaveFilesToLibrary(e,this._designData.productId,this._onSavedToLibrary),this._rememberDesignData(),PF.MockupGenerator.Tracking.trackSaveToLibrary(e.length)},_onSavedToLibrary:function(){mkE.addClassName(this._nodeSaveToLibrary,"disabled"),this._nodeSaveToLibrary.textContent=dlang("generator","Files added to library")},_rememberDesignData:function(){new PF.MockupGenerator.Memory(this._designData.productId).rememberTemplates(this._designData)},_getGeneratedAndPickedFiles:function(){var e=this._picker.getSelectedTemplates(),t=this._picker.getSelectedVariants(),i=[];for(var n in this._updateFileNames(),this._filesGenerated){var r=this._filesGenerated[n];r.isPrintfile?this._isFileWithinTemplates(e,r)&&i.push(r):this._isFileWithinMockups(t,r)&&i.push(r)}return i},_updateFileNames:function(){var e=this._filenameEditor.getValue();for(var t in this._filesGenerated){var i=this._filesGenerated[t];i.filename=e+(e?"_":"")+i.generatedSuffix}},_isFileWithinTemplates:function(e,t){for(var i in e)if(e[i].generatorVariantId==t.generatorVariantId&&e[i].placementId==t.placementId)return!0;return!1},_isFileWithinMockups:function(e,t){for(var i in e)if(e[i].generatorVariantId==t.generatorVariantId)return!0;return!1},_generate:function(){PF.LoadingOverlay.show(this._nodeGenerate),mkE.addClassName(this.nodeOverlay,"overlay--active"),tag("div","spinner-block",[tag("i","pf-i pf-i-loading pf-i-spin pf-i-48"),this._nodeSpinnerStatus=tag("div","spinner-status pf-my-12 pf-ui-subheading")]).append(this.nodeOverlay),this._setGenerateProgress(PF.ProductPush.LiveMockups.PROCESSING_FILES_STATE),this._isCurrentlyGenerating=!0;var e=new PF.ProductPush.DesignData;mkE.O2O(e,this._designData),this._designData=e,this._designData.generatorVariantsIdsToSave=this._getGeneratorVariantIdsToGenerate(),this._designData.templateKeysToSave=this._getTemplateKeysToGenerate(),this._designData.isTransparent=this._getTransparency(),(new PF.Repositories.GeneratorRepository).generateMockups(this._designData,{onProgress:this._setGenerateProgress,onFailed:this._onGenerateFailed,onCompleted:this._onGenerationCompleted}),this._trackGenerateClick(this._designData.generatorVariantsIdsToSave.length+this._designData.templateKeysToSave.length)},_onGenerateFailed:function(){mkE.removeClassName(this.nodeOverlay,"overlay--active"),this._isCurrentlyGenerating=!1,this._showGenerateButtonState(),alert(dlang("generator","Generation failed, please try again. If this persists, please contact us devsupport@printful.com"))},_setGenerateProgress:function(e){if(mkE.addClassName(this._nodeGenerate,"disabled"),PF.Utils.isTouch())var t=PF.ProductPush.LiveMockups.getShortStatusMessage(e);else t=PF.ProductPush.LiveMockups.getStatusMessage(e);this._nodeGenerate.textContent=t,this._nodeSpinnerStatus.textContent=t,tag("i","pf-i pf-i-loading pf-i-spin pf-i-24 pf-ml-4").append(this._nodeGenerate)},_onGenerationCompleted:function(e){for(var t in mkE.removeClassName(this._nodeGenerate,"disabled"),mkE.removeClassName(this.nodeOverlay,"overlay--active"),mkE.clearNode(this.nodeOverlay),this._nodeGenerate.textContent=dlang("generator","Generate files"),this._isCurrentlyGenerating=!1,e)this._filesGenerated.push(e[t]);this._filesGenerated.length?this._showFilesGeneratedButtonState():alert(dlang("generator","Your mockups couldn't be generated. Please refresh this page and try again."))},_isEverythingAlreadyGenerated:function(){return this._getTemplateKeysToGenerate().length<1&&this._getGeneratorVariantIdsToGenerate().length<1},_getGeneratorVariantIdsToGenerate:function(){var e=[],t=this._picker.getSelectedVariants();for(var i in t)this._isMockupAlreadyGenerated(t[i])||e.push(t[i].generatorVariantId);return e},_getTemplateKeysToGenerate:function(){var e=[],t=this._picker.getSelectedTemplates();for(var i in t)this._isTemplateAlreadyGenerated(t[i])||e.push(t[i].getKey());return e},_getTransparency:function(){return"jpg"!==this._fileChooser.getValue()},_isMockupAlreadyGenerated:function(e){return!!this._findGeneratedFileFromMockupOrTemplate(e)},_isTemplateAlreadyGenerated:function(e){return!!this._findGeneratedFileFromMockupOrTemplate(e)},_findGeneratedFileFromMockupOrTemplate:function(e){for(var t in this._filesGenerated){var i=this._filesGenerated[t];if(e instanceof PF.Items.GeneratorVariantItem){if(i.isPrintfile)continue;if(i.generatorVariantId==e.generatorVariantId)return i}else{if(!(e instanceof PF.Items.GeneratorTemplateItem))throw"Unknown type given";if(!i.isPrintfile)continue;if(i.templateId==e.templateId||i.templateId==e.parentTemplateId)return i}}return null},_onFilenameChanged:function(){PF.MockupGenerator.Tracking.trackFilenameChanged(),this._onPickedChange()},_onPickedChange:function(){if(!this._isCurrentlyGenerating){var e=this._picker.getSelectedCount();e>0&&this._isEverythingAlreadyGenerated()?this._showFilesGeneratedButtonState():(this._showGenerateButtonState(),e?mkE.removeClassName(this._nodeGenerate,"disabled"):mkE.addClassName(this._nodeGenerate,"disabled"))}},_prepareZipArchive:function(){mkE.addClassName(this._nodeDownload,"disabled"),mkE.addClassName(this.nodeOverlay,"overlay--active"),this._nodeDownloadInnerText.textContent=lang("Creating an archive…"),this._nodeDownloadMobileInnertText.textContent="",tag("span","spinner").append(this._nodeDownloadInnerText),tag("span","spinner").append(this._nodeDownloadMobileInnertText),this._updateFileNames();var e=this._getGeneratedAndPickedFiles();(new PF.Repositories.ZipDownload).download(e,this._filenameEditor.getValue(),this._onZipFileReady),this._trackDownloadClick(e.length)},_onZipFileReady:function(e,t){this._nodeDownloadInnerText.textContent=(dlang("generator","Download files")+" ({fileSize}M)").replace("{fileSize}",Math.round(e.size/1024/1024)),this._nodeDownloadMobileInnertText.textContent=lang("Download"),mkE.removeClassName(this._nodeDownload,"disabled"),mkE.removeClassName(this.nodeOverlay,"overlay--active"),this._nodeDownload.href=t,this._nodeDownload.onclick=null,location.href=t},_showFilesGeneratedButtonState:function(){mkE.removeClassName(this._nodeDownload,"hidden"),mkE.addClassName(this._nodeGenerate,"hidden"),this._picker.getSelectedTemplates().length>0?(mkE.removeClassName(this._nodeSaveToLibrary,"hidden"),mkE.removeClassName(this._nodeSaveToLibrary,"disabled"),this._nodeSaveToLibrary.textContent=dlang("generator","Save to library")):mkE.addClassName(this._nodeSaveToLibrary,"hidden"),mkE.addClassName(this._nodeOrderPreview,"hidden-xs"),1==this._picker.getSelectedCount()?(this._nodeDownload.href="javascript:",this._nodeDownload.onclick=this._downloadPickGeneratedFiles,this._nodeDownloadInnerText.textContent=lang("Download file")):(this._nodeDownload.href="javascript:",this._nodeDownload.onclick=this._prepareZipArchive,this._nodeDownloadInnerText.textContent=lang("Download files"))},_downloadPickGeneratedFiles:function(){this._updateFileNames();var e=this._getGeneratedAndPickedFiles();for(var t in e)(new PF.Repositories.GeneratorRepository).getDownloadUrl(e[t],(function(e){document.location.href=e}));this._trackDownloadClick(1)},_showGenerateButtonState:function(){mkE.addClassName(this._nodeDownload,"hidden"),mkE.addClassName(this._nodeSaveToLibrary,"hidden"),mkE.removeClassName(this._nodeGenerate,"hidden"),this._nodeGenerate.textContent=lang("Generate files"),this._nodeDownloadInnerText.textContent=lang("Download files")},_trackDownloadClick:function(e){this._hasAlreadyClickedDownload||(this._hasAlreadyClickedDownload=!0,PF.MockupGenerator.Tracking.trackDownloadClick(e))},_trackGenerateClick:function(e){if(!this._hasAlreadyClickedGenerate){this._hasAlreadyClickedGenerate=!0,PF.MockupGenerator.Tracking.trackGenerateClick(e);var t=Math.floor(this._picker.getSelectedCount()/this._picker.getCount()*100);PF.MockupGenerator.Tracking.trackGeneratePercentClick(t)}},getDynamicStickyFooter:function(){return this._dynamicStickyFooter}},mkE.Base)}()},aRUU:function(e,t){!function(){"use strict";PF.MockupGenerator.BundleOrderPreview=Class({__construct:function(e){this._par=e||new PF.MockupGenerator.BundleOrderPreview.Par,beginOrderTracking("generator",this._par.designData.hasTextLayers()?" with text":""),this._shouldShowPopup(),this._proceedWithOrderPreview()},_shouldShowPopup:function(){return!PF.Customer.isLogged()},_showLoginPopup:function(){new PF.Components.GeneratorLoginPopup(this._proceedWithOrderPreview,this._onSignInCallback)},_proceedWithOrderPreview:function(){this._pickStore()},_pickStore:function(){if(PF.Customer.isLogged()){var e=new PF.Components.StorePicker.Par;e.callback=this._pickOrderType,PF.Components.StorePicker.popup(e,dlang("generator","Choose store to save to…"))}else this._pickOrderType(PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID)},_pickOrderType:function(e){console.log("Store ID: ",e);var t=PF.VariantPicker.SampleVariantAvailability;if(e!==PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID&&!t.containsDisallowedVariants(this._par.designData,this._par.generatorParams)&&t.canBeSampleOrder(this._par.designData)){var i=new PF.Modal,n=new PF.OrderTypePicker({types:[PF.OrderBegin.ORDER_TYPE_SAMPLE,PF.OrderBegin.ORDER_TYPE_BASIC],isSimpleBasicPanel:!0,callback:function(t,i){t.remove(),this._showOrderPreview(e,i)}.bind(this,i)});i.setTitle(lang("Start new order")),i.setContent(n),i.show()}else this._showOrderPreview(e,PF.OrderBegin.ORDER_TYPE_BASIC)},_showOrderPreview:function(e,t){ga("send","event","MockupGenerator","Clicked order","Product view");var i={modalNode:null},n=new PF.MockupGenerator.OrderPreview({designData:this._par.designData,generatorParams:this._par.generatorParams,onEditDesign:this._editDesign.bind(this,i),storeId:e,contentScrollable:!0,viewName:"Product view",onProductOptionsChanged:this._par.onChildComponentProductOptionsChanged,orderType:t});i.modalNode=new PF.Modal({closeOnClick:!1,onClose:n.raiseState.bind(n)}),i.modalNode.setFooterContent(n.getFooterNode()),i.modalNode.setTitle(dlang("generator","Confirm variations")),i.modalNode.setContent(n.node),i.modalNode.show()},_editDesign:function(e){e.modalNode&&e.modalNode.remove(),this._par.editDesignCallback&&this._par.editDesignCallback()},_onSignInCallback:function(){new PF.MockupGenerator.Memory(this._par.designData.productId).rememberTemplates(this._par.designData)}})}()},"bJ+N":function(e,t){!function(){"use strict";PF.MockupGenerator={}}()},bvdp:function(e,t){!function(){"use strict";PF.MockupGenerator.Tracking={_track:function(e,t,i){var n={hitType:"event",eventCategory:"MockupGenerator",eventAction:e};if(void 0!==t&&(n.eventLabel=t),void 0!==i&&(n.eventValue=i),PF.DEV){var r='Track MockupGenerator action "'+n.eventAction+'"';n.eventLabel&&(r+=" (label: "+n.eventLabel+")"),void 0!==n.eventValue&&(r+=" with value "+n.eventValue),console.log(r)}else ga("send",n)},_getCustomerLabel:function(){return PF.Customer.customerId>0?PF.Customer.createdAt+1800>moment().unix()?"Just registered":PF.Customer.createdAt+2592e3>moment().unix()?"New user":"Old user":"Anonymous"},trackEvent:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.BLOCKED_LABELS[e]||(i&&(this.BLOCKED_LABELS[e]=!0),PF.DEV&&console.log('Track GA Event "'+e+'": '+JSON.stringify(t)),window.dataLayer=window.dataLayer||[],dataLayer.push(t))},unblockEvent:function(e){delete this.BLOCKED_LABELS[e]},trackTransparencyWarningContinue:function(e){this.trackEvent("transparency-warning-continue",{event:"transparency-warning",eventCategory:"Generator transparency warning message",eventAction:"Continue button clicked",eventLabel:e||null})},trackViewDesigner:function(){PF.MockupGenerator.Tracking._track("View designer",PF.MockupGenerator.Tracking._getCustomerLabel())},trackViewDownloadPage:function(){PF.MockupGenerator.Tracking._track("View download page",PF.MockupGenerator.Tracking._getCustomerLabel())},trackGenerateClick:function(e){PF.MockupGenerator.Tracking._track("Clicked generate",PF.MockupGenerator.Tracking._getCustomerLabel(),e)},trackGeneratePercentClick:function(e){PF.MockupGenerator.Tracking._track("Percent of files generated",PF.MockupGenerator.Tracking._getCustomerLabel(),e)},trackDownloadClick:function(e){PF.MockupGenerator.Tracking._track("Clicked download",PF.MockupGenerator.Tracking._getCustomerLabel(),e)},trackSaveToLibrary:function(e){PF.MockupGenerator.Tracking._track("Save to library",PF.MockupGenerator.Tracking._getCustomerLabel(),e)},trackSingleFileCheckToggle:function(e,t){PF.MockupGenerator.Tracking._track(t?"Check one file to generate":"Un-check one file to generate",e)},trackFileRowCheckToggle:function(e,t){PF.MockupGenerator.Tracking._track(t?"Check row to generate":"Un-check row to generate",e)},trackFilenameChanged:function(){PF.MockupGenerator.Tracking._track("Filename changed",PF.MockupGenerator.Tracking._getCustomerLabel())},trackCompleteFileSavingAfterLogin:function(){PF.MockupGenerator.Tracking._track("Finish file saving after login",PF.MockupGenerator.Tracking._getCustomerLabel())},BLOCKED_LABELS:{}}}()},dFzF:function(e,t){!function(){"use strict";PF.MockupGenerator.OrderPreview.Row=Class({_sizePicker:null,__construct:function(e){this._par=e,this.node=tag("div","order-preview__row row"),this._initSizePicker(),this.render()},render:function(){mkE.clearNode(this.node),tag("div","col-xs-12 col-sm-4",[this._getImage(this._par.generatorVariant)]).append(this.node),tag("div","col-xs-12 col-sm-8",[tag("div","order-preview__title pf-mb-8",[tag("b","",this._par.title)]),tag("div","order-preview__additional-info",[this._getColorInfo(),this._getSizeInfo()])]).append(this.node)},_getImage:function(e){return this._par.designData.getMockupPreview(e,150,160)},_getColorInfo:function(){return this._par.color?tag("p",{innerHTML:PF.Components.ProductDetails.getColorTitle(this._par.designData.product)+": {color}".replace("{color}",this._par.color)}):""},_initSizePicker:function(){this._sizePicker=PF.VariantPicker.SizePicker(this._par.variants,this._onSizeChanged.bind(this),""),this._par.selectedVariant&&this._sizePicker.setVariant(this._par.selectedVariant)},_getSizeInfo:function(){return this._par.size?tag("p",{innerHTML:lang("Size: {size}").replace("{size}",this._par.size)}):this._sizePicker},_onSizeChanged:function(e){this._sizePicker.updateErrorStatus();var t=this._getVariantBySize(e);console.log("Variant selected: ",t),console.log("Size selected: ",e),this._par.onVariantSelected&&this._par.onVariantSelected(t)},_getVariantBySize:function(e){return this._par.variants.filter((function(t){return t.size===e})).pop()},checkErrorState:function(){this._sizePicker.updateErrorStatus()}},mkE.Base)}()},el0J:function(e,t){!function(){"use strict";PF.MockupGenerator.OrderPreview=Class({_selectedVariantIds:[],_par:null,footerNode:null,_state:0,_isInProcess:!1,_rows:[],_data:{},_optionsPicker:null,__construct:function(e){this._par=e,this._repo=new PF.Repositories.Products,this._storeId=this._par.storeId||PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID,this._data.options=$.extend({},this._par.designData.productOptions),this.node=tag("div","order-preview"),this._par.contentScrollable&&(this.node.style.overflowX="hidden",this.node.style.overflowY="auto",this.node.style.maxHeight="500px"),this._selectedVariantIds=this._restoreSelectedVariantIdsFromStorage(),this._shouldShowOptions()&&this._initOptionsPicker(),this.render()},render:function(){mkE.clearNode(this.node);var e=this._getVariantsGrouped();e.forEach(function(e){var t=new PF.MockupGenerator.OrderPreview.Row.Par;t.title=this._par.designData.product.getFullTitle(),t.color=e.color,t.size=e.size,t.generatorVariant=e.generatorVariants.slice().shift(),t.variants=e.variants,t.designData=this._par.designData,t.selectedVariant=this._getSelectedVariant(e.variants.map((function(e){return e.variantId}))),t.onVariantSelected=this._onVariantSelected.bind(this,e.variants),1===t.variants.length&&(this._getSelectedVariant([t.variants[0].variantId])||this._selectedVariantIds.push(t.variants[0].variantId));var i=new PF.MockupGenerator.OrderPreview.Row(t);i.append(this.node),this._rows.push(i)}.bind(this)),this._cleanUpSelectedVariantIds(e),console.log(this._selectedVariantIds),this._shouldShowOptions()&&tag("div","row",[tag("div","col-xs-12 col-sm-8 offset-sm-4",[this._getOptionsInfo()])]).append(this.node)},getFooterNode:function(){if(this.footerNode)return this.footerNode;var e=this._isProceedToPricingDisabled()?" disabled":"";return this.footerNode=tag("div","row",[tag("div","col-md-12",[this.ctaButtonNode=tag("a",{className:"btn btn-danger pull-left"+e,onclick:this._onProceedToPricing.bind(this),style:{pointerEvents:"auto"}},dlang("generator","Proceed to pricing")),tag("a",{className:"pf-link pull-left margin-left-20 pf-py-0",style:{lineHeight:"39px"},onclick:this._onEditDesign},dlang("generator","Edit design"))]),this._footerErrorNode=tag("div","pf-text-red pf-bold text-center")])},_onEditDesign:function(){this._state+=1,this._saveSelectedVariantIdsToStorage(this._selectedVariantIds),this._par.onEditDesign&&this._par.onEditDesign()},_hasPartial3dPuffEmbroideryType:function(){if(!PF.Utils.BetaAccess().hasNewEmbroideryThreadColorPicker()||!this._par.designData||!this._par.designData.templates)return!1;var e=this._par.generatorParams.availablePlacements.map((function(e){return e.id}));for(var t in e){if(PF.ProductPush.EmbroideryHelper.prototype.getEmbrTypeForPlacement(this._par.designData.templates,e[t])===PF.Items.OrderLineItemFile.DIGITIZATION_BOTH)return!0}return!1},_isEmbroideryNotesEmpty:function(){return!this._data.options[PF.Items.ProductOptionItem.NAME_NOTES]},_shouldShowEmbrNotesMissingError:function(){return this._hasPartial3dPuffEmbroideryType()&&this._isEmbroideryNotesEmpty()},_isProceedToPricingDisabled:function(){return this._getVariantsGrouped().length!==this._selectedVariantIds.length||this._shouldShowOptions()&&!this._optionsPicker.isValuePicked()||this._shouldShowEmbrNotesMissingError()},_onProceedToPricing:function(){this._isProceedToPricingDisabled()?this._renderRowErrors():this._isInProcess?console.error("One request is already in process"):(ga("send","event","MockupGenerator","Clicked proceed to pricing",this._par.viewName),this._clearSelectedVariantIdsFromStorage(),PF.LoadingOverlay.show(this.node),this._isInProcess=!0,this.node.style.overflowY="hidden",mkE.addClassName(this.ctaButtonNode,"disabled"),(new PF.Repositories.GeneratorRepository).generateLibraryFiles(this._buildDesignDataForOrderPreview(),[PF.Items.OrderLineItemFile.TYPE_MOCKUP],!1,{onProgress:this._onMockupGenerationInProgress,onCompleted:this._onMockupGenerationCompleted.bind(this,this._state),onFailed:this._onMockupGenerationFailed,onStarted:this._onMockupGenerationStarted}))},_renderRowErrors:function(){this._rows.forEach((function(e){e.checkErrorState()})),this._shouldShowOptions()&&this._optionsPicker.updateErrorStatus(),this._setFooterErroMsgIfNeeded()},_cleanUpSelectedVariantIds:function(e){for(var t=e.reduce((function(e,t){var i=t.variants.map((function(e){return e.variantId}));return e.concat(i)}),[]),i=this._selectedVariantIds.length-1;i>=0;i--)-1===t.indexOf(this._selectedVariantIds[i])&&this._selectedVariantIds.splice(i,1)},_getTemplateKeysToSave:function(){var e=[];for(var t in this._par.designData.templates)e.push(t);return e},_getPlacementIdsToSave:function(){return this._par.designData.getPlacementIdsWithDesign()},_onMockupGenerationInProgress:function(e){this.ctaButtonNode&&(this.ctaButtonNode.textContent=dlang("generator","In progress - {status}").replace("{status}",e))},_onMockupGenerationCompleted:function(e,t){this._stateCheck(e)&&(this.ctaButtonNode&&(this.ctaButtonNode.textContent=lang("Completed")),console.log(t),this._newOrder(t))},_onMockupGenerationFailed:function(){this.ctaButtonNode&&(this.ctaButtonNode.textContent=dlang("generator","Generating failed. Please try again."),mkE.removeClassName(this.ctaButtonNode,"disabled")),this._isInProcess=!1},_onMockupGenerationStarted:function(e,t,i){this.ctaButtonNode.textContent=lang("Processing files..."),i&&(this._par.generatorDesignId=i)},_getLocalStorage:function(){try{return window.localStorage}catch(e){return null}},_restoreSelectedVariantIdsFromStorage:function(){var e,t=this._getLocalStorage();if(null===t)return[];try{e=t.getItem(PF.MockupGenerator.OrderPreview.STORAGE_KEY)}catch(e){console.error("Order preview - could not get selected variant ids")}if(!e)return[];var i=JSON.parse(e);return Array.isArray(i)?i:[]},_saveSelectedVariantIdsToStorage:function(e){var t=this._getLocalStorage();if(null===t)return!1;try{t.setItem(PF.MockupGenerator.OrderPreview.STORAGE_KEY,JSON.stringify(e))}catch(e){console.error("Order preview - Could not save selected variant ids")}return!0},_clearSelectedVariantIdsFromStorage:function(){this._saveSelectedVariantIdsToStorage([])},_getSelectedVariant:function(e){for(var t in e)if(-1!==this._selectedVariantIds.indexOf(e[t]))return this._repo.getCachedVariantById(e[t]);return null},_onVariantSelected:function(e,t){e&&e.forEach(function(e){-1!==this._selectedVariantIds.indexOf(e.variantId)&&this._selectedVariantIds.splice(this._selectedVariantIds.indexOf(e.variantId),1)}.bind(this)),t&&!this._getSelectedVariant([t.variantId])&&this._selectedVariantIds.push(t.variantId),this.ctaButtonNode&&!this._isProceedToPricingDisabled()&&mkE.removeClassName(this.ctaButtonNode,"disabled"),console.log(this._selectedVariantIds)},_getVariantsGrouped:function(){var e=this._par.generatorParams.colors.length>0,t=-1!==[PF.Items.ProductItem.TYPE_T_SHIRT,PF.Items.ProductItem.TYPE_CUT_SEW,PF.Items.ProductItem.TYPE_SHOES,PF.Items.ProductItem.TYPE_JEWELRY,PF.Items.ProductItem.TYPE_SUBLIMATION].indexOf(this._par.designData.product.type),i=[PF.Items.ProductItem.TYPE_MUG],n=[PF.Items.ProductItem.ID_COLOR_MUG],r=-1!==i.indexOf(this._par.designData.product.type)&&-1===n.indexOf(this._par.designData.product.productId),a=(e||t)&&!r&&!this._par.designData.product.isPillow()&&!this._par.designData.product.isLaptopSleeve();return this._getGroupedVariantsBy(a?"color":"size")},_getGroupedVariantsBy:function(e){var t=[null];return this._par.designData[e+"s"]&&this._par.designData[e+"s"].length&&(t=this._par.designData[e+"s"]),t.map(function(t){var i=this._getMappedVariantsByType(e,t);return{color:"color"===e?t:null,size:"size"===e?t:null,mappedVariants:i,variants:i.filter(function(e){return-1!==this._par.designData.sizes.indexOf(e.size)||null===e.size}.bind(this)).map(function(e){return this._repo.getCachedVariantById(e.variantId)}.bind(this)),generatorVariants:this._getGeneratorVariantsFromMapping(i)}}.bind(this))},_getMappedVariantsByType:function(e,t){return this._par.generatorParams.variantMapping.filter((function(i){return i[e]===t}))},_getGeneratorVariantsFromMapping:function(e){return e.reduce(function(e,t){var i;for(i in t.mockupIds)e=e.concat(this._par.designData.generatorVariants.filter((function(e){return t.mockupIds[i]===e.generatorVariantId})));for(i in t.templateIds)e=e.concat(this._par.designData.generatorVariants.filter((function(e){return t.templateIds[i]===e.generatorVariantId})));return e}.bind(this),[])},_buildDesignDataForOrderPreview:function(){var e={};mkE.O2O(e,this._par.designData),e.templateKeysToSave=this._getTemplateKeysToSave();var t=[];for(var i in this._selectedVariantIds){var n=this._filterVariantMappingByVariantId(this._selectedVariantIds[i]),r=this._getDefaultGeneratorVariantId(n);null!==r&&t.push(r)}return e.generatorVariantsIdsToSave=t.filter((function(e,t,i){return i.indexOf(e)===t})),e.multipleMockups=!0,e.storeId=this._storeId,e.productOptions=this._data.options,e},_includesMockupGeneratorVariantIds:function(){return this._par.designData.generatorVariants.reduce((function(e,t){return-1===[PF.Items.GeneratorVariantItem.ROLE_TEMPLATE,PF.Items.GeneratorVariantItem.ROLE_ADVANCED_TEMPLATE].indexOf(t.role)||e}),!1)},_newOrder:function(e){this._storeId===PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID&&(PF.Repositories.OrderRepository.URL_REF=PF.OrderBegin.B2C_FLOW_KEY),RPC("order/new-order",{storeId:this._storeId,isSampleOrder:this._par.orderType===PF.OrderBegin.ORDER_TYPE_SAMPLE?1:0,isScreenMode:0},this._newOrderRe.bind(this,this._state,e))},_newOrderRe:function(e,t,i){if(this._stateCheck(e)){var n=this._getItems(t),r=new PF.Repositories.OrderRepository;if(i.success){var a={orderItem:PF.Items.OrderItem.fromArray({storeId:this._storeId}),items:n,itemsToRemove:[],callback:this._saveDraftRe.bind(this,this._state)};r.saveDraft(a)}else alert("Could not create new order")}},_saveDraftRe:function(e,t){if(this._stateCheck(e)){PF.LoadingOverlay.hide(this.node),this._isInProcess=!1,this.node.style.overflowY="auto",this.ctaButtonNode&&mkE.removeClassName(this.ctaButtonNode,"disabled"),console.log("Order 'created'"),console.log(t);var i=langUrl("/dashboard/order/update");if(this._storeId===PF.Repositories.StoreRepository.ANONYMOUS_STORE_ID){var n=new Url(i);n.query.ref=PF.OrderBegin.B2C_FLOW_KEY,i=n.toString()}ga("send",{hitType:"event",eventCategory:"Button Clicks",eventAction:"Continue Button",eventLabel:"Continue to checkout (step 1) button clicked"}),console.log("Order saved. Redirecting..."),console.log(i);try{location.assign(i)}catch(e){location.href=i}}},_getItems:function(e){var t=[];return this._selectedVariantIds.forEach(function(i){var n=new PF.Items.OrderLineItem;n.options=this._data.options,n.variantId=i,n.quantity=1,n.itemFiles=this._filterFilesForOrderLineItem(i,e),n.designId=this._par.generatorDesignId?this._par.generatorDesignId:null;var r=this._repo.getCachedVariantById(i);r&&(n.technique=new PF.Utils.TechniqueMemory(r.productId).getTechniqueFromMemory()),t.push(n)}.bind(this)),t},_filterFilesForOrderLineItem:function(e,t){var i=this._filterVariantMappingByVariantId(e);console.log(i);var n=this._getPossibleGeneratorVariantIds(i);console.log(n);var r=this._getGeneratorVariantsByIds(n),a=r.map((function(e){return e.generatorVariantId})),o=r.map((function(e){return e.templateId})),s=this._getRelatedTemplateIds(o);console.log(r);var c=[],d=[];for(var l in t){t[l].filter(this._filterVariantPlacementFilesFunction.bind(this,a,o,s)).forEach(function(e,t){-1!==d.indexOf(e)&&e===PF.Items.OrderLineItemFile.TYPE_MOCKUP||(e===PF.Items.OrderLineItemFile.TYPE_MOCKUP&&d.push(e),c.push(this._fileToItemFile(t)))}.bind(this,l))}for(var h in this._par.designData.templates){var u=this._par.designData.templates[h];if(0!==u.layers.length&&(this._isTemplateSimpleDesign(u)&&(-1!==s.indexOf(u.templateId)||-1!==o.indexOf(u.templateId))&&-1===d.indexOf(u.placementId))){var p=u.layers.slice(0,1).pop(),_=new PF.Items.OrderLineItemFile;_.type=u.placementId,_.fileId=p.fileItem.fileId,_.position=p.position,c.push(_),d.push(u.placementId)}}return c},_fileToItemFile:function(e){var t=new PF.Items.OrderLineItemFile;return t.type=e.placementId,t.status=e.status,t.fileId=e.fileId,t.group=e.group,t.fileErrors=[],t},_filterVariantMappingByVariantId:function(e){return this._par.generatorParams.variantMapping.filter((function(t){return t.variantId===e}))},_getPossibleGeneratorVariantIds:function(e){return e.reduce((function(e,t){var i;for(i in t.templateIds)e.push(t.templateIds[i]);for(i in t.mockupIds)e.push(t.mockupIds[i]);for(i in t.extraIds)e=e.concat(t.extraIds[i]);return e}),[])},_getDefaultGeneratorVariantId:function(e){var t=this._getPlacementIdsToSave();for(var i in e){var n=e[i];for(var r in t){var a=t[r];if(n.mockupIds[a])return n.mockupIds[a];if(n.extraIds[a])return n.extraIds[a][0]}}return null},_getGeneratorVariantsByIds:function(e){var t=Object.keys(this._par.generatorParams.generatorVariants).filter(function(t){return!e||-1!==e.indexOf(this._par.generatorParams.generatorVariants[t].generatorVariantId)}.bind(this)).map(function(e){return this._par.generatorParams.generatorVariants[e]}.bind(this));if(this._includesMockupGeneratorVariantIds())return t;var i=[];for(var n in this._par.generatorParams.generatorVariants){var r=this._par.generatorParams.generatorVariants[n];e&&-1===e.indexOf(r.generatorVariantId)||-1===this._par.designData.generatorVariantsIdsToSave.indexOf(r.generatorVariantId)||i.push(r)}return t.concat(i)},_getRelatedTemplateIds:function(e){var t,i,n=[];for(i in this._par.designData.templates)(t=this._par.designData.templates[i]).parentTemplateId&&-1!==e.indexOf(t.templateId)&&n.push(t.parentTemplateId);var r=[];for(i in this._par.designData.templates)t=this._par.designData.templates[i],-1===n.indexOf(t.parentTemplateId)&&-1===n.indexOf(t.templateId)||r.push(t.templateId);return r},_filterVariantPlacementFilesFunction:function(e,t,i,n){var r=null===n.generatorVariantId||-1!==e.indexOf(n.generatorVariantId),a=-1!==t.concat(i).indexOf(n.templateId);return r&&a},raiseState:function(){this._state+=1,console.log(this._state)},_stateCheck:function(e){return e!==this._state&&console.log("States didn't match, skipping...",this._state,e),e===this._state},_shouldShowOptions:function(){return-1!==[PF.Items.ProductItem.TYPE_CUT_SEW,PF.Items.ProductItem.TYPE_SUBLIMATION,PF.Items.ProductItem.TYPE_EMBROIDERY].indexOf(this._par.designData.product.type)},_initOptionsPicker:function(){var e=new PF.Components.ProductOptions.Par;e.values=this._data.options,e.onChange=this._onOptionPickedCallback,e.inputNamePrefix="op_",e.optionItems=this._par.designData.product.getOptionItems(this._par.designData.product.getOptionExceptions().concat([PF.Items.ProductOptionItem.NAME_THREAD_COLORS,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_3D,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_LEFT,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_RIGHT,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_BACK,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_APPAREL,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_CHEST_CENTER,PF.Items.ProductOptionItem.NAME_THREAD_COLORS_CHEST_LEFT])).map((function(e){return e.isEmbroideryType()&&(e.visible=!1),e})),this._optionsPicker=new PF.VariantPicker.OptionPicker(e),this._optionsPicker.setFileTypesWithFiles(this._getPlacementsWithFiles())},_getPlacementsWithFiles:function(){var e=[];for(var t in this._par.designData.filesIdsByPlacement)e.push(t);return e},_onOptionPickedCallback:function(e){this._data.options[e.getName()]=e.getValue(),this._optionsPicker.hideError(),this.ctaButtonNode&&(this._isProceedToPricingDisabled()?mkE.addClassName(this.ctaButtonNode,"disabled"):mkE.removeClassName(this.ctaButtonNode,"disabled"),this._setFooterErroMsgIfNeeded()),this._par.onProductOptionsChanged&&this._par.onProductOptionsChanged(this._data.options)},_setFooterErroMsgIfNeeded:function(){this._footerErrorNode.innerHTML=this._shouldShowEmbrNotesMissingError()?dlang("dashboard","To continue, please specify which parts of your design are Flat and which 3D in the Embroidery notes"):""},_getOptionsInfo:function(){return!!this._optionsPicker&&this._optionsPicker},_isTemplateSimpleDesign:function(e){return!this._par.designData.hasPlacementDesignFillColorSet(e.placementId)&&e.isSimple()}},mkE.Base),PF.MockupGenerator.OrderPreview.STORAGE_KEY="mockupGeneratorSelectedVariants"}()},hdhN:function(e,t){!function(){"use strict";PF.MockupGenerator.OrderPreview.Par=Class({onEditDesign:null,designData:null,generatorParams:null,storeId:null,contentScrollable:!1,viewName:"",onProductOptionsChanged:null,orderType:PF.OrderBegin.ORDER_TYPE_BASIC,generatorDesignId:null})}()},hh1a:function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker.MainGroupItem=Class({__NAME:"PF.MockupGenerator.GeneratorPicker.MainGroupItem",_par:null,_nodeInput:null,_resizeTimeout:null,_mockupMainMaxWidth:159,_mockupMainMaxHeight:159,_defaultImageBreakpoint:992,__construct:function(e){this._par=e,this._nodeInput=tag("input",{className:"pf-mr-8",type:this._par.isRadio?"radio":"checkbox",value:this._par.itemTitle.text}),this._title=tag("div","generator-picker__main-group-text text-center pf-mt-12",dlang("generator","{title} mockups").replace("{title}",this._par.itemTitle.text)),this._contentBlock=tag("div"),this.node=tag("div",{className:"generator-picker__main-group-item",onclick:this._par.onNodeClickCallback.bind(this,this.getItem())}),this._render()},_render:function(){mkE.clearNode(this.node),this._nodeInput.append(this.node),this.setCheckedState(this._par.isChecked),this._contentBlock.append(this.node),this._renderContent(),this._par.itemTitle.isVisible&&this._title.append(this.node)},_renderState:function(){var e="generator-picker__main-group-item--active";this._nodeInput.checked?mkE.addClassName(this.node,e):mkE.removeClassName(this.node,e)},_renderContent:function(){if(!this._par.mockupPreview&&!this._par.generatorVariant)return!1;mkE.clearNode(this._contentBlock),this._par.content=this._par.mockupPreview(this._par.generatorVariant,this._recalculateMockupSize()),this._par.content.append(this._contentBlock),this.setPhotificLabel()},_onResize:function(){clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(this._renderContent(),300)},_recalculateMockupSize:function(){var e=1,t=this._mockupMainMaxWidth,i=this._mockupMainMaxHeight;return t>(window.innerWidth>=this._defaultImageBreakpoint?t:100)&&(e=t/(window.innerWidth>=this._defaultImageBreakpoint?t:100)),{maxWidth:t/e,maxHeight:i/e}},setCheckedState:function(e){this._nodeInput.checked=e,this._renderState()},isChecked:function(){return this._nodeInput.checked},getItem:function(){return this},getGroupName:function(){return this._par.itemTitle.text},getGeneratorVariantId:function(){return this._par.item.generatorVariantId},hasPhotificLabel:function(){return PF.Items.ProductItem.prototype.getPhotificOptionGroups(this._par.productId).includes(this._par.generatorVariant.noTranslationOptionGroup)},setPhotificLabel:function(){return!!this.hasPhotificLabel()&&tag("span",{className:"pf-py-0 pf-badge pf-badge-small pf-badge--default",style:{position:"absolute",right:"5px",bottom:"7.9px",zIndex:10,height:"auto"},innerHTML:dlang("generator","by Photific")}).append(this._contentBlock.children[0])}},mkE.Base)}()},pnlN:function(e,t){!function(){"use strict";PF.MockupGenerator.BundleOrderPreview.Par=Class({onChildComponentProductOptionsChanged:null,designData:null,generatorParams:null,editDesignCallback:null})}()},r6K3:function(e,t){!function(){"use strict";PF.MockupGenerator.ProductPicker=Class({__construct:function(e,t,i){this._repository=new PF.Repositories.CategoryRepository,this._onCategoryPicked=t,this._withoutBreadcrumbs=i,this.node=mkE({tag:"div"}),this._renderCategory(e)},_renderCategoryPicker:function(e){var t=new PF.CategoryPicker.Par;t.pickForGenerator=!0,t.callback=this._onCategoryPickerPicked,t.categoryId=e,t.onSubCategoryPicked=this._onNavigateCategoryPicker,t.withoutBreadcrumbs=!!this._withoutBreadcrumbs,this._picker=new PF.CategoryPicker(t),this._picker.append(this.node)},_onCategoryPickerPicked:function(e){this._onNavigateCategoryPicker(e),this._renderProductPicker(e)},_renderProductPicker:function(e){this._onNavigateCategoryPicker(e);var t=new PF.ProductPicker.Par;t.callback=this._onProductPicked,t.categoryId=e,t.isForGenerator=!0,t.showFulfillmentCountries=!1,mkE.clearNode(this.node),this._withoutBreadcrumbs||mkE({tag:"div",className:"margin-bottom-10",els:[this._getProductCategoryBreadcrumbs(e)]}).append(this.node),new PF.ProductPicker(t).append(this.node)},_onNavigateCategoryPicker:function(e){this._updateDocumentUrl(e),this._onCategoryPicked&&this._onCategoryPicked(e)},_getProductCategoryBreadcrumbs:function(e){var t=new PF.Components.BreadCrumbs,i=(new PF.Repositories.CategoryRepository).getPath(e);for(var n in t.add({title:lang("All categories"),onclick:this._onProductBreadcrumbClicked.bind(this,0)}),i)t.add({title:i[n].name,onclick:this._onProductBreadcrumbClicked.bind(this,i[n].categoryId)});return t},_onProductBreadcrumbClicked:function(e){this._onNavigateCategoryPicker(e),this._renderCategory(e)},_renderCategory:function(e){mkE.clearNode(this.node);var t=e?this._repository.getById(e):null;t&&!t.hasChildren?this._renderProductPicker(e):this._renderCategoryPicker(e)},_updateDocumentUrl:function(e){if(history&&history.replaceState){var t=langUrl("/generator");if(e)t=this._repository.getById(e).getMockupGeneratorUrl();history.replaceState(null,document.title,t)}},_onProductPicked:function(e){location.href=e.getMockupGeneratorUrl()},pickCategory:function(e){this._onNavigateCategoryPicker(e),this._renderCategory(e)}},mkE.Base)}()},rrge:function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker.Row=Class({__NAME:"PF.MockupGenerator.GeneratorPicker.Row",_rowItems:[],_checkbox:null,_isShowLessVisible:!1,_maxVisibleItems:6,_par:null,__construct:function(e){this._par=e,this.node=tag("div","generator-picker pf-mb-12",[this._renderHeader(),this._nodeItems=tag("div","generator-picker__wrapper"),this._showLessLink=tag("div",{className:"generator-picker__show-less hidden",onclick:this._onShowOtherItems},clang("action","Show less"))]),this._render(),this._updateCheckboxAndListState()},_render:function(){for(var e in mkE.clearNode(this._nodeItems),this._rowItems=[],this._par.items){var t,i=this._par.items[e],n="",r=parseInt(e)===this._maxVisibleItems-1&&this._par.items.length>this._maxVisibleItems;i instanceof PF.Items.GeneratorTemplateItem&&(n=this._allItemPlacementsTheSame()?this._getReadableSizeFromTemplate(i,this._allItemPrintfilesTheSame()):this._getReadablePlacement(i.placementId)),i instanceof PF.Items.GeneratorVariantItem&&(n=i.title),t=this._getImage(i),this._overlay={itemCount:this._par.items.length-this._maxVisibleItems,callback:this._onShowOtherItems,isVisible:r};var a=new PF.MockupGenerator.GeneratorPicker.Par;a.rowTitle=this._par.title,a.itemTitle.text=n,a.itemTitle.isVisible=!r,a.content=t,a.item=i,a.isRadio=!1,a.onChangedCallback=this._onRowItemChanged,a.overlay=this._overlay,a.activeItems=this._par.activeItems,a.inactiveItems=this._par.inactiveItems,a.onNodeClickCallback=function(){};var o=new PF.MockupGenerator.GeneratorPicker.RowItem(a);parseInt(e)>this._maxVisibleItems-1&&this._par.items.length>this._maxVisibleItems&&o.toggleVisibility(!0),this._rowItems.push(o),o.append(this._nodeItems)}},_renderHeader:function(){var e=new PF.Forms.CheckboxPar;return e.onchange=this._onCheckboxClick,e.label=this._par.title,e.isChecked=!0,tag("div","generator-picker__header",[this._checkbox=new PF.Forms.Checkbox(e)])},_allItemPlacementsTheSame:function(){var e=null;for(var t in this._par.items){var i=this._par.items[t];if(i instanceof PF.Items.GeneratorTemplateItem){if(null!==e&&e!==i.placementId)return!1;e=i.placementId}}return!0},_allItemPrintfilesTheSame:function(){var e=null;for(var t in this._par.items){var i=this._par.items[t];if(i instanceof PF.Items.GeneratorTemplateItem){if(null!==e&&e!==i.templateId)return!1;e=i.templateId}}return!0},_getReadablePlacement:function(e){for(var t in this._par.generatorParams.availablePlacements){var i=this._par.generatorParams.availablePlacements[t];if(i.id==e)return i.title}return e},_getReadableSizeFromTemplate:function(e,t){var i=this._getSizes(e);if(1===i.length)return i[0]||this._getReadablePlacement(e.placementId);var n=this._groupTitles(i,t);return n||this._par.designData.product.title},_getSizes:function(e){return Object.values(this._par.generatorParams.generatorVariants).filter((function(t){return t.templateId===e.templateId})).map((function(e){return e.size})).filter((function(e,t,i){return i.indexOf(e)===t}))},_groupTitles:function(e,t){for(var i=null,n=[],r=0,a=e.length;r<a;r++){var o=e[r],s=e[r<a-1?r+1:r],c=o.split(" "),d=[];n.push(c);for(var l=0,h=c.length;l<h;l++)if(-1!==s.indexOf(c[l])){var u=n[r>0?r-1:r][l];n[r][l]===u&&o.indexOf(c[l])===s.indexOf(c[l])&&d.push(c[l])}d.length===c.length&&d.pop(),(!i||d.length<i.length)&&(i=d)}var p=i.join(" ");return!p||t?p:p+=" "+n.map((function(e){return e.splice(i.length,e.length).join(" ")})).join(", ")},_getImage:function(e){var t=PF.Utils.isTouch()?100:120;return this._par.designData.getMockupPreview(e,t,t)},_onCheckboxClick:function(){this._rowItems.forEach(function(e){e.updateActiveState(this._checkbox.isChecked()),e.setCheckedState(this._checkbox.isChecked())}.bind(this)),PF.MockupGenerator.Tracking.trackFileRowCheckToggle(this._par.title,this._checkbox.isChecked()),this._onRowItemChanged(),this._updateCheckboxAndListState()},_onRowItemChanged:function(){this._checkbox.setChecked(this._getSelectedCount()>0),this._par.onChanged()},_onShowOtherItems:function(){for(var e in this._rowItems){var t=this._rowItems[e];parseInt(e)>this._maxVisibleItems-1&&t.toggleVisibility(),parseInt(e)===this._maxVisibleItems-1&&(t._par.overlay.isVisible=!t._par.overlay.isVisible,t._par.itemTitle.isVisible=!t._par.itemTitle.isVisible,t._render())}this._isShowLessVisible?mkE.addClassName(this._showLessLink,"hidden"):mkE.removeClassName(this._showLessLink,"hidden"),this._isShowLessVisible=!this._isShowLessVisible},_updateCheckboxAndListState:function(){var e=this._getSelectedCount();this._checkbox.setChecked(e>0),this._par.isPrintfiles||(e?mkE.removeClassName(this._nodeItems,"hidden"):mkE.addClassName(this._nodeItems,"hidden"))},getSelectedVariants:function(){var e=[];for(var t in this._rowItems){var i=this._rowItems[t];i.isChecked()&&i.isMockup()&&e.push(i.getItem())}return e},getSelectedTemplates:function(){var e=[];for(var t in this._rowItems){var i=this._rowItems[t];i.isChecked()&&i.isPrintfile()&&e.push(i.getItem())}return e},_getSelectedCount:function(){return this._rowItems.filter((function(e){return e.isChecked()})).length},getCount:function(){return this._rowItems.length}},mkE.Base)}()},t2vt:function(e,t){!function(){"use strict";PF.MockupGenerator.GeneratorPicker.RowItem=Class({__NAME:"PF.MockupGenerator.GeneratorPicker.RowItem",_par:null,_checkbox:null,_isHidden:!1,groupItem:null,__construct:function(e){this._par=e,this._overlayContent=tag("div",{className:"generator-picker__item-overlay",onclick:this._par.overlay.callback},[tag("span","item-overlay__count","+"+this._par.overlay.itemCount),tag("span","item-overlay__link",clang("action","See all"))]),this._checkbox=tag("input",{type:"checkbox",className:"margin-right-10",prop:{checked:this.isMockup()}}),this._title=tag("span","generator-picker__subtitle",this._par.itemTitle.text.replace(/ print$/,"")),this._tooltip=tag("div","generator-picker__item-tooltip",dlang("generator","Main mockup image")),this.node=tag("div",{className:"generator-picker__item",onclick:this._onClickItem}),this._render()},_render:function(){if(mkE.clearNode(this.node),!this._par.isRadio&&!this._par.isMockupUpdate){this._checkbox.append(this.node);var e=(!this.isMockup()||!this._par.item.isCloseUp())&&this._checkbox.checked;this.setCheckedState(e)}this._par.content.append(this.node),this._par.itemTitle.isVisible&&this._title.append(this.node),this._par.overlay.isVisible&&this._overlayContent.append(this.node),this._par.isRadio&&this._isDefault()},_onClickItem:function(e){return!this._par.overlay.isVisible&&"item-overlay__link"!==e.target.className&&("generator-picker__item-overlay"!==e.target.className&&(this._par.isRadio||(this._checkbox.checked=!this._checkbox.checked,this._checkboxCheckedChanged()),void("function"==typeof this._par.onNodeClickCallback&&this._par.onNodeClickCallback())))},_checkboxCheckedChanged:function(){this.updateActiveState(this.isChecked()),this._onStateChanged()},updateActiveState:function(e){e?(this.removeFromInactiveItemGroup(),this.addToActiveItemGroup()):(this.addToInactiveItemGroup(),this.removeFromActiveItemGroup())},_onStateChanged:function(){PF.MockupGenerator.Tracking.trackSingleFileCheckToggle(this._par.rowTitle,this._checkbox.checked),this._par.onChangedCallback()},setGroupItem:function(e){this.groupItem=e},getGroupItem:function(){return this.groupItem},setCheckedState:function(e){this.isInActiveItemGroup()?e=!0:this.isInInactiveItemGroup()?e=!1:this.updateActiveState(e),this._checkbox.checked=e},removeFromActiveItemGroup:function(){return!!this.isInActiveItemGroup()&&(this._par.activeItems.splice(this._par.activeItems.indexOf(this._par.item),1),!0)},removeFromInactiveItemGroup:function(){return!!this.isInInactiveItemGroup()&&(this._par.inactiveItems.splice(this._par.inactiveItems.indexOf(this._par.item),1),!0)},addToActiveItemGroup:function(){this.isInActiveItemGroup()||this._par.activeItems.push(this._par.item)},addToInactiveItemGroup:function(){this.isInInactiveItemGroup()||this._par.inactiveItems.push(this._par.item)},removeGroupItemOverlay:function(){this._par.overlay.isVisible=!this._par.overlay.isVisible,this._par.itemTitle.isVisible=!this._par.itemTitle.isVisible,this._par.itemTitle.isVisible?this._title.append(this.node):mkE.removeNode(this._title),this._par.overlay.isVisible?(this._overlayContent.append(this.node),$(this.node).attr("style","pointer-events: auto")):($(this.node).attr("style","pointer-events: none"),mkE.removeNode(this._overlayContent))},isInActiveItemGroup:function(){return-1!==this._par.activeItems.indexOf(this._par.item)},isInInactiveItemGroup:function(){return-1!==this._par.inactiveItems.indexOf(this._par.item)},isChecked:function(){return this._checkbox.checked},toggleVisibility:function(e){(e=void 0!==e?e:!this.isHidden())?mkE.addClassName(this.node,"pf-d-none"):mkE.removeClassName(this.node,"pf-d-none")},isHidden:function(){return mkE.hasClassName(this.node,"pf-d-none")},getItem:function(){return this._par.item},getGeneratorVariantId:function(){return this._par.item.generatorVariantId},isPrintfile:function(){return this._par.item instanceof PF.Items.GeneratorTemplateItem},isMockup:function(){return this._par.item instanceof PF.Items.GeneratorVariantItem},isActive:function(){return this._isActive},setActive:function(){if(this._par.isMockupUpdate)return!1;this._isActive=!0,mkE.addClassName(this.node,"generator-picker__item--selected"),this._tooltip.append(this.node)},setAsGroupActive:function(e){if(this._par.isMockupUpdate)return!1;e?(mkE.addClassName(this.node,"generator-picker__item--group-active"),this._tooltip.append(this.node)):(mkE.removeClassName(this.node,"generator-picker__item--group-active"),mkE.removeNode(this._tooltip))},removeActive:function(){this._isActive=!1,mkE.removeClassName(this.node,"generator-picker__item--selected"),mkE.removeNode(this._tooltip)},getSectionName:function(){return!!this.isMockup()&&this._par.item.option+"-"+this._par.item.size+"-"+this._par.item.color},_isDefault:function(){var e=this.getItem();return e.generatorVariantId===this._par.designData.defaultGeneratorVariantId&&(this._par.setActiveItemCallback(this),this.setActive()),e.generatorVariantId===this._par.designData.defaultGeneratorVariantId}},mkE.Base)}()},t5kI:function(e,t){!function(){"use strict";PF.MockupGenerator.Designer.DynamicStickyFooter=Class({_nodeBreakpoint:null,_unstickyClassName:"navigation__sticky-buttons--unstickied",_isAttached:!1,__construct:function(e,t){this.node=e,t&&(this._unstickyClassName+="-unpadded"),this.attach()},attach:function(){this._isAttached||(this._isAttached=!0,this._nodeBreakpoint=tag("div","navigation__sticky-buttons__unsticky-breakpoint"),mkE.insertBefore(this._nodeBreakpoint,this.node),this.subscribeToEvents(),this.updateFooterStickyState())},detach:function(){this._isAttached&&(this._isAttached=!1,mkE.removeNode(this._nodeBreakpoint),mkE.removeClassName(this.node,this._unstickyClassName),this.unsubscribeFromEvents())},subscribeToEvents:function(){document.addEventListener("scroll",this.updateFooterStickyState,!1),window.addEventListener("resize",this.updateFooterStickyState,!1),PF.Events.on(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE,this.updateFooterStickyState,this)},unsubscribeFromEvents:function(){document.removeEventListener("scroll",this.updateFooterStickyState,!1),window.removeEventListener("resize",this.updateFooterStickyState,!1),PF.Events.off(PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE,this.updateFooterStickyState)},updateFooterStickyState:function(){var e=this.node.offsetHeight,t=window.innerHeight,i=this._nodeBreakpoint.getBoundingClientRect().top+e<=t;i&&!this._isAlreadyUnstickied()?mkE.addClassName(this.node,this._unstickyClassName):!i&&this._isAlreadyUnstickied()&&mkE.removeClassName(this.node,this._unstickyClassName)},_isAlreadyUnstickied:function(){return mkE.hasClassName(this.node,this._unstickyClassName)}},mkE.Base),PF.MockupGenerator.Designer.DynamicStickyFooter.EVENT_UPDATE_STICKY_FOOTER_STATE="DynamicStickyFooter:EVENT_UPDATE_STICKY_FOOTER_STATE"}()},wQ4t:function(e,t){!function(){"use strict";PF.MockupGenerator.productPushPopup=Class({_key:"hasSeenProductPushPopup",__construct:function(){if(this._shouldShow()){this._setStorageItem(1);var e=new PF.Modal.Par;e.nodeClass="product-push-info";var t=new PF.Modal(e);t.setContent(mkE({tag:"div",className:"product-push-info",els:[{tag:"div",className:"product-push-info__header",text:dlang("generator","Create and publish new products straight to your Shopify, Storenvy, Woocommerce, Ecwid, Tictail or Bigcommerce store!")},{tag:"div",className:"margin-bottom-20",els:[{tag:"img",className:"img-responsive center-block",src:"/static/images/layout/pf-push-integrations.png"}]},{tag:"div",className:"text-center margin-bottom-15",els:[{tag:"a",className:"btn btn-danger",text:dlang("generator","Add new products"),href:langUrl("/dashboard/store?offerSync=1"),onclick:function(){ga("send",{hitType:"event",eventCategory:"Generator",eventAction:'Click "Add products" in popup'})}}]}]})),ga("send",{hitType:"event",eventCategory:"Generator",eventAction:'See "Add products" popup'}),setTimeout((function(){t.show()}),100)}},_setStorageItem:function(e){try{localStorage.setItem(this._key,e)}catch(e){console.log("Local storage not supported")}},_shouldShow:function(){return!(!localStorage||localStorage.getItem(this._key)&&!(new Url).query.forcePopup)}},mkE.Base)}()}},[[23,0]]]);